(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[96938],{3049:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fi-tax-schedules",function(){return t(90855)}])},90855:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return P}});var n=t(52322),s=t(2784),l=t(62202),o=t(69387),r=t(27723),d=t(65950),i=t(71987),c=t(26612),u=t(31389),m=t(33625),x=t(62362),b=t(61802),h=t(25870),f=t(29326),p=t(9522),_=t(60218),v=t(48601),C=t(82737),T=t(5088),I=t(80983),y=t(74898),g=t(19473);function j(e){let{labels:a,maxAccess:t,setStore:o,store:r,editMode:m}=e,{recordId:b}=r,{getRequest:f,postRequest:p}=(0,s.useContext)(d.$),{platformLabels:j}=(0,s.useContext)(g.l),S=(0,i.E)({endpointId:h.H.TaxSchedules.qry}),{formik:Z}=(0,I.c)({initialValues:{recordId:null,name:"",reference:"",nonDeductible:!1},maxAccess:t,validateOnChange:!0,validationSchema:v.Ry({name:v.Z_().required(),reference:v.Z_().required()}),onSubmit:async e=>{let a=await p({extension:h.H.TaxSchedules.set,record:JSON.stringify(e)});b||(o(e=>({...e,recordId:a.recordId})),Z.setValues({...e,recordId:a.recordId})),l.ZP.success(e.recordId?j.Edited:j.Added),S()}});(0,s.useEffect)(()=>{!async function(){if(b){let e=await f({extension:h.H.TaxSchedules.get,parameters:"_recordId=".concat(b)});Z.setValues(e.record)}}()},[]);let N=[{key:"Integration Account",condition:!0,onClick:"onClickGIA",masterSource:y.N.TaxCode,disabled:!m}];return(0,n.jsx)(C.Z,{resourceId:c.i.TaxSchedules,form:Z,maxAccess:t,editMode:m,actions:N,children:(0,n.jsx)(u.R,{children:(0,n.jsx)(x.Q,{children:(0,n.jsxs)(_.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(T.Z,{name:"reference",label:a.reference,value:Z.values.reference,required:!0,maxAccess:t,onChange:Z.handleChange,onClear:()=>Z.setFieldValue("reference",""),error:Z.touched.reference&&!!Z.errors.reference})}),(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(T.Z,{name:"name",label:a.name,value:Z.values.name,required:!0,maxAccess:t,maxLength:"30",onChange:Z.handleChange,onClear:()=>Z.setFieldValue("name",""),error:Z.touched.name&&!!Z.errors.name})})]})})})})}var S=t(76399),Z=t(84100),N=e=>{let{store:a,setStore:t,maxAccess:o,labels:r,editMode:i}=e,{recordId:m}=a,{getRequest:b,postRequest:f}=(0,s.useContext)(d.$),{formik:p}=(0,I.c)({validateOnChange:!0,maxAccess:o,initialValues:{TaxDetail:[{id:1,taxId:m||null,taxCodeId:"",taxBase:"",amount:"",taxCodeName:"",seqNo:""}]},validationSchema:v.Ry({TaxDetail:v.IX().of(v.Ry().shape({amount:v.Z_().required(),taxBase:v.Z_().required(),taxCodeId:v.Z_().required()})).required()}),onSubmit:async e=>{await _(e)}}),_=async e=>{let a=null==e?void 0:e.TaxDetail.map((e,a)=>({...e,taxId:m,seqNo:a+1}));await f({extension:h.H.TaxDetailPack.set2,record:JSON.stringify({taxId:m,items:a})}).then(e=>{l.ZP.success("Record Edited Successfully"),t(e=>({...e,TaxDetail:a}))})};return(0,s.useEffect)(()=>{m&&b({extension:h.H.TaxDetailPack.qry,parameters:"_taxId=".concat(m)}).then(e=>{var a;if((null==e?void 0:null===(a=e.list)||void 0===a?void 0:a.length)>0){let a=e.list.map((e,a)=>({...e,id:a+1,taxCodeId:e.taxCodeId,taxBase:e.taxBase,amount:e.amount,taxCodeName:e.taxCodeName}));p.setValues({TaxDetail:a}),t(e=>({...e,TaxDetail:a}))}})},[]),(0,n.jsx)(C.Z,{form:p,resourceId:c.i.TaxCodes,maxAccess:o,isInfo:!1,editMode:i,isParentWindow:!1,children:(0,n.jsx)(u.R,{children:(0,n.jsx)(x.Q,{children:(0,n.jsx)(S._,{onChange:e=>p.setFieldValue("TaxDetail",e),value:p.values.TaxDetail,error:p.errors.TaxDetail,columns:[{component:"resourcecombobox",label:r.taxCode,name:"taxCodeId",props:{endpointId:h.H.TaxCodes.qry,displayField:"name",valueField:"recordId",mapping:[{from:"recordId",to:"taxCodeId"},{from:"name",to:"taxCodeName"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}]}},{component:"resourcecombobox",label:r.taxBase,name:"taxBase",props:{datasetId:Z.v.FI_TAX_BASE,displayField:"value",valueField:"key",mapping:[{from:"value",to:"taxBaseName"},{from:"key",to:"taxBase"}]}},{component:"numberfield",label:r.amount,name:"amount",decimalScale:2}]})})})})},A=e=>{let{recordId:a,labels:t,maxAccess:l,expanded:o}=e,[r,d]=(0,s.useState)(0),[i,c]=(0,s.useState)({recordId:a||null,TaxDetail:[]}),u=!!i.recordId,m=[{label:t.taxSchedules},{label:t.details,disabled:!i.recordId}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Y,{tabs:m,activeTab:r,setActiveTab:d,maxAccess:l}),(0,n.jsx)(f.Z,{index:0,value:r,maxAccess:l,children:(0,n.jsx)(j,{labels:t,setStore:c,store:i,editMode:u,maxAccess:l})}),(0,n.jsx)(f.Z,{index:1,value:r,maxAccess:l,children:(0,n.jsx)(N,{labels:t,setStore:c,maxAccess:l,store:i,expanded:o,editMode:u})})]})},P=()=>{let{getRequest:e,postRequest:a}=(0,s.useContext)(d.$),{stack:t}=(0,b.zY)();async function f(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:n=50}=a;return{...await e({extension:h.H.TaxSchedules.qry,parameters:"_startAt=".concat(t,"&_pageSize=").concat(n,"&filter=")}),_startAt:t}}let{query:{data:p},labels:_,paginationParameters:v,refetch:C,access:T}=(0,i.J)({queryFn:f,endpointId:h.H.TaxSchedules.qry,datasetId:c.i.TaxSchedules}),I=(0,i.E)({endpointId:h.H.TaxSchedules.qry}),y=[{field:"reference",headerName:_.reference,flex:1},{field:"name",headerName:_.name,flex:1}],g=async e=>{await a({extension:h.H.TaxSchedules.del,record:JSON.stringify(e)}),I(),l.ZP.success("Record Deleted Successfully")};function j(e){t({Component:A,props:{labels:_,recordId:e,maxAccess:T},width:800,height:460,title:_.taxSchedules})}return(0,n.jsxs)(u.R,{children:[(0,n.jsx)(m.g,{children:(0,n.jsx)(r.Z,{onAdd:()=>{j()},maxAccess:T})}),(0,n.jsx)(x.Q,{children:(0,n.jsx)(o.Z,{columns:y,gridData:p,rowId:["recordId"],onEdit:e=>{j(null==e?void 0:e.recordId)},onDelete:g,isLoading:!1,pageSize:50,refetch:C,paginationParameters:v,paginationType:"api",maxAccess:T})})]})}},74898:function(e,a,t){"use strict";t.d(a,{N:function(){return n}});let n={Global:0,AccountGroup:10,Account:11,CashAccountGroup:20,CashAccount:21,ItemGroup:30,Item:31,ItemCategory:32,Site:33,ExpenseType:41,CostType:42,ProductionOverhead:51,TaxCode:12,PayrollGLGroup:61,PayrollEntitlementDeduction:62,AssetGroup:71,AssetClass:72}},29326:function(e,a,t){"use strict";var n=t(52322);t(2784);var s=t(23925),l=t(13980),o=t.n(l),r=t(95291),d=t.n(r),i=t(65947);let c=e=>{var a,t,l;let{children:o,value:r,index:c,maxAccess:u,...m}=e,x="".concat(e.name||"tab",".").concat(c),{accessLevel:b}=null!==(l=(null!==(t=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==t?t:[]).find(e=>e.controlId===x))&&void 0!==l?l:{accessLevel:0};if(b===i.A1)return null;let h=r===c;return(0,n.jsx)(s.Z,{role:"tabpanel",hidden:!h,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c),className:"".concat(d().tabPanel," ").concat(h?d().active:d().hidden),...m,children:o})};c.propTypes={children:o().node,index:o().number.isRequired,value:o().number.isRequired},a.Z=c},9522:function(e,a,t){"use strict";t.d(a,{Y:function(){return m}});var n=t(52322),s=t(23925),l=t(54582),o=t(68696),r=t(44258),d=t(2784),i=t(99266),c=t(52614),u=t.n(c);let m=e=>{var a,t,c,m,x;let{tabs:b,activeTab:h,setActiveTab:f,maxAccess:p,name:_="tab"}=e,v=(null==p?void 0:null===(t=p.record)||void 0===t?void 0:null===(a=t.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(_,".")))}).map(e=>e.controlId.split(".")[1]))||[],C=null==b?void 0:null===(c=b.map((e,a)=>({...e,id:a})))||void 0===c?void 0:c.filter((e,a)=>!v.includes(String(a))),T=null===(m=C[h])||void 0===m?void 0:m.id,I=null===(x=C[h])||void 0===x?void 0:x.disabled;return(0,d.useEffect)(()=>{T>=0&&!I&&h!=T&&f(T)},[]),(0,n.jsx)(s.Z,{className:u().tabsContainer,children:(0,n.jsx)(s.Z,{className:u().tabsWrapper,children:(0,n.jsx)(l.Z,{value:h,onChange:(e,a)=>f(a),variant:"scrollable",scrollButtons:C.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==C?void 0:C.map(e=>(0,n.jsx)(o.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,n.jsxs)(s.Z,{display:"flex",alignItems:"center",children:[(0,n.jsx)("span",{children:e.label}),e.id===h&&(null==e?void 0:e.onRefetch)&&(0,n.jsx)(r.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,n.jsx)(i.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=3049)}),_N_E=e.O()}]);