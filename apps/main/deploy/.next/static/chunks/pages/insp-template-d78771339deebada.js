(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2248],{77349:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/insp-template",function(){return s(83184)}])},83184:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return R}});var a=s(52322),n=s(2784),r=s(62202),l=s(69387),i=s(27723),d=s(65950),o=s(61802),p=s(71987),c=s(26612),g=s(31389),u=s(33625),m=s(62362),T=s(19473),y=s(54736),P=s(60218),h=s(48601),q=s(82737),v=s(5088),E=s(80983),x=s(19689),f=s(76399);function S(e){var t;let{labels:s,maxAccess:l,recordId:i}=e,{getRequest:o,postRequest:S}=(0,n.useContext)(d.$),{platformLabels:R}=(0,n.useContext)(T.l),O=(0,p.E)({endpointId:y.m.InspectionTemplate.page}),{formik:W}=(0,E.c)({maxAccess:l,initialValues:{recordId:i,name:"",allowSkipTask:!1,items:[{id:1,itId:i||0,taskName:"",seqNo:1}]},validationSchema:h.Ry({name:h.Z_().required()}),onSubmit:async e=>{var t;let{items:s,...a}=e,n=null==s?void 0:null===(t=s.filter(e=>e.taskName))||void 0===t?void 0:t.map((e,t)=>({...e,id:t+1,seqNo:t+1,itId:i})),l=await S({extension:y.m.InspectionTemplate.set2,record:JSON.stringify({header:{...a},items:n})});r.ZP.success(e.recordId?R.Edited:R.Added),W.setFieldValue("recordId",l.recordId),O()}}),k=!!W.values.recordId;return(0,n.useEffect)(()=>{!async function(){if(i){var e,t,s;let a=await o({extension:y.m.InspectionTemplate.get2,parameters:"_recordId=".concat(i)}),n=null==a?void 0:null===(t=a.record)||void 0===t?void 0:null===(e=t.items)||void 0===e?void 0:e.map((e,t)=>({...e,id:t+1,seqNo:t+1}));W.setValues({...null==a?void 0:null===(s=a.record)||void 0===s?void 0:s.header,items:n})}}()},[]),(0,a.jsx)(q.Z,{resourceId:c.i.InspectionTemplate,form:W,maxAccess:l,editMode:k,children:(0,a.jsxs)(g.R,{children:[(0,a.jsx)(u.g,{children:(0,a.jsxs)(P.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(P.ZP,{item:!0,xs:12,children:(0,a.jsx)(v.Z,{name:"name",label:s.name,value:W.values.name,required:!0,maxAccess:l,maxLength:"30",onChange:W.handleChange,onClear:()=>W.setFieldValue("name",""),error:W.touched.name&&!!W.errors.name})}),(0,a.jsx)(P.ZP,{item:!0,xs:12,children:(0,a.jsx)(x.Z,{name:"allowSkipTask",value:null===(t=W.values)||void 0===t?void 0:t.allowSkipTask,onChange:e=>W.setFieldValue("allowSkipTask",e.target.checked),label:s.allowSkipTask,maxAccess:l})})]})}),(0,a.jsx)(m.Q,{children:(0,a.jsx)(f._,{onChange:e=>W.setFieldValue("items",e),name:"items",value:W.values.items,error:W.errors.items,maxAccess:l,columns:[{component:"textfield",label:s.task,name:"taskName"}],allowDelete:!0,allowAddNewLine:!0})})]})})}s(67920);var R=()=>{let{getRequest:e,postRequest:t}=(0,n.useContext)(d.$),{platformLabels:s}=(0,n.useContext)(T.l),{stack:P}=(0,o.zY)();async function h(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:s=0,_pageSize:a=50}=t;return{...await e({extension:y.m.InspectionTemplate.page,parameters:"_startAt=".concat(s,"&_pageSize=").concat(a,"&_filter=")}),_startAt:s}}let{query:{data:q},labels:v,invalidate:E,paginationParameters:x,refetch:f,access:R}=(0,p.J)({queryFn:h,endpointId:y.m.InspectionTemplate.page,datasetId:c.i.InspectionTemplate}),O=[{field:"name",headerName:v.name,flex:1}],W=async e=>{await t({extension:y.m.InspectionTemplate.del,record:JSON.stringify(e)}),E(),r.ZP.success(s.Deleted)};function k(e){P({Component:S,props:{labels:v,recordId:e,maxAccess:R},width:600,height:500,title:v.InspectionTemplate})}return(0,a.jsxs)(g.R,{children:[(0,a.jsx)(u.g,{children:(0,a.jsx)(i.Z,{onAdd:()=>{k()},maxAccess:R})}),(0,a.jsx)(m.Q,{children:(0,a.jsx)(l.Z,{name:"table",columns:O,gridData:q,rowId:["recordId"],onEdit:e=>{k(null==e?void 0:e.recordId)},onDelete:W,pageSize:50,refetch:f,paginationParameters:x,paginationType:"api",maxAccess:R})})]})}},54736:function(e,t,s){"use strict";s.d(t,{m:function(){return n}});let a="RS.asmx/",n={RepairName:{page:a+"pageRNA",qry:a+"qryRNA",get:a+"getRNA",set:a+"setRNA",del:a+"delRNA"},WorkOrderTypes:{page:a+"pageWOT",qry:a+"qryWOT",get:a+"getWOT",set:a+"setWOT",del:a+"delWOT"},RepairType:{page:a+"pageRT",get:a+"getRT",set:a+"setRT",del:a+"delRT"},SpareParts:{snapshot:a+"snapshotSP",page:a+"pageSP",get:a+"getSP",set:a+"setSP",del:a+"delSP"},InspectionTemplate:{get2:a+"get2ITE",page:a+"pageITE",set2:a+"set2ITE",del:a+"delITE"},Department:{page:a+"pageDEP",get:a+"getDEP",set:a+"setDEP",del:a+"delDEP"},Warehouse:{page:a+"pageWH",qry:a+"qryWH",set:a+"setWH",get:a+"getWH",del:a+"delWH"},PreventiveMaintenanceTasks:{qry:a+"qryPMT",page:a+"pagePMT",qry:a+"qryPMT",get:a+"getPMT",set:a+"setPMT",del:a+"delPMT"},Equipment:{qry:a+"qryEQP",page:a+"pageEQP",get:a+"getEQP",set:a+"setEQP",del:a+"delEQP",snapshot:a+"snapshotEQP"},SpManufacturer:{page:a+"pageSPM",get:a+"getSPM",set:a+"setSPM",del:a+"delSPM",qry:a+"qrySPM"},JobPosition:{page:a+"pagePOS",qry:a+"qryPOS",get:a+"getPOS",set:a+"setPOS",del:a+"delPOS"},SpCategory:{page:a+"pageSPC",get:a+"getSPC",set:a+"setSPC",del:a+"delSPC",qry:a+"qrySPC"},MaintenanceTemplates:{page:a+"pageMTE",get:a+"getMTE",set:a+"setMTE",del:a+"delMTE",qry:a+"qryMTE"},MaintenanceTemplateTask:{qry:a+"qryMTT",get:a+"getMTT",set:a+"setMTT",del:a+"delMTT"},RsLabors:{qry:a+"qryLBR",snapshot:a+"snapshotLBR",page:a+"pageLBR",set:a+"setLBR",get:a+"getLBR",del:a+"delLBR",qry:a+"qryLBR"},WorkOrder:{page:a+"qryWO",get:a+"getWO",set:a+"setWO",del:a+"delWO",post:a+"postWO"},WorkTask:{qry:a+"qryWTK",get:a+"getWTK",set:a+"setWTK",del:a+"delWTK"},EquipmentType:{qry:a+"qryEQT",get:a+"getEQT",set:a+"setEQT",del:a+"delEQT"},WorkOrderParts:{qry:a+"qryWOP",set2:a+"set2WOP"},WorkOrderLabors:{qry:a+"qryWOL",set2:a+"set2WOL"},RepairRequest:{page:a+"pageREQ",get:a+"getREQ",set:a+"setREQ",del:a+"delREQ"},Employee:{snapshot:a+"snapshotEMP"},RepairType:{qry:a+"qryRT"}}},67920:function(e,t,s){"use strict";s.d(t,{m:function(){return n}});var a=s(48601);function n(e,t,s){var n;let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",l={...e};return null==s||null===(n=s.record)||void 0===n||n.controls.forEach(e=>{let{controlId:t,accessLevel:s}=e,[a,n]=null==t?void 0:t.split(".");a!==r||2!==s||n in l||(l[n]=e=>(null==e?void 0:e[n])!=null),(1===s||4===s)&&n in l&&delete l[n]}),{schema:a.Ry().shape({...Object.keys(l).reduce((e,s)=>(e[s]=a.nK().nullable().test(function(e){var a;let n=this.parent,[,r]=this.path.match(/^(\w+)\[(\d+)\]/)||[],i=(null===(a=this.options.context)||void 0===a?void 0:a[r])||[];if(t||!t&&i.length>1){if(null!==n[s]&&void 0!==n[s]&&0!==n[s]&&""!==l[s]&&!l[s](n))return!1;if(!Object.entries(l).some(e=>{let[,t]=e;return!!t(n)}))return!0}return!!l[s](n)&&void 0!==e}),e),{})}),requiredFields:l}}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=77349)}),_N_E=e.O()}]);