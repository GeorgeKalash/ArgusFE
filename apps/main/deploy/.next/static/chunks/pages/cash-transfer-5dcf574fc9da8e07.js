(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[13145],{55271:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cash-transfer",function(){return t(2210)}])},2210:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return N}});var a=t(52322),n=t(2784),s=t(69387),o=t(27723),l=t(65950),c=t(38449),d=t(26612),i=t(71987),u=t(61802),f=t(57981),m=t(62202),v=t(2119),g=t(7121),h=t(33625),y=t(62362),I=t(31389),p=t(96026),w=t(98345),x=t(19473),N=()=>{let{postRequest:e,getRequest:r}=(0,n.useContext)(l.$),{stack:t}=(0,u.zY)(),{stack:N}=(0,p.V)(),{platformLabels:_}=(0,n.useContext)(x.l);async function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:a=50}=e;return{...await r({extension:v.G.CashTransfer.page,parameters:"_startAt=".concat(t,"&_pageSize=").concat(a)}),_startAt:t}}let{query:{data:T},filterBy:S,clearFilter:b,labels:D,refetch:A,access:k}=(0,i.J)({queryFn:C,endpointId:v.G.CashTransfer.page,datasetId:d.i.CashTransfer,filter:{endpointId:v.G.CashTransfer.snapshot,filterFn:O}});async function O(e){let{filters:t}=e;return await r({extension:v.G.CashTransfer.snapshot,parameters:"_filter=".concat(t.qry)})}let E=(0,i.E)({endpointId:v.G.CashTransfer.page}),q=window.sessionStorage.getItem("userData")?JSON.parse(window.sessionStorage.getItem("userData")):null,P=async()=>{var e;let t=await r({extension:c.r.UserDefaults.get,parameters:"_userId=".concat(q&&q.userId,"&_key=plantId")});return(null===(e=t.record)||void 0===e?void 0:e.value)?t.record.value:""},G=async()=>{var e;let t=await r({extension:c.r.UserDefaults.get,parameters:"_userId=".concat(q&&q.userId,"&_key=cashAccountId")});return(null===(e=t.record)||void 0===e?void 0:e.value)?t.record.value:""},J=async()=>{let e=await r({extension:c.r.UserFunction.get,parameters:"_userId=".concat(q&&q.userId,"&_functionId=").concat(g.J.CashTransfer)});return e.record?e.record.dtId:""};async function F(e){let r=await P(),t=await G(),a=await J();if(""!==r&&""!==t)Z(r,t,e,a);else if(e)Z(r,t,e,a);else{if(""===r){N({message:_.mustHaveDefaultPlant});return}if(""===t){N({message:_.mustHaveDefaultCashAcc});return}}}let R=[{field:"reference",headerName:D.reference,flex:1},{field:"date",headerName:D.date,flex:1,type:"date"},{field:"fromPlantName",headerName:D.fromPlant,flex:1},{field:"toPlantName",headerName:D.toPlant,flex:1},{field:"fromCAName",headerName:D.fromCashAcc,flex:1},{field:"toCAName",headerName:D.toCashAcc,flex:1},{field:"rsName",headerName:D.releaseStatus,flex:1},{field:"statusName",headerName:D.status,flex:1},{field:"wipName",headerName:D.wip,flex:1}],{proxyAction:$}=(0,w.G)({functionId:g.J.CashTransfer,action:F,hasDT:!1}),j=async r=>{await e({extension:v.G.CashTransfer.del,record:JSON.stringify(r)}),E(),m.ZP.success(_.Deleted)};function Z(e,r,a,n){t({Component:f.Z,props:{plantId:e,cashAccountId:r,dtId:n,recordId:a}})}return(0,a.jsxs)(I.R,{children:[(0,a.jsx)(h.g,{children:(0,a.jsx)(o.Z,{onAdd:()=>{$()},maxAccess:k,onSearch:e=>{S("qry",e)},onSearchClear:()=>{b("qry")},labels:D,inputSearch:!0})}),(0,a.jsx)(y.Q,{children:(0,a.jsx)(s.Z,{name:"table",columns:R,gridData:T,rowId:["recordId"],onEdit:e=>{F(e.recordId)},onDelete:j,isLoading:!1,pageSize:50,refetch:A,paginationType:"client",maxAccess:k})})]})}},1685:function(e,r,t){"use strict";t.d(r,{m:function(){return a}});let a=e=>{let r=window.sessionStorage.getItem(e);return r?JSON.parse(r):null}},98345:function(e,r,t){"use strict";t.d(r,{H:function(){return g},G:function(){return v}});var a=t(45300),n=t(2784),s=t(96026),o=t(38449);t(26612);var l=t(65947),c=t(1685);let d=async(e,r,t)=>{try{let a=await e({extension:r,parameters:t});return r.includes("qry")?a:a.record}catch(e){return null}},i=(e,r,t,a)=>{let n=(e=JSON.parse(JSON.stringify(e))).record.controls,s=n.find(e=>"reference"===e.controlId);return s?s.accessLevel=(null==r?void 0:r.mandatory)?l.$7:l.rr:(null==r?void 0:r.mandatory)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==r?void 0:r.mandatory)?l.$7:l.rr}):(null==r?void 0:r.readOnly)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==r?void 0:r.readOnly)?l.rr:l.$7}):n=e.record.controls.filter(e=>"reference"!=e.controlId),t&&n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","dtId"),accessLevel:l.$7}),{...e,record:{...e.record,controls:n}}},u=async(e,r,t)=>{let a,n;switch(t){case"dtId":let s=(0,c.m)("userData"),l=null==s?void 0:s.userId;n="_userId=".concat(l,"&_functionId=").concat(r),a=o.r.UserFunction.get;break;case"glbSysNumberRange":n="_recordId=".concat(r),a=o.r.SystemFunction.get;break;case"DocumentType":n="_dgId=".concat(r,"&_startAt=",0,"&_pageSize=",50),a=o.r.DocumentType.qry;break;case"DcTypNumberRange":n="_recordId=".concat(r),a=o.r.DocumentType.get;break;case"isExternal":n="_recordId=".concat(r),a=o.r.NumberRange.get;break;default:return null}return await d(e,a,n)},f=async function(e){let r,t,a,n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,c=!(arguments.length>4)||void 0===arguments[4]||arguments[4],d=arguments.length>5?arguments[5]:void 0,f=void 0===l&&s&&await u(e,s,"dtId"),m=null==f?void 0:f.dtId,v="",g=!0;if(f&&void 0===l||"nraId"===l){if(m){let t=await u(e,m,"DcTypNumberRange");r=null==t?void 0:t.nraId,g=!((null==t?void 0:t.activeStatus)<0),r||(v="Assign the document type to a number range")}if((!m||!g)&&c&&s){var h;let r=await u(e,s,"DocumentType");n=(null==r?void 0:null===(h=r.list)||void 0===h?void 0:h.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===l||void 0===l)&&s){if((!m||m)&&!r||r&&!g){let t=await u(e,s,"glbSysNumberRange");(r=null==t?void 0:t.nraId)&&n&&(n=!1),g=!0}v=r||n?"":"Assign the system Function to a number range"}l>0&&!r&&(r=l),r&&g?(t={readOnly:null==(a=await u(e,r,"isExternal"))||!a.external,mandatory:null!=a&&!!a.external},o&&(o=await i(o,t,n,d))):!r&&o&&(o=await i(o,t,n,d));let y=d?"".concat(d,".reference"):"reference";return{dtId:m,resetReference:null==t?void 0:t.readOnly,dcTypeRequired:n,reference:{fieldName:y,isEmpty:(null==a?void 0:a.external)!==void 0&&(null==a||!a.external)},errorMessage:v,maxAccess:o,selectNraId:l}};var m=t(65950);function v(e){let{functionId:r,action:t,hasDT:a}=e,{getRequest:o}=(0,n.useContext)(m.$),{stack:l}=(0,s.V)();return{proxyAction:async()=>{let e=await f(o,r,"",void 0,a);(null==e?void 0:e.errorMessage)?l({message:null==e?void 0:e.errorMessage}):await t()}}}function g(e){var r;let{functionId:t,access:o,hasDT:l,enabled:c=!0,objectName:d=""}=e,{getRequest:i}=(0,n.useContext)(m.$),{stack:u}=(0,s.V)(),[v,g]=(0,n.useState)(),h=async e=>{let r=await f(i,t,o,e,l,d);if(!r.errorMessage)return r;u({message:null==r?void 0:r.errorMessage})},y=(0,a.a)({retry:!1,staleTime:0,enabled:c,queryKey:[t,v,!!o,c],queryFn:v||"nraId"===v?()=>h(v):()=>h()});return{documentType:y.data,maxAccess:(null==y?void 0:null===(r=y.data)||void 0===r?void 0:r.maxAccess)||o,changeDT(e){g((null==e?void 0:e.nraId)||"nraId")}}}},30390:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(52322),n=t(60218);function s(e){let{hideonempty:r=!1,children:t,...s}=e;return(0,a.jsx)(n.ZP,{...s,className:r?"__hide-on-empty":"",children:t})}}},function(e){e.O(0,[78451,57981,49774,92888,40179],function(){return e(e.s=55271)}),_N_E=e.O()}]);