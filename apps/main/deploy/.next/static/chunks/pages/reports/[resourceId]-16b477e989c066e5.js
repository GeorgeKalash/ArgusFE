(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57089],{9282:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/reports/[resourceId]",function(){return r(71869)}])},71869:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var l=r(52322),a=r(2784),s=r(60218),o=r(23925),n=r(65950),i=r(38449),d=r(31389),u=r(33625),c=r(36908),p=r(8661),m=r(85072),f=r(69627),h=r(35656),v=r(19473),x=e=>{var t,r,x;let{resourceId:y}=e,{getRequest:w,postRequest:g}=(0,a.useContext)(n.$),{exportFormat:_}=(0,a.useContext)(v.l),[N,R]=(0,a.useState)([]),[F,j]=(0,a.useState)({selectedFormat:"",selectedReport:""}),[S,b]=(0,a.useState)(null),[C,k]=(0,a.useState)(0),{width:Z}=(0,h.d)(),E=async()=>{_.length&&(k(0),j(e=>({...e,selectedFormat:_[0]})))},I=async()=>{var e;let t=await w({extension:i.r.ReportLayout.get,parameters:"_resourceId=".concat(y)}),r=(null==t?void 0:t.record)||{},l=(null==r?void 0:r.layouts)||[];if(null==r?void 0:null===(e=r.reportLayoutOverrides)||void 0===e?void 0:e.length){let e=new Set(((null==r?void 0:r.reportLayoutOverrides)||[]).map(e=>e.id));l=l.filter(t=>!e.has(t.id))}R(e=>{let t=new Set(e.map(e=>e.id));return[...e,...null==l?void 0:l.filter(e=>!t.has(e.id)).map(e=>({id:e.id,api_url:e.api,reportClass:e.instanceName,parameters:e.parameters,layoutName:e.layoutName,assembly:"ArgusRPT.dll"})),...((null==r?void 0:r.reportTemplates)||[]).filter(e=>!e.isInactive).map(e=>({api_url:e.wsName,reportClass:e.reportName,parameters:e.parameters,layoutName:e.caption,assembly:e.assembly}))]})};(0,a.useEffect)(()=>{I()},[]),(0,a.useEffect)(()=>{E()},[_]),(0,a.useEffect)(()=>{N.length>0&&!F.selectedReport&&j(e=>({...e,selectedReport:N[0]}))},[N]);let P=async e=>{let{rpbParams:t,paramsDict:r}=e,l=await (0,m.O)({isReport:!0,postRequest:g,paramsDict:r,params:t,resourceId:y,selectedReport:F.selectedReport,selectedFormat:F.selectedFormat.key});1===parseInt(F.selectedFormat.key)?b(l):window.location.href=l};return(0,l.jsxs)(d.R,{children:[(0,l.jsx)(u.g,{children:(0,l.jsx)(c.Z,{onApply:P,hasSearch:!1,reportName:null===(t=F.selectedReport)||void 0===t?void 0:t.parameters,disableActionsPadding:!0,leftSection:(0,l.jsxs)(s.ZP,{container:!0,spacing:2,alignItems:"end",wrap:"nowrap",children:[(0,l.jsx)(s.ZP,{item:!0,xs:!0,children:(0,l.jsx)(p.Z,{store:N,label:"Select a report template",name:"selectedReport",valueField:"layoutName",displayField:"layoutName",values:F,required:!0,defaultIndex:0,fullWidth:!0,onChange:(e,t)=>j(e=>({...e,selectedReport:t}))})}),(0,l.jsx)(s.ZP,{item:!0,children:(0,l.jsx)(f.Z,{onClick:()=>{let e=(C+1)%_.length;k(e),j(t=>({...t,selectedFormat:_[e]}))},image:"".concat((null===(r=F.selectedFormat)||void 0===r?void 0:r.value)||"PDF",".png"),disabled:0==_.length||!F.selectedReport})})]})})}),S&&(0,l.jsxs)(o.Z,{id:"reportContainer",sx:{flex:1,display:"flex",p:2,position:"relative"},children:[(0,l.jsx)("iframe",{title:null===(x=F.selectedReport)||void 0===x?void 0:x.layoutName,src:"".concat(S,"#zoom=").concat(Z<=768?90:Z<=1024?90:Z<=1366?100:Z<=1600?100:Z<=1920?140:180),width:"100%",height:"100%",allowFullScreen:!0}),(0,l.jsx)(o.Z,{position:"absolute",top:20,right:130,zIndex:1,children:(0,l.jsx)(f.Z,{image:"popup.png",color:"#231F20",onClick:()=>{S&&window.open(S,"_blank")}})})]})]})},y=r(63165),w=()=>{let{resourceId:e}=(0,y.F)();return(0,l.jsx)(x,{resourceId:e})}},63165:function(e,t,r){"use strict";r.d(t,{F:function(){return s}});var l=r(5632),a=r(2784);let s=()=>{let e=(0,l.useRouter)(),[t,r]=(0,a.useState)(e.query);return t}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=9282)}),_N_E=e.O()}]);