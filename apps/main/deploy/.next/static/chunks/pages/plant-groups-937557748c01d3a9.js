(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91168],{34268:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/plant-groups",function(){return n(57830)}])},57830:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return C}});var t=n(52322),i=n(2784),a=n(62202),o=n(69387),d=n(27723),l=n(82235),c=n(65950),s=n(38449),u=n(61802),p=n(71987),x=n(26612),m=n(60218),h=n(48601),f=n(82737),g=n(5088),v=n(8661),I=n(80983),w=n(62362),y=n(31389),b=n(19473);function j(e){let{labels:r,maxAccess:n,recordId:o}=e,{getRequest:d,postRequest:l}=(0,i.useContext)(c.$),{platformLabels:u}=(0,i.useContext)(b.l),j=(0,p.E)({endpointId:s.r.PlantGroup.qry}),{formik:Z}=(0,I.c)({initialValues:{recordId:null,name:"",reference:"",parentId:"",parentName:""},validateOnChange:!0,validationSchema:h.Ry({name:h.Z_().required(),reference:h.Z_().required()}),onSubmit:async e=>{let r=await l({extension:s.r.PlantGroup.set,record:JSON.stringify(e)});e.recordId||Z.setFieldValue("recordId",r.recordId),a.ZP.success(e.recordId?u.Edited:u.Added),j()}}),C=!!Z.values.recordId;return(0,i.useEffect)(()=>{!async function(){if(o){let e=await d({extension:s.r.PlantGroup.get,parameters:"_recordId=".concat(o)});Z.setValues(e.record)}}()},[]),(0,t.jsx)(f.Z,{resourceId:x.i.PlantGroups,form:Z,actions:[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!C}],maxAccess:n,editMode:C,children:(0,t.jsx)(y.R,{children:(0,t.jsx)(w.Q,{children:(0,t.jsxs)(m.ZP,{container:!0,spacing:2,children:[(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsx)(g.Z,{name:"reference",label:r.reference,value:Z.values.reference,required:!0,maxAccess:n,onChange:Z.handleChange,onClear:()=>Z.setFieldValue("reference",""),error:Z.touched.reference&&!!Z.errors.reference})}),(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsx)(g.Z,{name:"name",label:r.name,value:Z.values.name,required:!0,maxAccess:n,maxLength:"30",onChange:Z.handleChange,onClear:()=>Z.setFieldValue("name",""),error:Z.touched.name&&!!Z.errors.name})}),(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsx)(v.Z,{endpointId:s.r.PlantGroup.qry,name:"parentId",label:r.parent,valueField:"recordId",displayField:"name",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:Z.values,onChange:(e,r)=>{Z.setFieldValue("parentId",null==r?void 0:r.recordId)},error:Z.touched.parent&&!!Z.errors.parent,maxAccess:n})})]})})})})}var Z=n(33625),C=()=>{let{getRequest:e,postRequest:r}=(0,i.useContext)(c.$),{platformLabels:n}=(0,i.useContext)(b.l),{stack:m}=(0,u.zY)();async function h(){return await e({extension:s.r.PlantGroup.qry,parameters:"_filter="})}let{query:{data:f},labels:g,refetch:v,invalidate:I,access:C}=(0,p.J)({queryFn:h,endpointId:s.r.PlantGroup.qry,datasetId:x.i.PlantGroups}),k=[{field:"reference",headerName:g.reference,flex:1},{field:"name",headerName:g.name,flex:1},{field:"parentName",headerName:g.parent,flex:1}],P=async e=>{await r({extension:s.r.PlantGroup.del,record:JSON.stringify(e)}),I(),a.ZP.success(n.Deleted),await r({extension:s.r.PlantGroup.del,record:JSON.stringify(e)}),I(),a.ZP.success(n.Deleted)};function S(e){m({Component:j,props:{labels:g,recordId:e||null,maxAccess:C},width:600,height:300,title:g.plantGroup})}let T=[{key:"Tree",condition:!0,onClick:function(){m({Component:l.Z,props:{data:f}})},disabled:!1}];return(0,t.jsxs)(y.R,{children:[(0,t.jsx)(Z.g,{children:(0,t.jsx)(d.Z,{actions:T,onAdd:()=>{S()},maxAccess:C})}),(0,t.jsx)(w.Q,{children:(0,t.jsx)(o.Z,{columns:k,gridData:f,rowId:["recordId"],onEdit:e=>{S(null==e?void 0:e.recordId)},onDelete:P,isLoading:!1,pageSize:50,refetch:v,paginationType:"client",maxAccess:C})})]})}},82235:function(e,r,n){"use strict";var t=n(52322),i=n(2784),a=n(7913),o=n(61676),d=n(44781),l=n(78502),c=n(94045),s=n(55182),u=n(40234),p=n(55648),x=n(27149),m=n(94668),h=n(3),f=n(19473),g=n(21326);let v=e=>{let r=[];return e.forEach(e=>{r.push(e.recordId.toString()),e.children&&(r=r.concat(v(e.children)))}),r},I=e=>{let{nodes:r}=e,n=v(r),i=e=>(0,t.jsx)(y,{nodeId:e.recordId.toString(),label:e.name,children:Array.isArray(e.children)?e.children.map(e=>i(e)):null},e.recordId);return(0,t.jsx)(w,{"aria-label":"plant tree",expanded:n,defaultCollapseIcon:(0,t.jsx)(c.Z,{}),defaultExpandIcon:(0,t.jsx)(s.Z,{}),children:r.map(e=>i(e))})},w=(0,d.ZP)(a.Z)(e=>{let{theme:r}=e;return{width:"100%",flex:1,minHeight:0,overflowY:"auto",boxSizing:"border-box",padding:0,"--tree-font":"clamp(11px, 0.25vw + 10px, 13px)","--tree-rowH":"clamp(22px, 0.35vw + 20px, 26px)","--tree-py":"0px","--tree-px":"6px","--tree-iconBoxW":"18px","--tree-iconSize":"18px","--tree-indent":"18px","--tree-radius":"0px","& .MuiTreeItem-content":{minHeight:"var(--tree-rowH)",paddingTop:"var(--tree-py)",paddingBottom:"var(--tree-py)",paddingLeft:"var(--tree-px)",paddingRight:"var(--tree-px)",borderRadius:"var(--tree-radius)",alignItems:"center",gap:6},"& .MuiTreeItem-label":{fontSize:"var(--tree-font)",lineHeight:1.2,whiteSpace:"normal",wordBreak:"break-word"},"& .MuiTreeItem-iconContainer":{width:"var(--tree-iconBoxW)",minWidth:"var(--tree-iconBoxW)",marginRight:0,display:"flex",alignItems:"center",justifyContent:"center"},"& .MuiSvgIcon-root":{fontSize:"var(--tree-iconSize)"},"& .MuiTreeItem-group":{marginLeft:"var(--tree-indent)",paddingLeft:0},"& .MuiTreeItem-content:hover":{backgroundColor:r.palette.action.hover},"@media print":{overflowY:"visible","--tree-font":"11pt","--tree-rowH":"auto"},[r.breakpoints.down("sm")]:{"--tree-font":"clamp(10.5px, 0.4vw + 9.5px, 12px)","--tree-rowH":"clamp(20px, 0.4vw + 18px, 24px)","--tree-iconBoxW":"16px","--tree-iconSize":"16px","--tree-indent":"16px","--tree-px":"4px"}}}),y=(0,d.ZP)(o.Z)(e=>{let{theme:r}=e;return{"&.Mui-selected > .MuiTreeItem-content":{backgroundColor:"#d9d9d9"},"&.Mui-selected > .MuiTreeItem-content:hover":{backgroundColor:"#d9d9d9"},"&.Mui-focused > .MuiTreeItem-content":{backgroundColor:"#d9d9d9"},"& .MuiTreeItem-content .MuiTreeItem-label":{fontSize:"var(--tree-font) !important",lineHeight:"1.2 !important",whiteSpace:"normal",wordBreak:"break-word"}}});function b(e){let{data:r,window:n,printable:a=!0}=e,{platformLabels:o}=(0,i.useContext)(f.l),d=(0,l.Z)();(0,x.Z)(d.breakpoints.down("sm"));let v=(0,i.useRef)();(0,g.Z)({title:o.Tree,window:n});let b=(0,u.useReactToPrint)({content:()=>v.current,documentTitle:"Tree_Structure",removeAfterPrint:!0}),j=(0,i.useMemo)(()=>{if(r){var e,n;let t=new Map(null==r?void 0:null===(e=r.list)||void 0===e?void 0:e.map(e=>[e.recordId,{...e,children:[]}]));return null==r||null===(n=r.list)||void 0===n||n.forEach(e=>{if(e.parentId){let r=t.get(e.parentId);r&&r.children.push(t.get(e.recordId))}}),[...t.values()].filter(e=>!e.parentId)}return[]},[r]),Z=e=>(0,t.jsx)(y,{nodeId:e.recordId.toString(),label:e.name,children:Array.isArray(e.children)?e.children.map(e=>Z(e)):null},e.recordId);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(m.Z,{sx:{p:0,display:"flex",flexDirection:"column",width:"100%",height:"100%",minHeight:0,overflow:"hidden"},children:[(0,t.jsx)(w,{"aria-label":"plant tree",defaultCollapseIcon:(0,t.jsx)(c.Z,{}),defaultExpandIcon:(0,t.jsx)(s.Z,{}),children:j.map(e=>Z(e))}),(0,t.jsx)("div",{style:{display:"none",visibility:"hidden"},children:(0,t.jsx)("div",{ref:v,children:(0,t.jsx)(I,{nodes:j})})})]}),(0,t.jsx)(h.Z,{sx:{p:0,width:"100%"},children:(0,t.jsx)(p.Z,{actions:a?[{key:"Print",condition:!0,onClick:b,disabled:!1}]:[],isCleared:!1,isSaved:!1,isInfo:!1})})]})}b.width=500,b.height=400,r.Z=b}},function(e){e.O(0,[40234,9783,49774,92888,40179],function(){return e(e.s=34268)}),_N_E=e.O()}]);