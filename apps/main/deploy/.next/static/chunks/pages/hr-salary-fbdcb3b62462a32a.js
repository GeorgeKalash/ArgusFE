(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48242],{62952:function(e,l,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/hr-salary",function(){return a(61078)}])},61078:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return W}});var n=a(52322),t=a(2784),r=a(69387),d=a(65950),i=a(71987),o=a(26612),s=a(31389),u=a(33625),c=a(62362),m=a(61802),v=a(92407),x=a(60218),y=a(62202),p=a(5088),h=a(80983),f=a(19473),b=a(39812),A=a(25506),I=a(29326),F=a(9522),N=a(48601),g=a(82737),j=a(8661),C=a(91406),Z=a(38449),T=a(89330),P=a(2119),q=a(84100);function _(e,l,a,n){let t=parseFloat(String(a).replace(/,/g,""))||0;return 1==l?e/100*t:e/100*(t+parseFloat(n)||0)}async function D(e,l){let a=0;return null==e||e.map(e=>{if(e.includeInTotal){if(0==e.pct)a+=parseFloat(e.fixedAmount);else{let n=parseFloat(e.pct)/100*parseFloat(String(l).replace(/,/g,""));return a+=n,{...e,fixedAmount:n}}}return e}),a}async function S(e,l,a){let n=0;return null==e||e.map(e=>{if(e.includeInTotal){if(0==e.pct)return n+=parseFloat(e.fixedAmount),e;{let t;return t=1==e.pctOf?parseFloat(e.pct)/100*parseFloat(String(l).replace(/,/g,"")):parseFloat(e.pct)/100*(parseFloat(String(l).replace(/,/g,""))+parseFloat(String(a).replace(/,/g,""))),n+=t,{...e,fixedAmount:t}}}}),n}function V(e){var l,a,r,u,c,m,A,I;let{labels:F,maxAccess:_,store:V,setStore:R,employeeInfo:w,setSalaryInfo:E,data:k,refetchSalaryTab:O,reCalcNewAmounts:M,saveWholePack:Y,window:B}=e,{recordId:z}=V,{postRequest:J,getRequest:L}=(0,t.useContext)(d.$),{platformLabels:$}=(0,t.useContext)(f.l),W=(null==k?void 0:k.filter(e=>1==e.type))||[],Q=(null==k?void 0:k.filter(e=>2==e.type))||[],X=(0,i.E)({endpointId:v.y.EmployeeSalary.qry}),{formik:H}=(0,h.c)({maxAccess:_,initialValues:{recordId:null,employeeId:null==w?void 0:w.recordId,currencyId:null,scrId:null,effectiveDate:null,salaryType:null,paymentFrequency:null,paymentMethod:null,bankId:null,accountNumber:null,comments:"",basicAmount:"",finalAmount:null,eAmount:null,dAmount:null},validationSchema:N.Ry({currencyId:N.Rx().required(),scrId:N.Rx().required(),effectiveDate:N.hT().required(),salaryType:N.Rx().required(),paymentFrequency:N.Rx().required(),paymentMethod:N.Rx().required(),basicAmount:N.Rx().required(),bankId:N.Rx().nullable().test(function(e){let{paymentMethod:l}=this.parent;return 2!=l||!!e}),accountNumber:N.Rx().nullable().test(function(e){let{paymentMethod:l}=this.parent;return 2!=l||!!e})}),onSubmit:async e=>{if(e.recordId&&Y.current&&k.length>0)await J({extension:v.y.SalaryDetails.set2,record:JSON.stringify({salary:{...e,effectiveDate:(0,b.OZ)(new Date(e.effectiveDate))},salaryDetails:k})}),y.ZP.success($.Edited),X(),Y.current=!1,B.close();else{let l=await J({extension:v.y.EmployeeSalary.set,record:JSON.stringify({...e,effectiveDate:(0,b.OZ)(new Date(e.effectiveDate))})});y.ZP.success(e.recordId?$.Edited:$.Added),X(),K(null==l?void 0:l.recordId),e.recordId?B.close():R(e=>({...e,recordId:null==l?void 0:l.recordId}))}}}),G=!!(null==H?void 0:null===(l=H.values)||void 0===l?void 0:l.recordId);async function U(e){let l=z&&e?await D(W,e):0,a=z&&e?await S(Q,e,l):0,n=e?l-a+e:0;E(l=>({...l,basicAmount:e||0})),M(e,l),H.setFieldValue("finalAmount",parseFloat(n).toFixed(2)),H.setFieldValue("eAmount",parseFloat(l).toFixed(2)),H.setFieldValue("dAmount",parseFloat(a).toFixed(2)),H.setFieldValue("basicAmount",e)}async function K(e){var l,a,n;let t=await L({extension:v.y.EmployeeSalary.get,parameters:"_recordId=".concat(e)});H.setValues({...null==t?void 0:t.record,effectiveDate:(0,b.a1)(t.record.effectiveDate),finalAmount:parseFloat(null==t?void 0:null===(l=t.record)||void 0===l?void 0:l.finalAmount).toFixed(2),eAmount:parseFloat(null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.eAmount).toFixed(2),dAmount:parseFloat(null==t?void 0:null===(n=t.record)||void 0===n?void 0:n.dAmount).toFixed(2)}),E({...null==t?void 0:t.record,effectiveDate:(0,b.a1)(t.record.effectiveDate)}),R(e=>{var l;return{...e,currency:null==t?void 0:null===(l=t.record)||void 0===l?void 0:l.currencyRef}}),O.current=!1}return(0,t.useEffect)(()=>{z&&O.current&&K(z)},[O.current]),(0,t.useEffect)(()=>{!async function(){if(z)K(z);else{var e;let l=await L({extension:v.y.EmployeeSalary.qry,parameters:"_employeeId=".concat(null==w?void 0:w.recordId)}),a=null;if((null==l?void 0:null===(e=l.list)||void 0===e?void 0:e.length)>0){let e={...a=l.list.sort((e,l)=>new Date(parseInt(e.effectiveDate.match(/\d+/)[0]))-new Date(parseInt(l.effectiveDate.match(/\d+/)[0]))).at(-1),eAmount:"0.00",dAmount:"0.00",finalAmount:parseFloat(a.basicAmount).toFixed(2),effectiveDate:new Date,recordId:null};H.setValues(e),R(e=>({...e,currency:a.currencyRef}))}else{let e=await L({extension:v.y.Employee.get1,parameters:"_recordId=".concat(null==w?void 0:w.recordId)});H.setFieldValue("effectiveDate",e.record.hireDate?(0,b.a1)(e.record.hireDate):null)}}}()},[]),(0,n.jsx)(g.Z,{resourceId:o.i.Salaries,form:H,maxAccess:_,editMode:G,children:(0,n.jsx)(s.R,{children:(0,n.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(j.Z,{endpointId:Z.r.Currency.qry,name:"currencyId",label:F.currency,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:H.values,required:!0,maxAccess:_,onChange:(e,l)=>H.setFieldValue("currencyId",(null==l?void 0:l.recordId)||null),error:H.touched.currencyId&&!!H.errors.currencyId})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(p.Z,{name:"accountNumber",label:F.iban,value:null==H?void 0:null===(a=H.values)||void 0===a?void 0:a.accountNumber,maxAccess:_,onChange:H.handleChange,readOnly:2!=H.values.paymentMethod,required:2==H.values.paymentMethod,onClear:()=>H.setFieldValue("accountNumber",""),error:H.touched.accountNumber&&!!H.errors.accountNumber})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(j.Z,{endpointId:v.y.SalaryChangeReason.qry,name:"scrId",label:F.changeReason,valueField:"recordId",displayField:"name",values:H.values,required:!0,maxAccess:_,onChange:(e,l)=>H.setFieldValue("scrId",(null==l?void 0:l.recordId)||null),error:H.touched.scrId&&!!H.errors.scrId})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(p.Z,{name:"comments",label:F.comments,value:null===(r=H.values)||void 0===r?void 0:r.comments,onChange:H.handleChange,onClear:()=>H.setFieldValue("comments",""),error:H.touched.comments&&!!H.errors.comments,maxAccess:_})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(T.Z,{name:"effectiveDate",label:F.date,value:null==H?void 0:null===(u=H.values)||void 0===u?void 0:u.effectiveDate,onChange:H.setFieldValue,maxAccess:_,required:!0,onClear:()=>H.setFieldValue("effectiveDate",null),error:H.touched.effectiveDate&&!!H.errors.effectiveDate})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(C.Z,{name:"basicAmount",label:F.basicAmount,value:null==H?void 0:null===(c=H.values)||void 0===c?void 0:c.basicAmount,onChange:e=>{var l;return U((null==e?void 0:null===(l=e.target)||void 0===l?void 0:l.value)?Number(e.target.value.replace(/,/g,"")):null)},required:!0,maxLength:10,maxAccess:_,allowNegative:!1,onClear:()=>U(null),error:H.touched.basicAmount&&!!H.errors.basicAmount})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(j.Z,{datasetId:q.v.SALARY_TYPE,name:"salaryType",label:F.salaryType,valueField:"key",displayField:"value",values:H.values,maxAccess:_,required:!0,onChange:(e,l)=>{H.setFieldValue("salaryType",(null==l?void 0:l.key)||null)},error:H.touched.salaryType&&!!H.errors.salaryType})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(C.Z,{name:"finalAmount",label:F.finalAmount,value:null==H?void 0:null===(m=H.values)||void 0===m?void 0:m.finalAmount,readOnly:!0,maxAccess:_,onChange:H.handleChange,onClear:()=>H.setFieldValue("finalAmount",null),error:H.touched.finalAmount&&!!H.errors.finalAmount})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(j.Z,{datasetId:q.v.PY_PAY_PERIOD,name:"paymentFrequency",label:F.paymentFrequency,valueField:"key",displayField:"value",values:H.values,maxAccess:_,required:!0,onChange:(e,l)=>H.setFieldValue("paymentFrequency",(null==l?void 0:l.key)||null),error:H.touched.paymentFrequency&&!!H.errors.paymentFrequency})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(C.Z,{name:"eAmount",label:F.totalEntitlements,value:null==H?void 0:null===(A=H.values)||void 0===A?void 0:A.eAmount,onChange:H.handleChange,readOnly:!0,maxAccess:_,onClear:()=>H.setFieldValue("eAmount",null),error:H.touched.eAmount&&!!H.errors.eAmount})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(j.Z,{datasetId:q.v.HR_PAYMENT_METHOD,name:"paymentMethod",label:F.paymentMethod,valueField:"key",displayField:"value",values:H.values,maxAccess:_,onChange:(e,l)=>{(null==l?void 0:l.key)!=2&&(H.setFieldValue("bankId",""),H.setFieldValue("accountNumber","")),H.setFieldValue("paymentMethod",(null==l?void 0:l.key)||null)},required:!0,error:H.touched.paymentMethod&&!!H.errors.paymentMethod})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(C.Z,{name:"dAmount",label:F.totalDeductions,value:null==H?void 0:null===(I=H.values)||void 0===I?void 0:I.dAmount,onChange:H.handleChange,readOnly:!0,maxAccess:_,onClear:()=>H.setFieldValue("dAmount",null),error:H.touched.dAmount&&!!H.errors.dAmount})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(j.Z,{endpointId:P.G.CbBank.qry,name:"bankId",label:F.bank,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:H.values,readOnly:2!=H.values.paymentMethod,required:2==H.values.paymentMethod,maxAccess:_,onChange:(e,l)=>H.setFieldValue("bankId",(null==l?void 0:l.recordId)||null),error:H.touched.bankId&&!!H.errors.bankId})})]})})})}var R=a(27723),w=a(19689),E=a(21581),k=a(54074),O=a(6035);function M(e){var l,a,r,o,u;let{labels:c,maxAccess:m,seqNumbers:p,salaryInfo:b,fixedAmount:A,refetchSalaryTab:I,window:F}=e,{platformLabels:g}=(0,t.useContext)(f.l),{getRequest:Z,postRequest:T}=(0,t.useContext)(d.$),P=null==b?void 0:b.header.recordId,D=(0,i.E)({endpointId:v.y.SalaryDetails.qry}),{formik:S}=(0,h.c)({maxAccess:m,initialValues:{salaryId:P,seqNo:null==p?void 0:p.current,includeInTotal:!1,edId:null,isPct:!1,fixedAmount:null,pct:0,comments:"",isTaxable:!1,edCalcType:null,dayTypeId:null},validationSchema:N.Ry({edId:N.Rx().required(),fixedAmount:N.Rx().min(0).required(),edCalcType:N.Rx().required(),dayTypeId:N.Rx().nullable().test(function(e){let{edCalcType:l}=this.parent;return 2!=l||!!e}),pct:N.Rx().min(0).max(100).test(function(e){let{isPct:l}=this.parent;return!l||!!e})}),onSubmit:async e=>{let l={...e,seqNo:(null==p?void 0:p.current)||((null==p?void 0:p.maxSeqNo)||0)+1},a=[...((null==b?void 0:b.details)||[]).filter(e=>e.seqNo!==l.seqNo),l];await T({extension:v.y.SalaryDetails.set2,record:JSON.stringify({salary:null==b?void 0:b.header,salaryDetails:a})}),I.current=!0,y.ZP.success(e.salaryId?g.Edited:g.Added),F.close(),D()}}),V=!!S.values.salaryId;return(0,t.useEffect)(()=>{!async function(){if(P&&(null==p?void 0:p.current)){var e,l;let a=await Z({extension:v.y.SalaryDetails.get,parameters:"_salaryId=".concat(P,"&_seqNo=").concat(null==p?void 0:p.current)});S.setValues({...null==a?void 0:a.record,fixedAmount:parseFloat(A||0).toFixed(2)||parseFloat((null==a?void 0:null===(e=a.record)||void 0===e?void 0:e.fixedAmount)||0).toFixed(2),isPct:(null==a?void 0:null===(l=a.record)||void 0===l?void 0:l.pct)>0})}}()},[]),(0,n.jsx)(k.Z,{onSave:S.handleSubmit,maxAccess:m,editMode:V,children:(0,n.jsx)(s.R,{children:(0,n.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{endpointId:v.y.EmployeeDeduction.qry,name:"edId",label:c.entitlement,valueField:"recordId",displayField:"name",values:S.values,filter:e=>1==e.type,onChange:(e,l)=>S.setFieldValue("edId",(null==l?void 0:l.recordId)||null),required:!0,maxAccess:m,error:S.touched.edId&&!!S.errors.edId})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(w.Z,{name:"includeInTotal",value:null===(l=S.values)||void 0===l?void 0:l.includeInTotal,onChange:e=>S.setFieldValue("includeInTotal",e.target.checked),label:c.includeInTotal,maxAccess:m})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(w.Z,{name:"isPct",value:null===(a=S.values)||void 0===a?void 0:a.isPct,onChange:e=>{e.target.checked?S.setFieldValue("fixedAmount",0):S.setFieldValue("pct",0),S.setFieldValue("isPct",e.target.checked)},label:c.isPct,maxAccess:m})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"pct",label:c.pct,value:S.values.pct,readOnly:!S.values.isPct,required:S.values.isPct,allowNegative:!1,onBlur:e=>{let l=Number(e.target.value),a=_(l,1,b.header.basicAmount,b.header.eAmount);S.setFieldValue("fixedAmount",parseFloat(a||0).toFixed(2)),S.setFieldValue("pct",l)},maxAccess:m,onClear:()=>S.setFieldValue("pct",0),error:S.touched.pct&&!!S.errors.pct})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"fixedAmount",label:c.amount,value:S.values.fixedAmount,onBlur:e=>{var l;return S.setFieldValue("fixedAmount",parseFloat((null==e?void 0:null===(l=e.target)||void 0===l?void 0:l.value)||0).toFixed(2))},required:!0,allowNegative:!1,maxAccess:m,readOnly:S.values.isPct,onClear:()=>S.setFieldValue("fixedAmount",null),error:S.touched.fixedAmount&&!!S.errors.fixedAmount})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(E.Z,{name:"comments",label:c.comments,value:S.values.comments,maxLength:"100",rows:2,maxAccess:m,onChange:S.handleChange,onClear:()=>S.setFieldValue("comments",""),error:S.touched.comments&&!!S.errors.comments})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(w.Z,{name:"isTaxable",value:null===(r=S.values)||void 0===r?void 0:r.isTaxable,onChange:e=>S.setFieldValue("isTaxable",e.target.checked),label:c.isTaxable,maxAccess:m})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{datasetId:q.v.ED_CALC_TYPE,name:"edCalcType",label:c.calculationType,valueField:"key",displayField:"value",values:S.values,maxAccess:m,required:!0,onChange:(e,l)=>{S.setFieldValue("dayTypeId",null),S.setFieldValue("edCalcType",(null==l?void 0:l.key)||null)},error:S.touched.edCalcType&&!!S.errors.edCalcType})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{endpointId:O.f.DayTypes.qry,name:"dayTypeId",label:c.dayType,valueField:"recordId",displayField:"name",values:S.values,maxAccess:m,readOnly:(null===(o=S.values)||void 0===o?void 0:o.edCalcType)!=2,required:(null===(u=S.values)||void 0===u?void 0:u.edCalcType)==2,onChange:(e,l)=>S.setFieldValue("dayTypeId",(null==l?void 0:l.recordId)||null),error:S.touched.dayTypeId&&!!S.errors.dayTypeId})})]})})})}var Y=e=>{let{store:l,labels:a,maxAccess:o,salaryInfo:x,data:p,refetchSalaryTab:h}=e,{postRequest:b}=(0,t.useContext)(d.$),{stack:I}=(0,m.zY)(),{platformLabels:F}=(0,t.useContext)(f.l),N=(0,i.E)({endpointId:v.y.SalaryDetails.qry}),g=[{field:"edName",headerName:a.entitlements,flex:1},{field:"concatenatedPct",headerName:a.pct,flex:1},{field:"currencyAmount",headerName:a.amount,flex:1}];function j(e){I({Component:M,props:{labels:a,maxAccess:o,seqNumbers:{current:null==e?void 0:e.seqNo,maxSeqNo:null==l?void 0:l.maxSeqNo},salaryInfo:{header:x,details:p},fixedAmount:(null==e?void 0:e.fixedAmount)?(0,A.bj)(e.fixedAmount,2):0,refetchSalaryTab:h},width:800,height:500,title:a.entitlements})}let C=async e=>{await b({extension:v.y.SalaryDetails.del,record:JSON.stringify(e)}),h.current=!0,N(),y.ZP.success(F.Deleted)};return(0,n.jsxs)(s.R,{children:[(0,n.jsx)(u.g,{children:(0,n.jsx)(R.Z,{onAdd:()=>{j()},maxAccess:o,labels:a})}),(0,n.jsx)(c.Q,{children:(0,n.jsx)(r.Z,{name:"entitlementsTable",columns:g,gridData:{list:null==p?void 0:p.filter(e=>1==e.type)},rowId:"salaryId",onEdit:e=>{j(e)},onDelete:C,maxAccess:o,pagination:!1})})]})};function B(e){var l,a,r;let{labels:o,maxAccess:u,seqNumbers:c,salaryInfo:m,refetchSalaryTab:p,fixedAmount:b,window:A}=e,{platformLabels:I}=(0,t.useContext)(f.l),{getRequest:F,postRequest:g}=(0,t.useContext)(d.$),Z=null==m?void 0:m.header.recordId,T=(0,i.E)({endpointId:v.y.SalaryDetails.qry}),{formik:P}=(0,h.c)({maxAccess:u,initialValues:{salaryId:Z,seqNo:null==c?void 0:c.current,includeInTotal:!1,edId:null,isPct:!1,fixedAmount:null,pct:0,comments:"",isTaxable:!1,edCalcType:null},validationSchema:N.Ry({edId:N.Rx().required(),fixedAmount:N.Rx().min(0).required(),edCalcType:N.Rx().required(),pct:N.Rx().min(0).max(100).test(function(e){let{isPct:l}=this.parent;return!l||!!e})}),onSubmit:async e=>{let l={...e,seqNo:(null==c?void 0:c.current)||((null==c?void 0:c.maxSeqNo)||0)+1},a=[...((null==m?void 0:m.details)||[]).filter(e=>e.seqNo!==l.seqNo),l];await g({extension:v.y.SalaryDetails.set2,record:JSON.stringify({salary:null==m?void 0:m.header,salaryDetails:a})}),p.current=!0,y.ZP.success(e.salaryId?I.Edited:I.Added),A.close(),T()}}),D=!!P.values.salaryId;return(0,t.useEffect)(()=>{!async function(){if(Z&&(null==c?void 0:c.current)){var e,l;let a=await F({extension:v.y.SalaryDetails.get,parameters:"_salaryId=".concat(Z,"&_seqNo=").concat(null==c?void 0:c.current)});P.setValues({...null==a?void 0:a.record,fixedAmount:parseFloat(b||0).toFixed(2)||parseFloat((null==a?void 0:null===(e=a.record)||void 0===e?void 0:e.fixedAmount)||0).toFixed(2),isPct:(null==a?void 0:null===(l=a.record)||void 0===l?void 0:l.pct)>0})}}()},[]),(0,n.jsx)(k.Z,{onSave:P.handleSubmit,maxAccess:u,editMode:D,children:(0,n.jsx)(s.R,{children:(0,n.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{endpointId:v.y.EmployeeDeduction.qry,name:"edId",label:o.deduction,valueField:"recordId",displayField:"name",values:P.values,filter:e=>2==e.type,onChange:(e,l)=>P.setFieldValue("edId",(null==l?void 0:l.recordId)||null),maxAccess:u,required:!0,error:P.touched.edId&&!!P.errors.edId})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(w.Z,{name:"includeInTotal",value:null===(l=P.values)||void 0===l?void 0:l.includeInTotal,onChange:e=>P.setFieldValue("includeInTotal",e.target.checked),label:o.includeInTotal,maxAccess:u})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(w.Z,{name:"isPct",value:null===(a=P.values)||void 0===a?void 0:a.isPct,onChange:e=>{P.setFieldValue("pctOf",1),e.target.checked?P.setFieldValue("fixedAmount",0):P.setFieldValue("pct",0),P.setFieldValue("isPct",e.target.checked)},label:o.isPct,maxAccess:u})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{datasetId:q.v.APPLY_TO_SALARY,name:"pctOf",label:o.pctOf,valueField:"key",displayField:"value",values:P.values,maxAccess:u,readOnly:!P.values.isPct,onChange:(e,l)=>P.setFieldValue("pctOf",(null==l?void 0:l.key)||null),error:P.touched.pctOf&&!!P.errors.pctOf})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"pct",label:o.pct,value:P.values.pct,readOnly:!P.values.isPct,required:P.values.isPct,onBlur:e=>{let l=Number(e.target.value),a=_(l,1,m.header.basicAmount,m.header.eAmount);P.setFieldValue("fixedAmount",parseFloat(a||0).toFixed(2)),P.setFieldValue("pct",l)},allowNegative:!1,maxAccess:u,onClear:()=>P.setFieldValue("pct",0),error:P.touched.pct&&!!P.errors.pct})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"fixedAmount",label:o.amount,value:P.values.fixedAmount,onBlur:e=>{var l;return P.setFieldValue("fixedAmount",parseFloat((null==e?void 0:null===(l=e.target)||void 0===l?void 0:l.value)||0).toFixed(2))},required:!0,allowNegative:!1,maxAccess:u,readOnly:P.values.isPct,onClear:()=>P.setFieldValue("fixedAmount",null),error:P.touched.fixedAmount&&!!P.errors.fixedAmount})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(w.Z,{name:"isTaxable",value:null===(r=P.values)||void 0===r?void 0:r.isTaxable,onChange:e=>P.setFieldValue("isTaxable",e.target.checked),label:o.isTaxable,maxAccess:u})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{datasetId:q.v.ED_CALC_TYPE,name:"edCalcType",label:o.calculationType,valueField:"key",displayField:"value",values:P.values,maxAccess:u,required:!0,onChange:(e,l)=>P.setFieldValue("edCalcType",(null==l?void 0:l.key)||null),error:P.touched.edCalcType&&!!P.errors.edCalcType})})]})})})}var z=e=>{let{store:l,labels:a,maxAccess:o,salaryInfo:x,data:p,refetchSalaryTab:h}=e,{postRequest:b}=(0,t.useContext)(d.$),{stack:I}=(0,m.zY)(),{platformLabels:F}=(0,t.useContext)(f.l),N=[{field:"edName",headerName:a.deductions,flex:1},{field:"concatenatedPct",headerName:a.pct,flex:1},{field:"currencyAmount",headerName:a.amount,flex:1}],g=(0,i.E)({endpointId:v.y.SalaryDetails.qry});function j(e){I({Component:B,props:{labels:a,maxAccess:o,seqNumbers:{current:null==e?void 0:e.seqNo,maxSeqNo:null==l?void 0:l.maxSeqNo},salaryInfo:{header:x,details:p},fixedAmount:(null==e?void 0:e.fixedAmount)?(0,A.bj)(e.fixedAmount,2):0,refetchSalaryTab:h},width:800,height:500,title:a.deduction})}let C=async e=>{await b({extension:v.y.SalaryDetails.del,record:JSON.stringify(e)}),h.current=!0,g(),y.ZP.success(F.Deleted)};return(0,n.jsxs)(s.R,{children:[(0,n.jsx)(u.g,{children:(0,n.jsx)(R.Z,{onAdd:()=>{j()},maxAccess:o,labels:a})}),(0,n.jsx)(c.Q,{children:(0,n.jsx)(r.Z,{name:"deductionTable",columns:N,gridData:{list:null==p?void 0:p.filter(e=>2==e.type)},rowId:"salaryId",onEdit:e=>{j(e)},onDelete:C,maxAccess:o,pagination:!1})})]})};function J(e){let{labels:l,maxAccess:a,recordId:r,employeeInfo:s,window:u}=e,{getRequest:c}=(0,t.useContext)(d.$),[m,x]=(0,t.useState)(0),[y,p]=(0,t.useState)({recordId:r}),[h,f]=(0,t.useState)(null),[b,N]=(0,t.useState)({recordId:r,currency:""}),g=(0,t.useRef)(!1),j=(0,t.useRef)(!1),{query:{data:C}}=(0,i.J)({enabled:!!(r&&b.currency),datasetId:o.i.Salaries,queryFn:Z,endpointId:v.y.SalaryDetails.qry,params:{disabledReqParams:!0,maxAccess:a}});async function Z(){let e=await c({extension:v.y.SalaryDetails.qry,parameters:"_salaryId=".concat(r,"&_type=0")});return N(l=>{var a,n;return{...l,maxSeqNo:(null==e?void 0:null===(a=e.list)||void 0===a?void 0:a.length)>0?Math.max(...null==e?void 0:null===(n=e.list)||void 0===n?void 0:n.map(e=>{var l;return null!==(l=e.seqNo)&&void 0!==l?l:0})):0}}),f(null),e.list.map(e=>({...e,currencyAmount:"".concat(b.currency," ").concat((0,A.bj)(e.fixedAmount,2)),concatenatedPct:(null==e?void 0:e.pct)?"".concat(parseFloat(e.pct).toFixed(2),"%"):"0.00%"}))}let T=[{label:l.salary},{label:l.entitlement,disabled:!b.recordId},{label:l.deduction,disabled:!b.recordId}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(F.Y,{tabs:T,activeTab:m,setActiveTab:x,maxAccess:a}),(0,n.jsx)(I.Z,{index:0,value:m,maxAccess:a,children:(0,n.jsx)(V,{labels:l,maxAccess:a,setStore:N,store:b,employeeInfo:s,setSalaryInfo:p,data:h||C,refetchSalaryTab:g,reCalcNewAmounts:function(e,l){f((C||[]).map(a=>{let n;if(!a.includeInTotal)return a;let t=parseFloat(String(e).replace(/,/g,"")),r=parseFloat(String(l||0).replace(/,/g,""));if(!a.pct||0==a.pct)return a;let d=parseFloat(a.pct)/100;return 1===a.type?n=d*t:2===a.type&&(n=d*(t+(1==a.pctOf?0:r))),{...a,fixedAmount:n,currencyAmount:"".concat(b.currency," ").concat((0,A.bj)(n,2))}})),j.current=!0},saveWholePack:j,window:u})}),(0,n.jsx)(I.Z,{index:1,value:m,maxAccess:a,children:(0,n.jsx)(Y,{labels:l,maxAccess:a,store:b,salaryInfo:y,data:h||C,refetchSalaryTab:g})}),(0,n.jsx)(I.Z,{index:2,value:m,maxAccess:a,children:(0,n.jsx)(z,{labels:l,maxAccess:a,store:b,salaryInfo:y,data:h||C,refetchSalaryTab:g})})]})}function L(e){var l,a,I,F;let{employeeInfo:N,maxAccess:g,labels:j}=e,{getRequest:C,postRequest:Z}=(0,t.useContext)(d.$),{platformLabels:T}=(0,t.useContext)(f.l),{stack:P}=(0,m.zY)(),{query:{data:q},refetch:_,invalidate:D}=(0,i.J)({queryFn:V,endpointId:v.y.EmployeeSalary.qry,datasetId:o.i.Salaries,params:{disabledReqParams:!0,maxAccess:g}}),{formik:S}=(0,h.c)({initialValues:{employeeName:(null==N?void 0:N.name)||null,positionName:(null==N?void 0:N.positionName)||null,branchName:(null==N?void 0:N.branchName)||null,departmentName:(null==N?void 0:N.departmentName)||null},maxAccess:g});async function V(){if(null==N?void 0:N.recordId)return(await C({extension:v.y.EmployeeSalary.qry,parameters:"_employeeId=".concat(null==N?void 0:N.recordId)})).list.map(e=>({...e,effectiveDate:e.effectiveDate?(0,b.a1)(e.effectiveDate):null,basicAmount:"".concat(e.currencyRef," ").concat((0,A.bj)(e.basicAmount,2)),finalAmount:"".concat(e.currencyRef," ").concat((0,A.bj)(e.finalAmount,2))}))}let w=[{field:"effectiveDate",headerName:j.date,flex:1,type:"date"},{field:"basicAmount",headerName:j.basicAmount,flex:1},{field:"finalAmount",headerName:j.finalAmount,flex:1}];function E(e){P({Component:J,props:{labels:j,recordId:e,maxAccess:g,employeeInfo:N},width:900,height:600,title:j.salary})}let k=async e=>{await Z({extension:v.y.EmployeeSalary.del,record:JSON.stringify({...e,finalAmount:0,comments:"",accountNumber:"",basicAmount:0,currencyId:0,effectiveDate:new Date,paymentFrequency:0,paymentMethod:0,salaryType:0,scrId:0})}),D(),y.ZP.success(T.Deleted)};return(0,n.jsxs)(s.R,{children:[(0,n.jsx)(u.g,{children:(0,n.jsx)(R.Z,{onAdd:()=>{E()},maxAccess:g,leftSection:(0,n.jsx)(x.ZP,{item:!0,xs:11,sx:{mt:1},children:(0,n.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(p.Z,{name:"employeeName",label:j.employee,value:null==S?void 0:null===(l=S.values)||void 0===l?void 0:l.employeeName,maxAccess:g,readOnly:!0,onChange:S.handleChange,onClear:()=>S.setFieldValue("employeeName",""),error:S.touched.employeeName&&!!S.errors.employeeName})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(p.Z,{name:"positionName",label:j.position,value:null==S?void 0:null===(a=S.values)||void 0===a?void 0:a.positionName,maxAccess:g,readOnly:!0,onChange:S.handleChange,onClear:()=>S.setFieldValue("positionName",""),error:S.touched.positionName&&!!S.errors.positionName})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(p.Z,{name:"departmentName",label:j.department,value:null==S?void 0:null===(I=S.values)||void 0===I?void 0:I.departmentName,maxAccess:g,readOnly:!0,onChange:S.handleChange,onClear:()=>S.setFieldValue("departmentName",""),error:S.touched.departmentName&&!!S.errors.departmentName})}),(0,n.jsx)(x.ZP,{item:!0,xs:6,children:(0,n.jsx)(p.Z,{name:"branchName",label:j.branch,value:null==S?void 0:null===(F=S.values)||void 0===F?void 0:F.branchName,maxAccess:g,readOnly:!0,onChange:S.handleChange,onClear:()=>S.setFieldValue("branchName",""),error:S.touched.branchName&&!!S.errors.branchName})})]})})})}),(0,n.jsx)(c.Q,{children:(0,n.jsx)(r.Z,{name:"salaryTable",columns:w,gridData:{list:q},rowId:["recordId"],onEdit:e=>{E(null==e?void 0:e.recordId)},onDelete:k,pagination:!1,refetch:_,maxAccess:g})})]})}var $=a(36908);function W(){let{getRequest:e}=(0,t.useContext)(d.$),{stack:l}=(0,m.zY)(),{query:{data:a},filterBy:x,refetch:y,labels:p,paginationParameters:h,access:f}=(0,i.J)({queryFn:A,endpointId:v.y.EmployeeChart.page,datasetId:o.i.Salaries,filter:{filterFn:I}});function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map(e=>{var l,a,n,t,r,d,i;return{recordId:(null==e?void 0:null===(l=e.parent)||void 0===l?void 0:l.recordId)||null,reference:(null==e?void 0:null===(a=e.parent)||void 0===a?void 0:a.reference)||null,name:(null==e?void 0:null===(n=e.parent)||void 0===n?void 0:n.fullName)||null,departmentName:(null==e?void 0:null===(t=e.department)||void 0===t?void 0:t.name)||null,positionName:(null==e?void 0:null===(r=e.position)||void 0===r?void 0:r.name)||null,branchName:(null==e?void 0:null===(d=e.branch)||void 0===d?void 0:d.name)||null,scName:(null==e?void 0:e.scName)||null,scTypeName:(null==e?void 0:e.scTypeName)||null,hireDate:(null==e?void 0:null===(i=e.parent)||void 0===i?void 0:i.hireDate)||null}})}async function A(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:n=50,params:t=[]}=l,r=await e({extension:v.y.EmployeeChart.page,parameters:"_startAt=".concat(a,"&_size=").concat(n,"&_params=").concat(t,"&_sortBy=recordId&_filter=")});return{count:r.count,list:b(null==r?void 0:r.list),_startAt:a}}async function I(l){let{filters:a,pagination:n}=l;if(a.qry){let l=await e({extension:v.y.EmployeeChart.qry2,parameters:"_branchId=0&_filter=".concat(a.qry)});return{count:l.count,list:b(null==l?void 0:l.list)}}return A({_startAt:n._startAt||0,params:null==a?void 0:a.params})}let F=[{field:"reference",headerName:p.reference,flex:1},{field:"name",headerName:p.name,flex:1},{field:"departmentName",headerName:p.department,flex:1},{field:"positionName",headerName:p.position,flex:1},{field:"branchName",headerName:p.branch,flex:1},{field:"scName",headerName:p.schedule,flex:1},{field:"scTypeName",headerName:p.scheduleType,flex:1},{field:"hireDate",headerName:p.hireDate,flex:1,type:"date"}];return(0,n.jsxs)(s.R,{children:[(0,n.jsx)(u.g,{children:(0,n.jsx)($.Z,{maxAccess:f,reportName:"RT108",filterBy:x})}),(0,n.jsx)(c.Q,{children:(0,n.jsx)(r.Z,{name:"table",columns:F,gridData:a,rowId:["recordId"],onEdit:e=>{l({Component:L,props:{employeeInfo:e,maxAccess:f,labels:p},width:1e3,height:700,title:p.salary})},pageSize:50,paginationType:"api",paginationParameters:h,refetch:y,maxAccess:f})})]})}},29326:function(e,l,a){"use strict";var n=a(52322);a(2784);var t=a(23925),r=a(13980),d=a.n(r),i=a(95291),o=a.n(i),s=a(65947);let u=e=>{var l,a,r;let{children:d,value:i,index:u,maxAccess:c,...m}=e,v="".concat(e.name||"tab",".").concat(u),{accessLevel:x}=null!==(r=(null!==(a=null==c?void 0:null===(l=c.record)||void 0===l?void 0:l.controls)&&void 0!==a?a:[]).find(e=>e.controlId===v))&&void 0!==r?r:{accessLevel:0};if(x===s.A1)return null;let y=i===u;return(0,n.jsx)(t.Z,{role:"tabpanel",hidden:!y,id:"simple-tabpanel-".concat(u),"aria-labelledby":"simple-tab-".concat(u),className:"".concat(o().tabPanel," ").concat(y?o().active:o().hidden),...m,children:d})};u.propTypes={children:d().node,index:d().number.isRequired,value:d().number.isRequired},l.Z=u},9522:function(e,l,a){"use strict";a.d(l,{Y:function(){return m}});var n=a(52322),t=a(23925),r=a(54582),d=a(68696),i=a(44258),o=a(2784),s=a(99266),u=a(52614),c=a.n(u);let m=e=>{var l,a,u,m,v;let{tabs:x,activeTab:y,setActiveTab:p,maxAccess:h,name:f="tab"}=e,b=(null==h?void 0:null===(a=h.record)||void 0===a?void 0:null===(l=a.controls)||void 0===l?void 0:l.filter(e=>{var l;return 4===e.accessLevel&&(null===(l=e.controlId)||void 0===l?void 0:l.startsWith("".concat(f,".")))}).map(e=>e.controlId.split(".")[1]))||[],A=null==x?void 0:null===(u=x.map((e,l)=>({...e,id:l})))||void 0===u?void 0:u.filter((e,l)=>!b.includes(String(l))),I=null===(m=A[y])||void 0===m?void 0:m.id,F=null===(v=A[y])||void 0===v?void 0:v.disabled;return(0,o.useEffect)(()=>{I>=0&&!F&&y!=I&&p(I)},[]),(0,n.jsx)(t.Z,{className:c().tabsContainer,children:(0,n.jsx)(t.Z,{className:c().tabsWrapper,children:(0,n.jsx)(r.Z,{value:y,onChange:(e,l)=>p(l),variant:"scrollable",scrollButtons:A.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:c().tabsIndicator},className:c().tabs,children:null==A?void 0:A.map(e=>(0,n.jsx)(d.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(c().tabName," ").concat(e.disabled?c().tabDisabled:""),classes:{root:c().tabRoot,selected:c().selectedTab},label:(0,n.jsxs)(t.Z,{display:"flex",alignItems:"center",children:[(0,n.jsx)("span",{children:e.label}),e.id===y&&(null==e?void 0:e.onRefetch)&&(0,n.jsx)(i.Z,{size:"small",className:c().refreshButton,onClick:l=>{l.stopPropagation(),e.onRefetch()},children:(0,n.jsx)(s.Z,{className:c().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=62952)}),_N_E=e.O()}]);