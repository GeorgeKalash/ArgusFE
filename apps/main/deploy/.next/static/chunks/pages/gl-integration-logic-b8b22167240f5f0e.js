(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1555],{62193:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gl-integration-logic",function(){return a(2707)}])},2707:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return P}});var n=a(52322),i=a(2784),s=a(62202),l=a(69387),r=a(27723),o=a(65950),d=a(71987),c=a(33625),u=a(62362),m=a(31389),v=a(26612),x=a(19473),h=a(66361),g=a(29326),p=a(60218),b=a(48601),f=a(82737),I=a(5088),_=a(80983),y=a(8661),C=a(84100);function j(e){let{labels:t,maxAccess:a,setStore:l,store:r}=e,{getRequest:c,postRequest:g}=(0,i.useContext)(o.$),{platformLabels:j}=(0,i.useContext)(x.l),{recordId:L,header:Z}=r,N=!!L,S=(0,d.E)({endpointId:h.x.IntegrationLogic.page}),{formik:T}=(0,_.c)({initialValues:{recordId:"",name:"",distributionLevel:""},validateOnChange:!0,validationSchema:b.Ry({distributionLevel:b.Z_().required(),name:b.Z_().required()}),onSubmit:async e=>{let t=await g({extension:h.x.IntegrationLogic.set,record:JSON.stringify(e)});e.recordId?s.ZP.success(j.Edited):(l(e=>({...e,recordId:t.recordId})),s.ZP.success(j.Added),T.setFieldValue("recordId",t.recordId)),S()}});(0,i.useEffect)(()=>{Z&&T.setValues(Z)},[Z]);let A=async()=>{let e=await c({extension:h.x.IntegrationLogic.get2,parameters:"_recordId=".concat(L)});if(e.record){let t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download="integration_logic_".concat(L,".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}},F=async()=>{let e=document.createElement("input");e.type="file",e.accept=".json",e.style.display="none",e.onchange=async e=>{var t,a;let n=e.target.files[0];if(!n)return;let i={...JSON.parse(await n.text()).record,recordId:T.values.recordId||r.recordId};if(!(null==i?void 0:i.header))return;let s=structuredClone(i),o=r.recordId||T.values.recordId;o&&(s.header.recordId=o,s.items=null!==(a=null===(t=s.items)||void 0===t?void 0:t.map(e=>({...e,ilId:o})))&&void 0!==a?a:[],l(e=>({...e,recordId:o})),await g({extension:h.x.IntegrationLogic.set2,record:JSON.stringify({header:s.header,items:s.items})}),l(e=>({...e,recordId:o,header:s.header,items:s.items})),S())},document.body.appendChild(e),e.click(),document.body.removeChild(e)};return(0,n.jsx)(f.Z,{resourceId:v.i.IntegrationLogics,actions:[{key:"Export",condition:!0,onClick:A,disabled:!N},{key:"Import",condition:!0,onClick:F,disabled:!N}],form:T,maxAccess:a,editMode:N,children:(0,n.jsx)(m.R,{children:(0,n.jsx)(u.Q,{children:(0,n.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{name:"name",label:t.name,value:T.values.name,required:!0,maxAccess:a,onChange:T.handleChange,onClear:()=>T.setFieldValue("name",""),error:T.touched.name&&!!T.errors.name})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{datasetId:C.v.GLI_DISTRIBUTION_LEVEL,name:"distributionLevel",label:t.distributionLevel,values:T.values,valueField:"key",displayField:"value",required:!0,maxAccess:a,onChange:(e,t)=>T.setFieldValue("distributionLevel",t?t.key:""),error:T.touched.distributionLevel&&!!T.errors.distributionLevel})})]})})})})}var L=a(61802),Z=a(27423),N=a(21581),S=a(54074);function T(e){let{recordId:t,labels:a,maxAccess:l,getData:r,window:d,store:c}=e,{getRequest:v,postRequest:g}=(0,i.useContext)(o.$),{platformLabels:f}=(0,i.useContext)(x.l),I=null==c?void 0:c.recordId,{formik:j}=(0,_.c)({initialValues:{recordId:t,ilId:I,sign:"",tagId:null,integrationLevel:"",masterSource:"",postTypeId:null,description:"",costCenterSource:null},maxAccess:l,validationSchema:b.Ry({sign:b.Z_().required(),tagId:b.Z_().required(),integrationLevel:b.Z_().required(),masterSource:b.Z_().required(),postTypeId:b.Z_().required()}),onSubmit:async e=>{var a,n,i,l;let o=await L(),c=(null==e?void 0:e.seqNo)?null==o?void 0:null===(a=o.list)||void 0===a?void 0:a.map(t=>(null==t?void 0:t.seqNo)===(null==e?void 0:e.seqNo)?e:t):[...null==o?void 0:o.list,{...e,seqNo:(null==o?void 0:null===(n=o.list)||void 0===n?void 0:n.length)>0?(null===(i=o.list[(null==o?void 0:null===(l=o.list)||void 0===l?void 0:l.length)-1])||void 0===i?void 0:i.seqNo)+1:1}];await g({extension:h.x.IntegrationLogicDetails.set2,record:JSON.stringify({ilId:I,details:c})}),r(),s.ZP.success(t?f.Edited:f.Added),d.close()}});async function L(){if(I)return await v({extension:h.x.IntegrationLogicDetails.qry,parameters:"_ilId=".concat(I)})}return(0,i.useEffect)(()=>{!async function(){if(t&&I){let e=await v({extension:h.x.IntegrationLogicDetails.get,parameters:"_seqNo=".concat(t,"&_ilId=").concat(I)});j.setValues(e.record)}}()},[t]),(0,n.jsx)(S.Z,{onSave:j.handleSubmit,maxAccess:l,editMode:!!I,children:(0,n.jsx)(m.R,{children:(0,n.jsx)(u.Q,{children:(0,n.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(Z.U,{endpointId:h.x.IntegrationPostTypes.snapshot,parameters:{_type:0},required:!0,name:"postTypeId",label:a.postTypes,valueField:"reference",displayField:"name",valueShow:"ptRef",secondValueShow:"ptName",form:j,onChange:(e,t)=>{j.setFieldValue("ptRef",(null==t?void 0:t.reference)||""),j.setFieldValue("ptName",(null==t?void 0:t.name)||""),j.setFieldValue("postTypeId",(null==t?void 0:t.recordId)||null)},error:j.touched.postTypeId&&!!j.errors.postTypeId,maxAccess:l})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{datasetId:C.v.Sign,name:"sign",label:a.sign,values:j.values,valueField:"key",displayField:"value",required:!0,maxAccess:l,onChange:(e,t)=>{j.setFieldValue("sign",(null==t?void 0:t.key)||null)},error:j.touched.sign&&!!j.errors.sign})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{datasetId:C.v.GLI_MASTER_SOURCE,name:"masterSource",label:a.masterSource,values:j.values,valueField:"key",displayField:"value",required:!0,maxAccess:l,onChange:(e,t)=>{j.setFieldValue("masterSource",(null==t?void 0:t.key)||null)},error:j.touched.masterSource&&!!j.errors.masterSource})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{datasetId:C.v.GLI_TAG,name:"tagId",label:a.tag,values:j.values,valueField:"key",displayField:"value",required:!0,maxAccess:l,onChange:(e,t)=>{j.setFieldValue("tagId",(null==t?void 0:t.key)||null)},error:j.touched.tagId&&!!j.errors.tagId})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{datasetId:C.v.GLI_INTEGRATION_LEVEL,name:"integrationLevel",label:a.integrationLevel,values:j.values,valueField:"key",displayField:"value",required:!0,maxAccess:l,onChange:(e,t)=>{j.setFieldValue("integrationLevel",(null==t?void 0:t.key)||null)},error:j.touched.integrationLevel&&!!j.errors.integrationLevel})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{datasetId:C.v.COST_CENTER,name:"costCenterSource",label:a.costCenterSource,values:j.values,valueField:"key",displayField:"value",maxAccess:l,onChange:(e,t)=>j.setFieldValue("costCenterSource",(null==t?void 0:t.key)||null),error:j.touched.costCenterSource&&!!j.errors.costCenterSource})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(N.Z,{name:"description",label:a.description,value:j.values.description,maxLength:"100",rows:4,maxAccess:l,onChange:j.handleChange,onClear:()=>j.setFieldValue("description",""),error:j.touched.description&&!!j.errors.description})})]})})})})}var A=e=>{let{labels:t,maxAccess:a,store:d,getData:v}=e,{postRequest:g}=(0,i.useContext)(o.$),{platformLabels:p}=(0,i.useContext)(x.l),[b,f]=(0,i.useState)([]),{stack:I}=(0,L.zY)(),{recordId:_,items:y}=d,C=()=>{f(y||[])};(0,i.useEffect)(()=>{C()},[_,y]);let j=[{field:"ptName",headerName:t.postTypes,flex:.8},{field:"signName",headerName:t.sign,flex:.6},{field:"msName",headerName:t.masterSource,flex:1},{field:"tagName",headerName:t.tag,flex:1},{field:"integrationLevelName",headerName:t.integrationLevel,flex:1},{field:"costCenterSourceName",headerName:t.costCenterSourceName,flex:1},{field:"description",headerName:t.description,wrapText:!0,autoHeight:!0,flex:1.75}],Z=async e=>{await g({extension:h.x.IntegrationLogicDetails.del,record:JSON.stringify(e)}),s.ZP.success(p.Deleted),v()},N=e=>{I({Component:T,props:{labels:t,maxAccess:a,store:d,recordId:e,getData:v},width:650,height:550,title:t.integrationLogicDetails})};return(0,n.jsxs)(m.R,{children:[(0,n.jsx)(c.g,{children:(0,n.jsx)(r.Z,{onAdd:()=>{N()},maxAccess:a})}),(0,n.jsx)(u.Q,{children:(0,n.jsx)(l.Z,{table:"table",columns:j,gridData:{list:b},rowId:["recordId"],onEdit:e=>{N(null==e?void 0:e.seqNo)},onDelete:Z,maxAccess:a,pagination:!1})})]})},F=a(9522),w=e=>{let{labels:t,maxAccess:a,recordId:s}=e,[l,r]=(0,i.useState)(0),{getRequest:d}=(0,i.useContext)(o.$),[c,u]=(0,i.useState)({recordId:s||null,header:null,items:[]}),m=[{label:t.integrationLogic},{label:t.integrationLogicDetails,disabled:!c.recordId}],v=async()=>{if(!s)return;let e=await d({extension:h.x.IntegrationLogic.get2,parameters:"_recordId=".concat(s)});return u(t=>{var a,n;return{...t,header:null==e?void 0:null===(a=e.record)||void 0===a?void 0:a.header,items:null==e?void 0:null===(n=e.record)||void 0===n?void 0:n.items}}),null==e?void 0:e.record};return(0,i.useEffect)(()=>{v()},[s]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(F.Y,{tabs:m,activeTab:l,setActiveTab:r,maxAccess:a}),(0,n.jsx)(g.Z,{index:0,value:l,maxAccess:a,children:(0,n.jsx)(j,{labels:t,setStore:u,store:c,maxAccess:a})}),(0,n.jsx)(g.Z,{index:1,value:l,maxAccess:a,children:(0,n.jsx)(A,{labels:t,maxAccess:a,store:c,getData:v})})]})},P=()=>{let{getRequest:e,postRequest:t}=(0,i.useContext)(o.$),{platformLabels:a}=(0,i.useContext)(x.l),{stack:g}=(0,L.zY)();async function p(t){let{qry:a}=t;return await e({extension:h.x.IntegrationLogic.snapshot,parameters:"_filter=".concat(a)})}async function b(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:n=50}=t;return{...await e({extension:h.x.IntegrationLogic.page,parameters:"_startAt=".concat(a,"&_pageSize=").concat(n,"&filter=")}),_startAt:a}}let{query:{data:f},labels:I,access:_,invalidate:y,refetch:C,search:j,clear:Z,paginationParameters:N}=(0,d.J)({queryFn:b,endpointId:h.x.IntegrationLogic.page,datasetId:v.i.IntegrationLogics,search:{searchFn:p}}),S=[{field:"name",headerName:I.name,flex:1}],T=async e=>{await t({extension:h.x.IntegrationLogic.del,record:JSON.stringify(e)}),y(),s.ZP.success(a.Deleted)};function A(e){g({Component:w,props:{labels:I,recordId:e,maxAccess:_},width:1100,height:500,title:I.integrationLogic})}return(0,n.jsxs)(m.R,{children:[(0,n.jsx)(c.g,{children:(0,n.jsx)(r.Z,{onAdd:()=>{A()},maxAccess:_,onSearch:j,onSearchClear:Z,labels:I,inputSearch:!0})}),(0,n.jsx)(u.Q,{children:(0,n.jsx)(l.Z,{name:"table",columns:S,gridData:f,rowId:["recordId"],onEdit:e=>{A(null==e?void 0:e.recordId)},onDelete:T,deleteConfirmationType:"strict",pageSize:50,paginationType:"api",paginationParameters:N,refetch:C,maxAccess:_})})]})}},29326:function(e,t,a){"use strict";var n=a(52322);a(2784);var i=a(23925),s=a(13980),l=a.n(s),r=a(95291),o=a.n(r),d=a(65947);let c=e=>{var t,a,s;let{children:l,value:r,index:c,maxAccess:u,...m}=e,v="".concat(e.name||"tab",".").concat(c),{accessLevel:x}=null!==(s=(null!==(a=null==u?void 0:null===(t=u.record)||void 0===t?void 0:t.controls)&&void 0!==a?a:[]).find(e=>e.controlId===v))&&void 0!==s?s:{accessLevel:0};if(x===d.A1)return null;let h=r===c;return(0,n.jsx)(i.Z,{role:"tabpanel",hidden:!h,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c),className:"".concat(o().tabPanel," ").concat(h?o().active:o().hidden),...m,children:l})};c.propTypes={children:l().node,index:l().number.isRequired,value:l().number.isRequired},t.Z=c},9522:function(e,t,a){"use strict";a.d(t,{Y:function(){return m}});var n=a(52322),i=a(23925),s=a(54582),l=a(68696),r=a(44258),o=a(2784),d=a(99266),c=a(52614),u=a.n(c);let m=e=>{var t,a,c,m,v;let{tabs:x,activeTab:h,setActiveTab:g,maxAccess:p,name:b="tab"}=e,f=(null==p?void 0:null===(a=p.record)||void 0===a?void 0:null===(t=a.controls)||void 0===t?void 0:t.filter(e=>{var t;return 4===e.accessLevel&&(null===(t=e.controlId)||void 0===t?void 0:t.startsWith("".concat(b,".")))}).map(e=>e.controlId.split(".")[1]))||[],I=null==x?void 0:null===(c=x.map((e,t)=>({...e,id:t})))||void 0===c?void 0:c.filter((e,t)=>!f.includes(String(t))),_=null===(m=I[h])||void 0===m?void 0:m.id,y=null===(v=I[h])||void 0===v?void 0:v.disabled;return(0,o.useEffect)(()=>{_>=0&&!y&&h!=_&&g(_)},[]),(0,n.jsx)(i.Z,{className:u().tabsContainer,children:(0,n.jsx)(i.Z,{className:u().tabsWrapper,children:(0,n.jsx)(s.Z,{value:h,onChange:(e,t)=>g(t),variant:"scrollable",scrollButtons:I.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==I?void 0:I.map(e=>(0,n.jsx)(l.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,n.jsxs)(i.Z,{display:"flex",alignItems:"center",children:[(0,n.jsx)("span",{children:e.label}),e.id===h&&(null==e?void 0:e.onRefetch)&&(0,n.jsx)(r.Z,{size:"small",className:u().refreshButton,onClick:t=>{t.stopPropagation(),e.onRefetch()},children:(0,n.jsx)(d.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=62193)}),_N_E=e.O()}]);