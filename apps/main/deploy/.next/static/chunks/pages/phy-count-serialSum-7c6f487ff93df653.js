(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[59942],{96867:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/phy-count-serialSum",function(){return l(90111)}])},90111:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return j}});var s=l(52322),a=l(31389),n=l(62362),r=l(69387),i=l(2784),o=l(65950),d=l(26612),u=l(33625),c=l(60218),h=l(19473),m=l(71987),x=l(8661),v=l(76426),g=l(91406),y=l(80983),I=l(5088),C=l(89330),f=l(39812),p=l(61802),P=l(32025),S=l(54074),k=l(69627),j=()=>{var e,t;let{getRequest:l}=(0,i.useContext)(o.$),{platformLabels:j}=(0,i.useContext)(h.l),[Z,T]=(0,i.useState)([]),[D,q]=(0,i.useState)([]),{stack:L}=(0,p.zY)(),{labels:R,maxAccess:w}=(0,m.J)({queryFn:V,endpointId:v.x.StockCountSerialSum.qry,datasetId:d.i.PhysicalCountSerialSummary}),{formik:b}=(0,y.c)({initialValues:{stockCountId:null,siteId:null,totalCountedPcs:null,totalWeight:null,totalSystemPcs:null,totalVariancePcs:null,totalVarianceWeight:null,date:"",reference:"",search:""},maxAccess:w,validateOnChange:!0});async function V(){if(!b.values.stockCountId||!b.values.siteId)return;let e=(await l({extension:v.x.StockCountSerialSum.qry,parameters:"_stockCountId=".concat(b.values.stockCountId,"&_siteId=").concat(b.values.siteId)})).list.map(e=>({...e,netWeight:e.weight*e.countedPcs,varianceWght:e.weight*e.variancePcs})),t=0,s=0,a=0,n=0,r=0;e.forEach(e=>{t+=e.countedPcs||0,s+=e.netWeight||0,a+=e.systemPcs||0,n+=e.variancePcs||0,r+=e.varianceWght||0}),b.setFieldValue("totalCountedPcs",t),b.setFieldValue("totalWeight",s),b.setFieldValue("totalSystemPcs",a),b.setFieldValue("totalVariancePcs",n),b.setFieldValue("totalVarianceWeight",r),T({list:e})}let N=e=>{q([]),l({extension:v.x.Sites.qry,parameters:"_stockCountId=".concat(e)}).then(e=>{q(e.list.filter(e=>!0==e.isChecked))})},F=[{field:"srlNo",headerName:R.srlNo,flex:1},{field:"sku",headerName:R.sku,flex:1},{field:"itemName",headerName:R.name,flex:1},{field:"countedPcs",headerName:R.countedPcs,flex:1,type:"number"},{field:"systemPcs",headerName:R.systemPcs,flex:1,type:"number"},{field:"variancePcs",headerName:R.variancePcs,flex:1,type:"number"},{field:"weight",headerName:R.weight,flex:1,type:"number"},{field:"varianceWght",headerName:R.varW,flex:1,type:"number"},{field:"netWeight",headerName:R.netWeight,flex:1,type:"number"}];function _(){L({Component:P.Z,props:{open:{flag:!0},fullScreen:!1,dialogText:j.ClearFormGrid,onConfirm:()=>{b.resetForm(),T({list:[]}),q([])}}})}(0,i.useEffect)(()=>{!async function(){await V()}()},[b.values.siteId]);let W=(0,i.useMemo)(()=>{var e;return{...Z,list:null==Z?void 0:null===(e=Z.list)||void 0===e?void 0:e.filter(e=>e.sku&&e.sku.toString().toLowerCase().includes(b.values.search.toLowerCase())||e.srlNo&&e.srlNo.toLowerCase().includes(b.values.search.toLowerCase())||e.weight&&e.weight.toString().toLowerCase().includes(b.values.search.toLowerCase()))}},[b.values.search,Z]);return(0,s.jsx)(S.Z,{isSaved:!1,maxAccess:w,resourceId:d.i.PhysicalCountSerialSummary,previewReport:(null==Z?void 0:null===(e=Z.list)||void 0===e?void 0:e.length)>0,children:(0,s.jsxs)(a.R,{children:[(0,s.jsx)(u.g,{children:(0,s.jsxs)(c.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(x.Z,{endpointId:v.x.StockCount.qry,parameters:"_startAt=0&_pageSize=1000&_params=",name:"stockCountId",label:R.stockCount,valueField:"recordId",displayField:"reference",values:b.values,required:!0,readOnly:b.values.siteId,maxAccess:w,onChange:(e,t)=>{b.setFieldValue("stockCountId",null==t?void 0:t.recordId),b.setFieldValue("reference",null==t?void 0:t.reference),b.setFieldValue("date",(0,f.a1)(null==t?void 0:t.date)),b.setFieldValue("siteId",""),t?N(null==t?void 0:t.recordId):(q([]),b.setFieldValue("date",""),b.setFieldValue("reference",""),_())},error:b.touched.stockCountId&&!!b.errors.stockCountId})}),(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(C.Z,{name:"date",label:R.date,value:b.values.date,readOnly:!0,error:!1})}),(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(I.Z,{name:"reference",label:R.reference,value:b.values.reference,readOnly:!0,error:!1})}),(0,s.jsx)(c.ZP,{item:!0,xs:6}),(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(x.Z,{name:"siteId",store:D,label:R.site,valueField:"siteId",displayField:["siteRef","siteName"],columnsInDropDown:[{key:"siteRef",value:"Reference"},{key:"siteName",value:"Name"}],values:b.values,required:!0,readOnly:b.values.siteId,onChange:(e,t)=>{b.setFieldValue("siteId",null==t?void 0:t.siteId)},error:b.touched.siteId&&!!b.errors.siteId,maxAccess:w})}),(0,s.jsx)(c.ZP,{item:!0,xs:10}),(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(I.Z,{name:"search",value:b.values.search,label:R.search,onClear:()=>{b.setFieldValue("search","")},onChange:e=>{let{value:t}=e.target;b.setFieldValue("search",t)},readOnly:(null==Z?void 0:null===(t=Z.list)||void 0===t?void 0:t.length)===0||(null==Z?void 0:Z.length)===0})}),(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(k.Z,{image:"clear.png",tooltipText:j.Clear,onClick:_,style:{backgroundColor:"#f44336"}})})]})}),(0,s.jsx)(n.Q,{children:(0,s.jsx)(r.Z,{columns:F,gridData:null!=W?W:{list:[]},rowId:["recordId"],isLoading:!1,paginationType:"api",pagination:!1,maxAccess:w,textTransform:!0})}),(0,s.jsx)(u.g,{children:(0,s.jsxs)(c.ZP,{container:!0,spacing:2,sx:{pt:3},children:[(0,s.jsx)(c.ZP,{item:!0,xs:4}),(0,s.jsx)(c.ZP,{item:!0,xs:8,children:(0,s.jsxs)(c.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(g.Z,{name:"totalCountedPcs",label:R.totalCountedPcs,value:b.values.totalCountedPcs,readOnly:!0,hidden:!(b.values.stockCountId&&b.values.siteId)})}),(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(g.Z,{name:"totalSystemPcs",label:R.totalSys,value:b.values.totalSystemPcs,readOnly:!0,hidden:!(b.values.stockCountId&&b.values.siteId)})}),(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(g.Z,{name:"totalVariancePcs",label:R.tPv,value:b.values.totalVariancePcs,readOnly:!0,hidden:!(b.values.stockCountId&&b.values.siteId)})}),(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(g.Z,{name:"totalWeight",label:R.totalWeight,value:b.values.totalWeight,readOnly:!0,hidden:!(b.values.stockCountId&&b.values.siteId)})}),(0,s.jsx)(c.ZP,{item:!0,xs:2,children:(0,s.jsx)(g.Z,{name:"totalVarianceWeight",label:R.tVw,value:b.values.totalVarianceWeight,readOnly:!0,hidden:!(b.values.stockCountId&&b.values.siteId)})})]})})]})})]})})}},76426:function(e,t,l){"use strict";l.d(t,{x:function(){return a}});let s="SC.asmx/",a={LabelTemplate:{qry:s+"qryLBT",set:s+"setLBT",get:s+"getLBT",del:s+"delLBT"},Item:{qry:s+"qryLBI",set:s+"setLBI",get:s+"getLBI",del:s+"delLBI"},Sites:{qry:s+"qrySIT",set:s+"setSIT",set2:s+"set2SIT",get:s+"getSIT",del:s+"delSIT",reopen:s+"reopenSIT",end:s+"endSIT"},Controller:{qry:s+"qryCRL"},StockCountControllerTab:{qry:s+"qryPHY",set2:s+"set2PHY",set:s+"setPHY",get:s+"getPHY",del:s+"delPHY"},StockCount:{page:s+"pageHDR",post:s+"postHDR",unpost:s+"unpostHDR",qry:s+"qryHDR",get:s+"getHDR",set:s+"setHDR",del:s+"delHDR",close:s+"closeHDR",reopen:s+"reopenHDR",snapshot:s+"snapshotHDR"},StockCountController:{page:s+"pageCRL",set:s+"setCRL",get:s+"getCRL",del:s+"delCRL"},DocumentTypeDefaults:{qry:s+"qryDTD",set:s+"setDTD",get:s+"getDTD",del:s+"delDTD"},StockCountItem:{qry:s+"qryITM",set:s+"setITM",get:s+"getITM",del:s+"delITM"},StockCountSerialSum:{qry:s+"qrySRS"},StockCountItemDetail:{qry:s+"qryITD",set:s+"setITD",get:s+"getITD",del:s+"delITD",set2:s+"set2ITD"},StockCountSerialDetail:{set2:s+"set2SRL",qry:s+"qrySRL",append:s+"appendSRL",del:s+"delSRL",batch:s+"batchSRL"}}},32025:function(e,t,l){"use strict";var s=l(52322),a=l(2784),n=l(23361),r=l(19473),i=l(21326);let o=e=>{let{window:t,onConfirm:l,fullScreen:o,open:d,dialogText:u}=e,{platformLabels:c}=(0,a.useContext)(r.l);return(0,i.Z)({title:c.Clear,window:t}),(0,s.jsx)(n.Z,{open:null!=d&&!!d.flag&&(null==d?void 0:d.flag),DialogText:u,okButtonAction:()=>{"function"==typeof l&&l(),t.close()},fullScreen:o,cancelButtonAction:()=>t.close(),height:"140px"})};o.width=570,o.height=170,t.Z=o}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=96867)}),_N_E=e.O()}]);