(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[19584],{2904:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/rt-fees-schedule",function(){return t(24277)}])},24277:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return P}});var n=t(52322),r=t(2784),s=t(62202),l=t(61802),o=t(69387),i=t(65950),c=t(71987),d=t(26612),u=t(31389),m=t(33625),h=t(62362),b=t(88469),f=t(29326),x=t(9522),p=t(60218),_=t(84100),v=t(48601),y=t(5088),C=t(82737),T=t(80983),g=t(8661),F=t(19473),S=e=>{let{labels:a,maxAccess:t,setStore:l,store:o,onChange:h}=e,{postRequest:f,getRequest:x}=(0,r.useContext)(i.$),{recordId:S}=o,{platformLabels:N}=(0,r.useContext)(F.l),I=(0,c.E)({endpointId:b.N.FeeSchedule.page}),{formik:j}=(0,T.c)({maxAccess:t,initialValues:{recordId:null,name:"",reference:"",originCurrency:""},validateOnChange:!0,validationSchema:v.Ry({name:v.Z_().required(),reference:v.Z_().required(),originCurrency:v.Z_().required()}),onSubmit:async e=>{await Z(e)}});(0,r.useEffect)(()=>{h(j.values)},[j.values]);let Z=async e=>{let a=await f({extension:b.N.FeeSchedule.set,record:JSON.stringify(e)}),t=(null==e?void 0:e.recordId)?N.Edited:N.Added;s.ZP.success(t),(null==e?void 0:e.recordId)||(j.setFieldValue("recordId",a.recordId),l(e=>({...e,recordId:a.recordId}))),I()};(0,r.useEffect)(()=>{S&&A(S)},[]);let A=e=>{x({extension:b.N.FeeSchedule.get,parameters:"_recordId=".concat(e)}).then(e=>{j.setValues(e.record)}).catch(e=>{})};return(0,n.jsx)(C.Z,{form:j,resourceId:d.i.FeeSchedule,maxAccess:t,editMode:!!S,children:(0,n.jsx)(u.R,{children:(0,n.jsx)(m.g,{children:(0,n.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{name:"reference",label:a.reference,value:j.values.reference,required:!0,rows:2,maxAccess:t,onChange:j.handleChange,onClear:()=>j.setFieldValue("reference",""),error:j.touched.reference&&!!j.errors.reference})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{name:"name",label:a.name,value:j.values.name,required:!0,maxLength:"50",maxAccess:t,onChange:j.handleChange,onClear:()=>j.setFieldValue("name",""),error:j.touched.name&&!!j.errors.name})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{datasetId:_.v.Remittance_Fee_Type,name:"originCurrency",required:!0,label:a.originCurrency,valueField:"key",displayField:"value",values:j.values,maxAccess:t,onChange:(e,a)=>{j.setFieldValue("originCurrency",null==a?void 0:a.key)},error:j.touched.originCurrency&&!!j.errors.originCurrency})})]})})})})},N=t(78711),I=t(76399),j=t(54074),Z=e=>{let{store:a,labels:t,maxAccess:l}=e,{recordId:o}=a,{getRequest:c,postRequest:d}=(0,r.useContext)(i.$),{platformLabels:m}=(0,r.useContext)(F.l);(0,r.useEffect)(()=>{x.setValues({scheduleId:o,FeeScheduleDetail:[{id:1,seqNo:1,amountTo:"",amountFrom:"",feeAmount:"",feeType:"",feeTypeName:""}]}),o&&c({extension:b.N.FeeScheduleDetail.qry,parameters:"_scheduleId=".concat(o)}).then(e=>{let a=e.list,t=a.map((e,a)=>({...e,id:a+1,seqNo:a+1}));a&&x.setValues({FeeScheduleDetail:t})}).catch(e=>{})},[o]);let f=[{component:"numberfield",label:t.amountFrom,name:"amountFrom"},{component:"numberfield",label:t.amountTo,name:"amountTo"},{component:"resourcecombobox",name:"feeType",label:t.feeType,props:{datasetId:_.v.FeesType,valueField:"key",displayField:"value",mapping:[{from:"key",to:"feeType"},{from:"value",to:"feeTypeName"}]}},{component:"textfield",label:t.feeAmount,name:"feeAmount"}],x=(0,N.TA)({validateOnChange:!0,validationSchema:v.Ry({FeeScheduleDetail:v.IX().of(v.Ry().shape({amountFrom:v.Z_().required(),amountTo:v.Z_().required(),feeAmount:v.Z_().required(),feeType:v.Z_().required()})).required()}),initialValues:{scheduleId:o,FeeScheduleDetail:[{id:1,seqNo:1,amountTo:"",amountFrom:"",feeAmount:"",feeType:"",feeTypeName:""}]},onSubmit:async e=>{await p(e)}}),p=async e=>{let a=e.FeeScheduleDetail.map((e,a)=>{let{seqNo:t,scheduleId:n,...r}=e;return{seqNo:a+1,scheduleId:o,...r}});await d({extension:b.N.FeeScheduleDetail.set2,record:JSON.stringify({scheduleId:o,items:a})}).then(e=>{s.ZP.success(m.Submit)}).catch(e=>{})};return(0,n.jsx)(j.Z,{onSave:x.handleSubmit,maxAccess:l,isParentWindow:!1,children:(0,n.jsx)(u.R,{children:(0,n.jsx)(h.Q,{children:(0,n.jsx)(I._,{onChange:e=>x.setFieldValue("FeeScheduleDetail",e),value:x.values.FeeScheduleDetail,error:x.errors.FeeScheduleDetail,columns:f,maxAccess:l,name:"FeeScheduleDetail"})})})})},A=e=>{let{recordId:a,labels:t,maxAccess:s}=e,[l,o]=(0,r.useState)(0),[i,c]=(0,r.useState)({recordId:a||null}),d=[{label:t.feesScedule},{label:t.details,disabled:!i.recordId}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.Y,{tabs:d,activeTab:l,setActiveTab:o,maxAccess:s}),(0,n.jsx)(f.Z,{index:0,value:l,maxAccess:s,children:(0,n.jsx)(S,{labels:t,setStore:c,store:i,maxAccess:s,onChange:function(e){c({...i,...e})}})}),(0,n.jsx)(f.Z,{index:1,value:l,maxAccess:s,children:(0,n.jsx)(Z,{labels:t,store:i,maxAccess:s})})]})},q=t(36908),P=()=>{let{getRequest:e,postRequest:a}=(0,r.useContext)(i.$),{stack:t}=(0,l.zY)(),{platformLabels:f}=(0,r.useContext)(F.l);async function x(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:n=50,params:r=[]}=a;return{...await e({extension:b.N.FeeSchedule.page,parameters:"_startAt=".concat(t,"&_pageSize=").concat(n,"&_params=").concat(r)}),_startAt:t}}let{query:{data:p},filterBy:_,refetch:v,labels:y,access:C,paginationParameters:T,invalidate:g}=(0,c.J)({queryFn:x,endpointId:b.N.FeeSchedule.snapshot,datasetId:d.i.FeeSchedule,filter:{filterFn:S}});async function S(a){let{filters:t,pagination:n}=a;return t.qry?await e({extension:b.N.FeeSchedule.snapshot,parameters:"_filter=".concat(t.qry)}):x({_startAt:n._startAt||0,params:null==t?void 0:t.params})}let N=[{field:"reference",headerName:y.reference,flex:1},{field:"name",headerName:y.name,flex:1},{field:"originCurrencyName",headerName:y.originCurrency,flex:1}];function I(e){t({Component:A,props:{labels:y,recordId:e,maxAccess:C},width:1e3,height:500,title:y.feesScedule})}let j=async e=>{await a({extension:b.N.FeeSchedule.del,record:JSON.stringify(e)}),g(),s.ZP.success(f.Deleted)};return(0,n.jsxs)(u.R,{children:[(0,n.jsx)(m.g,{children:(0,n.jsx)(q.Z,{onAdd:()=>{I()},maxAccess:C,reportName:"RTFSC",filterBy:_})}),(0,n.jsx)(h.Q,{children:(0,n.jsx)(o.Z,{name:"table",columns:N,gridData:p,rowId:["recordId"],onEdit:e=>{I(e.recordId)},onDelete:j,pageSize:50,paginationType:"api",paginationParameters:T,refetch:v,maxAccess:C})})]})}},29326:function(e,a,t){"use strict";var n=t(52322);t(2784);var r=t(23925),s=t(13980),l=t.n(s),o=t(95291),i=t.n(o),c=t(65947);let d=e=>{var a,t,s;let{children:l,value:o,index:d,maxAccess:u,...m}=e,h="".concat(e.name||"tab",".").concat(d),{accessLevel:b}=null!==(s=(null!==(t=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==t?t:[]).find(e=>e.controlId===h))&&void 0!==s?s:{accessLevel:0};if(b===c.A1)return null;let f=o===d;return(0,n.jsx)(r.Z,{role:"tabpanel",hidden:!f,id:"simple-tabpanel-".concat(d),"aria-labelledby":"simple-tab-".concat(d),className:"".concat(i().tabPanel," ").concat(f?i().active:i().hidden),...m,children:l})};d.propTypes={children:l().node,index:l().number.isRequired,value:l().number.isRequired},a.Z=d},9522:function(e,a,t){"use strict";t.d(a,{Y:function(){return m}});var n=t(52322),r=t(23925),s=t(54582),l=t(68696),o=t(44258),i=t(2784),c=t(99266),d=t(52614),u=t.n(d);let m=e=>{var a,t,d,m,h;let{tabs:b,activeTab:f,setActiveTab:x,maxAccess:p,name:_="tab"}=e,v=(null==p?void 0:null===(t=p.record)||void 0===t?void 0:null===(a=t.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(_,".")))}).map(e=>e.controlId.split(".")[1]))||[],y=null==b?void 0:null===(d=b.map((e,a)=>({...e,id:a})))||void 0===d?void 0:d.filter((e,a)=>!v.includes(String(a))),C=null===(m=y[f])||void 0===m?void 0:m.id,T=null===(h=y[f])||void 0===h?void 0:h.disabled;return(0,i.useEffect)(()=>{C>=0&&!T&&f!=C&&x(C)},[]),(0,n.jsx)(r.Z,{className:u().tabsContainer,children:(0,n.jsx)(r.Z,{className:u().tabsWrapper,children:(0,n.jsx)(s.Z,{value:f,onChange:(e,a)=>x(a),variant:"scrollable",scrollButtons:y.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==y?void 0:y.map(e=>(0,n.jsx)(l.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,n.jsxs)(r.Z,{display:"flex",alignItems:"center",children:[(0,n.jsx)("span",{children:e.label}),e.id===f&&(null==e?void 0:e.onRefetch)&&(0,n.jsx)(o.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,n.jsx)(c.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=2904)}),_N_E=e.O()}]);