(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[33206],{87156:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fi-aging-profile",function(){return a(77247)}])},77247:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return C}});var i=a(52322),r=a(2784),t=a(62202),d=a(69387),l=a(27723),s=a(65950),o=a(71987),c=a(26612),g=a(33625),u=a(62362),m=a(31389),f=a(61802),p=a(25870),h=a(76399),x=a(82737),I=a(48601),v=a(19473),_=a(80983),y=a(5088),A=a(60218),q=e=>{let{recordId:n,labels:a,maxAccess:d,name:l,window:g}=e,{getRequest:f,postRequest:q}=(0,r.useContext)(s.$),{platformLabels:C}=(0,r.useContext)(v.l),w=(0,o.E)({endpointId:p.H.AgingProfile.qry}),{formik:P}=(0,_.c)({validateOnChange:!0,validationSchema:I.Ry({name:I.Z_().required(),agingLeg:I.IX().of(I.Ry().shape({days:I.Z_().required(),caption:I.Z_().required()})).required()}),initialValues:{name:l,recordId:n||"",agingLeg:[{id:1,agpId:n||"",days:"",caption:""}]},onSubmit:e=>{let{agingLeg:n}=e;1===n.length&&j(n[0])?(P.setValues({...e,agingLeg:[]}),L([])):L(e)}}),j=e=>!e.caption&&!e.days,L=async e=>{var a;let i=(null==e?void 0:null===(a=e.agingLeg)||void 0===a?void 0:a.map((e,a)=>({...e,agpId:n,seqNo:a+1})))||[],r={header:{recordId:n||"",name:P.values.name},items:i},d=await q({extension:p.H.AgingProfile.set2,record:JSON.stringify(r)});e.recordId||(P.setFieldValue("recordId",d.recordId),g.close()),t.ZP.success(e.recordId?C.Edited:C.Added),w()},Z=[{component:"numberfield",label:a.qty,name:"days"},{component:"textfield",label:a.caption,name:"caption"}],b=!!P.values.recordId;return(0,r.useEffect)(()=>{n&&f({extension:p.H.AgingLeg.qry,parameters:"_agpId=".concat(n)}).then(e=>{var n;let a=null===(n=e.list)||void 0===n?void 0:n.map((e,n)=>({...e,id:n+1}));P.setValues({...P.values,agingLeg:a})})},[n]),(0,i.jsx)(x.Z,{form:P,resourceId:c.i.FIAgingProfile,isCleared:!1,maxAccess:d,editMode:b,children:(0,i.jsx)(m.R,{children:(0,i.jsxs)(u.Q,{children:[(0,i.jsx)(A.ZP,{item:!0,xs:12,children:(0,i.jsx)(y.Z,{name:"name",label:a.name,value:P.values.name,required:!0,onChange:P.handleChange,onClear:()=>P.setFieldValue("name",""),error:P.touched.name&&!!P.errors.name,maxAccess:d})}),(0,i.jsx)(h._,{onChange:e=>P.setFieldValue("agingLeg",e),value:P.values.agingLeg||[],error:P.errors.agingLeg,allowDelete:!0,columns:Z})]})})})},C=()=>{let{getRequest:e,postRequest:n}=(0,r.useContext)(s.$),{stack:a}=(0,f.zY)(),{platformLabels:h}=(0,r.useContext)(v.l);async function x(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:i=50}=n;return{...await e({extension:p.H.AgingProfile.qry,parameters:"_startAt=".concat(a,"&_pageSize=").concat(i,"&filter=")}),_startAt:a}}let{query:{data:I},labels:_,invalidate:y,refetch:A,access:C}=(0,o.J)({queryFn:x,endpointId:p.H.AgingProfile.qry,datasetId:c.i.FIAgingProfile}),w=[{field:"name",headerName:_.reference,flex:1}];function P(e,n){a({Component:q,props:{labels:_,recordId:e,name:n||"",maxAccess:C},width:600,height:370,title:_.aging})}let j=async e=>{await n({extension:p.H.AgingProfile.del,record:JSON.stringify(e)}),y(),t.ZP.success(h.Deleted)};return(0,i.jsxs)(m.R,{children:[(0,i.jsx)(g.g,{children:(0,i.jsx)(l.Z,{onAdd:()=>{P()},maxAccess:C})}),(0,i.jsx)(u.Q,{children:(0,i.jsx)(d.Z,{columns:w,gridData:I,rowId:["recordId"],onEdit:e=>{P(null==e?void 0:e.recordId,null==e?void 0:e.name)},onDelete:j,refetch:A,isLoading:!1,pageSize:50,paginationType:"client",maxAccess:C})})]})}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=87156)}),_N_E=e.O()}]);