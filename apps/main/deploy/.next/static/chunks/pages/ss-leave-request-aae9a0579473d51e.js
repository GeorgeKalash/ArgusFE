(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11510],{99901:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ss-leave-request",function(){return a(56047)}])},56047:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return B}});var l=a(52322),s=a(2784),n=a(62202),r=a(69387),d=a(65950),o=a(26612),i=a(71987),u=a(61802),c=a(31389),g=a(33625),p=a(62362),v=a(19473),y=a(37501),m=a(27723),h=a(60218),x=a(80983),q=a(48601),S=a(92407),R=a(39812),E=a(50496),f=a(7121),L=a(5088),I=a(89330),C=a(8661),D=a(91406),P=a(27423),T=a(82737),j=a(85325),V=a(84100);function F(e){var t,a,r,u,g,m;let{recordId:F,labels:A,maxAccess:B}=e,{postRequest:_,getRequest:w}=(0,s.useContext)(d.$),{platformLabels:N}=(0,s.useContext)(v.l),{user:Z}=(0,s.useContext)(j.V),b=null==Z?void 0:Z.employeeId,U=(0,i.E)({endpointId:y.V.SSLeaveRequest.page}),{formik:O}=(0,x.c)({maxAccess:B,initialValues:{recordId:null,startDate:new Date,endDate:null,date:new Date,employeeId:b,justification:"",reference:"",destination:"",ltId:null,isPaid:!1,status:1,leaveBalance:0,multiDayLeave:2,wip:1},validationSchema:q.Ry({date:q.hT().required(),employeeId:q.Rx().required(),ltId:q.Rx().required(),startDate:q.hT().required(),endDate:q.hT().required(),destination:q.Z_().required()}),onSubmit:async e=>{let t={...e,date:(0,R.ku)(e.date),startDate:(0,R.ku)(e.startDate),endDate:(0,R.ku)(e.endDate)},a=await _({extension:y.V.SSLeaveRequest.set,record:JSON.stringify(t)});await H(a.recordId),n.ZP.success(e.recordId?N.Edited:N.Added),U()}}),k=!!O.values.recordId,J=async(e,t,a,l)=>{var s,n,r,d,o;if(!t||!a){O.setFieldValue("leaveBalance",0);return}let i=await w({extension:S.y.Leaves.get,parameters:"_ltId=".concat(a,"&_employeeId=").concat(t)}),u=null==i?void 0:null===(s=i.record)||void 0===s?void 0:s.lsId,c=await w({extension:E.U.Leaves.qry,parameters:"_recordId=".concat(e,"&_employeeId=").concat(t,"&_lsId=").concat(u||0,"&_asOfDate=").concat(l?(0,R.jW)(l):(0,R.jW)(new Date))});O.setFieldValue("leaveBalance",null!==(o=null==c?void 0:null===(d=c.list)||void 0===d?void 0:null===(r=d[0])||void 0===r?void 0:null===(n=r.summary)||void 0===n?void 0:n.balance)&&void 0!==o?o:0)},H=async e=>{var t,a,l;if(!e)return;let s=await w({extension:y.V.SSLeaveRequest.get,parameters:"_employeeId=".concat(b,"&_leaveId=").concat(e)});O.setValues({...s.record,date:(0,R.a1)(s.record.date),startDate:(0,R.a1)(s.record.startDate),endDate:(0,R.a1)(s.record.endDate)}),await J(e,null==s?void 0:null===(t=s.record)||void 0===t?void 0:t.employeeId,null==s?void 0:null===(a=s.record)||void 0===a?void 0:a.ltId,(0,R.a1)(null==s?void 0:null===(l=s.record)||void 0===l?void 0:l.date))};return(0,s.useEffect)(()=>{H(F);let e=async()=>{var e,t,a;if(!b)return;let l=await w({extension:S.y.Employee.get1,parameters:"_recordId=".concat(b)});O.setFieldValue("employeeId",null==l?void 0:null===(e=l.record)||void 0===e?void 0:e.recordId),O.setFieldValue("employeeRef",null==l?void 0:null===(t=l.record)||void 0===t?void 0:t.reference),O.setFieldValue("employeeName",null==l?void 0:null===(a=l.record)||void 0===a?void 0:a.fullName)};F||e()},[]),(0,l.jsx)(T.Z,{resourceId:o.i.SSLeaveRequest,functionId:f.J.LeaveRequest,form:O,maxAccess:B,editMode:k,children:(0,l.jsx)(c.R,{children:(0,l.jsx)(p.Q,{children:(0,l.jsxs)(h.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(L.Z,{name:"reference",label:A.reference,value:null===(t=O.values)||void 0===t?void 0:t.reference,maxAccess:B,readOnly:!0,onChange:O.handleChange,onClear:()=>O.setFieldValue("reference",""),error:O.touched.reference&&!!O.errors.reference})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{name:"date",label:A.date,value:null===(a=O.values)||void 0===a?void 0:a.date,onChange:async(e,t)=>{var a,l;await J(F,null==O?void 0:null===(a=O.values)||void 0===a?void 0:a.employeeId,null==O?void 0:null===(l=O.values)||void 0===l?void 0:l.ltId,t),O.setFieldValue("date",t)},required:!0,onClear:()=>O.setFieldValue("date",null),error:O.touched.date&&!!O.errors.date,maxAccess:B})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(P.U,{endpointId:S.y.Employee.snapshot,parameters:{_branchId:0},form:O,maxAccess:B,valueField:"reference",displayField:"fullName",name:"employeeRef",label:A.employee,required:!0,readOnly:!0,secondValue:O.values.employeeName,onChange:async(e,t)=>{O.setFieldValue("employeeRef",(null==t?void 0:t.reference)||""),O.setFieldValue("employeeName",(null==t?void 0:t.fullName)||""),O.setFieldValue("employeeId",(null==t?void 0:t.recordId)||null)},error:O.touched.employeeId&&!!O.errors.employeeId})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(L.Z,{name:"justification",label:A.justification,value:null===(r=O.values)||void 0===r?void 0:r.justification,maxLength:512,maxAccess:B,onChange:O.handleChange,onClear:()=>O.setFieldValue("justification",""),error:O.touched.justification&&!!O.errors.justification})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{name:"startDate",label:A.startDate,value:null===(u=O.values)||void 0===u?void 0:u.startDate,max:O.values.endDate,required:!0,onChange:O.setFieldValue,onClear:()=>O.setFieldValue("startDate",null),error:O.touched.startDate&&!!O.errors.startDate,maxAccess:B})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{name:"endDate",label:A.endDate,value:null===(g=O.values)||void 0===g?void 0:g.endDate,min:O.values.startDate,required:!0,onChange:O.setFieldValue,onClear:()=>O.setFieldValue("endDate",null),error:O.touched.endDate&&!!O.errors.endDate,maxAccess:B})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{endpointId:E.U.IndemnityAccuralsFilters.qry,name:"ltId",label:A.leaveType,valueField:"recordId",displayField:"name",values:O.values,maxAccess:B,required:!0,onChange:async(e,t)=>{var a;O.setFieldValue("leaveBalance",0),await J(F,null==O?void 0:null===(a=O.values)||void 0===a?void 0:a.employeeId,null==t?void 0:t.recordId,O.values.date),O.setFieldValue("ltId",(null==t?void 0:t.recordId)||null)},error:O.touched.ltId&&!!O.errors.ltId})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(L.Z,{name:"destination",label:A.destination,value:null===(m=O.values)||void 0===m?void 0:m.destination,required:!0,maxLength:50,maxAccess:B,onChange:O.handleChange,onClear:()=>O.setFieldValue("destination",""),error:O.touched.destination&&!!O.errors.destination})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"leaveBalance",label:A.leaveBalance,value:O.values.leaveBalance,readOnly:!0,maxAccess:B,onChange:O.handleChange,onClear:()=>O.setFieldValue("leaveBalance",null),error:O.touched.leaveBalance&&!!O.errors.leaveBalance})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"status",label:A.statusName,datasetId:V.v.DOCUMENT_STATUS,values:O.values,valueField:"key",displayField:"value",readOnly:!0,onChange:(e,t)=>{O.setFieldValue("status",(null==t?void 0:t.key)||null)},error:O.touched.status&&!!O.errors.status,maxAccess:B})})]})})})})}var A=a(96026),B=()=>{let{getRequest:e,postRequest:t}=(0,s.useContext)(d.$),{platformLabels:a}=(0,s.useContext)(v.l),{stack:h}=(0,u.zY)(),{stack:x}=(0,A.V)(),{user:q}=(0,s.useContext)(j.V),S=null==q?void 0:q.employeeId;async function R(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:l=0,_pageSize:s=50,params:n=[]}=t;return S?{...await e({extension:y.V.SSLeaveRequest.page,parameters:"_size=50&_startAt=".concat(l,"&_pageSize=").concat(s,"&_params=").concat(n,"&_employeeId=").concat(null==q?void 0:q.employeeId,"&_sortBy=recordId")}),_startAt:l}:(x({message:a.notConnectedToEmployee}),{list:[],totalCount:0,_startAt:l})}let{query:{data:E},refetch:f,labels:L,access:I,paginationParameters:C,invalidate:D}=(0,i.J)({queryFn:R,endpointId:y.V.SSLeaveRequest.page,datasetId:o.i.SSLeaveRequest}),P=[{field:"startDate",headerName:L.startDate,flex:1,type:"date"},{field:"endDate",headerName:L.endDate,flex:1,type:"date"},{field:"destination",headerName:L.destination,flex:1},{field:"statusName",headerName:L.statusName,flex:1}];async function T(e){S?h({Component:F,props:{recordId:e,labels:L,maxAccess:I},width:800,height:550,title:L.SSLeaveRequest}):x({message:a.notConnectedToEmployee})}let V=async e=>{await t({extension:y.V.SSLeaveRequest.del,record:JSON.stringify(e)}),D(),n.ZP.success(a.Deleted)};return(0,l.jsxs)(c.R,{children:[(0,l.jsx)(g.g,{children:(0,l.jsx)(m.Z,{onAdd:()=>{T()},maxAccess:I})}),(0,l.jsx)(p.Q,{children:(0,l.jsx)(r.Z,{name:"table",columns:P,gridData:E,rowId:["recordId"],onEdit:e=>{T(e.recordId)},onDelete:V,pageSize:50,paginationType:"api",paginationParameters:C,maxAccess:I,refetch:f})})]})}},92407:function(e,t,a){"use strict";a.d(t,{y:function(){return s}});let l="EP.asmx/",s={Employee:{snapshot:l+"snapshotEM",get1:l+"getEM1",set:l+"setEM",del:l+"delEM"},CertificateFilters:{qry:l+"qryCL",get:l+"getCL",set:l+"setCL",del:l+"delCL",page:l+"pageCL"},HRDocTypeFilters:{qry:l+"qryDT"},SalaryChangeReason:{qry:l+"qrySC",get:l+"getSC",set:l+"setSC",del:l+"delSC",page:l+"pageSC"},EmploymentStatusFilters:{qry:l+"qryST",page:l+"pageST",set:l+"setST",get:l+"getST",del:l+"delST"},SponsorFilters:{qry:l+"qrySP",page:l+"pageSP",set:l+"setSP",get:l+"getSP",del:l+"delSP"},RelationshipTypes:{page:l+"pageRT",set:l+"setRT",get:l+"getRT",del:l+"delRT"},BonusTypes:{get:l+"getBT",set:l+"setBT",page:l+"pageBT",del:l+"delBT"},BgCheck:{page:l+"pageCT",set:l+"setCT",get:l+"getCT",del:l+"delCT"},NoticePeriods:{get:l+"getNP",set:l+"setNP",del:l+"delNP",qry:l+"qryNP",page:l+"pageNP"},CustomProperties:{get:l+"getUP",set:l+"setUP",del:l+"delUP",page:l+"pageUP",qry:l+"qryUP"},ResignationRequest:{get:l+"getRR",set:l+"setRR",del:l+"delRR",page:l+"pageRR",close:l+"closeRR",reopen:l+"reopenRR"},TerminationReasons:{qry:l+"qryTR",get:l+"getTR",set:l+"setTR",del:l+"delTR",page:l+"pageTR"},JobInfo:{snapshot:l+"snapshotJI",page:l+"pageJI",close:l+"closeJI",reopen:l+"reopenJI",get:l+"getJI",set:l+"setJI",del:l+"delJI",qry:l+"qryJI"},QuickView:{get:l+"getQV"},EmployeePenalty:{page:l+"pagePE",close:l+"closePE",reopen:l+"reopenPE",get:l+"getPE",set:l+"setPE",del:l+"delPE"},EmployeeDeduction:{qry:l+"qryED",page:l+"pageED",del:l+"delED",get:l+"getED",set:l+"setED",snapshot:l+"snapshotED"},FullName:{sync:l+"syncFullName"},EmployeeChart:{page:l+"pageES",qry:l+"qryES",qry2:l+"qryES2"},EmployeeSalary:{qry:l+"qrySA",get:l+"getSA",set:l+"setSA",del:l+"delSA"},SalaryDetails:{qry:l+"qrySD",get:l+"getSD",set2:l+"set2SD",del:l+"delSD"},TerminationEmployee:{get:l+"getTE"},EmployementHistory:{qry:l+"qryEH",del:l+"delEH",get:l+"getEH",set:l+"setEH"},Hiring:{get:l+"getRE",set:l+"setRE"},Skills:{qry:l+"qryCE",del:l+"delCE",get:l+"getCE",set:l+"setCE"},UserDefined:{qry:l+"qryUV",set2:l+"set2UV"},Leaves:{set:l+"setLS",del:l+"delLS",get:l+"getLS"}}},50496:function(e,t,a){"use strict";a.d(t,{U:function(){return s}});let l="LM.asmx/",s={IndemnityAccuralsFilters:{qry:l+"qryLT"},LeaveScheduleFilters:{qry:l+"qryLS",page:l+"pageLS",set:l+"setLS",get:l+"getLS",del:l+"delLS"},OpeningBalances:{page:l+"pageOBA",set:l+"setOBA",get:l+"getOBA",del:l+"delOBA",qry:l+"qryOBA"},BalanceAdjustment:{page:l+"pageBA",set:l+"setBA",get:l+"getBA",del:l+"delBA",snapshot:l+"snapshotBA"},EarnedLeave:{page:l+"pageEL",set2:l+"set2EL",get2:l+"get2EL",del:l+"delEL",preview:l+"previewEL",post:l+"postEL"},LeavePeriod:{qry:l+"qryLP",del:l+"delLP",get:l+"getLP",set:l+"setLP"},LeaveRequest:{page:l+"pageLR",qry:l+"qryLR",set:l+"setLR",get:l+"getLR",del:l+"delLR",snapshot:l+"snapshotLR",close:l+"closeLR",reopen:l+"reopenLR",set2:l+"set2LR",get2:l+"get2LR"},LeaveReturn:{page:l+"pageRE",set:l+"setRE",get:l+"getRE",del:l+"delRE",snapshot:l+"snapshotRE",close:l+"closeRE",reopen:l+"reopenRE"},PreviewDays:{preview:l+"previewLD"},Leaves:{qry:l+"qryELB"}}},37501:function(e,t,a){"use strict";a.d(t,{V:function(){return s}});let l="SS.asmx/",s={SSUserInfo:{set:l+"setUS",get:l+"getUS"},SSLeaveRequest:{set:l+"setLR",get:l+"getLR",page:l+"pageLR",del:l+"delLR"}}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=99901)}),_N_E=e.O()}]);