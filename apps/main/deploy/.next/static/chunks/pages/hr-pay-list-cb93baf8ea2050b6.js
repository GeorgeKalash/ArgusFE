(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90340],{54427:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/hr-pay-list",function(){return t(54807)}])},54807:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return g}});var l=t(52322),r=t(83562),n=t(26612),d=t(7121),s=t(98345),i=t(71987),o=t(19473),u=t(65950),c=t(61802),y=t(2784),v=t(62202),D=t(21379),p=t(31389),m=t(33625),f=t(36908),x=t(62362),h=t(69387),g=()=>{let{postRequest:e,getRequest:a}=(0,y.useContext)(u.$),{platformLabels:t}=(0,y.useContext)(o.l),{stack:g}=(0,c.zY)(),{query:{data:I},filterBy:k,refetch:F,labels:S,access:P,paginationParameters:w,invalidate:C}=(0,i.J)({queryFn:Z,endpointId:r.m.Payroll.page,datasetId:n.i.PayrollHeader,filter:{filterFn:E}}),b=[{field:"reference",headerName:S.reference,flex:1},{field:"date",headerName:S.date,flex:1,type:"date"},{field:"fiscalYear",headerName:S.fiscalYear,flex:1},{field:"payDate",headerName:S.payDate,flex:1,type:"date"},{field:"payDescription",headerName:S.payDescription,flex:1},{field:"startDate",headerName:S.startDate,flex:1,type:"date"},{field:"endDate",headerName:S.endDate,flex:1,type:"date"},{field:"taStartDate",headerName:S.taStartDate,flex:1,type:"date"},{field:"taEndDate",headerName:S.taEndDate,flex:1,type:"date"},{field:"notes",headerName:S.notes,flex:1},{field:"statusName",headerName:S.status,flex:1}];async function Z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:l=50,params:n=[]}=e;return{...await a({extension:r.m.Payroll.page,parameters:"_startAt=".concat(t,"&_pageSize=").concat(l,"&_params=").concat(n,"&filter=")}),_startAt:t}}async function E(e){let{filters:t,pagination:l}=e;return t.qry?await a({extension:r.m.Payroll.snapshot,parameters:"_filter=".concat(t.qry)}):Z({_startAt:l._startAt||0,params:null==t?void 0:t.params})}let{proxyAction:j}=(0,s.G)({functionId:d.J.PayrollList,action:_}),T=async()=>{await j()};async function _(e){g({Component:D.Z,props:{recordId:e}})}let N=async a=>{await e({extension:r.m.Payroll.del,record:JSON.stringify(a)}),C(),v.ZP.success(t.Deleted)};return(0,l.jsxs)(p.R,{children:[(0,l.jsx)(m.g,{children:(0,l.jsx)(f.Z,{onAdd:T,maxAccess:P,filterBy:k,reportName:"PYHE"})}),(0,l.jsx)(x.Q,{children:(0,l.jsx)(h.Z,{name:"table",columns:b,gridData:I,rowId:["recordId"],onEdit:e=>{_(null==e?void 0:e.recordId)},refetch:F,onDelete:N,deleteConfirmationType:"strict",pageSize:50,maxAccess:P,paginationParameters:w,paginationType:"api"})})]})}},1685:function(e,a,t){"use strict";t.d(a,{m:function(){return l}});let l=e=>{let a=window.sessionStorage.getItem(e);return a?JSON.parse(a):null}},98345:function(e,a,t){"use strict";t.d(a,{H:function(){return p},G:function(){return D}});var l=t(45300),r=t(2784),n=t(96026),d=t(38449);t(26612);var s=t(65947),i=t(1685);let o=async(e,a,t)=>{try{let l=await e({extension:a,parameters:t});return a.includes("qry")?l:l.record}catch(e){return null}},u=(e,a,t,l)=>{let r=(e=JSON.parse(JSON.stringify(e))).record.controls,n=r.find(e=>"reference"===e.controlId);return n?n.accessLevel=(null==a?void 0:a.mandatory)?s.$7:s.rr:(null==a?void 0:a.mandatory)?r.push({sgId:0,resourceId:"",controlId:"".concat(l?l+".":"","reference"),accessLevel:(null==a?void 0:a.mandatory)?s.$7:s.rr}):(null==a?void 0:a.readOnly)?r.push({sgId:0,resourceId:"",controlId:"".concat(l?l+".":"","reference"),accessLevel:(null==a?void 0:a.readOnly)?s.rr:s.$7}):r=e.record.controls.filter(e=>"reference"!=e.controlId),t&&r.push({sgId:0,resourceId:"",controlId:"".concat(l?l+".":"","dtId"),accessLevel:s.$7}),{...e,record:{...e.record,controls:r}}},c=async(e,a,t)=>{let l,r;switch(t){case"dtId":let n=(0,i.m)("userData"),s=null==n?void 0:n.userId;r="_userId=".concat(s,"&_functionId=").concat(a),l=d.r.UserFunction.get;break;case"glbSysNumberRange":r="_recordId=".concat(a),l=d.r.SystemFunction.get;break;case"DocumentType":r="_dgId=".concat(a,"&_startAt=",0,"&_pageSize=",50),l=d.r.DocumentType.qry;break;case"DcTypNumberRange":r="_recordId=".concat(a),l=d.r.DocumentType.get;break;case"isExternal":r="_recordId=".concat(a),l=d.r.NumberRange.get;break;default:return null}return await o(e,l,r)},y=async function(e){let a,t,l,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,d=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4],o=arguments.length>5?arguments[5]:void 0,y=void 0===s&&n&&await c(e,n,"dtId"),v=null==y?void 0:y.dtId,D="",p=!0;if(y&&void 0===s||"nraId"===s){if(v){let t=await c(e,v,"DcTypNumberRange");a=null==t?void 0:t.nraId,p=!((null==t?void 0:t.activeStatus)<0),a||(D="Assign the document type to a number range")}if((!v||!p)&&i&&n){var m;let a=await c(e,n,"DocumentType");r=(null==a?void 0:null===(m=a.list)||void 0===m?void 0:m.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===s||void 0===s)&&n){if((!v||v)&&!a||a&&!p){let t=await c(e,n,"glbSysNumberRange");(a=null==t?void 0:t.nraId)&&r&&(r=!1),p=!0}D=a||r?"":"Assign the system Function to a number range"}s>0&&!a&&(a=s),a&&p?(t={readOnly:null==(l=await c(e,a,"isExternal"))||!l.external,mandatory:null!=l&&!!l.external},d&&(d=await u(d,t,r,o))):!a&&d&&(d=await u(d,t,r,o));let f=o?"".concat(o,".reference"):"reference";return{dtId:v,resetReference:null==t?void 0:t.readOnly,dcTypeRequired:r,reference:{fieldName:f,isEmpty:(null==l?void 0:l.external)!==void 0&&(null==l||!l.external)},errorMessage:D,maxAccess:d,selectNraId:s}};var v=t(65950);function D(e){let{functionId:a,action:t,hasDT:l}=e,{getRequest:d}=(0,r.useContext)(v.$),{stack:s}=(0,n.V)();return{proxyAction:async()=>{let e=await y(d,a,"",void 0,l);(null==e?void 0:e.errorMessage)?s({message:null==e?void 0:e.errorMessage}):await t()}}}function p(e){var a;let{functionId:t,access:d,hasDT:s,enabled:i=!0,objectName:o=""}=e,{getRequest:u}=(0,r.useContext)(v.$),{stack:c}=(0,n.V)(),[D,p]=(0,r.useState)(),m=async e=>{let a=await y(u,t,d,e,s,o);if(!a.errorMessage)return a;c({message:null==a?void 0:a.errorMessage})},f=(0,l.a)({retry:!1,staleTime:0,enabled:i,queryKey:[t,D,!!d,i],queryFn:D||"nraId"===D?()=>m(D):()=>m()});return{documentType:f.data,maxAccess:(null==f?void 0:null===(a=f.data)||void 0===a?void 0:a.maxAccess)||d,changeDT(e){p((null==e?void 0:e.nraId)||"nraId")}}}},21379:function(e,a,t){"use strict";t.d(a,{Z:function(){return Z}});var l=t(52322),r=t(60218),n=t(2784),d=t(48601),s=t(62202),i=t(39812),o=t(65950),u=t(19473),c=t(71987),y=t(83562),v=t(7121),D=t(98345),p=t(80983),m=t(26612),f=t(82737),x=t(31389),h=t(62362),g=t(8661),I=t(38449),k=t(5088),F=t(89330),S=t(84100),P=t(91406),w=t(21581),C=t(50023),b=t(21326);function Z(e){var a,t,Z,E,j,T,_,N,V,A,O;let{recordId:q,window:Y}=e,{getRequest:L,postRequest:R}=(0,n.useContext)(o.$),{platformLabels:J,defaultsData:M}=(0,n.useContext)(u.l),$=parseInt(null==M?void 0:null===(t=M.list)||void 0===t?void 0:null===(a=t.find(e=>{let{key:a}=e;return"pytvStartDate"===a}))||void 0===a?void 0:a.value)||null,H=parseInt(null==M?void 0:null===(E=M.list)||void 0===E?void 0:null===(Z=E.find(e=>{let{key:a}=e;return"pytvEndDate"===a}))||void 0===Z?void 0:Z.value)||null,z=(0,c.E)({endpointId:y.m.Payroll.page}),{labels:G,access:U}=(0,C.Z)({datasetId:m.i.PayrollHeader,editMode:!!q});(0,b.Z)({title:G.payrollList,window:Y});let{documentType:Q,maxAccess:X,changeDT:B}=(0,D.H)({functionId:v.J.PayrollList,access:U,enabled:!q}),{formik:K}=(0,p.c)({maxAccess:X,documentType:{key:"dtId",value:null==Q?void 0:Q.dtId,reference:null==Q?void 0:Q.reference},initialValues:{recordId:null,dtId:null,reference:"",fiscalYear:null,salaryType:5,date:new Date,payDate:null,startDate:null,endDate:null,taStartDate:null,taEndDate:null,calendarDays:null,periodId:null,notes:"",status:1},validationSchema:d.Ry({periodId:d.Rx().required(),date:d.hT().required(),payDate:d.hT().required(),startDate:d.hT().required(),endDate:d.hT().required(),fiscalYear:d.Rx().required()}),onSubmit:async e=>{await R({extension:y.m.Payroll.set,record:JSON.stringify(e)}),s.ZP.success(e.recordId?J.Edited:J.Added),z(),Y.close()}}),W=!!K.values.recordId,ee=2==K.values.wip,ea=3===K.values.status,et=async e=>{if(e){let a=await L({extension:y.m.Payroll.get,parameters:"_recordId=".concat(e)});K.setValues({...a.record,date:(0,i.a1)(a.record.date),payDate:(0,i.a1)(a.record.payDate),startDate:(0,i.a1)(a.record.startDate),endDate:(0,i.a1)(a.record.endDate),taStartDate:(0,i.a1)(a.record.taStartDate),taEndDate:(0,i.a1)(a.record.taEndDate)})}};(0,n.useEffect)(()=>{et(q)},[]);let el=async()=>{let e=await R({extension:y.m.Payroll.close,record:JSON.stringify({...K.values,date:(0,i.ku)(K.values.date),payDate:(0,i.ku)(K.values.payDate),startDate:(0,i.ku)(K.values.startDate),endDate:(0,i.ku)(K.values.endDate),taStartDate:(0,i.ku)(K.values.taStartDate),taEndDate:(0,i.ku)(K.values.taEndDate)})});s.ZP.success(J.Closed),et(null==e?void 0:e.recordId),z()},er=async()=>{await R({extension:y.m.Payroll.post,record:JSON.stringify({...K.values,date:(0,i.ku)(K.values.date),payDate:(0,i.ku)(K.values.payDate),startDate:(0,i.ku)(K.values.startDate),endDate:(0,i.ku)(K.values.endDate),taStartDate:(0,i.ku)(K.values.taStartDate),taEndDate:(0,i.ku)(K.values.taEndDate)})}),s.ZP.success(J.Posted),et(q),z()},en=async()=>{let e=await R({extension:y.m.Payroll.unpost,record:JSON.stringify({...K.values,date:(0,i.ku)(K.values.date),payDate:(0,i.ku)(K.values.payDate),startDate:(0,i.ku)(K.values.startDate),endDate:(0,i.ku)(K.values.endDate),taStartDate:(0,i.ku)(K.values.taStartDate),taEndDate:(0,i.ku)(K.values.taEndDate)})});s.ZP.success(J.Unposted),et(null==e?void 0:e.recordId),z()},ed=async()=>{let e=await R({extension:y.m.Payroll.reopen,record:JSON.stringify({...K.values,date:(0,i.ku)(K.values.date),payDate:(0,i.ku)(K.values.payDate),startDate:(0,i.ku)(K.values.startDate),endDate:(0,i.ku)(K.values.endDate),taStartDate:(0,i.ku)(K.values.taStartDate),taEndDate:(0,i.ku)(K.values.taEndDate)})});s.ZP.success(J.Reopened),et(null==e?void 0:e.recordId),z()},es=[{key:"GL",condition:!0,onClick:"onClickGL",datasetId:m.i.GLPayrollList,disabled:!W},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!ee},{key:"Close",condition:!ee,onClick:el,disabled:ee||!W},{key:"Reopen",condition:ee,onClick:ed,disabled:!ee||ea},{key:"Unlocked",condition:!ea,onClick:er,disabled:!W||!ee},{key:"Locked",condition:ea,onClick:"onUnpostConfirmation",onSuccess:en,disabled:!W||!ee}],ei=(e,a,t,l)=>{if(!e||!a)return{};let r=new Date(e),n=new Date(a),d=new Date(n.getFullYear(),n.getMonth(),l),s=r.getMonth(),i=r.getFullYear();return t>r.getDate()&&(s-=1)<0&&(s=11,i-=1),{taStartDate:new Date(i,s,t),taEndDate:d}};return(0,l.jsx)(f.Z,{resourceId:m.i.PayrollHeader,form:K,maxAccess:X,editMode:W,actions:es,functionId:v.J.PayrollList,disabledSubmit:ee,children:(0,l.jsx)(x.R,{children:(0,l.jsx)(h.Q,{children:(0,l.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{endpointId:I.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(v.J.PayrollList),name:"dtId",label:G.docType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:W,valueField:"recordId",displayField:["reference","name"],values:K.values,maxAccess:X,onChange:async(e,a)=>{await B(a),K.setFieldValue("dtId",(null==a?void 0:a.recordId)||null)},error:K.touched.dtId&&!!K.errors.dtId})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(k.Z,{name:"reference",label:G.reference,value:null==K?void 0:null===(j=K.values)||void 0===j?void 0:j.reference,maxAccess:!W&&X,readOnly:W,onChange:K.handleChange,onClear:()=>K.setFieldValue("reference",""),error:K.touched.reference&&!!K.errors.reference})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(F.Z,{name:"date",required:!0,label:G.date,value:null==K?void 0:null===(T=K.values)||void 0===T?void 0:T.date,maxAccess:X,readOnly:ee,onChange:K.setFieldValue,onClear:()=>K.setFieldValue("date",null),error:K.touched.date&&!!K.errors.date})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{endpointId:y.m.FiscalYear.qry,name:"fiscalYear",label:G.fiscalYear,valueField:"fiscalYear",displayField:"fiscalYear",values:K.values,readOnly:ee,required:!0,maxAccess:X,onChange:(e,a)=>{K.setFieldValue("fiscalYear",(null==a?void 0:a.fiscalYear)||null)},error:K.touched.fiscalYear&&!!K.errors.fiscalYear})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{datasetId:S.v.SALARY_TYPE,name:"salaryType",label:G.salaryType,valueField:"key",displayField:"value",values:K.values,maxAccess:X,readOnly:!0,onChange:(e,a)=>K.setFieldValue("salaryType",(null==a?void 0:a.key)||null),error:K.touched.salaryType&&!!K.errors.salaryType})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{endpointId:y.m.Period.qry,parameters:K.values.fiscalYear&&K.values.salaryType&&"_year=".concat(K.values.fiscalYear,"&_salaryType=").concat(K.values.salaryType,"&_status=0"),name:"periodId",label:G.period,valueField:"periodId",required:!0,displayField:"periodName",values:K.values,readOnly:ee,maxAccess:X,onChange:(e,a)=>K.setFieldValue("periodId",(null==a?void 0:a.periodId)||null),error:K.touched.periodId&&!!K.errors.periodId})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(F.Z,{name:"payDate",required:!0,label:G.payDate,value:null==K?void 0:null===(_=K.values)||void 0===_?void 0:_.payDate,maxAccess:X,readOnly:ee,onChange:(e,a)=>{if(a&&5===K.values.salaryType){let e=new Date(a),t=new Date(e.getFullYear(),e.getMonth(),1),l=new Date(e.getFullYear(),e.getMonth()+1,0),r=l.getTime()-t.getTime();if(K.setFieldValue("calendarDays",r/864e5+1),K.setFieldValue("startDate",t),K.setFieldValue("endDate",l),K.setFieldTouched("startDate",!1,!1),K.setFieldTouched("endDate",!1,!1),$&&H){let{taStartDate:e,taEndDate:a}=ei(t,l,$,H);K.setFieldValue("taStartDate",e),K.setFieldValue("taEndDate",a)}}K.setFieldValue("payDate",a)},onClear:()=>{K.setFieldValue("payDate",null),K.setFieldValue("calendarDays",""),K.setFieldValue("startDate",null),K.setFieldValue("endDate",null),K.setFieldValue("taStartDate",null),K.setFieldValue("taEndDate",null)},error:K.touched.payDate&&!!K.errors.payDate})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(F.Z,{name:"startDate",label:G.startDate,value:null==K?void 0:null===(N=K.values)||void 0===N?void 0:N.startDate,maxAccess:X,readOnly:!0,required:!0,onChange:K.setFieldValue,onClear:()=>K.setFieldValue("startDate",null),error:K.touched.startDate&&!!K.errors.startDate})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(F.Z,{name:"endDate",label:G.endDate,value:null==K?void 0:null===(V=K.values)||void 0===V?void 0:V.endDate,onChange:K.setFieldValue,maxAccess:X,readOnly:!0,required:!0,onClear:()=>K.setFieldValue("endDate",null),error:K.touched.endDate&&!!K.errors.endDate})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(F.Z,{name:"taStartDate",label:G.taStartDate,value:null==K?void 0:null===(A=K.values)||void 0===A?void 0:A.taStartDate,onChange:K.setFieldValue,maxAccess:X,readOnly:!0,onClear:()=>K.setFieldValue("taStartDate",null),error:K.touched.taStartDate&&!!K.errors.taStartDate})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(F.Z,{name:"taEndDate",label:G.taEndDate,value:null==K?void 0:null===(O=K.values)||void 0===O?void 0:O.taEndDate,onChange:K.setFieldValue,maxAccess:X,readOnly:!0,onClear:()=>K.setFieldValue("taEndDate",null),error:K.touched.taEndDate&&!!K.errors.taEndDate})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(P.Z,{name:"calendarDays",label:G.calendarDays,value:K.values.calendarDays,onChange:K.handleChange,onClear:()=>K.setFieldValue("calendarDays",""),readOnly:!0,maxAccess:X,error:K.touched.calendarDays&&!!K.errors.calendarDays})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(w.Z,{name:"notes",label:G.notes,value:K.values.notes,maxAccess:X,readOnly:ee,rows:3,maxLength:"128",onChange:e=>K.setFieldValue("notes",e.target.value),onClear:()=>K.setFieldValue("notes",""),error:K.touched.notes&&!!K.errors.notes})})]})})})})}Z.width=850,Z.height=700}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=54427)}),_N_E=e.O()}]);