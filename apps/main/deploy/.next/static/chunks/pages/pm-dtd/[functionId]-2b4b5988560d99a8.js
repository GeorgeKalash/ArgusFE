(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53379],{75568:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pm-dtd/[functionId]",function(){return n(39185)}])},39185:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return J}});var r=n(52322),a=n(2784),d=n(62202),i=n(69387),c=n(65950),s=n(71987),u=n(26612),o=n(31389),l=n(33625),p=n(62362),D=n(61802),m=n(19473),f=n(7121),h=n(63165),I=n(63518),y=n(60218),x=n(48601),T=n(82737),g=n(8661),_=n(38449),v=n(80983),P=n(90587);function w(e){let{labels:t,maxAccess:n,recordId:i,functionId:l,resourceId:D,window:f}=e,{getRequest:h,postRequest:w}=(0,a.useContext)(c.$),{platformLabels:A}=(0,a.useContext)(m.l),J=(0,s.E)({endpointId:I.z.DocumentTypeDefault.page}),{formik:M}=(0,v.c)({initialValues:{recordId:i,dtId:null,productionLineId:null},maxAccess:n,validateOnChange:!0,validationSchema:x.Ry({dtId:x.Rx().required(),productionLineId:x.Rx().required()}),onSubmit:async e=>{await w({extension:I.z.DocumentTypeDefault.set,record:JSON.stringify(e)}),i||M.setFieldValue("recordId",e.dtId),d.ZP.success(e.recordId?A.Edited:A.Added),J(),f.close()}}),k=!!M.values.recordId;return(0,a.useEffect)(()=>{!async function(){if(i){let e=await h({extension:I.z.DocumentTypeDefault.get,parameters:"_dtId=".concat(i)});M.setValues({...e.record,recordId:i})}}()},[]),(0,r.jsx)(T.Z,{resourceId:u.i.ProductModelingDTD,form:M,maxAccess:n,editMode:k,children:(0,r.jsx)(o.R,{children:(0,r.jsx)(p.Q,{children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(g.Z,{endpointId:_.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(l),name:"dtId",required:!0,label:t.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],readOnly:k,values:M.values,maxAccess:n,onChange:(e,t)=>{M.setFieldValue("dtId",(null==t?void 0:t.recordId)||null)},error:M.touched.dtId&&!!M.errors.dtId})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(g.Z,{endpointId:P.u.ProductionLine.qry,parameters:"_startAt=0&_pageSize=1000",values:M.values,name:"productionLineId",label:t.productionLine,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,maxAccess:n,onChange:(e,t)=>{M.setFieldValue("productionLineId",(null==t?void 0:t.recordId)||null)},error:M.touched.productionLineId&&M.errors.productionLineId})})]})})})})}var A=n(36908),J=()=>{let{getRequest:e,postRequest:t}=(0,a.useContext)(c.$),{platformLabels:n}=(0,a.useContext)(m.l),{stack:y}=(0,D.zY)(),{functionId:x}=(0,h.F)();async function T(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0,_pageSize:r=50,params:a}=t;return{...await e({extension:I.z.DocumentTypeDefault.page,parameters:"_startAt=".concat(n,"&_pageSize=").concat(r,"&_functionId=").concat(x,"&_params=").concat(a||"")}),_startAt:n}}let g=e=>{switch(e){case f.J.Sketch:return u.i.SketchDTD;case f.J.ThreeDDesign:return u.i.ThreeDDrawingDTD;case f.J.ModellingCasting:return u.i.CastingDTD;case f.J.Rubber:return u.i.RubberDTD;case f.J.ModelMaker:return u.i.ModelDTD;case f.J.ThreeDPrint:return u.i.ThreePrintingDTD}},{query:{data:_},labels:v,refetch:P,filterBy:J,invalidate:M,paginationParameters:k,access:N}=(0,s.J)({queryFn:T,endpointId:I.z.DocumentTypeDefault.page,datasetId:u.i.SketchDTD,DatasetIdAccess:g(parseInt(x)),filter:{filterFn:S,default:{functionId:x}}});async function S(e){let{filters:t,pagination:n}=e;return T({_startAt:n._startAt||0,params:null==t?void 0:t.params})}let b=[{field:"dtName",headerName:v.documentType,flex:1},{field:"productionLineName",headerName:v.productionLine,flex:1}],j=g(parseInt(x));function C(e){y({Component:w,props:{labels:v,recordId:null==e?void 0:e.dtId,maxAccess:N,resourceId:j,functionId:x},width:500,height:380,title:v.DocumentTypeDefault})}let F=async()=>{C()},z=async e=>{await t({extension:I.z.DocumentTypeDefault.del,record:JSON.stringify(e)}),M(),d.ZP.success(n.Deleted)};return(0,r.jsxs)(o.R,{children:[(0,r.jsx)(l.g,{children:(0,r.jsx)(A.Z,{onAdd:F,hasSearch:!1,maxAccess:N,reportName:(e=>{switch(e){case f.J.Sketch:return"PMDTDa";case f.J.ThreeDDesign:return"PMDTDb";case f.J.Rubber:return"PMDTDc";case f.J.ModelMaker:return"PMDTDd";case f.J.ModellingCasting:return"PMDTDe";case f.J.ThreeDPrint:return"PMDTDf"}})(parseInt(x)),filterBy:J})}),(0,r.jsx)(p.Q,{children:(0,r.jsx)(i.Z,{name:"table",columns:b,gridData:_,rowId:["dtId"],onEdit:e=>{C(e)},onDelete:z,isLoading:!1,pageSize:50,paginationParameters:k,refetch:P,paginationType:"api",maxAccess:N})})]})}},63165:function(e,t,n){"use strict";n.d(t,{F:function(){return d}});var r=n(5632),a=n(2784);let d=()=>{let e=(0,r.useRouter)(),[t,n]=(0,a.useState)(e.query);return t}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=75568)}),_N_E=e.O()}]);