(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[27011],{97490:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/hr-pay-details",function(){return t(90343)}])},90343:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return D}});var l=t(52322),n=t(2784),s=t(31389),r=t(33625),i=t(62362),o=t(69387),d=t(65950),c=t(61802),u=t(71987),m=t(83562),p=t(26612),f=t(29326),b=t(9522),v=t(92407),h=t(67920),y=t(84100),x=t(80983),_=t(19473),N=t(76399),I=t(54074),C=t(62202),T=t(48601);function j(e){let{labels:a,maxAccess:t,store:r,setStore:o}=e,{postRequest:c,getRequest:u}=(0,n.useContext)(d.$),{platformLabels:p}=(0,n.useContext)(_.l),{recordId:f,seqNo:b}=r,{schema:j,requiredFields:g}=(0,h.m)({amount:e=>null==e?void 0:e.amount,edId:e=>null==e?void 0:e.edId,type:e=>null==e?void 0:e.type},!0,t,"items"),{formik:P}=(0,x.c)({maxAccess:t,initialValues:{recordId:f||null,items:[{id:1,payId:f,seqNo:"",edSeqNo:null,edId:null,itemId:null,type:null,amount:null,masterId:null}]},validationSchema:T.Ry({items:T.IX().of(j)}),conditionSchema:["items"],onSubmit:async e=>{var a;let t=null==e?void 0:null===(a=e.items)||void 0===a?void 0:a.filter(e=>{var a;return null===(a=Object.values(g))||void 0===a?void 0:a.every(a=>a(e))}).map((e,a)=>({...e,id:a+1,payId:f,seqNo:b}));await c({extension:m.m.PayrollDetails.set2,record:JSON.stringify({payId:f,seqNo:b,items:t})}),o({recordId:f,seqNo:b}),C.ZP.success(p.Edited)}}),A=!!P.values.recordId,D=[{component:"resourcecombobox",label:a.type,name:"type",props:{datasetId:y.v.ENTITLEMENT_DEDUCTION_TYPE,displayField:"value",valueField:"key",mapping:[{from:"value",to:"typeName"},{from:"key",to:"type"}]}},{component:"resourcelookup",label:a.entitlementDeduction,name:"edId",width:150,props:{valueField:"reference",displayField:"name",displayFieldWidth:2,minChars:1,endpointId:v.y.EmployeeDeduction.qry,mapping:[{from:"recordId",to:"edId"},{from:"name",to:"edName"},{from:"reference",to:"edRef"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}]}},{component:"numberfield",label:a.amount,name:"amount",props:{maxLength:8,decimals:2}}];return(0,n.useEffect)(()=>{!async function(){if(f){var e;let a=await u({extension:m.m.PayrollDetails.qry,parameters:"_payId=".concat(f,"&_seqNo=").concat(b)});P.setValues({items:null==a?void 0:null===(e=a.list)||void 0===e?void 0:e.map((e,a)=>({id:a+1,...e})),recordId:f})}}()},[]),(0,l.jsx)(I.Z,{onSave:P.handleSubmit,maxAccess:t,editMode:A,isParentWindow:!1,children:(0,l.jsx)(s.R,{children:(0,l.jsx)(i.Q,{children:(0,l.jsx)(N._,{onChange:e=>P.setFieldValue("items",e),value:P.values.items,error:P.errors.items,columns:D,name:"items",maxAccess:t})})})})}var g=e=>{let{labels:a,maxAccess:t,store:r}=e,{getRequest:c}=(0,n.useContext)(d.$),{recordId:f,seqNo:b}=r,v=[{field:"payCode",headerName:a.payCode,flex:1},{field:"pcName",headerName:a.payCodeName,flex:1},{field:"ePct",headerName:a.percentage,flex:1},{field:"essAmount",headerName:a.ess,flex:1},{field:"cPct",headerName:a.percentage,flex:1},{field:"cssAmount",headerName:a.css,flex:1}];async function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:t=50}=e;return{...await c({extension:m.m.SocialSecurity.qry,parameters:"_startAt=".concat(a,"&_pageSize=").concat(t,"&_payId=").concat(f,"&_seqNo=").concat(b)}),_startAt:a}}let{query:{data:y}}=(0,u.J)({enabled:!!f,queryFn:h,endpointId:m.m.SocialSecurity.qry,datasetId:p.i.PayrollDetail,params:{disabledReqParams:!0,maxAccess:t}});return(0,l.jsx)(s.R,{children:(0,l.jsx)(i.Q,{children:(0,l.jsx)(o.Z,{name:"socialSecurity",columns:v,gridData:y,rowId:["recordId"],maxAccess:t,pagination:!1})})})},P=e=>{let{seqNo:a,recordId:t,labels:s,maxAccess:r}=e,[i,o]=(0,n.useState)(0),[d,c]=(0,n.useState)({recordId:t||null,seqNo:a}),u=[{label:s.PayrollDetails},{label:s.SocialSecurity,disabled:!d.recordId}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.Y,{tabs:u,activeTab:i,setActiveTab:o,maxAccess:r}),(0,l.jsx)(f.Z,{index:0,value:i,maxAccess:r,children:(0,l.jsx)(j,{labels:s,store:d,setStore:c,maxAccess:r})}),(0,l.jsx)(f.Z,{index:1,value:i,maxAccess:r,children:(0,l.jsx)(g,{labels:s,maxAccess:r,store:d})})]})},A=t(36908),D=()=>{let{getRequest:e}=(0,n.useContext)(d.$),{stack:a}=(0,c.zY)();async function t(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:l=50,params:n}=a;return{...await e({extension:m.m.GeneratePayroll.page,parameters:"_startAt=".concat(t,"&_pageSize=").concat(l,"&_params=").concat(n||"","&_sortBy=recordId desc")}),_startAt:t}}async function f(e){let{filters:a,pagination:l}=e;return t({_startAt:l._startAt||0,params:null==a?void 0:a.params})}let{query:{data:b},labels:v,filterBy:h,paginationParameters:y,refetch:x,access:_}=(0,u.J)({queryFn:t,endpointId:m.m.GeneratePayroll.page,datasetId:p.i.PayrollDetail,filter:{filterFn:f}}),N=[{field:"asOfDate",headerName:v.asOfDate,flex:1},{field:"employeeRef",headerName:v.reference,flex:1},{field:"employeeName",headerName:v.employee,flex:1},{field:"branchName",headerName:v.branch,flex:1},{field:"departmentName",headerName:v.department,flex:1},{field:"paymentMethodName",headerName:v.payment,flex:1},{field:"calendarDays",headerName:v.calendarDays,flex:1,type:"number"},{field:"workingDays",headerName:v.days,flex:1,type:"number"},{field:"eAmount",headerName:v.entitlements,flex:1,type:"number"},{field:"dAmount",headerName:v.deduction,flex:1,type:"number"},{field:"netSalary",headerName:v.net,flex:1,type:"number"},{field:"cssAmount",headerName:v.css,flex:1,type:"number"}];async function I(e){a({Component:P,props:{labels:v,recordId:null==e?void 0:e.payId,seqNo:null==e?void 0:e.seqNo,maxAccess:_},width:700,height:500,title:v.PayrollDetails})}return(0,l.jsxs)(s.R,{children:[(0,l.jsx)(r.g,{children:(0,l.jsx)(A.Z,{maxAccess:_,reportName:"PYEM",filterBy:h,hasSearch:!1})}),(0,l.jsx)(i.Q,{children:(0,l.jsx)(o.Z,{name:"table",columns:N,gridData:b,rowId:["recordId"],onEdit:e=>{I(e)},deleteConfirmationType:"strict",pageSize:50,paginationType:"api",paginationParameters:y,refetch:x,maxAccess:_})})]})}},67920:function(e,a,t){"use strict";t.d(a,{m:function(){return n}});var l=t(48601);function n(e,a,t){var n;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",r={...e};return null==t||null===(n=t.record)||void 0===n||n.controls.forEach(e=>{let{controlId:a,accessLevel:t}=e,[l,n]=null==a?void 0:a.split(".");l!==s||2!==t||n in r||(r[n]=e=>(null==e?void 0:e[n])!=null),(1===t||4===t)&&n in r&&delete r[n]}),{schema:l.Ry().shape({...Object.keys(r).reduce((e,t)=>(e[t]=l.nK().nullable().test(function(e){var l;let n=this.parent,[,s]=this.path.match(/^(\w+)\[(\d+)\]/)||[],i=(null===(l=this.options.context)||void 0===l?void 0:l[s])||[];if(a||!a&&i.length>1){if(null!==n[t]&&void 0!==n[t]&&0!==n[t]&&""!==r[t]&&!r[t](n))return!1;if(!Object.entries(r).some(e=>{let[,a]=e;return!!a(n)}))return!0}return!!r[t](n)&&void 0!==e}),e),{})}),requiredFields:r}}},29326:function(e,a,t){"use strict";var l=t(52322);t(2784);var n=t(23925),s=t(13980),r=t.n(s),i=t(95291),o=t.n(i),d=t(65947);let c=e=>{var a,t,s;let{children:r,value:i,index:c,maxAccess:u,...m}=e,p="".concat(e.name||"tab",".").concat(c),{accessLevel:f}=null!==(s=(null!==(t=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==t?t:[]).find(e=>e.controlId===p))&&void 0!==s?s:{accessLevel:0};if(f===d.A1)return null;let b=i===c;return(0,l.jsx)(n.Z,{role:"tabpanel",hidden:!b,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c),className:"".concat(o().tabPanel," ").concat(b?o().active:o().hidden),...m,children:r})};c.propTypes={children:r().node,index:r().number.isRequired,value:r().number.isRequired},a.Z=c},9522:function(e,a,t){"use strict";t.d(a,{Y:function(){return m}});var l=t(52322),n=t(23925),s=t(54582),r=t(68696),i=t(44258),o=t(2784),d=t(99266),c=t(52614),u=t.n(c);let m=e=>{var a,t,c,m,p;let{tabs:f,activeTab:b,setActiveTab:v,maxAccess:h,name:y="tab"}=e,x=(null==h?void 0:null===(t=h.record)||void 0===t?void 0:null===(a=t.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(y,".")))}).map(e=>e.controlId.split(".")[1]))||[],_=null==f?void 0:null===(c=f.map((e,a)=>({...e,id:a})))||void 0===c?void 0:c.filter((e,a)=>!x.includes(String(a))),N=null===(m=_[b])||void 0===m?void 0:m.id,I=null===(p=_[b])||void 0===p?void 0:p.disabled;return(0,o.useEffect)(()=>{N>=0&&!I&&b!=N&&v(N)},[]),(0,l.jsx)(n.Z,{className:u().tabsContainer,children:(0,l.jsx)(n.Z,{className:u().tabsWrapper,children:(0,l.jsx)(s.Z,{value:b,onChange:(e,a)=>v(a),variant:"scrollable",scrollButtons:_.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==_?void 0:_.map(e=>(0,l.jsx)(r.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,l.jsxs)(n.Z,{display:"flex",alignItems:"center",children:[(0,l.jsx)("span",{children:e.label}),e.id===b&&(null==e?void 0:e.onRefetch)&&(0,l.jsx)(i.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,l.jsx)(d.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=97490)}),_N_E=e.O()}]);