(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[36187],{92550:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mf-design",function(){return a(9154)}])},9154:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return L}});var l=a(52322),r=a(2784),t=a(71987),i=a(65950),d=a(69387),s=a(62202),o=a(61802),c=a(26612),u=a(31389),m=a(33625),v=a(62362),p=a(19473),x=a(36908),f=a(90587),g=a(29326),h=a(9522),I=a(60218),y=a(48601),b=a(82737),C=a(80983),_=a(5088),j=a(8661),N=a(63518),F=a(39812),w=a(91406),D=a(89330),Z=a(27423),k=a(2801),P=a(65215),A=a(243),R=a(19689);function S(e){var n,a;let{labels:d,access:o,store:m,setStore:x}=e,{recordId:g}=m,{platformLabels:h}=(0,r.useContext)(p.l),{getRequest:S,postRequest:V}=(0,r.useContext)(i.$),O=(0,r.useRef)(null),q=(0,t.E)({endpointId:f.u.Design.page}),{changeDT:T,maxAccess:W}=(0,A.r)({access:o,readOnlyOnEditMode:!1,name:"reference"}),{formik:E}=(0,C.c)({initialValues:{recordId:null,name:"",groupId:null,familyId:null,reference:"",designDate:null,description:"",threeDDId:null,rubberId:null,itemId:null,routingId:null,lineId:null,classId:null,standardId:null,stdWeight:0,designerId:null,itemCategoryId:null,designerRef:"",designerName:"",isInactive:!1},maxAccess:W,validateOnChange:!0,validationSchema:y.Ry({name:y.Z_().required(),itemId:y.Rx().required()}),onSubmit:async e=>{let n={...e,designDate:e.designDate?(0,F.ku)(e.designDate):null},a=await V({extension:f.u.Design.set,record:JSON.stringify(n)});O.current&&(O.current.value=a.recordId,await O.current.submit()),z(a.recordId),e.recordId||(E.setFieldValue("recordId",a.recordId),x({recordId:a.recordId})),s.ZP.success(e.recordId?h.Added:h.Edited),q()}}),L=!!E.values.recordId;async function z(e){S({extension:f.u.Design.get,parameters:"_recordId=".concat(e)}).then(async e=>{var n,a,l;(null==e?void 0:null===(n=e.record)||void 0===n?void 0:n.groupId)&&T((await S({extension:f.u.DesignGroup.get,parameters:"_recordId=".concat(null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.groupId)})).record),E.setValues({...e.record,designDate:(0,F.a1)(null==e?void 0:null===(a=e.record)||void 0===a?void 0:a.designDate)}),x({recordId:e.record.recordId})})}return(0,r.useEffect)(()=>{g&&z(g)},[]),(0,l.jsx)(b.Z,{resourceId:c.i.Design,form:E,maxAccess:W,editMode:L,previewReport:L,children:(0,l.jsx)(u.R,{children:(0,l.jsx)(v.Q,{children:(0,l.jsxs)(I.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(I.ZP,{item:!0,xs:6,children:(0,l.jsxs)(I.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:f.u.DesignGroup.qry,name:"groupId",label:d.designGroup,valueField:"recordId",displayField:"name",readOnly:!!L,values:E.values,onChange:(e,n)=>{E.setFieldValue("groupId",(null==n?void 0:n.recordId)||null),T(n)},error:E.touched.groupId&&!!E.errors.groupId,maxAccess:W})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(_.Z,{name:"reference",readOnly:L,label:d.reference,value:E.values.reference,onChange:E.handleChange,maxLength:"10",maxAccess:W,onClear:()=>E.setFieldValue("reference",""),error:E.touched.reference&&!!E.errors.reference})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(_.Z,{name:"name",label:d.name,value:E.values.name,required:!0,maxAccess:W,maxLength:"30",onChange:E.handleChange,onClear:()=>E.setFieldValue("name",""),error:E.touched.name&&!!E.errors.name})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"designDate",label:d.designDate,value:null===(n=E.values)||void 0===n?void 0:n.designDate,onChange:E.setFieldValue,onClear:()=>E.setFieldValue("designDate",null),error:E.touched.designDate&&!!E.errors.designDate,maxAccess:W})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(_.Z,{name:"description",label:d.description,value:E.values.description,maxLength:"200",maxAccess:W,onChange:E.handleChange,onClear:()=>E.setFieldValue("description",""),error:E.touched.description&&!!E.errors.description})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.U,{endpointId:P.$.Item.snapshot,name:"itemId",label:d.sku,valueField:"sku",displayField:"name",valueShow:"sku",secondValueShow:"itemName",form:E,required:!0,columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"}],onChange:(e,n)=>{E.setFieldValue("itemId",(null==n?void 0:n.recordId)||null),E.setFieldValue("itemName",(null==n?void 0:n.name)||""),E.setFieldValue("sku",(null==n?void 0:n.sku)||""),E.setFieldValue("itemCategoryId",(null==n?void 0:n.categoryId)||null)},displayFieldWidth:2,maxAccess:W,errorCheck:"itemId"})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:f.u.ProductionLine.qry,parameters:"_startAt=0&_pageSize=1000",values:E.values,name:"lineId",label:d.productionLine,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],maxAccess:W,onChange:(e,n)=>{E.setFieldValue("lineId",(null==n?void 0:n.recordId)||null)},error:E.touched.lineId&&E.errors.lineId})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:P.$.Category.qry,parameters:"_name=&_pageSize=1000&_startAt=0",values:E.values,name:"itemCategoryId",label:d.category,valueField:"recordId",displayField:["reference","name"],readOnly:!0})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.U,{endpointId:f.u.Routing.snapshot2,parameters:{_lineId:E.values.lineId||0},valueField:"reference",displayField:"name",name:"routingId",label:d.routing,readOnly:!E.values.lineId,form:E,minChars:2,firstValue:E.values.routingRef,secondValue:E.values.routingName,errorCheck:"routingId",maxAccess:W,displayFieldWidth:2,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],onChange:async(e,n)=>{E.setFieldValue("routingId",(null==n?void 0:n.recordId)||null),E.setFieldValue("routingRef",(null==n?void 0:n.reference)||null),E.setFieldValue("routingName",(null==n?void 0:n.name)||null)}})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:f.u.DesignFamily.qry,values:E.values,name:"familyId",label:d.designFamily,valueField:"recordId",displayField:"name",maxAccess:W,onChange:(e,n)=>{E.setFieldValue("familyId",(null==n?void 0:n.recordId)||"")},error:E.touched.familyId&&!!E.errors.familyId})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:f.u.ProductionClass.qry,values:E.values,name:"classId",label:d.productionClass,valueField:"recordId",displayField:"name",maxAccess:W,onChange:(e,n)=>{E.setFieldValue("classId",(null==n?void 0:n.recordId)||"")},error:E.touched.classId&&!!E.errors.classId})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:f.u.ProductionStandard.qry,values:E.values,name:"standardId",label:d.productionStandard,valueField:"recordId",displayField:"reference",maxAccess:W,onChange:(e,n)=>{E.setFieldValue("standardId",(null==n?void 0:n.recordId)||"")},error:E.touched.standardId&&!!E.errors.standardId})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.U,{endpointId:N.z.ThreeDDrawing.snapshot2,valueField:"reference",displayField:"reference",secondDisplayField:!1,name:"threeDDId",label:d.threeDD,form:E,valueShow:"threeDDRef",maxAccess:W,onChange:(e,n)=>{E.setFieldValue("threeDDId",(null==n?void 0:n.recordId)||null),E.setFieldValue("threeDDRef",(null==n?void 0:n.reference)||""),E.setFieldValue("fileReference",(null==n?void 0:n.fileReference)||"")},errorCheck:"threeDDId"})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.U,{endpointId:N.z.Rubber.snapshot,valueField:"reference",displayField:"reference",secondDisplayField:!1,name:"rubberId",label:d.rubber,form:E,valueShow:"rubberRef",maxAccess:W,onChange:(e,n)=>{E.setFieldValue("rubberId",(null==n?void 0:n.recordId)||null),E.setFieldValue("rubberRef",(null==n?void 0:n.reference)||"")},errorCheck:"rubberId"})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(w.Z,{name:"stdWeight",label:d.weight,value:E.values.stdWeight,maxAccess:W,onChange:E.handleChange,maxLength:12,decimalScale:3,onClear:()=>E.setFieldValue("stdWeight",0),error:E.touched.stdWeight&&!!E.errors.stdWeight})})]})}),(0,l.jsx)(I.ZP,{item:!0,xs:6,children:(0,l.jsxs)(I.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(k.Z,{ref:O,resourceId:c.i.Design,seqNo:0,recordId:null==E?void 0:null===(a=E.values)||void 0===a?void 0:a.recordId,height:250})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.U,{endpointId:N.z.Designer.snapshot,parameters:{_productionLineId:E.values.productionLineId||0},valueField:"name",displayField:"name",secondDisplayField:!0,firstValue:E.values.designerRef,secondValue:E.values.designerName,name:"designerId",displayFieldWidth:2,label:d.designer,form:E,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],maxAccess:W,onChange:(e,n)=>{E.setFieldValue("designerName",(null==n?void 0:n.name)||""),E.setFieldValue("designerRef",(null==n?void 0:n.reference)||""),E.setFieldValue("designerId",(null==n?void 0:n.recordId)||null)},errorCheck:"designerId"})}),(0,l.jsx)(I.ZP,{item:!0,xs:12,children:(0,l.jsx)(R.Z,{name:"isInactive",value:E.values.isInactive,onChange:e=>E.setFieldValue("isInactive",e.target.checked),label:d.isInactive,maxAccess:W})})]})})]})})})})}var V=a(76399),O=a(25506),q=a(67920),T=e=>{let{store:n,maxAccess:a,labels:t}=e,{recordId:d}=n,{getRequest:o,postRequest:x}=(0,r.useContext)(i.$),{platformLabels:g}=(0,r.useContext)(p.l),{schema:h,requiredFields:j}=(0,q.m)({workCenterId:e=>null==e?void 0:e.workCenterId,operationId:e=>null==e?void 0:e.operationId,sku:e=>null==e?void 0:e.sku,designQty:e=>null==e?void 0:e.designQty},!0,a,"data"),{formik:N}=(0,C.c)({maxAccess:a,conditionSchema:["data"],initialValues:{designId:d,data:[{id:1,workCenterId:null,designId:d,operationId:"",rmSeqNo:1,itemId:"",designQty:null,designPcs:null}]},validationSchema:y.Ry({data:y.IX().of(h)}),onSubmit:async e=>{let n=null==e?void 0:e.data.map((e,n)=>({...e,id:n+1,rmSeqNo:n+1,designId:d})).filter(e=>{var n;return null===(n=Object.values(j))||void 0===n?void 0:n.every(n=>n(e))});await x({extension:f.u.DesignRawMaterial.set2,record:JSON.stringify({designId:d,data:n})}).then(()=>{w(),s.ZP.success(g.Edited)})}}),F=!!d;async function w(){var e;let n=await o({extension:f.u.DesignRawMaterial.qry,parameters:"_designId=".concat(d)}),a=(null==n?void 0:n.list)&&(null==n?void 0:null===(e=n.list)||void 0===e?void 0:e.length)!==0?await Promise.all(n.list.map(async(e,n)=>({...e,id:n+1}))):N.initialValues.data;N.setValues({designId:d,recordId:d,data:a})}(0,r.useEffect)(()=>{!async function(){d&&await w()}()},[]);let D=N.values.data.reduce((e,n)=>e+(Number(n.designQty)||0),0),Z=N.values.data.reduce((e,n)=>e+(Number(n.designPcs)||0),0),k=[{component:"resourcelookup",label:t.workCenter,name:"workCenterId",flex:2,props:{endpointId:f.u.WorkCenter.snapshot,displayField:"reference",valueField:"recordId",mapping:[{from:"recordId",to:"workCenterId"},{from:"reference",to:"workCenterRef"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:3},async onChange(e){let{row:{update:n,newRow:a}}=e;if(!(null==a?void 0:a.workCenterId)){n({operationId:null,operationName:""});return}n({workCenterId:(null==a?void 0:a.workCenterId)||null,workCenterRef:(null==a?void 0:a.workCenterRef)||""})}},{component:"resourcecombobox",label:t.operation,name:"operationId",variableParameters:[{key:"workCenterId",value:"workCenterId"}],props:{endpointId:f.u.Operation.qry,valueField:"recordId",displayField:"name",mapping:[{from:"recordId",to:"operationId"},{from:"name",to:"operationName"},{from:"reference",to:"operationRef"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:4},propsReducer(e){let{row:n,props:a}=e;return{...a,readOnly:!n.workCenterId}}},{component:"resourcelookup",label:t.sku,name:"sku",props:{endpointId:P.$.RMSKU.snapshot,displayField:"sku",valueField:"sku",columnsInDropDown:[{key:"sku",value:"Sku"},{key:"name",value:"Name"}],mapping:[{from:"recordId",to:"itemId"},{from:"name",to:"itemName"},{from:"sku",to:"sku"},{from:"categoryName",to:"categoryName"}],displayFieldWidth:3},async onChange(e){let{row:{update:n,newRow:a}}=e;if(null==a?void 0:a.itemId){var l;let e=await o({extension:P.$.ItemProduction.get,parameters:"_recordId=".concat(a.itemId)});n({rmCategoryName:(null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.rmcName)||""})}else n({rmCategoryName:""})}},{component:"textfield",label:t.item,name:"itemName",props:{readOnly:!0}},{component:"textfield",label:t.category,name:"categoryName",props:{readOnly:!0}},{component:"textfield",label:t.rmCategory,name:"rmCategoryName",props:{readOnly:!0}},{component:"numberfield",label:t.qty,name:"designQty",props:{decimalScale:3,maxLength:12}},{component:"numberfield",label:t.pcs,name:"designPcs",props:{decimalScale:0,maxLength:10}}];return(0,l.jsx)(b.Z,{form:N,resourceId:c.i.Design,maxAccess:a,isCleared:!1,editMode:F,children:(0,l.jsxs)(u.R,{children:[(0,l.jsx)(v.Q,{children:(0,l.jsx)(V._,{onChange:e=>N.setFieldValue("data",e),value:N.values.data,error:N.errors.data,columns:k,name:"data",maxAccess:a})}),(0,l.jsx)(m.g,{children:(0,l.jsxs)(I.ZP,{container:!0,direction:"row",wrap:"nowrap",sx:{pt:5,justifyContent:"flex-end"},children:[(0,l.jsx)(I.ZP,{item:!0,xs:3,sx:{pl:3},children:(0,l.jsx)(_.Z,{name:"totalQty",maxAccess:a,value:(0,O.bj)(D),label:t.totalQty,readOnly:!0})}),(0,l.jsx)(I.ZP,{item:!0,xs:3,sx:{pl:3},children:(0,l.jsx)(_.Z,{name:"totalPcs",maxAccess:a,value:(0,O.bj)(Z.toFixed(2)),label:t.totalPcs,readOnly:!0})})]})})]})})},W=e=>{let{store:n,maxAccess:a,labels:t}=e,{recordId:d}=n,{getRequest:o,postRequest:x}=(0,r.useContext)(i.$),{platformLabels:g}=(0,r.useContext)(p.l),{schema:h,requiredFields:j}=(0,q.m)({itemId:e=>null==e?void 0:e.itemId,qty:e=>(null==e?void 0:e.qty)!=null,pcs:e=>(null==e?void 0:e.pcs)!=null&&(null==e?void 0:e.pcs)<=2147483647},!0,a,"items"),{formik:N}=(0,C.c)({validateOnChange:!0,maxAccess:a,conditionSchema:["items"],initialValues:{designId:d,items:[{id:1,designId:d,itemId:"",seqNo:1,qty:null,pcs:null}]},validationSchema:y.Ry({items:y.IX().of(h)}),onSubmit:async e=>{let n=e.items.map((e,n)=>({...e,seqNo:n+1,id:n+1})).filter(e=>{var n;return null===(n=Object.values(j))||void 0===n?void 0:n.every(n=>n(e))});await x({extension:f.u.Components.set2,record:JSON.stringify({designId:d,items:n})}).then(()=>{w(),s.ZP.success(g.Edited)})}}),F=!!d;async function w(){var e,n;let a=await o({extension:f.u.Components.qry,parameters:"_designId=".concat(d)}),l=(null==a?void 0:null===(e=a.list)||void 0===e?void 0:e.length)!=0?await Promise.all(null==a?void 0:null===(n=a.list)||void 0===n?void 0:n.map(async(e,n)=>({...e,id:n+1}))):N.initialValues.items;N.setValues({designId:d,recordId:d,items:l})}(0,r.useEffect)(()=>{!async function(){d&&await w()}()},[]);let D=N.values.items.reduce((e,n)=>e+(Number(n.qty)||0),0),Z=N.values.items.reduce((e,n)=>e+(Number(n.pcs)||0),0),k=[{component:"resourcelookup",label:t.sku,name:"itemId",props:{endpointId:P.$.Item.snapshot4,displayField:"sku",valueField:"recordId",columnsInDropDown:[{key:"sku",value:"Sku"},{key:"name",value:"Name"}],mapping:[{from:"recordId",to:"itemId"},{from:"name",to:"itemName"},{from:"sku",to:"sku"},{from:"categoryName",to:"categoryName"}],displayFieldWidth:2},async onChange(e){let{row:{update:n,newRow:a}}=e;if(null==a?void 0:a.itemId){var l;let e=await o({extension:P.$.ItemProduction.get,parameters:"_recordId=".concat(a.itemId)});n({rmCategoryName:(null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.rmcName)||""})}else n({rmCategoryName:""})}},{component:"textfield",label:t.itemName,name:"itemName",props:{readOnly:!0}},{component:"textfield",label:t.category,name:"categoryName",props:{readOnly:!0}},{component:"textfield",label:t.rmCategory,name:"rmCategoryName",props:{readOnly:!0}},{component:"numberfield",label:t.qty,name:"qty",props:{decimalScale:3,maxLength:12}},{component:"numberfield",label:t.pcs,name:"pcs",props:{decimalScale:0,maxLength:10}}];return(0,l.jsx)(b.Z,{form:N,resourceId:c.i.Design,maxAccess:a,isCleared:!1,editMode:F,children:(0,l.jsxs)(u.R,{children:[(0,l.jsx)(v.Q,{children:(0,l.jsx)(V._,{onChange:e=>N.setFieldValue("items",e),value:N.values.items,error:N.errors.items,columns:k,name:"items",maxAccess:a})}),(0,l.jsx)(m.g,{children:(0,l.jsxs)(I.ZP,{container:!0,direction:"row",wrap:"nowrap",sx:{pt:5,justifyContent:"flex-end"},children:[(0,l.jsx)(I.ZP,{item:!0,xs:3,sx:{pl:3},children:(0,l.jsx)(_.Z,{name:"totalQty",maxAccess:a,value:(0,O.bj)(D),label:t.totalQty,readOnly:!0})}),(0,l.jsx)(I.ZP,{item:!0,xs:3,sx:{pl:3},children:(0,l.jsx)(_.Z,{name:"totalPcs",maxAccess:a,value:(0,O.bj)(Z.toFixed(2)),label:t.totalPcs,readOnly:!0})})]})})]})})},E=e=>{let{recordId:n,labels:a,maxAccess:t}=e,[i,d]=(0,r.useState)(0),[s,o]=(0,r.useState)({recordId:n}),c=[{label:a.Design},{label:a.DesignRoutingSequence,disabled:!s.recordId},{label:a.Components,disabled:!s.recordId}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.Y,{tabs:c,activeTab:i,setActiveTab:d,maxAccess:t}),(0,l.jsx)(g.Z,{index:0,value:i,maxAccess:t,children:(0,l.jsx)(S,{labels:a,setStore:o,store:s,access:t})}),(0,l.jsx)(g.Z,{index:1,value:i,maxAccess:t,children:(0,l.jsx)(T,{labels:a,store:s,maxAccess:t})}),(0,l.jsx)(g.Z,{index:2,value:i,maxAccess:t,children:(0,l.jsx)(W,{labels:a,maxAccess:t,store:s})})]})},L=()=>{let{postRequest:e,getRequest:n}=(0,r.useContext)(i.$),{platformLabels:a}=(0,r.useContext)(p.l),{stack:g}=(0,o.zY)();async function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:l=50,params:r=[]}=e;return{...await n({extension:f.u.Design.page,parameters:"_startAt=".concat(a,"&_pageSize=").concat(l,"&_filter=&_sortField=&_params=").concat(r,"&_sortBy=recordId")}),_startAt:a}}let{query:{data:I},filterBy:y,refetch:b,labels:C,access:_,paginationParameters:j,invalidate:N}=(0,t.J)({queryFn:h,endpointId:f.u.Design.page,datasetId:c.i.Design,filter:{filterFn:F}});async function F(e){let{filters:a,pagination:l}=e;return(null==a?void 0:a.qry)?await n({extension:f.u.Design.snapshot,parameters:"_filter=".concat(a.qry,"&_startAt=").concat(l._startAt||0,"&_size=").concat(l._size||50)}):h({_startAt:l._startAt||0,params:null==a?void 0:a.params})}let w=[{field:"reference",headerName:C.reference,flex:1},{field:"name",headerName:C.name,flex:1},{field:"designDate",headerName:C.designDate,flex:1,type:"date"},{field:"description",headerName:C.description,flex:1},{field:"lineRef",headerName:C.productionLine,flex:1}];async function D(e){g({Component:E,props:{labels:C,recordId:e,maxAccess:_},width:900,height:740,title:C.Designs})}let Z=async n=>{await e({extension:f.u.Design.del,record:JSON.stringify(n)}),N(),s.ZP.success(a.Deleted)};return(0,l.jsxs)(u.R,{children:[(0,l.jsx)(m.g,{children:(0,l.jsx)(x.Z,{onAdd:()=>{D()},maxAccess:_,reportName:"MFDES",filterBy:y})}),(0,l.jsx)(v.Q,{children:(0,l.jsx)(d.Z,{columns:w,gridData:I,rowId:["recordId"],onEdit:e=>{D(null==e?void 0:e.recordId)},refetch:b,onDelete:Z,isLoading:!1,pageSize:50,maxAccess:_,paginationParameters:j,paginationType:"api"})})]})}},67920:function(e,n,a){"use strict";a.d(n,{m:function(){return r}});var l=a(48601);function r(e,n,a){var r;let t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",i={...e};return null==a||null===(r=a.record)||void 0===r||r.controls.forEach(e=>{let{controlId:n,accessLevel:a}=e,[l,r]=null==n?void 0:n.split(".");l!==t||2!==a||r in i||(i[r]=e=>(null==e?void 0:e[r])!=null),(1===a||4===a)&&r in i&&delete i[r]}),{schema:l.Ry().shape({...Object.keys(i).reduce((e,a)=>(e[a]=l.nK().nullable().test(function(e){var l;let r=this.parent,[,t]=this.path.match(/^(\w+)\[(\d+)\]/)||[],d=(null===(l=this.options.context)||void 0===l?void 0:l[t])||[];if(n||!n&&d.length>1){if(null!==r[a]&&void 0!==r[a]&&0!==r[a]&&""!==i[a]&&!i[a](r))return!1;if(!Object.entries(i).some(e=>{let[,n]=e;return!!n(r)}))return!0}return!!i[a](r)&&void 0!==e}),e),{})}),requiredFields:i}}},243:function(e,n,a){"use strict";a.d(n,{r:function(){return m}});var l=a(45300),r=a(2784),t=a(38449),i=a(65947);let d=async(e,n,a)=>{try{let l=await e({extension:n,parameters:a});return n.includes("qry")?l:l.record}catch(e){return null}},s=(e,n,a)=>{let l=(e=JSON.parse(JSON.stringify(e))).record.controls,r=l.find(e=>e.controlId===a);return r?r.accessLevel=(null==n?void 0:n.mandatory)?i.$7:i.rr:(null==n?void 0:n.mandatory)?l.push({sgId:18,resourceId:"",controlId:a,accessLevel:(null==n?void 0:n.mandatory)?i.$7:i.rr}):(null==n?void 0:n.readOnly)?l.push({sgId:18,resourceId:"",controlId:a,accessLevel:(null==n?void 0:n.readOnly)?i.rr:i.$7}):l=e.record.controls.filter(e=>e.controlId!==a),{...e,record:{...e.record,controls:l}}},o=async(e,n,a)=>{let l,r;return"isExternal"!==a?null:(r="_recordId=".concat(n),l=t.r.NumberRange.get,await d(e,l,r))},c=async function(e,n){let a,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,t=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"reference",i={readOnly:!1,mandatory:!1};return i=l?{readOnly:null==(a=await o(e,l,"isExternal"))||!a.external,mandatory:null!=a&&!!a.external}:{readOnly:!1,mandatory:!0},r&&(i={readOnly:!0,mandatory:!1}),n&&i&&(n=await s(n,i,t)),{type:i,maxAccess:n,selectNraId:l}};var u=a(65950);function m(e){var n;let{access:a,readOnlyOnEditMode:t,name:i}=e,{getRequest:d}=(0,r.useContext)(u.$),[s,o]=(0,r.useState)(),m=async e=>await c(d,a,e,t,i),v=(0,l.a)({retry:!1,enabled:!0,staleTime:0,queryKey:[s,!!a],queryFn:()=>m(s)});return{refBehavior:v.data,maxAccess:null==v?void 0:null===(n=v.data)||void 0===n?void 0:n.maxAccess,changeDT(e){o(null==e?void 0:e.nraId)}}}},2801:function(e,n,a){"use strict";var l=a(52322),r=a(23925),t=a(2784),i=a(80983),d=a(65950),s=a(38449),o=a(19473),c=a(35656),u=a(10498),m=a.n(u),v=a(69627);let p=(0,t.forwardRef)((e,n)=>{let{resourceId:u,error:p,seqNo:x,recordId:f,width:g=140,height:h=140,customWidth:I,customHeight:y,disabled:b=!1,isAbsolutePath:C=!1,parentImage:_}=e,j=(0,t.useRef)(null),N=(0,t.useRef)(null),F=(0,t.useRef)({}),{getRequest:w,postRequest:D}=(0,t.useContext)(d.$),{platformLabels:Z}=(0,t.useContext)(o.l),[k,P]=(0,t.useState)(""),A=null==_?void 0:_.recordId,R=null==_?void 0:_.resourceId,{formik:S}=(0,i.c)({initialValues:{}}),{width:V}=(0,c.d)(),O=V>=1680?1:V>=1600?.9:V<=1024?.7:.7+(V-1024)/576*.22000000000000008;(0,t.useImperativeHandle)(n,()=>({submit:q}));let q=()=>{var e,a,l,r,t,i,d,o,c,m,v,p;if(b)return;let x=(null==n?void 0:null===(e=n.current)||void 0===e?void 0:e.value)||f;if(C){if((null===(i=S.values)||void 0===i?void 0:null===(t=i.file)||void 0===t?void 0:t.name)||S.values.url){let e={...S.values,fileName:(null===(c=S.values.file)||void 0===c?void 0:c.name)||S.values.url,resourceId:u,recordId:x};return D({extension:s.r.Attachment.set2,record:JSON.stringify(e),file:null===(m=S.values)||void 0===m?void 0:m.file}).then(()=>W(x))}return k||null===(d=F.current)||void 0===d||!d.fileName||(null===(o=S.values)||void 0===o?void 0:o.fileName)?void 0:D({extension:s.r.Attachment.del,record:JSON.stringify(F.current)}).then(()=>W(x))}if(null===(a=S.values)||void 0===a?void 0:a.file){let e={...S.values,recordId:x};return D({extension:s.r.Attachment.set,record:JSON.stringify(e),file:null===(v=S.values)||void 0===v?void 0:v.file}).then(()=>W(x))}if(!k&&(null===(l=F.current)||void 0===l?void 0:l.url)&&!(null===(r=S.values)||void 0===r?void 0:r.url))return D({extension:s.r.Attachment.del,record:JSON.stringify(F.current),file:null===(p=F.current)||void 0===p?void 0:p.url}).then(()=>W(x))},T=()=>{P(""),S.setValues({})},W=async e=>{let n=e||f;if(!u)return;if(C&&n){let e=await w({extension:s.r.Attachment.get2,parameters:"_resourceId=".concat(u,"&_seqNo=").concat(x,"&_recordId=").concat(n)}),a=(null==e?void 0:e.record)||{};S.setValues({...a,resourceId:u}),F.current={...a,resourceId:u},P((null==a?void 0:a.fileName)?"".concat(a.fileName,"?t=").concat(Date.now()):"");return}let a=R||u,l=A||n;if(!l)return;let r=await w({extension:s.r.Attachment.get,parameters:"_resourceId=".concat(a,"&_seqNo=").concat(x,"&_recordId=").concat(l)}),t=(null==r?void 0:r.record)||{};S.setValues({...t,resourceId:a}),F.current={...t,resourceId:a},P((null==t?void 0:t.url)?"".concat(t.url,"?t=").concat(Date.now()):"")};return(0,t.useEffect)(()=>{A||f?W():T()},[A,f]),(0,l.jsxs)(r.Z,{className:m().container,children:[(0,l.jsx)(r.Z,{className:m().previewBox,style:{width:"100%",maxWidth:(I||g)*O,height:(y||h)*O},onClick:()=>{b||j.current.click()},children:(0,l.jsx)("img",{src:k||a(68802).default.src,alt:"",className:m().previewImage,style:{border:p?"2px solid #F44336":"none"},onError:e=>{e.currentTarget.src=a(68802).default.src}})}),(0,l.jsxs)(r.Z,{className:m().bottomSection,children:[(0,l.jsx)("input",{hidden:!0,type:"file",accept:"image/png, image/jpeg, image/jpg",ref:j,onChange:e=>{var n,a;let l=null==e?void 0:null===(a=e.target)||void 0===a?void 0:null===(n=a.files)||void 0===n?void 0:n[0];if(!l)return;if(Math.round(l.size/1024)>500){alert(Z.MaxFileSize);return}let r=new Date(l.lastModifiedDate),t="".concat(r.getDate(),"/").concat(r.getMonth()+1,"/").concat(r.getFullYear());S.setValues({resourceId:u,recordId:f,seqNo:0,fileName:l.name,folderId:null,folderName:null,date:t,url:null,file:l});let i=new FileReader;N.current=i,i.onloadend=e=>P(e.target.result),i.readAsDataURL(l)},disabled:b}),(0,l.jsx)(v.Z,{onClick:T,image:"clear.png",tooltipText:Z.Clear,color:"#F44336",border:"none",disabled:b})]})]})});n.Z=p},29326:function(e,n,a){"use strict";var l=a(52322);a(2784);var r=a(23925),t=a(13980),i=a.n(t),d=a(95291),s=a.n(d),o=a(65947);let c=e=>{var n,a,t;let{children:i,value:d,index:c,maxAccess:u,...m}=e,v="".concat(e.name||"tab",".").concat(c),{accessLevel:p}=null!==(t=(null!==(a=null==u?void 0:null===(n=u.record)||void 0===n?void 0:n.controls)&&void 0!==a?a:[]).find(e=>e.controlId===v))&&void 0!==t?t:{accessLevel:0};if(p===o.A1)return null;let x=d===c;return(0,l.jsx)(r.Z,{role:"tabpanel",hidden:!x,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c),className:"".concat(s().tabPanel," ").concat(x?s().active:s().hidden),...m,children:i})};c.propTypes={children:i().node,index:i().number.isRequired,value:i().number.isRequired},n.Z=c},9522:function(e,n,a){"use strict";a.d(n,{Y:function(){return m}});var l=a(52322),r=a(23925),t=a(54582),i=a(68696),d=a(44258),s=a(2784),o=a(99266),c=a(52614),u=a.n(c);let m=e=>{var n,a,c,m,v;let{tabs:p,activeTab:x,setActiveTab:f,maxAccess:g,name:h="tab"}=e,I=(null==g?void 0:null===(a=g.record)||void 0===a?void 0:null===(n=a.controls)||void 0===n?void 0:n.filter(e=>{var n;return 4===e.accessLevel&&(null===(n=e.controlId)||void 0===n?void 0:n.startsWith("".concat(h,".")))}).map(e=>e.controlId.split(".")[1]))||[],y=null==p?void 0:null===(c=p.map((e,n)=>({...e,id:n})))||void 0===c?void 0:c.filter((e,n)=>!I.includes(String(n))),b=null===(m=y[x])||void 0===m?void 0:m.id,C=null===(v=y[x])||void 0===v?void 0:v.disabled;return(0,s.useEffect)(()=>{b>=0&&!C&&x!=b&&f(b)},[]),(0,l.jsx)(r.Z,{className:u().tabsContainer,children:(0,l.jsx)(r.Z,{className:u().tabsWrapper,children:(0,l.jsx)(t.Z,{value:x,onChange:(e,n)=>f(n),variant:"scrollable",scrollButtons:y.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==y?void 0:y.map(e=>(0,l.jsx)(i.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,l.jsxs)(r.Z,{display:"flex",alignItems:"center",children:[(0,l.jsx)("span",{children:e.label}),e.id===x&&(null==e?void 0:e.onRefetch)&&(0,l.jsx)(d.Z,{size:"small",className:u().refreshButton,onClick:n=>{n.stopPropagation(),e.onRefetch()},children:(0,l.jsx)(o.Z,{className:u().refreshIcon})})]})},e.id))})})})}},10498:function(e){e.exports={container:"ImageUpload_container__I2BWx",previewBox:"ImageUpload_previewBox__JogCN",previewImage:"ImageUpload_previewImage___eqQX",bottomSection:"ImageUpload_bottomSection__jpph8"}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=92550)}),_N_E=e.O()}]);