(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[40388],{29716:function(e,r,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/iv-opening-cost",function(){return i(99043)}])},99043:function(e,r,i){"use strict";i.r(r),i.d(r,{default:function(){return F}});var a=i(52322),n=i(2784),t=i(62202),d=i(69387),s=i(65950),l=i(71987),o=i(26612),c=i(31389),u=i(33625),m=i(62362),p=i(61802),x=i(19473),I=i(65215),g=i(60218),y=i(48601),f=i(82737),h=i(80983),v=i(27423),C=i(8661),_=i(38449),j=i(91406),N=i(5088);function O(e){let{labels:r,maxAccess:i,record:d,recordId:u}=e,{getRequest:p,postRequest:O}=(0,n.useContext)(s.$),{platformLabels:S}=(0,n.useContext)(x.l),F=(0,l.E)({endpointId:I.$.OpeningCost.qry}),{formik:Z}=(0,h.c)({initialValues:{recordId:null,itemId:null,itemName:"",year:null,periodId:null,avgCost:0},maxAccess:i,validateOnChange:!0,validationSchema:y.Ry({year:y.Rx().required(),itemId:y.Z_().required(),periodId:y.Rx().required(),avgCost:y.Rx().min(0).max(999999999).required()}),onSubmit:async e=>{await O({extension:I.$.OpeningCost.set,record:JSON.stringify(e)}),e.recordId?t.ZP.success(S.Edited):(t.ZP.success(S.Added),Z.setValues({...e,recordId:String(e.year)+String(e.itemId)+String(e.periodId)})),F()}}),k=!!Z.values.recordId;return(0,n.useEffect)(()=>{!async function(){if((null==d?void 0:d.itemId)&&(null==d?void 0:d.year)&&(null==d?void 0:d.periodId)&&u){let e=await p({extension:I.$.OpeningCost.get,parameters:"_itemId=".concat(null==d?void 0:d.itemId,"&_fiscalYear=").concat(null==d?void 0:d.year,"&_periodId=").concat(null==d?void 0:d.periodId)});Z.setValues({...e.record,recordId:String(e.record.year)+String(e.record.itemId)+String(e.record.periodId)})}}()},[]),(0,a.jsx)(f.Z,{resourceId:o.i.InventoryOpeningCosts,form:Z,maxAccess:i,editMode:k,isInfo:!1,children:(0,a.jsx)(c.R,{children:(0,a.jsx)(m.Q,{children:(0,a.jsxs)(g.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(g.ZP,{item:!0,xs:12,children:(0,a.jsx)(C.Z,{endpointId:_.r.FiscalYears.qry,readOnly:k,name:"year",label:r.fiscalYear,valueField:"fiscalYear",displayField:"fiscalYear",values:Z.values,required:!0,maxAccess:i,onChange:(e,r)=>Z.setFieldValue("year",(null==r?void 0:r.fiscalYear)||null),error:Z.touched.year&&!!Z.errors.year})}),(0,a.jsx)(g.ZP,{item:!0,xs:12,children:(0,a.jsx)(C.Z,{endpointId:_.r.FiscalPeriod.qry,name:"periodId",label:r.fiscalPeriod,valueField:"periodId",displayField:"name",values:Z.values,required:!0,readOnly:k,maxAccess:i,onChange:(e,r)=>Z.setFieldValue("periodId",(null==r?void 0:r.periodId)||null),error:Z.touched.periodId&&!!Z.errors.periodId})}),(0,a.jsx)(g.ZP,{item:!0,xs:12,children:(0,a.jsx)(v.U,{endpointId:I.$.Item.snapshot,name:"itemId",label:r.sku,readOnly:k,valueField:"recordId",displayField:"sku",valueShow:"sku",secondDisplayField:!1,form:Z,columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"}],onChange:(e,r)=>{Z.setFieldValue("itemId",(null==r?void 0:r.recordId)||""),Z.setFieldValue("itemName",(null==r?void 0:r.name)||""),Z.setFieldValue("sku",(null==r?void 0:r.sku)||"")},maxAccess:i,required:!0,errorCheck:"itemId"})}),(0,a.jsx)(g.ZP,{item:!0,xs:12,children:(0,a.jsx)(N.Z,{name:"itemName",label:r.item,value:Z.values.itemName,readOnly:!0,maxAccess:i})}),(0,a.jsx)(g.ZP,{item:!0,xs:12,children:(0,a.jsx)(j.Z,{name:"avgCost",label:r.cost,value:Z.values.avgCost,onChange:Z.handleChange,maxLength:12,required:!0,decimalScale:3,onClear:()=>Z.setFieldValue("avgCost",0),error:Z.touched.avgCost&&!!Z.errors.avgCost})})]})})})})}var S=i(36908),F=()=>{let{getRequest:e,postRequest:r}=(0,n.useContext)(s.$),{platformLabels:i}=(0,n.useContext)(x.l),{stack:g}=(0,p.zY)();async function y(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:i=0,_pageSize:a=50,params:n}=r;return{...await e({extension:I.$.OpeningCost.qry,parameters:"_startAt=".concat(i,"&_pageSize=").concat(a,"&filter=&_params=").concat(n||"","&_sortBy=year desc")}),_startAt:i}}async function f(e){let{filters:r,pagination:i}=e;return y({_startAt:i._startAt||0,params:null==r?void 0:r.params})}let{query:{data:h},labels:v,paginationParameters:C,refetch:_,access:j,invalidate:N,filterBy:F}=(0,l.J)({queryFn:y,endpointId:I.$.OpeningCost.qry,datasetId:o.i.InventoryOpeningCosts,filter:{filterFn:f}}),Z=[{field:"year",headerName:v.fiscalYear,flex:1},{field:"sku",headerName:v.sku,flex:1},{field:"itemName",headerName:v.item,flex:1},{field:"periodId",headerName:v.periodId,flex:1},{field:"avgCost",headerName:v.cost,flex:1,type:"number"}];function k(e){g({Component:O,props:{labels:v,record:e,recordId:e?String(e.year)+String(e.itemId):null,maxAccess:j},width:550,height:400,title:v.OpeningCost})}let q=async e=>{await r({extension:I.$.OpeningCost.del,record:JSON.stringify(e)}),N(),t.ZP.success(i.Deleted)};return(0,a.jsxs)(c.R,{children:[(0,a.jsx)(u.g,{children:(0,a.jsx)(S.Z,{labels:v,maxAccess:j,filterBy:F,onAdd:()=>{k()},hasSearch:!1,reportName:"IVOC"})}),(0,a.jsx)(m.Q,{children:(0,a.jsx)(d.Z,{columns:Z,gridData:h,rowId:["itemId","year"],onEdit:e=>{k(e)},onDelete:q,isLoading:!1,pageSize:50,paginationType:"api",paginationParameters:C,refetch:_,maxAccess:j})})]})}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=29716)}),_N_E=e.O()}]);