(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11344],{45898:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sales-order",function(){return n(27450)}])},27450:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var a=n(52322),r=n(2784),l=n(71987),d=n(65950),i=n(69387),o=n(62202),s=n(61802),c=n(26612),u=n(31389),m=n(33625),f=n(62362),h=n(19473),p=n(98345),v=n(7121),y=n(22341),x=n(58669),N=n(96026),I=n(36908),b=()=>{let{postRequest:e,getRequest:t}=(0,r.useContext)(d.$),{platformLabels:n,defaultsData:b}=(0,r.useContext)(h.l),{stack:A}=(0,s.zY)(),{stack:g}=(0,N.V)(),{query:{data:w},filterBy:S,refetch:_,labels:O,access:C,paginationParameters:j,invalidate:E}=(0,l.J)({queryFn:F,endpointId:y.P.SalesOrder.page,datasetId:c.i.SalesOrder,filter:{filterFn:P}}),k=[{field:"reference",headerName:O.reference,flex:1},{field:"statusName",headerName:O.status,flex:1},{field:"date",headerName:O.date,flex:1,type:"date"},{field:"clientName",headerName:O.client,flex:1},{field:"spRef",headerName:O.salesPerson,flex:1},{field:"szName",headerName:O.saleZone,flex:1},{field:"volume",headerName:O.volume,flex:1,type:"number"},{field:"amount",headerName:O.net,flex:1,type:"number"},{field:"dsName",headerName:O.deliveryStatus,flex:1},{field:"rsName",headerName:O.releaseStatus,flex:1},{field:"wipName",headerName:O.wip,flex:1},{field:"printStatusName",headerName:O.printStatus,flex:1},{field:"description",headerName:O.description,flex:1}];async function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0,_pageSize:a=50,params:r=[]}=e;return{...await t({extension:y.P.SalesOrder.page,parameters:"_startAt=".concat(n,"&_pageSize=").concat(a,"&_sortBy=recordId desc&_params=").concat(r,"&filter=")}),_startAt:n}}async function P(e){let{filters:n,pagination:a}=e;return n.qry?await t({extension:y.P.SalesOrder.snapshot,parameters:"_filter=".concat(n.qry)}):F({_startAt:a._startAt||0,params:null==n?void 0:n.params})}async function D(){var e;let t=null==b?void 0:null===(e=b.list)||void 0===e?void 0:e.find(e=>{let{key:t}=e;return"currencyId"===t});return parseInt(null==t?void 0:t.value)}let{proxyAction:T}=(0,p.G)({functionId:v.J.SalesOrder,action:async()=>{await D()?L():g({message:O.noSelectedCurrency})}}),Z=async()=>{T()};async function L(e){let t=await D();A({Component:x.Z,props:{currency:t,recordId:e}})}let q=async t=>{await e({extension:y.P.SalesOrder.del,record:JSON.stringify(t)}),E(),o.ZP.success(n.Deleted)};return(0,a.jsxs)(u.R,{children:[(0,a.jsx)(m.g,{children:(0,a.jsx)(I.Z,{onAdd:Z,maxAccess:C,reportName:"SAORD",filterBy:S})}),(0,a.jsx)(f.Q,{children:(0,a.jsx)(i.Z,{name:"table",columns:k,gridData:w,rowId:["recordId"],onEdit:e=>{L(null==e?void 0:e.recordId)},refetch:_,onDelete:q,deleteConfirmationType:"strict",isLoading:!1,pageSize:50,maxAccess:C,paginationParameters:j,paginationType:"api"})})]})}},67920:function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var a=n(48601);function r(e,t,n){var r;let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",d={...e};return null==n||null===(r=n.record)||void 0===r||r.controls.forEach(e=>{let{controlId:t,accessLevel:n}=e,[a,r]=null==t?void 0:t.split(".");a!==l||2!==n||r in d||(d[r]=e=>(null==e?void 0:e[r])!=null),(1===n||4===n)&&r in d&&delete d[r]}),{schema:a.Ry().shape({...Object.keys(d).reduce((e,n)=>(e[n]=a.nK().nullable().test(function(e){var a;let r=this.parent,[,l]=this.path.match(/^(\w+)\[(\d+)\]/)||[],i=(null===(a=this.options.context)||void 0===a?void 0:a[l])||[];if(t||!t&&i.length>1){if(null!==r[n]&&void 0!==r[n]&&0!==r[n]&&""!==d[n]&&!d[n](r))return!1;if(!Object.entries(d).some(e=>{let[,t]=e;return!!t(r)}))return!0}return!!d[n](r)&&void 0!==e}),e),{})}),requiredFields:d}}},45937:function(e,t,n){"use strict";var a=n(52322),r=n(38449),l=n(93894),d=n(2784),i=n(65950),o=n(19473),s=n(21326);let c=e=>{let{recordId:t,editMode:n,onSubmit:c=()=>{},window:u,actions:m=[],address:f,setAddress:h,required:p=!0,...v}=e,{getRequest:y,postRequest:x}=(0,d.useContext)(i.$),{platformLabels:N}=(0,d.useContext)(o.l),[I,b]=(0,d.useState)(t||null),[A,g]=(0,d.useState)(null),w=!!f&&!!h,S=w?f:A,_=w?h:g;(0,s.Z)({title:N.Address,window:u});let O=async e=>{if(!p){_(e),c(e,u);return}let t={...e,recordId:I||(null==S?void 0:S.recordId)||null},n=await x({extension:r.r.Address.set,record:JSON.stringify(t)}),a=(null==n?void 0:n.recordId)||I||null,l={...t,recordId:a,addressId:a};b(a),_(l),c(l,u)};return(0,d.useEffect)(()=>{!w&&I&&(async()=>{let e=await y({extension:r.r.Address.get,parameters:"_filter=&_recordId=".concat(I)});g((null==e?void 0:e.record)||null)})()},[I,w]),(0,a.jsx)(l.O,{editMode:n,setAddress:_,address:S,onSubmit:O,actions:m,window:u,...v})};c.width=600,c.height=500,t.Z=c},93894:function(e,t,n){"use strict";n.d(t,{O:function(){return u}});var a=n(52322),r=n(2784),l=n(82737),d=n(13073),i=n(80983),o=n(31389),s=n(33625),c=n(48601);let u=e=>{let{setAddress:t,address:n,editMode:u,window:m,readOnly:f,allowPost:h=!0,optional:p=!1,onSubmit:v,isSavedClear:y=!0,isCleared:x=!0,changeClear:N=!1,actions:I=[],...b}=e,[A,g]=(0,r.useState)(!p),[w,S]=(0,r.useState)({}),{formik:_}=(0,i.c)({maxAccess:w.maxAccess,initialValues:{recordId:null,name:"",countryId:null,countryName:"",stateId:null,stateName:"",cityId:null,city:"",street1:"",street2:"",email1:"",email2:"",phone:"",phone2:"",phone3:"",addressId:null,postalCode:"",cityDistrictId:null,cityDistrict:"",bldgNo:"",unitNo:"",subNo:"",poBox:""},validateOnChange:!0,validateOnBlur:!0,validationSchema:c.Ry({...w.validate}),onSubmit:e=>{t(e),h?v(e,m):m.close()}});return(0,r.useEffect)(()=>{p&&(_.values.name||_.values.street1||_.values.countryId||_.values.cityId)&&g(!0),!p||_.values.name||_.values.street1||_.values.countryId||_.values.cityId||g(!1)},[_.values]),(0,a.jsx)(l.Z,{form:_,maxAccess:w.maxAccess,isInfo:!1,disabledSubmit:f,editMode:u,isSavedClear:y,isCleared:x,onClear:N?()=>{_.resetForm({values:_.initialValues})}:void 0,actions:I,...b,children:(0,a.jsx)(o.R,{children:(0,a.jsx)(s.g,{children:(0,a.jsx)(d.Z,{addressValidation:_,readOnly:f,required:A,setFormik:S,address:n,...b})})})})}},39704:function(e,t,n){"use strict";var a=n(52322),r=n(2784),l=n(22341),d=n(65950),i=n(85325),o=n(21326),s=n(19473),c=n(35656),u=n(24868),m=n.n(u);let f=e=>{let{functionId:t,recordId:n,window:u}=e,{getRequest:f}=(0,r.useContext)(d.$),{languageId:h}=(0,r.useContext)(i.V),{platformLabels:p}=(0,r.useContext)(s.l),v=n+"-"+t;(0,o.Z)({title:p.WorkFlow,window:u});let{width:y}=(0,c.d)(),x=y<=1024,N=y>1024&&y<=1280,I=x?10:N?12:14,b=x?75:N?85:95,A=x?15:N?20:25,g=async()=>{var e="_functionId=".concat(t,"&_recordId=").concat(n);let a=await f({extension:l.P.WorkFlow.graph,parameters:e});return null==a?void 0:a.record},w=e=>{let t=[],n=[],a="",r="";return e.objects.forEach(e=>{t.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(t=>{e.objects.forEach(e=>{let n=e.functionName.split(" ").join("\r\n");t.parentId===e.recordId&&t.parentFunctionId===e.functionId&&(a=e.reference+"\r\n"+e.date+"\r\n"+n,t.parentId),t.childId===e.recordId&&t.childFunctionId===e.functionId&&(r=e.reference+"\r\n"+e.date+"\r\n"+n,t.childId)}),""===a||""===r||n.push({from:a,to:r,value:1,labelText:""}),a="",r=""}),n};return(0,r.useEffect)(()=>{!async function(){var e=await g();if(e){let t=(e,t)=>{let n=document.createElement("script");n.type="text/javascript",n.src=e,n.async=!0,n.onload=t,document.head.appendChild(n)};t("https://cdn.amcharts.com/lib/4/core.js",()=>{t("https://cdn.amcharts.com/lib/4/charts.js",()=>{t("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let t=am4core.create(v,am4charts.SankeyDiagram),n=w(e);t.data=n,t.dataFields.fromName="from",t.dataFields.toName="to",t.dataFields.value="value",t.paddingRight=2===h?0:40,t.paddingLeft=2===h?40:0,t.tooltip.label.fontSize=I;let a=t.nodes.template;a.draggable=!1,a.inert=!0,a.clickable=!1,a.width=b,a.height=A,a.nameLabel.label.fontSize=I,a.nameLabel.locationX=2===h?.85:0,a.nameLabel.height=void 0,a.nameLabel.label.fontWeight="bold";let r=t.links.template;r.middleLine.strokeOpacity=.3,r.middleLine.stroke=am4core.color("#555"),r.middleLine.strokeWidth=5,r.middleLine.hoverable=!1,r.fillOpacity=0,r.hoverable=!0,r.hoverOnFocus=!0,r.fill=am4core.color("#A8C686"),r.isHover=!0,t.appear(1e3,100)})})})})}}()},[]),(0,a.jsx)("div",{id:v,className:m().root})};f.width=950,t.Z=f},16096:function(e,t,n){"use strict";n.d(t,{ER:function(){return a},Ot:function(){return s},Ww:function(){return o},Yi:function(){return d},a$:function(){return r}});let a=1,r=2,l=e=>{if(!0===e.tdPct){e.tdAmount>100?1===e.typeChange?e.tdAmount=0:e.tdAmount=e.currentDiscount:e.currentDiscount=e.tdAmount,e.hiddenTdPct=e.tdAmount;let t=e.subtotal*e.tdAmount/100;e.hiddenTdAmount=t,e.tdType=r}else if(e.tdAmount>e.subtotal)1===e.typeChange?e.tdAmount=0:e.tdAmount=e.currentDiscount;else{e.currentDiscount=e.tdAmount;let t=0===e.subtotal?0:100*e.tdAmount/e.subtotal;e.hiddenTdPct=t,e.hiddenTdAmount=e.tdAmount,e.tdType=a}return e},d=e=>e=l(e),i=(e,t)=>(e.forEach(e=>{t.totalQty+=parseFloat(e.qty),t.totalWeight+=e.qty*e.weight,t.totalVolume+=e.qty*e.volume,t.totalUpo+=e.upo,t.sumVat+=e.vatAmount}),t.net=t.sumExtended+t.sumVat+((null==t?void 0:t.miscAmount)||0)-((null==t?void 0:t.tdAmount)||0),t),o=e=>e.reduce((e,t)=>e+(Number(t.extendedPrice)||0),0),s=(e,t)=>t=i(e,t)},24868:function(e){e.exports={root:"WorkFlow_root__EINm1"}}},function(e){e.O(0,[92515,2494,36908,23352,13073,35934,58669,49774,92888,40179],function(){return e(e.s=45898)}),_N_E=e.O()}]);