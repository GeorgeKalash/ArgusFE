(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[13854],{92413:function(e,i,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/client-price-list",function(){return r(80539)}])},80539:function(e,i,r){"use strict";r.r(i),r.d(i,{default:function(){return w}});var n=r(52322),l=r(2784),t=r(62202),c=r(69387),a=r(65950),d=r(71987),s=r(26612),u=r(61802),o=r(31389),m=r(36908),p=r(22341),y=r(60218),I=r(48601),x=r(82737),h=r(8661),f=r(80983),v=r(65215),P=r(38449),g=r(62362),C=r(19473),N=r(27423),S=r(91406),k=r(84100),_=e=>{var i;let{labels:r,maxAccess:c,recordId:u,record:m}=e,{postRequest:_,getRequest:F}=(0,l.useContext)(a.$),{platformLabels:w}=(0,l.useContext)(C.l),j=(0,d.E)({endpointId:p.P.ClientPriceList.page}),{formik:T}=(0,f.c)({maxAccess:c,initialValues:{recordId:u,clientId:null,sku:"",itemId:null,itemName:"",currencyId:null,priceType:null,unitPrice:null},validateOnChange:!0,validationSchema:I.Ry({clientId:I.Rx().required(),itemId:I.Rx().required(),currencyId:I.Rx().required(),priceType:I.Rx().required(),unitPrice:I.Rx().required()}),onSubmit:async e=>{await _({extension:p.P.ClientPriceList.set,record:JSON.stringify(e)}),T.values.currencyId||T.values.clientId||T.values.itemId||T.values.priceType?t.ZP.success(w.Edited):t.ZP.success(w.Added),T.setFieldValue("recordId",String(1e3*e.itemId)+String(100*e.clientId)+String(10*e.currencyId)+String(e.priceType)),j()}}),R=!!T.values.recordId;return(0,l.useEffect)(()=>{!async function(){if(m&&m.itemId&&m.clientId&&m.currencyId&&m.priceType&&u){let e=await F({extension:p.P.ClientPriceList.get,parameters:"_itemId=".concat(m.itemId,"&_clientId=").concat(m.clientId,"&_currencyId=").concat(m.currencyId,"&_priceType=").concat(m.priceType)});T.setValues({...e.record,recordId:String(1e3*e.record.itemId)+String(100*e.record.clientId)+String(10*e.record.currencyId)+String(e.record.priceType)})}}()},[]),(0,n.jsx)(x.Z,{form:T,resourceId:s.i.ClientPriceLists,maxAccess:c,editMode:R,children:(0,n.jsx)(o.R,{children:(0,n.jsx)(g.Q,{children:(0,n.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(N.U,{endpointId:p.P.Client.snapshot,valueField:"reference",displayField:"name",secondFieldLabel:r.name,name:"clientId",label:r.client,readOnly:R,form:T,required:!0,displayFieldWidth:2,valueShow:"clientRef",secondValueShow:"clientName",maxAccess:c,editMode:R,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],onChange:async(e,i)=>{T.setFieldValue("clientId",(null==i?void 0:i.recordId)||null),T.setFieldValue("clientName",(null==i?void 0:i.name)||""),T.setFieldValue("clientRef",(null==i?void 0:i.reference)||"")},errorCheck:"clientId"})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(N.U,{endpointId:v.$.Item.snapshot,name:"itemId",label:r.sku,valueField:"sku",displayField:"name",readOnly:R,valueShow:"sku",secondValueShow:"itemName",form:T,required:!0,columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"}],onChange:(e,i)=>{T.setFieldValue("itemId",(null==i?void 0:i.recordId)||null),T.setFieldValue("itemName",(null==i?void 0:i.name)||""),T.setFieldValue("sku",(null==i?void 0:i.sku)||"")},errorCheck:"itemId",maxAccess:c})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{endpointId:P.r.Currency.qry,name:"currencyId",label:r.currency,valueField:"recordId",readOnly:R,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:T.values,required:!0,maxAccess:c,onChange:(e,i)=>{T.setFieldValue("currencyId",(null==i?void 0:i.recordId)||null)},error:T.touched.currencyId&&!!T.errors.currencyId})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{datasetId:k.v.PRICE_TYPE,name:"priceType",label:r.priceType,readOnly:R,valueField:"key",displayField:"value",required:!0,values:T.values,maxAccess:c,onChange:(e,i)=>{T.setFieldValue("priceType",(null==i?void 0:i.key)||null)},error:T.touched.priceType&&!!T.errors.priceType})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{name:"unitPrice",label:r.unitPrice,required:!0,value:null==T?void 0:null===(i=T.values)||void 0===i?void 0:i.unitPrice,maxAccess:c,onChange:T.handleChange,onClear:()=>T.setFieldValue("unitPrice",""),decimalScale:3,error:T.touched.unitPrice&&!!T.errors.unitPrice,allowNegative:!1,maxLength:12})})]})})})})},F=r(33625),w=()=>{let{getRequest:e,postRequest:i}=(0,l.useContext)(a.$),{stack:r}=(0,u.zY)(),{platformLabels:y}=(0,l.useContext)(C.l);async function I(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:n=50,params:l}=i;return{...await e({extension:p.P.ClientPriceList.page,parameters:"_startAt=".concat(r,"&_pageSize=").concat(n,"&_params=").concat(l||"")}),_startAt:r}}async function x(e){let{filters:i,pagination:r}=e;return I({_startAt:r._startAt||0,params:null==i?void 0:i.params})}let{query:{data:h},labels:f,paginationParameters:v,filterBy:P,refetch:N,invalidate:S,access:k}=(0,d.J)({queryFn:I,endpointId:p.P.ClientPriceList.page,datasetId:s.i.ClientPriceLists,filter:{filterFn:x}}),w=[{field:"clientRef",headerName:f.clientRef,flex:1},{field:"clientName",headerName:f.clientName,flex:1},{field:"sku",headerName:f.sku,flex:1},{field:"itemName",headerName:f.itemName,flex:1},{field:"currencyRef",headerName:f.currency,flex:1},{field:"ptName",headerName:f.priceType,flex:1},{field:"unitPrice",headerName:f.unitPrice,flex:1,type:"number"}],j=async e=>{await i({extension:p.P.ClientPriceList.del,record:JSON.stringify(e)}),S(),t.ZP.success(y.Deleted)};function T(e){r({Component:_,props:{labels:f,recordId:e?String(1e3*e.itemId)+String(100*e.clientId)+String(10*e.currencyId)+String(e.priceType):null,record:e,maxAccess:k},width:600,height:450,title:f.ClientPriceList})}return(0,n.jsxs)(o.R,{children:[(0,n.jsx)(F.g,{children:(0,n.jsx)(m.Z,{hasSearch:!1,onAdd:()=>{T()},maxAccess:k,filterBy:P,reportName:"SAPRC"})}),(0,n.jsx)(g.Q,{children:(0,n.jsx)(c.Z,{columns:w,gridData:h,rowId:["recordId"],onEdit:e=>{T(e)},onDelete:j,isLoading:!1,pageSize:50,paginationParameters:v,paginationType:"api",maxAccess:k,refetch:N})})]})}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=92413)}),_N_E=e.O()}]);