(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[42401],{64448:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mf-prod-order",function(){return r(54453)}])},54453:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n=r(52322),a=r(2784),o=r(71987),i=r(65950),l=r(69387),c=r(62202),d=r(61802),s=r(26612),u=r(31389),f=r(33625),m=r(62362),p=r(19473),v=r(90587),h=r(36908),g=r(98345),y=r(7121),I=r(35934),b=()=>{let{postRequest:e,getRequest:t}=(0,a.useContext)(i.$),{platformLabels:r}=(0,a.useContext)(p.l),{stack:b}=(0,d.zY)(),{query:{data:x},filterBy:w,refetch:_,labels:N,access:k,paginationParameters:O,invalidate:F}=(0,o.J)({queryFn:j,endpointId:v.u.ProductionOrder.page,datasetId:s.i.ProductionOrder,filter:{filterFn:E}}),S=[{field:"reference",headerName:N.refernce,flex:1},{field:"date",headerName:N.date,flex:1,type:"date"},{field:"notes",headerName:N.description,flex:1},{field:"plantName",headerName:N.plant,flex:1},{field:"statusName",headerName:N.status,flex:1}];async function j(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:n=50,params:a=[]}=e;return{...await t({extension:v.u.ProductionOrder.page,parameters:"_startAt=".concat(r,"&_pageSize=").concat(n,"&_params=").concat(a,"&_jobId=0&filter=")}),_startAt:r}}async function E(e){let{filters:r,pagination:n}=e;return(null==r?void 0:r.qry)?await t({extension:v.u.ProductionOrder.snapshot,parameters:"_filter=".concat(r.qry)}):j({_startAt:n._startAt||0,params:null==r?void 0:r.params})}let{proxyAction:A}=(0,g.G)({functionId:y.J.ProductionOrder,action:T}),L=async()=>{await A()};async function T(e){b({Component:I.Z,props:{recordId:e}})}let C=async t=>{await e({extension:v.u.ProductionOrder.del,record:JSON.stringify(t)}),F(),c.ZP.success(r.Deleted)};return(0,n.jsxs)(u.R,{children:[(0,n.jsx)(f.g,{children:(0,n.jsx)(h.Z,{onAdd:L,maxAccess:k,filterBy:w,reportName:"MFPO"})}),(0,n.jsx)(m.Q,{children:(0,n.jsx)(l.Z,{columns:S,gridData:x,rowId:["recordId"],onEdit:e=>{T(e.recordId)},refetch:_,onDelete:C,deleteConfirmationType:"strict",isLoading:!1,pageSize:50,maxAccess:k,paginationParameters:O,paginationType:"api"})})]})}},67920:function(e,t,r){"use strict";r.d(t,{m:function(){return a}});var n=r(48601);function a(e,t,r){var a;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",i={...e};return null==r||null===(a=r.record)||void 0===a||a.controls.forEach(e=>{let{controlId:t,accessLevel:r}=e,[n,a]=null==t?void 0:t.split(".");n!==o||2!==r||a in i||(i[a]=e=>(null==e?void 0:e[a])!=null),(1===r||4===r)&&a in i&&delete i[a]}),{schema:n.Ry().shape({...Object.keys(i).reduce((e,r)=>(e[r]=n.nK().nullable().test(function(e){var n;let a=this.parent,[,o]=this.path.match(/^(\w+)\[(\d+)\]/)||[],l=(null===(n=this.options.context)||void 0===n?void 0:n[o])||[];if(t||!t&&l.length>1){if(null!==a[r]&&void 0!==a[r]&&0!==a[r]&&""!==i[r]&&!i[r](a))return!1;if(!Object.entries(i).some(e=>{let[,t]=e;return!!t(a)}))return!0}return!!i[r](a)&&void 0!==e}),e),{})}),requiredFields:i}}},1685:function(e,t,r){"use strict";r.d(t,{m:function(){return n}});let n=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,r){"use strict";r.d(t,{H:function(){return v},G:function(){return p}});var n=r(45300),a=r(2784),o=r(96026),i=r(38449);r(26612);var l=r(65947),c=r(1685);let d=async(e,t,r)=>{try{let n=await e({extension:t,parameters:r});return t.includes("qry")?n:n.record}catch(e){return null}},s=(e,t,r,n)=>{let a=(e=JSON.parse(JSON.stringify(e))).record.controls,o=a.find(e=>"reference"===e.controlId);return o?o.accessLevel=(null==t?void 0:t.mandatory)?l.$7:l.rr:(null==t?void 0:t.mandatory)?a.push({sgId:0,resourceId:"",controlId:"".concat(n?n+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?l.$7:l.rr}):(null==t?void 0:t.readOnly)?a.push({sgId:0,resourceId:"",controlId:"".concat(n?n+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?l.rr:l.$7}):a=e.record.controls.filter(e=>"reference"!=e.controlId),r&&a.push({sgId:0,resourceId:"",controlId:"".concat(n?n+".":"","dtId"),accessLevel:l.$7}),{...e,record:{...e.record,controls:a}}},u=async(e,t,r)=>{let n,a;switch(r){case"dtId":let o=(0,c.m)("userData"),l=null==o?void 0:o.userId;a="_userId=".concat(l,"&_functionId=").concat(t),n=i.r.UserFunction.get;break;case"glbSysNumberRange":a="_recordId=".concat(t),n=i.r.SystemFunction.get;break;case"DocumentType":a="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),n=i.r.DocumentType.qry;break;case"DcTypNumberRange":a="_recordId=".concat(t),n=i.r.DocumentType.get;break;case"isExternal":a="_recordId=".concat(t),n=i.r.NumberRange.get;break;default:return null}return await d(e,n,a)},f=async function(e){let t,r,n,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,c=!(arguments.length>4)||void 0===arguments[4]||arguments[4],d=arguments.length>5?arguments[5]:void 0,f=void 0===l&&o&&await u(e,o,"dtId"),m=null==f?void 0:f.dtId,p="",v=!0;if(f&&void 0===l||"nraId"===l){if(m){let r=await u(e,m,"DcTypNumberRange");t=null==r?void 0:r.nraId,v=!((null==r?void 0:r.activeStatus)<0),t||(p="Assign the document type to a number range")}if((!m||!v)&&c&&o){var h;let t=await u(e,o,"DocumentType");a=(null==t?void 0:null===(h=t.list)||void 0===h?void 0:h.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===l||void 0===l)&&o){if((!m||m)&&!t||t&&!v){let r=await u(e,o,"glbSysNumberRange");(t=null==r?void 0:r.nraId)&&a&&(a=!1),v=!0}p=t||a?"":"Assign the system Function to a number range"}l>0&&!t&&(t=l),t&&v?(r={readOnly:null==(n=await u(e,t,"isExternal"))||!n.external,mandatory:null!=n&&!!n.external},i&&(i=await s(i,r,a,d))):!t&&i&&(i=await s(i,r,a,d));let g=d?"".concat(d,".reference"):"reference";return{dtId:m,resetReference:null==r?void 0:r.readOnly,dcTypeRequired:a,reference:{fieldName:g,isEmpty:(null==n?void 0:n.external)!==void 0&&(null==n||!n.external)},errorMessage:p,maxAccess:i,selectNraId:l}};var m=r(65950);function p(e){let{functionId:t,action:r,hasDT:n}=e,{getRequest:i}=(0,a.useContext)(m.$),{stack:l}=(0,o.V)();return{proxyAction:async()=>{let e=await f(i,t,"",void 0,n);(null==e?void 0:e.errorMessage)?l({message:null==e?void 0:e.errorMessage}):await r()}}}function v(e){var t;let{functionId:r,access:i,hasDT:l,enabled:c=!0,objectName:d=""}=e,{getRequest:s}=(0,a.useContext)(m.$),{stack:u}=(0,o.V)(),[p,v]=(0,a.useState)(),h=async e=>{let t=await f(s,r,i,e,l,d);if(!t.errorMessage)return t;u({message:null==t?void 0:t.errorMessage})},g=(0,n.a)({retry:!1,staleTime:0,enabled:c,queryKey:[r,p,!!i,c],queryFn:p||"nraId"===p?()=>h(p):()=>h()});return{documentType:g.data,maxAccess:(null==g?void 0:null===(t=g.data)||void 0===t?void 0:t.maxAccess)||i,changeDT(e){v((null==e?void 0:e.nraId)||"nraId")}}}},39704:function(e,t,r){"use strict";var n=r(52322),a=r(2784),o=r(22341),i=r(65950),l=r(85325),c=r(21326),d=r(19473),s=r(35656),u=r(24868),f=r.n(u);let m=e=>{let{functionId:t,recordId:r,window:u}=e,{getRequest:m}=(0,a.useContext)(i.$),{languageId:p}=(0,a.useContext)(l.V),{platformLabels:v}=(0,a.useContext)(d.l),h=r+"-"+t;(0,c.Z)({title:v.WorkFlow,window:u});let{width:g}=(0,s.d)(),y=g<=1024,I=g>1024&&g<=1280,b=y?10:I?12:14,x=y?75:I?85:95,w=y?15:I?20:25,_=async()=>{var e="_functionId=".concat(t,"&_recordId=").concat(r);let n=await m({extension:o.P.WorkFlow.graph,parameters:e});return null==n?void 0:n.record},N=e=>{let t=[],r=[],n="",a="";return e.objects.forEach(e=>{t.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(t=>{e.objects.forEach(e=>{let r=e.functionName.split(" ").join("\r\n");t.parentId===e.recordId&&t.parentFunctionId===e.functionId&&(n=e.reference+"\r\n"+e.date+"\r\n"+r,t.parentId),t.childId===e.recordId&&t.childFunctionId===e.functionId&&(a=e.reference+"\r\n"+e.date+"\r\n"+r,t.childId)}),""===n||""===a||r.push({from:n,to:a,value:1,labelText:""}),n="",a=""}),r};return(0,a.useEffect)(()=>{!async function(){var e=await _();if(e){let t=(e,t)=>{let r=document.createElement("script");r.type="text/javascript",r.src=e,r.async=!0,r.onload=t,document.head.appendChild(r)};t("https://cdn.amcharts.com/lib/4/core.js",()=>{t("https://cdn.amcharts.com/lib/4/charts.js",()=>{t("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let t=am4core.create(h,am4charts.SankeyDiagram),r=N(e);t.data=r,t.dataFields.fromName="from",t.dataFields.toName="to",t.dataFields.value="value",t.paddingRight=2===p?0:40,t.paddingLeft=2===p?40:0,t.tooltip.label.fontSize=b;let n=t.nodes.template;n.draggable=!1,n.inert=!0,n.clickable=!1,n.width=x,n.height=w,n.nameLabel.label.fontSize=b,n.nameLabel.locationX=2===p?.85:0,n.nameLabel.height=void 0,n.nameLabel.label.fontWeight="bold";let a=t.links.template;a.middleLine.strokeOpacity=.3,a.middleLine.stroke=am4core.color("#555"),a.middleLine.strokeWidth=5,a.middleLine.hoverable=!1,a.fillOpacity=0,a.hoverable=!0,a.hoverOnFocus=!0,a.fill=am4core.color("#A8C686"),a.isHover=!0,t.appear(1e3,100)})})})})}}()},[]),(0,n.jsx)("div",{id:h,className:f().root})};m.width=950,t.Z=m},24868:function(e){e.exports={root:"WorkFlow_root__EINm1"}}},function(e){e.O(0,[92515,2494,36908,35934,49774,92888,40179],function(){return e(e.s=64448)}),_N_E=e.O()}]);