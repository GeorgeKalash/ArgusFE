(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[76479],{34252:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mf-post-wc-job",function(){return s(17988)}])},17988:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return O}});var r=s(52322),o=s(2784),l=s(48601),n=s(69387),a=s(65950),d=s(26612),i=s(62202),u=s(31389),p=s(33625),g=s(62362),c=s(19473),y=s(60218),v=s(27423),q=s(90587),I=s(50023),C=s(80983),m=s(91406),S=s(82737),h=s(5088),R=s(8661),O=()=>{var e,t,s,O,D,M,T,k,x;let{getRequest:b,postRequest:P}=(0,o.useContext)(a.$),{platformLabels:J}=(0,o.useContext)(c.l),{labels:f,access:N}=(0,I.Z)({datasetId:d.i.PostWorkCenterJob}),{formik:j}=(0,C.c)({initialValues:{jobId:null,toWorkCenterId:null,workCenterId:null,seqNo:1,data:{list:[]}},maxAccess:N,validationSchema:l.Ry({workCenterId:l.Rx().required(),toWorkCenterId:l.Rx().nullable().when("routingId",{is:e=>!!e,then:()=>l.Rx().required(),otherwise:()=>l.Rx().nullable()})}),onSubmit:async()=>{W?(await P({extension:q.u.JobWorkCenter.reopen,record:JSON.stringify({jobId:j.values.jobId,seqNo:j.values.seqNo,workCenterId:j.values.workCenterId})}),i.ZP.success(J.Unposted)):(await P({extension:q.u.JobWorkCenter.close,record:JSON.stringify({jobId:j.values.jobId,seqNo:j.values.seqNo,workCenterId:j.values.workCenterId,qty:j.values.qty,pcs:j.values.pcs})}),i.ZP.success(J.Posted)),j.resetForm()}}),w=[{field:"reference",headerName:f.documentRef,flex:1},{field:"dtName",headerName:f.documentTypeName,flex:1},{field:"wipQty",headerName:f.qty,flex:1,type:"number"},{field:"loss",headerName:f.loss,flex:1,type:"number"},{field:"wipPcs",headerName:f.pcs,flex:1,type:"number"}],W=1===j.values.status,A=(null==j?void 0:null===(s=j.values)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:null===(e=t.list)||void 0===e?void 0:e.length)>0,B=[{key:"Unlocked",condition:!W,onClick:j.handleSubmit,disabled:A||!j.values.jobId},{key:"Locked",condition:W,onClick:"onUnpostConfirmation",onSuccess:j.handleSubmit,disabled:!1}],F=async(e,t)=>{if(!e)return;let s=await b({extension:q.u.JobRouting.get,parameters:"_jobOrderId=".concat(e,"&_seqNo=").concat(t)});return null==s?void 0:s.record},L=async(e,t)=>{let s=await b({extension:q.u.Worksheet.draft,parameters:"_jobId=".concat(e.recordId,"&_seqNo=").concat(t)});return null==s?void 0:s.list},Z=async e=>{e?await b({extension:q.u.MFJobOrder.get,parameters:"_recordId=".concat(null==e?void 0:e.recordId)}).then(async t=>{var s,r,o,l,n,a,d,i,u,p,g,c,y,v,I,C,m,S,h,R,O,D,M,T,k;if(null==t?void 0:null===(s=t.record)||void 0===s?void 0:s.routingSeqNo){j.setValues({...j.values,...null==t?void 0:t.record,workCenterId:(null==t?void 0:null===(r=t.record)||void 0===r?void 0:r.workCenterId)||"",workCenterName:(null==t?void 0:null===(o=t.record)||void 0===o?void 0:o.wcName)||"",workCenterRef:(null==t?void 0:null===(l=t.record)||void 0===l?void 0:l.wcRef)||"",pcs:(null==t?void 0:null===(n=t.record)||void 0===n?void 0:n.pcs)||0,pcsIn:(null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.expectedPcs)||0,qty:(null==t?void 0:null===(d=t.record)||void 0===d?void 0:d.qty)||0,qtyIn:(null==t?void 0:null===(i=t.record)||void 0===i?void 0:i.expectedQty)||0,jobId:(null==t?void 0:null===(u=t.record)||void 0===u?void 0:u.recordId)||null,jobRef:(null==t?void 0:null===(p=t.record)||void 0===p?void 0:p.reference)||"",documentTypeID:(null==t?void 0:null===(g=t.record)||void 0===g?void 0:g.dtName)||null}),F(null==t?void 0:null===(c=t.record)||void 0===c?void 0:c.recordId,null==t?void 0:null===(y=t.record)||void 0===y?void 0:y.routingSeqNo).then(e=>{var s;j.setFieldValue("status",(null==e?void 0:e.status)||null),j.setFieldValue("statusName",null==e?void 0:e.statusName),j.setFieldValue("seqNo",null==t?void 0:null===(s=t.record)||void 0===s?void 0:s.routingSeqNo)}),L(e,null==t?void 0:null===(v=t.record)||void 0===v?void 0:v.routingSeqNo).then(e=>{j.setFieldValue("data",{list:e})});let s=await b({extension:q.u.JobRouting.get,parameters:"_jobOrderId=".concat(null==e?void 0:e.recordId,"&_seqNo=").concat(parseInt(null==t?void 0:null===(I=t.record)||void 0===I?void 0:I.routingSeqNo)+1)});j.setFieldValue("toWorkCenterId",(null==s?void 0:null===(C=s.record)||void 0===C?void 0:C.workCenterId)||null),j.setFieldValue("toWorkCenterName",(null==s?void 0:null===(m=s.record)||void 0===m?void 0:m.workCenterName)||""),j.setFieldValue("toWorkCenterRef",(null==s?void 0:null===(S=s.record)||void 0===S?void 0:S.workCenterRef)||"")}else j.setValues({...j.values,...null==t?void 0:t.record,workCenterId:null,workCenterName:"",workCenterRef:"",toWorkCenterId:null,pcs:(null==t?void 0:null===(h=t.record)||void 0===h?void 0:h.pcs)||0,pcsIn:(null==t?void 0:null===(R=t.record)||void 0===R?void 0:R.expectedPcs)||0,qty:(null==t?void 0:null===(O=t.record)||void 0===O?void 0:O.qty)||0,qtyIn:(null==t?void 0:null===(D=t.record)||void 0===D?void 0:D.expectedQty)||0,jobId:(null==t?void 0:null===(M=t.record)||void 0===M?void 0:M.recordId)||null,jobRef:(null==t?void 0:null===(T=t.record)||void 0===T?void 0:T.reference)||"",documentTypeID:(null==t?void 0:null===(k=t.record)||void 0===k?void 0:k.dtName)||null,seqNo:1})}):j.resetForm()};return(0,r.jsx)(S.Z,{resourceId:d.i.PostWorkCenterJob,actions:B,form:j,maxAccess:N,isParentWindow:!1,isInfo:!1,isSaved:!1,children:(0,r.jsxs)(u.R,{children:[(0,r.jsx)(p.g,{children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,padding:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(v.U,{endpointId:q.u.MFJobOrder.snapshot,valueField:"reference",displayField:"reference",secondDisplayField:!1,name:"jobId",label:f.jobReference,form:j,valueShow:"jobRef",maxAccess:N,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"itemName",value:"Item Name"}],onChange:async(e,t)=>{j.setFieldValue("jobRef",(null==t?void 0:t.reference)||""),j.setFieldValue("routingId",(null==t?void 0:t.routingId)||null),j.setFieldValue("jobId",(null==t?void 0:t.recordId)||null),Z(t)},errorCheck:"jobId"})}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(h.Z,{name:"documentTypeID",label:f.documentTypeID,value:j.values.documentTypeID,readOnly:!0})}),(0,r.jsx)(y.ZP,{item:!0,xs:6}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(h.Z,{name:"sku",label:f.sku,value:j.values.sku,readOnly:!0})}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(h.Z,{name:"itemName",label:f.itemName,value:j.values.itemName,readOnly:!0})}),(0,r.jsx)(y.ZP,{item:!0,xs:6}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(h.Z,{name:"routingRef",label:f.routing,value:j.values.routingRef,readOnly:!0})}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(h.Z,{name:"routingName",label:f.name,value:j.values.routingName,readOnly:!0})}),(0,r.jsx)(y.ZP,{item:!0,xs:6}),(0,r.jsx)(y.ZP,{item:!0,xs:6,children:(0,r.jsx)(R.Z,{endpointId:(null==j?void 0:null===(O=j.values)||void 0===O?void 0:O.jobId)?(null==j?void 0:null===(D=j.values)||void 0===D?void 0:D.routingId)?q.u.JobRouting.qry:q.u.JobWorkCenter.qry:null,parameters:j.values.jobId?"_jobId=".concat(j.values.jobId).concat(j.values.routingId?"&_workCenterId=0&_status=0&_params=":""):"",name:"workCenterId",label:f.fromWorkCenter,readOnly:!!(null==j?void 0:null===(M=j.values)||void 0===M?void 0:M.routingId)||!j.values.jobId,valueField:"workCenterId",displayField:["workCenterRef","workCenterName"],values:j.values,columnsInDropDown:[{key:"workCenterRef",value:"Reference"},{key:"workCenterName",value:"Name"}],onChange:async(e,t)=>{j.setFieldValue("workCenterId",(null==t?void 0:t.workCenterId)||null)},required:!0,maxAccess:N,error:j.touched.workCenterId&&j.errors.workCenterId})}),(0,r.jsx)(y.ZP,{item:!0,xs:6}),(0,r.jsx)(y.ZP,{item:!0,xs:6,children:(0,r.jsx)(R.Z,{endpointId:(null==j?void 0:null===(T=j.values)||void 0===T?void 0:T.jobId)?(null==j?void 0:null===(k=j.values)||void 0===k?void 0:k.routingId)?q.u.JobRouting.qry:q.u.JobWorkCenter.qry:null,parameters:j.values.jobId?"_jobId=".concat(j.values.jobId).concat(j.values.routingId?"&_workCenterId=0&_status=0&_params=":""):"",name:"toWorkCenterId",label:f.toWorkCenter,readOnly:!0,valueField:"workCenterId",displayField:["workCenterRef","workCenterName"],values:j.values,columnsInDropDown:[{key:"workCenterRef",value:"Reference"},{key:"workCenterName",value:"Name"}],onChange:async(e,t)=>{j.setFieldValue("toWorkCenterId",(null==t?void 0:t.workCenterId)||null)},required:j.values.routingId,maxAccess:N,error:j.touched.toWorkCenterId&&j.errors.toWorkCenterId})}),(0,r.jsx)(y.ZP,{item:!0,xs:6}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(m.Z,{name:"qtyIn",label:f.qtyIn,value:j.values.qtyIn,readOnly:!0})}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(m.Z,{name:"qty",label:f.qtyOut,value:j.values.qty,readOnly:!0})}),(0,r.jsx)(y.ZP,{item:!0,xs:6}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(m.Z,{name:"pcsIn",label:f.pcsIn,value:j.values.pcsIn,readOnly:!0})}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(m.Z,{name:"pcs",label:f.pcsOut,value:j.values.pcs,readOnly:!0})}),(0,r.jsx)(y.ZP,{item:!0,xs:6}),(0,r.jsx)(y.ZP,{item:!0,xs:3,children:(0,r.jsx)(h.Z,{name:"statusName",label:f.status,value:j.values.statusName,readOnly:!0})})]})}),(0,r.jsx)(g.Q,{children:(0,r.jsx)(n.Z,{columns:w,gridData:null==j?void 0:null===(x=j.values)||void 0===x?void 0:x.data,rowId:["recordId"],isLoading:!1,pagination:!1,maxAccess:N})})]})})}},90587:function(e,t,s){"use strict";s.d(t,{u:function(){return o}});let r="MF.asmx/",o={DesignRawMaterial:{qry2:r+"qryDRM2",qry:r+"qryDRM",set2:r+"set2DRM"},JobOrdersItem:{qry:r+"qryJIT",set2:r+"set2JIT"},IssueOfMaterialsItems:{qry:r+"qryIMI",qry2:r+"qryIMI2"},LaborGroup:{snapshot:r+"snapshotLBG",page:r+"pageLBG",qry:r+"qryLBG",set:r+"setLBG",get:r+"getLBG",del:r+"delLBG"},ProductionLine:{page:r+"pageLIN",qry:r+"qryLIN",qry2:r+"qry2LIN",qry3:r+"qry3LIN",set:r+"setLIN",get:r+"getLIN",del:r+"delLIN"},CostGroup:{page:r+"pageCG",set:r+"setCG",get:r+"getCG",del:r+"delCG",qry:r+"qryCG"},WorkCenter:{page:r+"pageWCT",qry:r+"qryWCT",qry3:r+"qryWCT3",set:r+"setWCT",get:r+"getWCT",del:r+"delWCT",snapshot:r+"snapshotWCT"},Routing:{page:r+"pageRTN",qry:r+"qryRTN",set:r+"setRTN",get:r+"getRTN",del:r+"delRTN",snapshot2:r+"snapshot2RTN",snapshot:r+"snapshotRTN"},Operation:{snapshot:r+"snapshotOPR",qry:r+"qryOPR",page:r+"pageOPR",set:r+"setOPR",get:r+"getOPR",del:r+"delOPR"},Labor:{page:r+"pageLBR",qry:r+"qryLBR",qry2:r+"qry2LBR",set:r+"setLBR",get:r+"getLBR",del:r+"delLBR",snapshot:r+"snapshotLBR"},Machine:{page:r+"pageMAC",qry:r+"qryMAC",set:r+"setMAC",get:r+"getMAC",del:r+"delMAC",snapshot:r+"snapshotMAC"},MachineSpecification:{page:r+"pageMAS",qry:r+"qryMAS",set:r+"setMAS",get:r+"getMAS",del:r+"delMAS"},LeanProductionPlanning:{preview:r+"previewPQ",update:r+"updatePQ",snapshot:r+"snapshotPQ",del:r+"delPQ",cancel:r+"cancelPQ"},MaterialsAdjustment:{generate:r+"generateADJ"},ProductionClass:{page:r+"pageCLS",qry:r+"qryCLS",set:r+"setCLS",get:r+"getCLS",del:r+"delCLS",snapshot:r+"qryCLS"},ProductionStandard:{qry:r+"qrySTD",page:r+"pageSTD",set:r+"setSTD",get:r+"getSTD",del:r+"delSTD"},ProductionClassSemiFinished:{qry:r+"qryCSF",set:r+"setCSF",get:r+"getCSF",del:r+"delCSF",set2:r+"set2CSF"},RoutingSequence:{set2:r+"set2RTS",qry:r+"qryRTS"},Overhead:{qry:r+"qryOVH",set:r+"setOVH",get:r+"getOVH",del:r+"delOVH",page:r+"pageOVH",snapshot:r+"snapshotOVH"},Design:{qry:r+"qryDES",set:r+"setDES",get:r+"getDES",del:r+"delDES",snapshot:r+"snapshotDES",page:r+"pageDES"},MFJobOrder:{pack:r+"packJOB",qry:r+"qryJOB",qry2:r+"qryJOB2",set:r+"setJOB",get:r+"getJOB",get2:r+"get2JOB",del:r+"delJOB",snapshot:r+"snapshotJOB",snapshot2:r+"snapshotJOB2",snapshot3:r+"snapshotJOB3",cancel:r+"cancelJOB",post:r+"postJOB",start:r+"startJOB",stop:r+"stopJOB",wip:r+"wipJOB",sync:r+"syncJOB"},ProductionSheet:{page:r+"pagePST",qry:r+"qryPST",get:r+"getPST",set2:r+"set2PST",get2:r+"get2PST",del:r+"delPST",post:r+"postPST",unpost:r+"unpostPST",snapshot:r+"snapshotPST"},ProductionSheetItem:{qry:r+"qryPSI",set:r+"setPSI",get:r+"getPSI",del:r+"delPSI"},DocumentTypeDefault:{qry:r+"qryDTD",get:r+"getDTD",set:r+"setDTD",del:r+"delDTD",page:r+"pageDTD"},RawMaterialCategory:{qry:r+"qryRMC",get:r+"getRMC",set:r+"setRMC",del:r+"delRMC",page:r+"pageRMC"},WorksheetMaterials:{qry:r+"qryIMA",get:r+"getIMA",pack:r+"get2IMA",set:r+"setIMA",set2:r+"set2IMA",del:r+"delIMA",post:r+"postIMA"},ProductionSheetQueue:{qry:r+"qryPSQ"},Damage:{qry:r+"qryDMG",get:r+"getDMG",set:r+"setDMG",del:r+"delDMG",page:r+"pageDMG",snapshot:r+"snapshotDMG",post:r+"postDMG",get2:r+"get2DMG",set2:r+"set2DMG",preview:r+"previewDMG"},JobCategory:{qry:r+"qryJCA"},JobRouting:{qry:r+"qryJRO",get:r+"getJRO",set:r+"setJRO",set2:r+"set2JRO",del:r+"delJRO",sync:r+"syncJRO",close:r+"closeJRO",reopen:r+"reopenJRO"},Worksheet:{snapshot:r+"snapshotWST",get:r+"getWST",pack:r+"getPackWST",set:r+"setWST",del:r+"delWST",page:r+"pageWST",summary:r+"summaryWST",post:r+"postWST",qry2:r+"qryWST2",draft:r+"draftWST"},JobOverhead:{qry:r+"qryJOH",set2:r+"set2JOH",generate:r+"generateJOH"},JobMaterial:{qry:r+"qryJMA"},JobItemSize:{qry:r+"qryJSZ",set2:r+"set2JSZ"},MFSerial:{qry:r+"qrySRL",qry2:r+"qrySRL2",set2:r+"set2SRL",generate:r+"generateSRL"},SamplePack:{qry:r+"qrySPL",set2:r+"set2SPL"},DamageReturn:{get:r+"getDMR",set:r+"setDMR",del:r+"delDMR",page:r+"pageDMR",snapshot:r+"snapshotDMR",post:r+"postDMR"},ProductionOrder:{get2:r+"get2PO",set2:r+"set2PO",del:r+"delPO",page:r+"pagePO",snapshot:r+"snapshotPO",post:r+"postPO",gen:r+"genPO",close:r+"closePO"},BillOfMaterials:{get:r+"getBMA",qry2:r+"qry2BMA",set:r+"setBMA",del:r+"delBMA",page:r+"pageBMA",snapshot:r+"snapshotBMA"},Component:{get:r+"getBMI",qry:r+"qryBMI",del:r+"delBMI",set:r+"setBMI",set2:r+"set2BMI"},Assembly:{get:r+"getASM",set2:r+"set2ASM",del:r+"delASM",page:r+"pageASM",snapshot:r+"snapshotASM",post:r+"postASM",unpost:r+"unpostASM",generate:r+"genASM"},AssemblyItems:{qry:r+"qryASC"},AssemblyLot:{get:r+"getASL",set:r+"setASL"},AssemblyOverhead:{qry:r+"qryAOH",set2:r+"set2AOH"},MeasurementScheduleMap:{qry:r+"qryMSM",set:r+"setMSM",set2:r+"set2MSM",del:r+"delMSM"},JobCategory:{set:r+"setJCA",get:r+"getJCA",del:r+"delJCA",page:r+"pageJCA",qry:r+"qryJCA"},DesignGroup:{qry:r+"qryDEG",set:r+"setDEG",get:r+"getDEG",del:r+"delDEG",page:r+"pageDEG"},Components:{qry:r+"qryDEM",set2:r+"set2DEM"},DesignFamily:{qry:r+"qryDEF",set:r+"setDEF",get:r+"getDEF",del:r+"delDEF",page:r+"pageDEF"},ProductionShifts:{qry:r+"qrySHI",set:r+"setSHI",get:r+"getSHI",del:r+"delSHI",page:r+"pageSHI"},JobOrderWizard:{set2:r+"set2JOZ",get2:r+"get2JOZ",del:r+"delJOZ",page:r+"pageJOZ",snapshot:r+"snapshotJOZ",post:r+"postJOZ"},JobTransfer:{get2:r+"get2TFR",set2:r+"set2TFR",del:r+"delTFR",page:r+"pageTFR",snapshot:r+"snapshotTFR",post:r+"postTFR",close:r+"closeTFR",reopen:r+"reopenTFR",qry:r+"qryTFR"},JobWorkCenter:{qry:r+"qryJWC",close:r+"closeJWC",reopen:r+"reopenJWC",get:r+"getJWC",snapshot:r+"snapshotJWC",verify:r+"verifyJWC"},WorkCenterConsumption:{page:r+"pageCON",snapshot:r+"snapshotCON",del:r+"delCON",set2:r+"set2CON",get:r+"getCON",post:r+"postCON",unpost:r+"unpostCON",close:r+"closeCON",reopen:r+"reopenCON"},ConsumptionItemView:{qry:r+"qryCOI"},LineItemCapacity:{set2:r+"set2LIT",del:r+"delLIT",qry:r+"qryLIT",page:r+"pageLIT"},CostGroupOverhead:{set2:r+"set2CGV",qry:r+"qryCGV"},IssueOfMaterialDimension:{set:r+"setIMD",qry:r+"qryIMD"},JobOrder:{gen:r+"genORD"},RefreshPoItem:{refresh:r+"refreshPOI"},WorkCenterTransferMap:{qry:r+"qryWCTM",set2:r+"set2WCTM"},BatchWorksheet:{get2:r+"get2BWST",set2:r+"set2BWST",del:r+"delBWST",page:r+"pageBWST",snapshot:r+"snapshotBWST",post:r+"postBWST",gen:r+"genBWST",close:r+"closeBWST",reopen:r+"reopenBWST"},ProductionOrderFromSaleOrder:{gen:r+"generatePOFromSO"},BatchTransfer:{page:r+"pageBTFR",set2:r+"set2BTFR",del:r+"delBTFR",snapshot:r+"snapshotBTFR",get:r+"getBTFR",post:r+"postBTFR",unpost:r+"unpostBTFR"},BatchTransferJob:{qry:r+"qryBTFJ"},Disposal:{page:r+"pageDIS",snapshot:r+"snapshotDIS",get:r+"getDIS",set2:r+"set2DIS",del:r+"delDIS"},DisposalItem:{qry:r+"qryDII"},DisposalSerial:{qry:r+"qryDISRL"},MetalSetting:{page:r+"pageMTS",set:r+"setMTS",get:r+"getMTS",del:r+"delMTS"},DamageReason:{qry:r+"qryDRS",page:r+"pageDRS",set:r+"setDRS",get:r+"getDRS",del:r+"delDRS",snapshot:r+"snapshotDRS"},DamageCategory:{qry:r+"qryDCA",page:r+"pageDCA",set:r+"setDCA",get:r+"getDCA",del:r+"delDCA",snapshot:r+"snapshotDCA"}}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=34252)}),_N_E=e.O()}]);