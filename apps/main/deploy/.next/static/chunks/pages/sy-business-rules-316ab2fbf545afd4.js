(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[83197],{73834:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sy-business-rules",function(){return s(85414)}])},85414:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return g}});var l=s(52322),d=s(2784),u=s(62202),a=s(69387),i=s(27723),n=s(65950),t=s(38449),o=s(26612),c=s(31389),x=s(61802),m=s(71987),I=s(33625),v=s(62362),y=s(19473),h=s(60218),p=s(48601),f=s(82737),_=s(80983),N=s(84100),Z=s(8661),E=s(19689);function P(e){var r;let{labels:s,obj:a,window:i,maxAccess:x}=e,{platformLabels:I}=(0,d.useContext)(y.l),{getRequest:P,postRequest:g}=(0,d.useContext)(n.$),j=(0,m.E)({endpointId:t.r.BusinessRules.qry}),{formik:F}=(0,_.c)({initialValues:{recordId:null,resourceId:"",moduleId:"",ruleEndPoint:null,ruleId:null,trxType:"",isActive:!1},maxAccess:x,validateOnChange:!0,validationSchema:p.Ry({moduleId:p.Z_().required(),resourceId:p.Z_().required(),ruleId:p.Z_().required(),ruleEndPoint:p.Z_().required(),trxType:p.Z_().required()}),onSubmit:async e=>{let r=e.recordId,s=await g({extension:t.r.BusinessRules.set,record:JSON.stringify(e)});r?u.ZP.success(I.Edited):(u.ZP.success(I.Added),F.setFieldValue("recordId",s.recordId)),j(),i.close()}}),q=!!F.values.recordId;return(0,d.useEffect)(()=>{!async function(){if(null==a?void 0:a.recordId){let e=await P({extension:t.r.BusinessRules.get,parameters:"_recordId=".concat(a.recordId)});F.setValues({...e.record,moduleId:parseInt(e.record.resourceId/1e3).toString()})}}()},[]),(0,l.jsx)(f.Z,{resourceId:o.i.BusinessRules,form:F,maxAccess:x,editMode:q,isCleared:!1,children:(0,l.jsx)(c.R,{children:(0,l.jsx)(v.Q,{children:(0,l.jsxs)(h.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.Z,{datasetId:N.v.MODULE,label:s.module,name:"moduleId",values:F.values,valueField:"key",displayField:"value",readOnly:q,required:!0,onChange:(e,r)=>{F.setFieldValue("moduleId",r?r.key:""),F.setFieldValue("resourceId",""),F.setFieldValue("ruleId","")},error:F.touched.moduleId&&!!F.errors.moduleId})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.Z,{endpointId:F.values.moduleId&&t.r.ModuleClassRES.qry,parameters:"_moduleId=".concat(F.values.moduleId,"&_filter="),label:s.res,readOnly:!F.values.moduleId||q,name:"resourceId",values:F.values,required:!0,valueField:"key",displayField:"value",onChange:(e,r)=>{F.setFieldValue("resourceId",r?r.key:""),F.setFieldValue("trxType",r?r.key:"")},error:F.touched.resourceId&&!!F.errors.resourceId})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.Z,{endpointId:F.values.resourceId&&t.r.Rules.qry,parameters:"_resourceId=".concat(F.values.resourceId,"&_filter="),name:"ruleId",label:s.rule,readOnly:!F.values.resourceId||q,valueField:"seqNo",required:!0,displayField:"description",values:F.values,maxAccess:x,onChange:(e,r)=>{F.setFieldValue("ruleId",r?null==r?void 0:r.seqNo:"")},error:F.touched.ruleId&&!!F.errors.ruleId})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.Z,{datasetId:N.v.RULE_END_POINT,name:"ruleEndPoint",label:s.ruleEnd,readOnly:q,required:!0,valueField:"key",displayField:"value",values:F.values,onChange:(e,r)=>{F.setFieldValue("ruleEndPoint",(null==r?void 0:r.key)||null)},error:F.touched.ruleEndPoint&&!!F.errors.ruleEndPoint})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(Z.Z,{datasetId:N.v.TRX_TYPE,readOnly:q,name:"trxType",required:!0,label:s.ttype,valueField:"key",displayField:"value",values:F.values,onChange:(e,r)=>{F.setFieldValue("trxType",(null==r?void 0:r.key)||null)},error:F.touched.trxType&&!!F.errors.trxType})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,children:(0,l.jsx)(E.Z,{name:"isActive",value:null===(r=F.values)||void 0===r?void 0:r.isActive,onChange:e=>F.setFieldValue("isActive",e.target.checked),label:s.isActive,maxAccess:x})})]})})})})}var g=()=>{let{getRequest:e,postRequest:r}=(0,d.useContext)(n.$),{platformLabels:s}=(0,d.useContext)(y.l),{stack:h}=(0,x.zY)();async function p(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:s=0,_pageSize:l=50}=r;return{...await e({extension:t.r.BusinessRules.qry,parameters:"_startAt=".concat(s,"&_pageSize=").concat(l,"&_filter=&_countryId=0&_stateId=0")}),_startAt:s}}let{query:{data:f},labels:_,refetch:N,invalidate:Z,paginationParameters:E,access:g}=(0,m.J)({queryFn:p,endpointId:t.r.BusinessRules.qry,datasetId:o.i.BusinessRules}),j=[{field:"resourceName",headerName:_.resourceName,flex:1},{field:"trxTypeName",headerName:_.trxTypeName,flex:1},{field:"ruleEndPointName",headerName:_.ruleEndPointName,flex:1},{field:"ruleName",headerName:_.ruleName,flex:1},{field:"isActive",headerName:_.isActive,type:"checkbox",flex:1}],F=async e=>{try{await r({extension:t.r.BusinessRules.del,record:JSON.stringify(e)}),Z(),u.ZP.success(s.Deleted)}catch(e){}};function q(e){h({Component:P,props:{labels:_,maxAccess:g,obj:e},width:500,height:460,title:_.businessRules})}return(0,l.jsxs)(c.R,{children:[(0,l.jsx)(I.g,{children:(0,l.jsx)(i.Z,{onAdd:()=>{q()},maxAccess:g,labels:_,refetch:N})}),(0,l.jsx)(v.Q,{children:(0,l.jsx)(a.Z,{columns:j,gridData:f,rowId:["recordId"],onEdit:e=>{q(e)},onDelete:F,maxAccess:g,pageSize:50,paginationParameters:E,paginationType:"api"})})]})}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=73834)}),_N_E=e.O()}]);