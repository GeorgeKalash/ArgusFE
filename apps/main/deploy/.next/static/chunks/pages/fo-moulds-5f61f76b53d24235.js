(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[52762],{31958:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fo-moulds",function(){return r(29229)}])},29229:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return C}});var t=r(52322),a=r(2784),i=r(62202),d=r(69387),s=r(65950),l=r(71987),o=r(26612),c=r(31389),u=r(33625),f=r(62362),p=r(61802),m=r(19473),x=r(36908),h=r(36773),_=r(60218),g=r(48601),I=r(82737),y=r(8661),v=r(80983),w=r(90587),j=r(5088);function A(e){let{labels:n,maxAccess:r,recordId:d,window:u}=e,{getRequest:p,postRequest:x}=(0,a.useContext)(s.$),{platformLabels:A}=(0,a.useContext)(m.l),C=(0,l.E)({endpointId:h.B.Mould.page}),{formik:M}=(0,v.c)({initialValues:{recordId:d,reference:"",lineId:null},maxAccess:r,validateOnChange:!0,validationSchema:g.Ry({reference:g.Z_().required()}),onSubmit:async e=>{await x({extension:h.B.Mould.set,record:JSON.stringify(e)}),d||M.setFieldValue("recordId",e.recordId),i.ZP.success(e.recordId?A.Edited:A.Added),C(),u.close()}}),N=!!M.values.recordId;return(0,a.useEffect)(()=>{!async function(){if(d){let e=await p({extension:h.B.Mould.get,parameters:"_recordId=".concat(d)});M.setValues(e.record)}}()},[]),(0,t.jsx)(I.Z,{resourceId:o.i.Moulds,form:M,maxAccess:r,editMode:N,children:(0,t.jsx)(c.R,{children:(0,t.jsx)(f.Q,{children:(0,t.jsxs)(_.ZP,{container:!0,spacing:2,children:[(0,t.jsx)(_.ZP,{item:!0,xs:12,children:(0,t.jsx)(j.Z,{name:"reference",label:n.reference,value:M.values.reference,required:!0,maxLength:"15",maxAccess:r,onChange:M.handleChange,onClear:()=>M.setFieldValue("reference",""),error:M.touched.reference&&!!M.errors.reference})}),(0,t.jsx)(_.ZP,{item:!0,xs:12,children:(0,t.jsx)(y.Z,{endpointId:w.u.ProductionLine.qry,parameters:"_startAt=0&_pageSize=1000",values:M.values,name:"lineId",label:n.productionLine,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],maxAccess:r,onChange:(e,n)=>{M.setFieldValue("lineId",(null==n?void 0:n.recordId)||null)},error:M.touched.lineId&&!!M.errors.lineId})})]})})})})}var C=()=>{let{getRequest:e,postRequest:n}=(0,a.useContext)(s.$),{platformLabels:r}=(0,a.useContext)(m.l),{stack:_}=(0,p.zY)();async function g(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:t=50,params:a}=n;return{...await e({extension:h.B.Mould.page,parameters:"_startAt=".concat(r,"&_pageSize=").concat(t,"&_params=").concat(a||"")}),_startAt:r}}let{query:{data:I},labels:y,paginationParameters:v,refetch:w,access:j,invalidate:C,filterBy:M}=(0,l.J)({queryFn:g,endpointId:h.B.Mould.page,datasetId:o.i.Moulds,filter:{filterFn:Z}}),N=[{field:"reference",headerName:y.reference,flex:1},{field:"lineName",headerName:y.productionLine,flex:1}];async function Z(n){let{filters:r,pagination:t}=n;return(null==r?void 0:r.qry)?await e({extension:h.B.Mould.snapshot,parameters:"_filter=".concat(r.qry)}):g({_startAt:t._startAt||0,params:null==r?void 0:r.params})}function E(e){_({Component:A,props:{labels:y,recordId:e,maxAccess:j},width:550,height:400,title:y.Moulds})}let F=async e=>{await n({extension:h.B.Mould.del,record:JSON.stringify(e)}),C(),i.ZP.success(r.Deleted)};return(0,t.jsxs)(c.R,{children:[(0,t.jsx)(u.g,{children:(0,t.jsx)(x.Z,{labels:y,maxAccess:j,filterBy:M,onAdd:()=>{E()},reportName:"FOMOU"})}),(0,t.jsx)(f.Q,{children:(0,t.jsx)(d.Z,{name:"table",columns:N,gridData:I,rowId:["recordId"],onEdit:e=>{E(null==e?void 0:e.recordId)},onDelete:F,isLoading:!1,pageSize:50,paginationType:"api",paginationParameters:v,refetch:w,maxAccess:j})})]})}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=31958)}),_N_E=e.O()}]);