(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[65340],{10551:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ca-open-tfm",function(){return a(66476)}])},66476:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return T}});var t=a(52322),r=a(2784),l=a(8661),c=a(65950),s=a(38449),d=a(27723),i=a(69387),o=a(71987),u=a(23925),f=a(44258),m=a(60218),h=a(48601),p=a(26612),v=a(80983),I=a(31389),y=a(33625),x=a(62362),g=a(19473),N=a(62202),w=a(65215),C=a(61802),A=a(2119),_=a(27423),b=a(54074);function S(e){let{labels:n,maxAccess:a,recordId:l,plId:s,window:d}=e,{postRequest:i}=(0,r.useContext)(c.$),{platformLabels:u}=(0,r.useContext)(g.l),f=(0,o.E)({endpointId:A.G.OpenMultiCurrencyCashTransfer.open}),{formik:p}=(0,v.c)({initialValues:{recordId:l,cashAccountId:"",cashAccountRef:"",cashAccountName:""},maxAccess:a,validateOnChange:!0,validationSchema:h.Ry({cashAccountId:h.Z_().required()}),onSubmit:async e=>{await i({extension:A.G.OpenMultiCurrencyCashTransfer.set,record:JSON.stringify(e)}),N.ZP.success(u.Submit),d.close(),f()}});return(0,t.jsx)(b.Z,{onSave:p.handleSubmit,maxAccess:a,children:(0,t.jsx)(I.R,{children:(0,t.jsx)(x.Q,{children:(0,t.jsx)(m.ZP,{container:!0,spacing:2,children:(0,t.jsx)(m.ZP,{item:!0,xs:12,children:(0,t.jsx)(_.U,{endpointId:A.G.CashAccount.snapshot,parameters:{_type:0},required:!0,name:"cashAccountId",label:n.cashAccount,valueField:"reference",displayField:"name",filter:{plantId:s},valueShow:"cashAccountRef",secondValueShow:"cashAccountName",form:p,onChange:(e,n)=>{p.setFieldValue("cashAccountId",(null==n?void 0:n.recordId)||""),p.setFieldValue("cashAccountRef",(null==n?void 0:n.reference)||""),p.setFieldValue("cashAccountName",(null==n?void 0:n.name)||"")},error:p.touched.cashAccountId&&!!p.errors.cashAccountId,maxAccess:a})})})})})})}var j=a(1685),O=a(9737),Z=a(57981),T=()=>{let[e,n]=(0,r.useState)([]),{getRequest:a,postRequest:_}=(0,r.useContext)(c.$),{platformLabels:b}=(0,r.useContext)(g.l),{stack:T}=(0,C.zY)(),D=(0,j.m)("userData").userId,k=async()=>{if(!V.values.plantId){n([]);return}n(await a({extension:A.G.OpenMultiCurrencyCashTransfer.open,parameters:"_plantId=".concat(V.values.plantId)})||[])},{labels:F,access:R,invalidate:P,refetch:E}=(0,o.J)({queryFn:k,endpointId:A.G.OpenMultiCurrencyCashTransfer.open,datasetId:p.i.OpenMultiCurrencyCashTransfer}),{formik:V}=(0,v.c)({initialValues:{plantId:""},access:R,validateOnChange:!0,validationSchema:h.Ry({plantId:h.Z_().required()})});(0,r.useEffect)(()=>{!async function(){let e=await a({extension:s.r.UserDefaults.get,parameters:"_userId=".concat(D,"&_key=plantId")});V.setFieldValue("plantId",parseInt(e.record.value)||"")}()},[]);let q=[{field:"reference",headerName:F.reference,flex:1},{field:"date",headerName:F.date,flex:1,type:"date"},{field:"fromPlantName",headerName:F.fromPlant,flex:1},{field:"toPlantName",headerName:F.toPlant,flex:1},{field:"fromCAName",headerName:F.fromCashAcc,flex:1},{field:"toCAName",headerName:F.toCashAcc,flex:1},{field:"rsName",headerName:F.releaseStatus,flex:1},{field:"statusName",headerName:F.status,flex:1},{field:"wipName",headerName:F.wip,flex:1},{field:"",cellRenderer:e=>(0,t.jsx)(u.Z,{sx:{display:"flex",width:"100%",justifyContent:"center"},children:(0,t.jsx)(f.Z,{size:"small",onClick:()=>{var n;T({Component:Z.Z,props:{recordId:null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.recordId,refetch:()=>{E()}}})},children:(0,t.jsx)(O.Z,{icon:"mdi:application-edit-outline",fontSize:18})})})}],M=async e=>{try{await _({extension:w.$.Dimension.del,record:JSON.stringify(e)}),P(),N.ZP.success(b.Deleted)}catch(e){}};return(0,r.useEffect)(()=>{k()},[V.values.plantId]),(0,t.jsxs)(I.R,{children:[(0,t.jsxs)(y.g,{children:[(0,t.jsx)(d.Z,{maxAccess:R}),(0,t.jsx)(m.ZP,{container:!0,spacing:2,sx:{pl:5,mb:2},children:(0,t.jsx)(m.ZP,{item:!0,xs:4,children:(0,t.jsx)(l.Z,{endpointId:s.r.Plant.qry,name:"plantId",label:F.plant,valueField:"recordId",displayField:"name",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:V.values,maxAccess:R,onClear:()=>V.setFieldValue("plantId",""),onChange:(e,n)=>{V&&V.setFieldValue("plantId",null==n?void 0:n.recordId)},error:!V.values.plantId})})})]}),(0,t.jsx)(x.Q,{children:(0,t.jsx)(i.Z,{columns:q,gridData:e||[],rowId:["id"],pageSize:50,onEdit:e=>{T({Component:S,props:{labels:F,recordId:null==e?void 0:e.recordId,maxAccess:R,plId:V.values.plantId},width:500,height:270,title:F.openmulti})},paginationType:"client",refetch:E,isLoading:!1,onDelete:M,maxAccess:R})})]})}},1685:function(e,n,a){"use strict";a.d(n,{m:function(){return t}});let t=e=>{let n=window.sessionStorage.getItem(e);return n?JSON.parse(n):null}},98345:function(e,n,a){"use strict";a.d(n,{H:function(){return p},G:function(){return h}});var t=a(45300),r=a(2784),l=a(96026),c=a(38449);a(26612);var s=a(65947),d=a(1685);let i=async(e,n,a)=>{try{let t=await e({extension:n,parameters:a});return n.includes("qry")?t:t.record}catch(e){return null}},o=(e,n,a,t)=>{let r=(e=JSON.parse(JSON.stringify(e))).record.controls,l=r.find(e=>"reference"===e.controlId);return l?l.accessLevel=(null==n?void 0:n.mandatory)?s.$7:s.rr:(null==n?void 0:n.mandatory)?r.push({sgId:0,resourceId:"",controlId:"".concat(t?t+".":"","reference"),accessLevel:(null==n?void 0:n.mandatory)?s.$7:s.rr}):(null==n?void 0:n.readOnly)?r.push({sgId:0,resourceId:"",controlId:"".concat(t?t+".":"","reference"),accessLevel:(null==n?void 0:n.readOnly)?s.rr:s.$7}):r=e.record.controls.filter(e=>"reference"!=e.controlId),a&&r.push({sgId:0,resourceId:"",controlId:"".concat(t?t+".":"","dtId"),accessLevel:s.$7}),{...e,record:{...e.record,controls:r}}},u=async(e,n,a)=>{let t,r;switch(a){case"dtId":let l=(0,d.m)("userData"),s=null==l?void 0:l.userId;r="_userId=".concat(s,"&_functionId=").concat(n),t=c.r.UserFunction.get;break;case"glbSysNumberRange":r="_recordId=".concat(n),t=c.r.SystemFunction.get;break;case"DocumentType":r="_dgId=".concat(n,"&_startAt=",0,"&_pageSize=",50),t=c.r.DocumentType.qry;break;case"DcTypNumberRange":r="_recordId=".concat(n),t=c.r.DocumentType.get;break;case"isExternal":r="_recordId=".concat(n),t=c.r.NumberRange.get;break;default:return null}return await i(e,t,r)},f=async function(e){let n,a,t,r,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,d=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=arguments.length>5?arguments[5]:void 0,f=void 0===s&&l&&await u(e,l,"dtId"),m=null==f?void 0:f.dtId,h="",p=!0;if(f&&void 0===s||"nraId"===s){if(m){let a=await u(e,m,"DcTypNumberRange");n=null==a?void 0:a.nraId,p=!((null==a?void 0:a.activeStatus)<0),n||(h="Assign the document type to a number range")}if((!m||!p)&&d&&l){var v;let n=await u(e,l,"DocumentType");r=(null==n?void 0:null===(v=n.list)||void 0===v?void 0:v.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===s||void 0===s)&&l){if((!m||m)&&!n||n&&!p){let a=await u(e,l,"glbSysNumberRange");(n=null==a?void 0:a.nraId)&&r&&(r=!1),p=!0}h=n||r?"":"Assign the system Function to a number range"}s>0&&!n&&(n=s),n&&p?(a={readOnly:null==(t=await u(e,n,"isExternal"))||!t.external,mandatory:null!=t&&!!t.external},c&&(c=await o(c,a,r,i))):!n&&c&&(c=await o(c,a,r,i));let I=i?"".concat(i,".reference"):"reference";return{dtId:m,resetReference:null==a?void 0:a.readOnly,dcTypeRequired:r,reference:{fieldName:I,isEmpty:(null==t?void 0:t.external)!==void 0&&(null==t||!t.external)},errorMessage:h,maxAccess:c,selectNraId:s}};var m=a(65950);function h(e){let{functionId:n,action:a,hasDT:t}=e,{getRequest:c}=(0,r.useContext)(m.$),{stack:s}=(0,l.V)();return{proxyAction:async()=>{let e=await f(c,n,"",void 0,t);(null==e?void 0:e.errorMessage)?s({message:null==e?void 0:e.errorMessage}):await a()}}}function p(e){var n;let{functionId:a,access:c,hasDT:s,enabled:d=!0,objectName:i=""}=e,{getRequest:o}=(0,r.useContext)(m.$),{stack:u}=(0,l.V)(),[h,p]=(0,r.useState)(),v=async e=>{let n=await f(o,a,c,e,s,i);if(!n.errorMessage)return n;u({message:null==n?void 0:n.errorMessage})},I=(0,t.a)({retry:!1,staleTime:0,enabled:d,queryKey:[a,h,!!c,d],queryFn:h||"nraId"===h?()=>v(h):()=>v()});return{documentType:I.data,maxAccess:(null==I?void 0:null===(n=I.data)||void 0===n?void 0:n.maxAccess)||c,changeDT(e){p((null==e?void 0:e.nraId)||"nraId")}}}},30390:function(e,n,a){"use strict";a.d(n,{Z:function(){return l}});var t=a(52322),r=a(60218);function l(e){let{hideonempty:n=!1,children:a,...l}=e;return(0,t.jsx)(r.ZP,{...l,className:n?"__hide-on-empty":"",children:a})}}},function(e){e.O(0,[78451,57981,49774,92888,40179],function(){return e(e.s=10551)}),_N_E=e.O()}]);