(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[42607],{47065:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/strategies",function(){return t(1842)}])},1842:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return E}});var r=t(52322),d=t(2784),s=t(62202),n=t(61802),o=t(69387),l=t(27723),i=t(29326),c=t(9522),u=t(68676),m=t(65950),p=t(60218),y=t(82737),x=t(26612),I=t(8661),h=t(48601),g=t(80983),b=t(71987),f=t(31389),v=t(62362),_=e=>{let{labels:a,editMode:t,maxAccess:n,recordId:o,store:l,window:i}=e,{postRequest:c,getRequest:_}=(0,d.useContext)(m.$),S=(0,b.E)({endpointId:u.y.StrategyCode.qry}),{recordId:C}=l,{formik:j}=(0,g.c)({maxAccess:n,initialValues:{codeId:"",groupId:l.groupId,strategyId:C},validateOnChange:!0,validationSchema:h.Ry({codeId:h.Z_().required()}),onSubmit:async e=>{await q(e),i.close()}}),q=async e=>{await c({extension:u.y.StrategyCode.set,record:JSON.stringify(e)}),s.ZP.success(e.recordId?platformLabels.Edited:platformLabels.Added),S()};(0,d.useEffect)(()=>{o&&Z(o)},[o]);let Z=e=>{_({extension:u.y.GroupCode.qry,parameters:"_groupId=".concat(l.groupId)}).then(e=>{j.setValues(e.record)})};return(0,r.jsx)(y.Z,{form:j,isInfo:!1,resourceId:x.i.Strategies,maxAccess:n,editMode:t,children:(0,r.jsx)(f.R,{children:(0,r.jsx)(v.Q,{children:(0,r.jsx)(p.ZP,{container:!0,spacing:2,children:(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(I.Z,{endpointId:u.y.GroupCode.qry,parameters:"_groupId=".concat(l.groupId),name:"codeId",label:a.code,valueField:"codeId",displayField:"codeRef",columnsInDropDown:[{key:"codeRef",value:"Reference"},{key:"codeName",value:"Name"}],values:j.values,required:!0,readOnly:t,maxAccess:n,onClear:()=>j.setFieldValue("codeId",""),onChange:(e,a)=>{j.setFieldValue("codeId",null==a?void 0:a.codeId)},error:j.touched.codeId&&!!j.errors.codeId})})})})})})},S=t(33625),C=e=>{let{store:a,labels:t,maxAccess:i}=e,{getRequest:c,postRequest:p}=(0,d.useContext)(m.$),{recordId:y}=a,{stack:I}=(0,n.zY)(),[h,g]=(0,d.useState)();async function C(){return await c({extension:u.y.StrategyCode.qry,parameters:"&_strategyId=".concat(y)})}let{query:{data:j},labels:q,refetch:Z}=(0,b.J)({enabled:!!y,datasetId:x.i.Strategies,queryFn:C,endpointId:u.y.StrategyCode.qry}),A=[{field:"code",headerName:t.code,flex:1},{field:"name",headerName:t.name,flex:1}],N=async e=>{try{await p({extension:u.y.StrategyCode.del,record:JSON.stringify(e)}),Z(),s.ZP.success("Record Deleted Successfully")}catch(e){s.ZP.error("Record cannot be deleted")}};return(0,r.jsxs)(f.R,{children:[(0,r.jsx)(S.g,{children:(0,r.jsx)(l.Z,{onAdd:()=>{I({Component:_,props:{labels:t,recordId:void 0,maxAccess:i,store:a},width:500,height:300,title:t.code})},maxAccess:i})}),(0,r.jsx)(v.Q,{children:(0,r.jsx)(o.Z,{name:"code",columns:A,gridData:j,rowId:["codeId"],isLoading:!1,pageSize:50,pagination:!1,onDelete:N,maxAccess:i})})]})},j=t(84100),q=t(5088),Z=t(19473),A=e=>{var a;let{labels:t,maxAccess:n,setStore:o,store:l,onChange:i}=e,{postRequest:c,getRequest:_}=(0,d.useContext)(m.$),{platformLabels:S}=(0,d.useContext)(Z.l),{recordId:C}=l,A=(0,b.E)({endpointId:u.y.Strategy.qry}),{formik:N}=(0,g.c)({maxAccess:n,initialValues:{recordId:null,name:"",type:"",groupId:""},validateOnChange:!0,validationSchema:h.Ry({name:h.Z_().required(),groupId:h.Z_().required(),type:h.Z_().required()}),onSubmit:async e=>{await R(e)}}),P=!!C;(0,d.useEffect)(()=>{i(N.values)},[N.values]);let R=async e=>{let a=!(null==e?void 0:e.recordId),t=await c({extension:u.y.Strategy.set,record:JSON.stringify(e)}),r=a?S.Added:S.Edited;s.ZP.success(r),a&&(N.setFieldValue("recordId",t.recordId),o(e=>({...e,recordId:t.recordId}))),A()};(0,d.useEffect)(()=>{C&&w(C)},[]);let w=e=>{_({extension:u.y.Strategy.get,parameters:"_recordId=".concat(e)}).then(e=>{N.setValues(e.record)})};return(0,r.jsx)(y.Z,{form:N,resourceId:x.i.Strategies,maxAccess:n,editMode:P,children:(0,r.jsx)(f.R,{children:(0,r.jsx)(v.Q,{children:(0,r.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(q.Z,{name:"name",label:t.name,value:null==N?void 0:null===(a=N.values)||void 0===a?void 0:a.name,required:!0,maxLength:"50",maxAccess:n,onChange:N.handleChange,onClear:()=>N.setFieldValue("name",""),error:N.touched.name&&!!N.errors.name})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(I.Z,{endpointId:u.y.DRGroup.qry,parameters:"_startAt=0&_pageSize=100",name:"groupId",label:t.groupStrat,valueField:"recordId",displayField:"name",values:N.values,required:!0,readOnly:P,maxAccess:n,onChange:(e,a)=>{N&&N.setFieldValue("groupId",null==a?void 0:a.recordId)},error:N.touched.groupId&&!!N.errors.groupId})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(I.Z,{datasetId:j.v.SY_TYPE,name:"type",label:t.type,valueField:"key",displayField:"value",values:N.values,required:!0,maxAccess:n,onChange:(e,a)=>{N.setFieldValue("type",null==a?void 0:a.key)},error:N.touched.type&&!!N.errors.type})})]})})})})},N=e=>{let{labels:a,editMode:t,maxAccess:n,recordId:o,store:l}=e,{postRequest:i,getRequest:c}=(0,d.useContext)(m.$),[_,S]=(0,d.useState)(""),C=(0,b.E)({endpointId:u.y.StrategyPrereq.qry}),{recordId:j}=l,q=h.Ry({codeId:h.Rx().required(),prerequisiteId:h.Rx().required()}),{formik:Z}=(0,g.c)({maxAccess:n,initialValues:{codeId:"",prerequisiteId:"",StrategyId:j},validateOnChange:!0,validationSchema:q,onSubmit:e=>{A(e)}}),A=async e=>{await i({extension:u.y.StrategyPrereq.set,record:JSON.stringify(e)}),s.ZP.success(e.recordId?platformLabels.Edited:platformLabels.Added),C()};(0,d.useEffect)(()=>{o&&N(o)},[o]);let N=e=>{"_codeId=".concat(e,"&_groupId=").concat(j),c({extension:u.y.StrategyCode.get,parameters:"_groupId=".concat(o)}).then(e=>{Z.setValues(e.record)})};return(0,r.jsx)(y.Z,{form:Z,isInfo:!1,resourceId:x.i.Strategies,maxAccess:n,editMode:t,children:(0,r.jsx)(f.R,{children:(0,r.jsx)(v.Q,{children:(0,r.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(I.Z,{endpointId:u.y.StrategyCode.qry,parameters:"_startAt=".concat(0,"&_pageSize=",100,"&_strategyId=").concat(j),name:"codeId",label:a.code,valueField:"codeId",displayField:"code",values:Z.values,required:!0,readOnly:t,onClear:()=>{Z.setFieldValue("codeId",""),Z.setFieldTouched("codeId",!1)},maxAccess:n,onChange:(e,a)=>{let t=a?a.codeId:"";Z.setFieldValue("codeId",t),S(t)},error:Z.touched.codeId&&!!Z.errors.codeId})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(I.Z,{endpointId:Z.values.codeId&&u.y.StrategyCode.qry,parameters:Z.values.codeId&&"_strategyId=".concat(j),name:"prerequisiteId",label:a.prere,valueField:"codeId",displayField:"code",values:Z.values,readOnly:t,maxAccess:n,filter:e=>e.codeId!==_,onClear:()=>{Z.setFieldValue("prerequisiteId",""),Z.setFieldTouched("prerequisiteId",!1)},onChange:(e,a)=>{let t=a?a.codeId:"";Z.setFieldValue("prerequisiteId",t)},error:Z.touched.prerequisiteId&&!!Z.errors.prerequisiteId})})]})})})})},P=e=>{let{store:a,labels:t,maxAccess:i}=e,{getRequest:c,postRequest:p}=(0,d.useContext)(m.$),{recordId:y}=a,{stack:I}=(0,n.zY)();async function h(){return await c({extension:u.y.StrategyPrereq.qry,parameters:"&_strategyId=".concat(y)})}let{query:{data:g},labels:_,refetch:C}=(0,b.J)({enabled:!!y,datasetId:x.i.Strategies,queryFn:h,endpointId:u.y.StrategyPrereq.qry}),j=[{field:"code",headerName:t.code,flex:1},{field:"prerequisiteCode",headerName:t.prerequisite,flex:1}],q=async e=>{await p({extension:u.y.StrategyPrereq.del,record:JSON.stringify(e)}),C(),s.ZP.success("Record Deleted Successfully")};return(0,r.jsxs)(f.R,{children:[(0,r.jsx)(S.g,{children:(0,r.jsx)(l.Z,{onAdd:()=>{I({Component:N,props:{labels:t,recordId:null,maxAccess:i,store:a},width:500,height:300,title:t.prere})},maxAccess:i})}),(0,r.jsx)(v.Q,{children:(0,r.jsx)(o.Z,{name:"preReq",columns:j,gridData:g,rowId:["code"],isLoading:!1,pageSize:50,pagination:!1,onDelete:q,maxAccess:i})})]})},R=t(76399),w=t(54074),F=e=>{var a;let{labels:t,editMode:n,maxAccess:o,store:l}=e,[i,c]=(0,d.useState)([]),{postRequest:p}=(0,d.useContext)(m.$),{getRequest:y}=(0,d.useContext)(m.$),{recordId:x}=l,[I,b]=(0,d.useState)(0),{formik:f}=(0,g.c)({maxAccess:o,validateOnChange:!0,initialValues:{indicatorData:[{id:1,strategyId:x,seqNo:"",codeId:"",name:"",indicatorId:"",indicatorName:""}]},validationSchema:h.Ry({indicatorData:h.IX().of(null===(a=h.Ry())||void 0===a?void 0:a.shape({indicatorName:h.Z_().required()})).required()}),onSubmit:async e=>{await _(e.indicatorData)}}),_=async e=>{0!==e.length&&Promise.all(e.map(e=>{let{id:a,indicatorRef:t,indicatorName:r,...d}=e;return d.strategyId=x,p({extension:u.y.StrategyIndicator.set,record:JSON.stringify(d)})})).then(e=>{s.ZP.success("Records Edited Successfully")}).catch(e=>{s.ZP.error("An error occurred while editing records")})},S=e=>{y({extension:u.y.StrategyIndicator.qry,parameters:"_strategyId=".concat(e)}).then(e=>{let a=e.list.map((e,a)=>({id:a+1,...e,strtategyId:e.strategyId}));c(a),f.setValues({indicatorData:a})}).catch(e=>{console.error("Error fetching grid data:",e)})};(0,d.useEffect)(()=>{x&&S(x)},[x,I]);let C=async()=>{let{groupName:e,...a}=l;await p({extension:u.y.ApplySTG.apply,record:JSON.stringify(a)}),s.ZP.success("Strategy Applied Successfully"),b(e=>e+1)},j=[{component:"numberfield",label:t.seqNo,name:"seqNo",min:1},{component:"textfield",label:t.name,name:"name",props:{readOnly:!0}},{component:"resourcecombobox",label:t.indicator,name:"indicatorName",props:{endpointId:u.y.ReleaseIndicator.qry,parameters:"_startAt=0&_pageSize=50",valueField:"recordId",displayField:"name",mapping:[{from:"name",to:"indicatorName"},{from:"reference",to:"indicatorRef"},{from:"recordId",to:"indicatorId"}],columnsInDropDown:[{key:"reference",value:"Ref"},{key:"name",value:"Name"}]}}];return(0,r.jsx)(w.Z,{onSave:f.handleSubmit,maxAccess:o,editMode:n,actions:[{key:"Apply",condition:!0,onClick:()=>{C()},disabled:!1}],isParentWindow:!1,children:(0,r.jsx)(v.Q,{children:(0,r.jsx)(R._,{onChange:e=>f.setFieldValue("indicatorData",e),value:f.values.indicatorData,error:f.errors.indicatorData,columns:j,allowDelete:!1,allowAddNewLine:!1})})})},T=e=>{let{height:a,recordId:t,labels:s,maxAccess:n,expanded:o,onApply:l}=e,[u,m]=(0,d.useState)(0),p=!!t,[y,x]=(0,d.useState)({recordId:t||null}),I=[{label:s.strategy},{label:s.code,disabled:!y.recordId},{label:s.prere,disabled:!y.recordId},{label:s.indicator,disabled:!y.recordId}];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Y,{tabs:I,activeTab:u,setActiveTab:m,maxAccess:n}),(0,r.jsx)(i.Z,{index:0,value:u,disabledApply:!p,maxAccess:n,children:(0,r.jsx)(A,{labels:s,setStore:x,store:y,maxAccess:n,onChange:function(e){x({...y,...e})}})}),(0,r.jsx)(i.Z,{index:1,value:u,maxAccess:n,children:(0,r.jsx)(C,{labels:s,setStore:x,maxAccess:n,store:y})}),(0,r.jsx)(i.Z,{index:2,value:u,maxAccess:n,children:(0,r.jsx)(P,{labels:s,setStore:x,maxAccess:n,store:y})}),(0,r.jsx)(i.Z,{index:3,value:u,onApply:l,maxAccess:n,children:(0,r.jsx)(F,{labels:s,height:a,expanded:o,maxAccess:n,store:y})})]})},D=t(21346),E=()=>{let{getRequest:e,postRequest:a}=(0,d.useContext)(m.$),{platformLabels:t}=(0,d.useContext)(Z.l),[i,c]=(0,d.useState)(null),{stack:p}=(0,n.zY)(),[y,I]=(0,d.useState)(!1),[h,g]=(0,d.useState)(null);async function _(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:r=50}=a;return await e({extension:u.y.Strategy.qry,parameters:"_startAt=".concat(t,"&_pageSize=").concat(r,"&filter=")})}let{query:{data:C},labels:j,paginationParameters:q,search:A,refetch:N,clear:P,access:R}=(0,b.J)({queryFn:_,endpointId:u.y.Strategy.qry,datasetId:x.i.Strategies,search:{endpointId:u.y.Strategy.snapshot,searchFn:w}});async function w(a){let{qry:t}=a;return await e({extension:u.y.Strategy.snapshot,parameters:"_filter=".concat(t)})}let F=(0,b.E)({endpointId:u.y.Strategy.qry}),E=[{field:"name",headerName:j.name,flex:1},{field:"groupName",headerName:j.groupStrat,flex:1}];function V(e){p({Component:T,props:{labels:j,recordId:e||null,maxAccess:R},width:600,height:400,title:j.strategy})}let O=async e=>{await a({extension:u.y.Strategy.del,record:JSON.stringify(e)}),F(),s.ZP.success(t.Deleted)};return(0,r.jsxs)(f.R,{children:[(0,r.jsx)(S.g,{children:(0,r.jsx)(l.Z,{onAdd:()=>{V()},maxAccess:R,onSearch:A,onSearchClear:P,inputSearch:!0,labels:j})}),(0,r.jsx)(v.Q,{children:(0,r.jsx)(o.Z,{columns:E,gridData:C,rowId:["recordId"],onEdit:e=>{V(e.recordId)},onDelete:O,isLoading:!1,pageSize:50,refetch:N,paginationParameters:q,paginationType:"api",maxAccess:R})}),y&&(0,r.jsx)(T,{onClose:()=>{I(!1),c(null)},labels:j,maxAccess:R,recordId:i,setSelectedRecordId:c}),(0,r.jsx)(D.Z,{open:h,onClose:()=>g(null),message:h})]})}},29326:function(e,a,t){"use strict";var r=t(52322);t(2784);var d=t(23925),s=t(13980),n=t.n(s),o=t(95291),l=t.n(o),i=t(65947);let c=e=>{var a,t,s;let{children:n,value:o,index:c,maxAccess:u,...m}=e,p="".concat(e.name||"tab",".").concat(c),{accessLevel:y}=null!==(s=(null!==(t=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==t?t:[]).find(e=>e.controlId===p))&&void 0!==s?s:{accessLevel:0};if(y===i.A1)return null;let x=o===c;return(0,r.jsx)(d.Z,{role:"tabpanel",hidden:!x,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c),className:"".concat(l().tabPanel," ").concat(x?l().active:l().hidden),...m,children:n})};c.propTypes={children:n().node,index:n().number.isRequired,value:n().number.isRequired},a.Z=c},9522:function(e,a,t){"use strict";t.d(a,{Y:function(){return m}});var r=t(52322),d=t(23925),s=t(54582),n=t(68696),o=t(44258),l=t(2784),i=t(99266),c=t(52614),u=t.n(c);let m=e=>{var a,t,c,m,p;let{tabs:y,activeTab:x,setActiveTab:I,maxAccess:h,name:g="tab"}=e,b=(null==h?void 0:null===(t=h.record)||void 0===t?void 0:null===(a=t.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(g,".")))}).map(e=>e.controlId.split(".")[1]))||[],f=null==y?void 0:null===(c=y.map((e,a)=>({...e,id:a})))||void 0===c?void 0:c.filter((e,a)=>!b.includes(String(a))),v=null===(m=f[x])||void 0===m?void 0:m.id,_=null===(p=f[x])||void 0===p?void 0:p.disabled;return(0,l.useEffect)(()=>{v>=0&&!_&&x!=v&&I(v)},[]),(0,r.jsx)(d.Z,{className:u().tabsContainer,children:(0,r.jsx)(d.Z,{className:u().tabsWrapper,children:(0,r.jsx)(s.Z,{value:x,onChange:(e,a)=>I(a),variant:"scrollable",scrollButtons:f.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==f?void 0:f.map(e=>(0,r.jsx)(n.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,r.jsxs)(d.Z,{display:"flex",alignItems:"center",children:[(0,r.jsx)("span",{children:e.label}),e.id===x&&(null==e?void 0:e.onRefetch)&&(0,r.jsx)(o.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,r.jsx)(i.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=47065)}),_N_E=e.O()}]);