(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12231],{81335:function(e,r,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/exchange-tables",function(){return a(37321)}])},37321:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return q}});var n=a(52322),t=a(2784),l=a(62202),c=a(69387),s=a(27723),d=a(65950),i=a(1251),u=a(71987),o=a(26612),h=a(31389),x=a(33625),g=a(62362),m=a(61802),f=a(60218),y=a(48601),I=a(82737),v=a(38449),C=a(8661),A=a(84100),p=a(80983),_=a(5088),Z=a(19473);function b(e){let{labels:r,maxAccess:a,recordId:c,invalidate:s}=e,{getRequest:u,postRequest:x}=(0,t.useContext)(d.$),{platformLabels:m}=(0,t.useContext)(Z.l),{formik:b}=(0,p.c)({initialValues:{recordId:c||null,reference:"",name:"",currencyId:"",rateCalcMethod:"",rateAgainst:"",rateAgainstCurrencyId:""},maxAccess:a,validateOnChange:!0,validationSchema:y.Ry({reference:y.Z_().required(),name:y.Z_().required(),currencyId:y.Z_().required(),rateCalcMethod:y.Z_().required(),rateAgainst:y.Z_().required(),rateAgainstCurrencyId:y.Z_().nullable().test("is-rateAgainstCurrencyId-required"," ",function(e){let{rateAgainst:r}=this.parent;return"2"!==r||!!e})}),onSubmit:async e=>{let r=await x({extension:i.q.ExchangeTable.set,record:JSON.stringify(e)});e.recordId?l.ZP.success(m.Edited):(l.ZP.success(m.Added),b.setValues({...e,recordId:r.recordId})),s()}}),q=!!b.values.recordId;return(0,t.useEffect)(()=>{!async function(){if(c){let e=await u({extension:i.q.ExchangeTable.get,parameters:"_recordId=".concat(c)});b.setValues(e.record)}}()},[c]),(0,n.jsx)(I.Z,{resourceId:o.i.ExchangeTables,form:b,maxAccess:a,editMode:q,children:(0,n.jsx)(h.R,{children:(0,n.jsx)(g.Q,{children:(0,n.jsxs)(f.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(f.ZP,{item:!0,xs:12,children:(0,n.jsx)(_.Z,{name:"reference",label:r.reference,value:b.values.reference,required:!0,maxAccess:a,maxLength:"10",onChange:b.handleChange,onClear:()=>b.setFieldValue("reference",""),error:b.touched.reference&&!!b.errors.reference})}),(0,n.jsx)(f.ZP,{item:!0,xs:12,children:(0,n.jsx)(_.Z,{name:"name",label:r.name,value:b.values.name,required:!0,maxAccess:a,maxLength:"50",onChange:b.handleChange,onClear:()=>b.setFieldValue("name",""),error:b.touched.name&&!!b.errors.name})}),(0,n.jsx)(f.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{endpointId:v.r.Currency.qry,name:"currencyId",label:r.currencyId,valueField:"recordId",displayField:["reference","name","flName"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"},{key:"flName",value:"Foreign Language"}],values:b.values,required:!0,maxAccess:a,onChange:(e,r)=>{b.setFieldValue("currencyId",(null==r?void 0:r.recordId)||null)},error:b.touched.currencyId&&!!b.errors.currencyId})}),(0,n.jsx)(f.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{datasetId:A.v.MC_RATE_CALC_METHOD,name:"rateCalcMethod",label:r.rateCalcMethod,valueField:"key",displayField:"value",values:b.values,required:!0,maxAccess:a,onChange:(e,r)=>{b.setFieldValue("rateCalcMethod",(null==r?void 0:r.key)||null)},error:b.touched.rateCalcMethod&&!!b.errors.rateCalcMethod})}),(0,n.jsx)(f.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{datasetId:A.v.MC_RATE_AGAINST,name:"rateAgainst",label:r.rateAgainst,valueField:"key",displayField:"value",values:b.values,required:!0,maxAccess:a,onChange:(e,r)=>{b.setFieldValue("rateAgainst",(null==r?void 0:r.key)||null)},error:b.touched.rateAgainst&&!!b.errors.rateAgainst})}),(0,n.jsx)(f.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{endpointId:v.r.Currency.qry,name:"rateAgainstCurrencyId",label:r.rateAgainstCurrencyId,valueField:"recordId",displayField:["reference","name","flName"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"},{key:"flName",value:"Foreign Language"}],values:b.values,required:"2"===b.values.rateAgainst,maxAccess:a,onChange:(e,r)=>{b.setFieldValue("rateAgainstCurrencyId",(null==r?void 0:r.recordId)||null)},error:b.touched.rateAgainstCurrencyId&&!!b.errors.rateAgainstCurrencyId,readOnly:"2"!==b.values.rateAgainst})})]})})})})}var q=()=>{let{getRequest:e,postRequest:r}=(0,t.useContext)(d.$),{platformLabels:a}=(0,t.useContext)(Z.l),{stack:f}=(0,m.zY)();async function y(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:n=50}=r;return{...await e({extension:i.q.ExchangeTable.page,parameters:"_startAt=".concat(a,"&_pageSize=").concat(n,"&filter=")}),_startAt:a}}let{query:{data:I},labels:v,refetch:C,paginationParameters:A,access:p}=(0,u.J)({queryFn:y,endpointId:i.q.ExchangeTable.page,datasetId:o.i.ExchangeTables}),_=(0,u.E)({endpointId:i.q.ExchangeTable.page}),q=[{field:"reference",headerName:v.reference,flex:1},{field:"name",headerName:v.name,flex:1},{field:"currencyRef",headerName:v.currencyId,flex:1}],j=async e=>{try{await r({extension:i.q.ExchangeTable.del,record:JSON.stringify(e)}),_(),l.ZP.success(a.Deleted)}catch(e){}};function E(e){f({Component:b,props:{labels:v,recordId:e||null,maxAccess:p,invalidate:_},width:600,height:450,title:v.ExchangeTables})}return(0,n.jsxs)(h.R,{children:[(0,n.jsx)(x.g,{children:(0,n.jsx)(s.Z,{onAdd:()=>{E()},maxAccess:p})}),(0,n.jsx)(g.Q,{children:(0,n.jsx)(c.Z,{columns:q,gridData:I,rowId:["recordId"],onEdit:e=>{E(null==e?void 0:e.recordId)},onDelete:j,isLoading:!1,refetch:C,pageSize:50,paginationParameters:A,maxAccess:p,paginationType:"api"})})]})}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=81335)}),_N_E=e.O()}]);