(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[29344],{94102:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mf-gen-prod-order",function(){return r(89097)}])},89097:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return D}});var s=r(52322),a=r(2784),n=r(62202),l=r(65950),o=r(69387),i=r(71987),d=r(60218),c=r(26612),u=r(80983),p=r(31389),g=r(33625),y=r(62362),m=r(19473),h=r(69627),S=r(27423),v=r(22341),f=r(90587),q=r(35934),I=r(61802),C=r(54074),D=()=>{var e,t,r,D,M,O,T,R,x;let{getRequest:b,postRequest:P}=(0,a.useContext)(l.$),{platformLabels:J}=(0,a.useContext)(m.l),{stack:N}=(0,I.zY)(),{labels:A,access:w}=(0,i.J)({datasetId:c.i.GenerateProductionOrder}),{formik:F}=(0,u.c)({initialValues:{clientId:null,itemSummaries:{list:[]},orders:{list:[]}},maxAccess:w,onSubmit:async()=>{var e,t,r,s;let a={items:null==F?void 0:null===(r=F.values)||void 0===r?void 0:null===(t=r.itemSummaries)||void 0===t?void 0:null===(e=t.list)||void 0===e?void 0:e.filter(e=>e.checked).map(e=>({poId:0,seqNo:0,itemId:e.itemId,qty:e.produceNow}))},l=await P({extension:f.u.ProductionOrder.gen,record:JSON.stringify(a)});N({Component:q.Z,props:{recordId:null==l?void 0:l.recordId}}),n.ZP.success(J.Generated),await k(null==F?void 0:null===(s=F.values)||void 0===s?void 0:s.clientId),F.setFieldValue("orders",{list:[]})}}),B=[{field:"sku",headerName:A.sku,flex:1},{field:"itemName",headerName:A.itemName,flex:2},{field:"soQty",headerName:A.soQty,type:"number",width:130},{field:"remainingQty",headerName:A.remainingQty,type:"number",width:130},{field:"onHand",headerName:A.onHand,type:"number",width:130},{field:"minQty",headerName:A.minQty,type:"number",width:130},{field:"inProduction",headerName:A.inProduction,type:"number",width:130},{field:"deltaQty",headerName:A.deltaQty,type:"number",width:130},{field:"produceNow",headerName:A.produceNow,type:"number",width:130}],L=[{field:"orderRef",headerName:A.orderRef,flex:1},{field:"orderDate",headerName:A.orderDate,type:"date",flex:1},{field:"clientName",headerName:A.clientName,flex:1,wrapText:!0,autoHeight:!0},{field:"soQty",headerName:A.soQty,type:"number",flex:1},{field:"remainingQty",headerName:A.remainingQty,type:"number",flex:1}],k=async e=>{var t;let r=await b({extension:v.P.SalesOrder.summaryORD,parameters:"_clientId=".concat(e||0)}),s=null==r?void 0:null===(t=r.record)||void 0===t?void 0:t.itemSummaries.map((e,t)=>{var s,a;return{...e,id:t+1,initialSoQty:e.soQty,initialRemainingQty:e.remainingQty,orders:null==r?void 0:null===(a=r.record)||void 0===a?void 0:null===(s=a.orders)||void 0===s?void 0:s.filter(t=>t.itemId===e.itemId).map((e,t)=>({...e,id:t+1,checked:!0}))}});F.setFieldValue("itemSummaries",{list:s})};(0,a.useEffect)(()=>{k()},[]),(0,a.useEffect)(()=>{var e,t;let r=(null==F?void 0:null===(t=F.values)||void 0===t?void 0:null===(e=t.itemSummaries)||void 0===e?void 0:e.list)||[],s=r.map(e=>e.deltaQty>=0&&e.checked?{...e,checked:!1}:e);r.some((e,t)=>e.checked!==s[t].checked)&&F.setFieldValue("itemSummaries.list",s)},[null===(e=F.values.itemSummaries)||void 0===e?void 0:e.list]);let W=e=>{e&&F.setFieldValue("orders",{list:e.orders})};return(0,s.jsx)(C.Z,{onSave:F.handleSubmit,isSaved:!1,disabledSubmit:!(null===(r=F.values.itemSummaries)||void 0===r?void 0:null===(t=r.list)||void 0===t?void 0:t.some(e=>e.checked)),children:(0,s.jsxs)(p.R,{children:[(0,s.jsx)(g.g,{children:(0,s.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(d.ZP,{item:!0,xs:6,children:(0,s.jsx)(S.U,{endpointId:v.P.Client.snapshot,name:"clientId",label:A.client,valueField:"reference",displayField:"name",valueShow:"clientRef",secondValueShow:"clientName",form:F,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],onChange:(e,t)=>{F.setFieldValue("clientId",(null==t?void 0:t.recordId)||null),F.setFieldValue("clientName",(null==t?void 0:t.name)||""),F.setFieldValue("clientRef",(null==t?void 0:t.reference)||""),k(null==t?void 0:t.recordId),F.setFieldValue("orders",{list:[]})},maxAccess:w,autoSelectFistValue:!F.values.clientId,displayFieldWidth:3,error:(null===(D=F.touched)||void 0===D?void 0:D.clientId)&&!!(null===(M=F.errors)||void 0===M?void 0:M.clientId)})}),(0,s.jsx)(d.ZP,{item:!0,xs:2,children:(0,s.jsx)(h.Z,{onClick:()=>k(F.values.clientId),label:J.Preview,image:"preview.png",color:"#231f20"})})]})}),(0,s.jsx)(y.Q,{children:(0,s.jsx)(d.ZP,{container:!0,spacing:2,sx:{display:"flex",flex:1},children:(0,s.jsx)(d.ZP,{item:!0,xs:12,sx:{display:"flex"},children:(0,s.jsxs)(d.ZP,{container:!0,spacing:2,sx:{display:"flex",flex:1},children:[(0,s.jsx)(d.ZP,{item:!0,xs:12,sx:{display:"flex"},children:(0,s.jsx)(o.Z,{columns:B,gridData:null==F?void 0:null===(O=F.values)||void 0===O?void 0:O.itemSummaries,rowId:["itemId"],pagination:!1,maxAccess:w,disableSorting:!0,showCheckboxColumn:!0,showSelectAll:!0,disable:e=>(null==e?void 0:e.deltaQty)>=0,handleCheckboxChange:e=>{W(e)},onSelectionChange:e=>{W(e)}})}),(0,s.jsx)(d.ZP,{item:!0,xs:12,sx:{display:"flex",flexDirection:"column"},children:(0,s.jsx)(o.Z,{columns:L,gridData:null==F?void 0:null===(T=F.values)||void 0===T?void 0:T.orders,rowId:["itemId"],isLoading:!1,pagination:!1,maxAccess:w,showCheckboxColumn:!0,showSelectAll:!1,handleCheckboxChange:()=>{var e,t;let r=(null==F?void 0:null===(t=F.values)||void 0===t?void 0:null===(e=t.orders)||void 0===e?void 0:e.list)||[],s=r.filter(e=>e.checked),a=r.reduce((e,t)=>{let r=t.itemId;return e[r]||(e[r]={soQty:0,remainingQty:0}),e[r].soQty+=t.soQty||0,e[r].remainingQty+=t.remainingQty||0,e},{}),n=s.reduce((e,t)=>{let r=t.itemId;return e[r]||(e[r]={soQty:0,remainingQty:0}),e[r].soQty+=t.soQty||0,e[r].remainingQty+=t.remainingQty||0,e},{}),l=F.values.itemSummaries.list.map(e=>{let t=e.itemId;if(a[t]){let r=n[t]||{soQty:0,remainingQty:0},s=e.onHand+e.inProduction-e.minQty-r.remainingQty;return{...e,soQty:r.soQty,deltaQty:s,remainingQty:r.remainingQty,produceNow:Math.abs(s)}}return e});F.setFieldValue("itemSummaries",{list:l})}})})]})})})}),(0,s.jsx)(g.g,{children:(0,s.jsxs)(d.ZP,{container:!0,spacing:2,p:2,children:[(0,s.jsx)(d.ZP,{item:!0,xs:1,children:(0,s.jsx)(h.Z,{onClick:()=>{F.resetForm(),k()},label:J.Clear,tooltipText:J.Clear,image:"clear.png",color:"#f44336"})}),(0,s.jsx)(d.ZP,{item:!0,xs:10.5}),(0,s.jsx)(d.ZP,{item:!0,xs:.5,children:(0,s.jsx)(h.Z,{onClick:()=>F.handleSubmit(),label:J.Generate,color:"#231f20",tooltipText:J.Generate,disabled:!(null===(x=F.values.itemSummaries)||void 0===x?void 0:null===(R=x.list)||void 0===R?void 0:R.some(e=>e.checked)),image:"generate.png"})})]})})]})})}},90587:function(e,t,r){"use strict";r.d(t,{u:function(){return a}});let s="MF.asmx/",a={DesignRawMaterial:{qry2:s+"qryDRM2",qry:s+"qryDRM",set2:s+"set2DRM"},JobOrdersItem:{qry:s+"qryJIT",set2:s+"set2JIT"},IssueOfMaterialsItems:{qry:s+"qryIMI",qry2:s+"qryIMI2"},LaborGroup:{snapshot:s+"snapshotLBG",page:s+"pageLBG",qry:s+"qryLBG",set:s+"setLBG",get:s+"getLBG",del:s+"delLBG"},ProductionLine:{page:s+"pageLIN",qry:s+"qryLIN",qry2:s+"qry2LIN",qry3:s+"qry3LIN",set:s+"setLIN",get:s+"getLIN",del:s+"delLIN"},CostGroup:{page:s+"pageCG",set:s+"setCG",get:s+"getCG",del:s+"delCG",qry:s+"qryCG"},WorkCenter:{page:s+"pageWCT",qry:s+"qryWCT",qry3:s+"qryWCT3",set:s+"setWCT",get:s+"getWCT",del:s+"delWCT",snapshot:s+"snapshotWCT"},Routing:{page:s+"pageRTN",qry:s+"qryRTN",set:s+"setRTN",get:s+"getRTN",del:s+"delRTN",snapshot2:s+"snapshot2RTN",snapshot:s+"snapshotRTN"},Operation:{snapshot:s+"snapshotOPR",qry:s+"qryOPR",page:s+"pageOPR",set:s+"setOPR",get:s+"getOPR",del:s+"delOPR"},Labor:{page:s+"pageLBR",qry:s+"qryLBR",qry2:s+"qry2LBR",set:s+"setLBR",get:s+"getLBR",del:s+"delLBR",snapshot:s+"snapshotLBR"},Machine:{page:s+"pageMAC",qry:s+"qryMAC",set:s+"setMAC",get:s+"getMAC",del:s+"delMAC",snapshot:s+"snapshotMAC"},MachineSpecification:{page:s+"pageMAS",qry:s+"qryMAS",set:s+"setMAS",get:s+"getMAS",del:s+"delMAS"},LeanProductionPlanning:{preview:s+"previewPQ",update:s+"updatePQ",snapshot:s+"snapshotPQ",del:s+"delPQ",cancel:s+"cancelPQ"},MaterialsAdjustment:{generate:s+"generateADJ"},ProductionClass:{page:s+"pageCLS",qry:s+"qryCLS",set:s+"setCLS",get:s+"getCLS",del:s+"delCLS",snapshot:s+"qryCLS"},ProductionStandard:{qry:s+"qrySTD",page:s+"pageSTD",set:s+"setSTD",get:s+"getSTD",del:s+"delSTD"},ProductionClassSemiFinished:{qry:s+"qryCSF",set:s+"setCSF",get:s+"getCSF",del:s+"delCSF",set2:s+"set2CSF"},RoutingSequence:{set2:s+"set2RTS",qry:s+"qryRTS"},Overhead:{qry:s+"qryOVH",set:s+"setOVH",get:s+"getOVH",del:s+"delOVH",page:s+"pageOVH",snapshot:s+"snapshotOVH"},Design:{qry:s+"qryDES",set:s+"setDES",get:s+"getDES",del:s+"delDES",snapshot:s+"snapshotDES",page:s+"pageDES"},MFJobOrder:{pack:s+"packJOB",qry:s+"qryJOB",qry2:s+"qryJOB2",set:s+"setJOB",get:s+"getJOB",get2:s+"get2JOB",del:s+"delJOB",snapshot:s+"snapshotJOB",snapshot2:s+"snapshotJOB2",snapshot3:s+"snapshotJOB3",cancel:s+"cancelJOB",post:s+"postJOB",start:s+"startJOB",stop:s+"stopJOB",wip:s+"wipJOB",sync:s+"syncJOB"},ProductionSheet:{page:s+"pagePST",qry:s+"qryPST",get:s+"getPST",set2:s+"set2PST",get2:s+"get2PST",del:s+"delPST",post:s+"postPST",unpost:s+"unpostPST",snapshot:s+"snapshotPST"},ProductionSheetItem:{qry:s+"qryPSI",set:s+"setPSI",get:s+"getPSI",del:s+"delPSI"},DocumentTypeDefault:{qry:s+"qryDTD",get:s+"getDTD",set:s+"setDTD",del:s+"delDTD",page:s+"pageDTD"},RawMaterialCategory:{qry:s+"qryRMC",get:s+"getRMC",set:s+"setRMC",del:s+"delRMC",page:s+"pageRMC"},WorksheetMaterials:{qry:s+"qryIMA",get:s+"getIMA",pack:s+"get2IMA",set:s+"setIMA",set2:s+"set2IMA",del:s+"delIMA",post:s+"postIMA"},ProductionSheetQueue:{qry:s+"qryPSQ"},Damage:{qry:s+"qryDMG",get:s+"getDMG",set:s+"setDMG",del:s+"delDMG",page:s+"pageDMG",snapshot:s+"snapshotDMG",post:s+"postDMG",get2:s+"get2DMG",set2:s+"set2DMG",preview:s+"previewDMG"},JobCategory:{qry:s+"qryJCA"},JobRouting:{qry:s+"qryJRO",get:s+"getJRO",set:s+"setJRO",set2:s+"set2JRO",del:s+"delJRO",sync:s+"syncJRO",close:s+"closeJRO",reopen:s+"reopenJRO"},Worksheet:{snapshot:s+"snapshotWST",get:s+"getWST",pack:s+"getPackWST",set:s+"setWST",del:s+"delWST",page:s+"pageWST",summary:s+"summaryWST",post:s+"postWST",qry2:s+"qryWST2",draft:s+"draftWST"},JobOverhead:{qry:s+"qryJOH",set2:s+"set2JOH",generate:s+"generateJOH"},JobMaterial:{qry:s+"qryJMA"},JobItemSize:{qry:s+"qryJSZ",set2:s+"set2JSZ"},MFSerial:{qry:s+"qrySRL",qry2:s+"qrySRL2",set2:s+"set2SRL",generate:s+"generateSRL"},SamplePack:{qry:s+"qrySPL",set2:s+"set2SPL"},DamageReturn:{get:s+"getDMR",set:s+"setDMR",del:s+"delDMR",page:s+"pageDMR",snapshot:s+"snapshotDMR",post:s+"postDMR"},ProductionOrder:{get2:s+"get2PO",set2:s+"set2PO",del:s+"delPO",page:s+"pagePO",snapshot:s+"snapshotPO",post:s+"postPO",gen:s+"genPO",close:s+"closePO"},BillOfMaterials:{get:s+"getBMA",qry2:s+"qry2BMA",set:s+"setBMA",del:s+"delBMA",page:s+"pageBMA",snapshot:s+"snapshotBMA"},Component:{get:s+"getBMI",qry:s+"qryBMI",del:s+"delBMI",set:s+"setBMI",set2:s+"set2BMI"},Assembly:{get:s+"getASM",set2:s+"set2ASM",del:s+"delASM",page:s+"pageASM",snapshot:s+"snapshotASM",post:s+"postASM",unpost:s+"unpostASM",generate:s+"genASM"},AssemblyItems:{qry:s+"qryASC"},AssemblyLot:{get:s+"getASL",set:s+"setASL"},AssemblyOverhead:{qry:s+"qryAOH",set2:s+"set2AOH"},MeasurementScheduleMap:{qry:s+"qryMSM",set:s+"setMSM",set2:s+"set2MSM",del:s+"delMSM"},JobCategory:{set:s+"setJCA",get:s+"getJCA",del:s+"delJCA",page:s+"pageJCA",qry:s+"qryJCA"},DesignGroup:{qry:s+"qryDEG",set:s+"setDEG",get:s+"getDEG",del:s+"delDEG",page:s+"pageDEG"},Components:{qry:s+"qryDEM",set2:s+"set2DEM"},DesignFamily:{qry:s+"qryDEF",set:s+"setDEF",get:s+"getDEF",del:s+"delDEF",page:s+"pageDEF"},ProductionShifts:{qry:s+"qrySHI",set:s+"setSHI",get:s+"getSHI",del:s+"delSHI",page:s+"pageSHI"},JobOrderWizard:{set2:s+"set2JOZ",get2:s+"get2JOZ",del:s+"delJOZ",page:s+"pageJOZ",snapshot:s+"snapshotJOZ",post:s+"postJOZ"},JobTransfer:{get2:s+"get2TFR",set2:s+"set2TFR",del:s+"delTFR",page:s+"pageTFR",snapshot:s+"snapshotTFR",post:s+"postTFR",close:s+"closeTFR",reopen:s+"reopenTFR",qry:s+"qryTFR"},JobWorkCenter:{qry:s+"qryJWC",close:s+"closeJWC",reopen:s+"reopenJWC",get:s+"getJWC",snapshot:s+"snapshotJWC",verify:s+"verifyJWC"},WorkCenterConsumption:{page:s+"pageCON",snapshot:s+"snapshotCON",del:s+"delCON",set2:s+"set2CON",get:s+"getCON",post:s+"postCON",unpost:s+"unpostCON",close:s+"closeCON",reopen:s+"reopenCON"},ConsumptionItemView:{qry:s+"qryCOI"},LineItemCapacity:{set2:s+"set2LIT",del:s+"delLIT",qry:s+"qryLIT",page:s+"pageLIT"},CostGroupOverhead:{set2:s+"set2CGV",qry:s+"qryCGV"},IssueOfMaterialDimension:{set:s+"setIMD",qry:s+"qryIMD"},JobOrder:{gen:s+"genORD"},RefreshPoItem:{refresh:s+"refreshPOI"},WorkCenterTransferMap:{qry:s+"qryWCTM",set2:s+"set2WCTM"},BatchWorksheet:{get2:s+"get2BWST",set2:s+"set2BWST",del:s+"delBWST",page:s+"pageBWST",snapshot:s+"snapshotBWST",post:s+"postBWST",gen:s+"genBWST",close:s+"closeBWST",reopen:s+"reopenBWST"},ProductionOrderFromSaleOrder:{gen:s+"generatePOFromSO"},BatchTransfer:{page:s+"pageBTFR",set2:s+"set2BTFR",del:s+"delBTFR",snapshot:s+"snapshotBTFR",get:s+"getBTFR",post:s+"postBTFR",unpost:s+"unpostBTFR"},BatchTransferJob:{qry:s+"qryBTFJ"},Disposal:{page:s+"pageDIS",snapshot:s+"snapshotDIS",get:s+"getDIS",set2:s+"set2DIS",del:s+"delDIS"},DisposalItem:{qry:s+"qryDII"},DisposalSerial:{qry:s+"qryDISRL"},MetalSetting:{page:s+"pageMTS",set:s+"setMTS",get:s+"getMTS",del:s+"delMTS"},DamageReason:{qry:s+"qryDRS",page:s+"pageDRS",set:s+"setDRS",get:s+"getDRS",del:s+"delDRS",snapshot:s+"snapshotDRS"},DamageCategory:{qry:s+"qryDCA",page:s+"pageDCA",set:s+"setDCA",get:s+"getDCA",del:s+"delDCA",snapshot:s+"snapshotDCA"}}},67920:function(e,t,r){"use strict";r.d(t,{m:function(){return a}});var s=r(48601);function a(e,t,r){var a;let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",l={...e};return null==r||null===(a=r.record)||void 0===a||a.controls.forEach(e=>{let{controlId:t,accessLevel:r}=e,[s,a]=null==t?void 0:t.split(".");s!==n||2!==r||a in l||(l[a]=e=>(null==e?void 0:e[a])!=null),(1===r||4===r)&&a in l&&delete l[a]}),{schema:s.Ry().shape({...Object.keys(l).reduce((e,r)=>(e[r]=s.nK().nullable().test(function(e){var s;let a=this.parent,[,n]=this.path.match(/^(\w+)\[(\d+)\]/)||[],o=(null===(s=this.options.context)||void 0===s?void 0:s[n])||[];if(t||!t&&o.length>1){if(null!==a[r]&&void 0!==a[r]&&0!==a[r]&&""!==l[r]&&!l[r](a))return!1;if(!Object.entries(l).some(e=>{let[,t]=e;return!!t(a)}))return!0}return!!l[r](a)&&void 0!==e}),e),{})}),requiredFields:l}}},1685:function(e,t,r){"use strict";r.d(t,{m:function(){return s}});let s=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,r){"use strict";r.d(t,{H:function(){return m},G:function(){return y}});var s=r(45300),a=r(2784),n=r(96026),l=r(38449);r(26612);var o=r(65947),i=r(1685);let d=async(e,t,r)=>{try{let s=await e({extension:t,parameters:r});return t.includes("qry")?s:s.record}catch(e){return null}},c=(e,t,r,s)=>{let a=(e=JSON.parse(JSON.stringify(e))).record.controls,n=a.find(e=>"reference"===e.controlId);return n?n.accessLevel=(null==t?void 0:t.mandatory)?o.$7:o.rr:(null==t?void 0:t.mandatory)?a.push({sgId:0,resourceId:"",controlId:"".concat(s?s+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?o.$7:o.rr}):(null==t?void 0:t.readOnly)?a.push({sgId:0,resourceId:"",controlId:"".concat(s?s+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?o.rr:o.$7}):a=e.record.controls.filter(e=>"reference"!=e.controlId),r&&a.push({sgId:0,resourceId:"",controlId:"".concat(s?s+".":"","dtId"),accessLevel:o.$7}),{...e,record:{...e.record,controls:a}}},u=async(e,t,r)=>{let s,a;switch(r){case"dtId":let n=(0,i.m)("userData"),o=null==n?void 0:n.userId;a="_userId=".concat(o,"&_functionId=").concat(t),s=l.r.UserFunction.get;break;case"glbSysNumberRange":a="_recordId=".concat(t),s=l.r.SystemFunction.get;break;case"DocumentType":a="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),s=l.r.DocumentType.qry;break;case"DcTypNumberRange":a="_recordId=".concat(t),s=l.r.DocumentType.get;break;case"isExternal":a="_recordId=".concat(t),s=l.r.NumberRange.get;break;default:return null}return await d(e,s,a)},p=async function(e){let t,r,s,a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4],d=arguments.length>5?arguments[5]:void 0,p=void 0===o&&n&&await u(e,n,"dtId"),g=null==p?void 0:p.dtId,y="",m=!0;if(p&&void 0===o||"nraId"===o){if(g){let r=await u(e,g,"DcTypNumberRange");t=null==r?void 0:r.nraId,m=!((null==r?void 0:r.activeStatus)<0),t||(y="Assign the document type to a number range")}if((!g||!m)&&i&&n){var h;let t=await u(e,n,"DocumentType");a=(null==t?void 0:null===(h=t.list)||void 0===h?void 0:h.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===o||void 0===o)&&n){if((!g||g)&&!t||t&&!m){let r=await u(e,n,"glbSysNumberRange");(t=null==r?void 0:r.nraId)&&a&&(a=!1),m=!0}y=t||a?"":"Assign the system Function to a number range"}o>0&&!t&&(t=o),t&&m?(r={readOnly:null==(s=await u(e,t,"isExternal"))||!s.external,mandatory:null!=s&&!!s.external},l&&(l=await c(l,r,a,d))):!t&&l&&(l=await c(l,r,a,d));let S=d?"".concat(d,".reference"):"reference";return{dtId:g,resetReference:null==r?void 0:r.readOnly,dcTypeRequired:a,reference:{fieldName:S,isEmpty:(null==s?void 0:s.external)!==void 0&&(null==s||!s.external)},errorMessage:y,maxAccess:l,selectNraId:o}};var g=r(65950);function y(e){let{functionId:t,action:r,hasDT:s}=e,{getRequest:l}=(0,a.useContext)(g.$),{stack:o}=(0,n.V)();return{proxyAction:async()=>{let e=await p(l,t,"",void 0,s);(null==e?void 0:e.errorMessage)?o({message:null==e?void 0:e.errorMessage}):await r()}}}function m(e){var t;let{functionId:r,access:l,hasDT:o,enabled:i=!0,objectName:d=""}=e,{getRequest:c}=(0,a.useContext)(g.$),{stack:u}=(0,n.V)(),[y,m]=(0,a.useState)(),h=async e=>{let t=await p(c,r,l,e,o,d);if(!t.errorMessage)return t;u({message:null==t?void 0:t.errorMessage})},S=(0,s.a)({retry:!1,staleTime:0,enabled:i,queryKey:[r,y,!!l,i],queryFn:y||"nraId"===y?()=>h(y):()=>h()});return{documentType:S.data,maxAccess:(null==S?void 0:null===(t=S.data)||void 0===t?void 0:t.maxAccess)||l,changeDT(e){m((null==e?void 0:e.nraId)||"nraId")}}}},39704:function(e,t,r){"use strict";var s=r(52322),a=r(2784),n=r(22341),l=r(65950),o=r(85325),i=r(21326),d=r(19473),c=r(35656),u=r(24868),p=r.n(u);let g=e=>{let{functionId:t,recordId:r,window:u}=e,{getRequest:g}=(0,a.useContext)(l.$),{languageId:y}=(0,a.useContext)(o.V),{platformLabels:m}=(0,a.useContext)(d.l),h=r+"-"+t;(0,i.Z)({title:m.WorkFlow,window:u});let{width:S}=(0,c.d)(),v=S<=1024,f=S>1024&&S<=1280,q=v?10:f?12:14,I=v?75:f?85:95,C=v?15:f?20:25,D=async()=>{var e="_functionId=".concat(t,"&_recordId=").concat(r);let s=await g({extension:n.P.WorkFlow.graph,parameters:e});return null==s?void 0:s.record},M=e=>{let t=[],r=[],s="",a="";return e.objects.forEach(e=>{t.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(t=>{e.objects.forEach(e=>{let r=e.functionName.split(" ").join("\r\n");t.parentId===e.recordId&&t.parentFunctionId===e.functionId&&(s=e.reference+"\r\n"+e.date+"\r\n"+r,t.parentId),t.childId===e.recordId&&t.childFunctionId===e.functionId&&(a=e.reference+"\r\n"+e.date+"\r\n"+r,t.childId)}),""===s||""===a||r.push({from:s,to:a,value:1,labelText:""}),s="",a=""}),r};return(0,a.useEffect)(()=>{!async function(){var e=await D();if(e){let t=(e,t)=>{let r=document.createElement("script");r.type="text/javascript",r.src=e,r.async=!0,r.onload=t,document.head.appendChild(r)};t("https://cdn.amcharts.com/lib/4/core.js",()=>{t("https://cdn.amcharts.com/lib/4/charts.js",()=>{t("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let t=am4core.create(h,am4charts.SankeyDiagram),r=M(e);t.data=r,t.dataFields.fromName="from",t.dataFields.toName="to",t.dataFields.value="value",t.paddingRight=2===y?0:40,t.paddingLeft=2===y?40:0,t.tooltip.label.fontSize=q;let s=t.nodes.template;s.draggable=!1,s.inert=!0,s.clickable=!1,s.width=I,s.height=C,s.nameLabel.label.fontSize=q,s.nameLabel.locationX=2===y?.85:0,s.nameLabel.height=void 0,s.nameLabel.label.fontWeight="bold";let a=t.links.template;a.middleLine.strokeOpacity=.3,a.middleLine.stroke=am4core.color("#555"),a.middleLine.strokeWidth=5,a.middleLine.hoverable=!1,a.fillOpacity=0,a.hoverable=!0,a.hoverOnFocus=!0,a.fill=am4core.color("#A8C686"),a.isHover=!0,t.appear(1e3,100)})})})})}}()},[]),(0,s.jsx)("div",{id:h,className:p().root})};g.width=950,t.Z=g},24868:function(e){e.exports={root:"WorkFlow_root__EINm1"}}},function(e){e.O(0,[35934,49774,92888,40179],function(){return e(e.s=94102)}),_N_E=e.O()}]);