(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[27613],{48743:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/au-res-downtime",function(){return t(64987)}])},64987:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return A}});var l=t(52322),r=t(2784),s=t(62202),i=t(69387),n=t(27723),o=t(65950),d=t(95982),u=t(71987),m=t(26612),c=t(31389),x=t(33625),h=t(62362),p=t(61802),f=t(60218),v=t(48601),y=t(82737),g=t(5088),F=t(80983),I=t(19473),j=t(8661),Z=t(84100),w=t(80968),N=t(19689),C=t(28298),T=t(38449),_=t(28879),b=t.n(_);function k(e){var a,t;let{labels:i,maxAccess:n,recordId:x}=e,{getRequest:p,postRequest:_}=(0,r.useContext)(o.$),{platformLabels:k}=(0,r.useContext)(I.l),{getAllKvsByDataset:A}=(0,r.useContext)(w.k),P=(0,u.E)({endpointId:d.y.ResourceDowntime.page}),{formik:q}=(0,F.c)({initialValues:{recordId:null,name:"",timeFrom:"",timeTo:"",type:null,moduleId:null,resourceId:null,sgId:null,isInactive:!1,flags:[]},maxAccess:n,validateOnChange:!0,validationSchema:v.Ry({name:v.Z_().required(),type:v.Rx().required(),timeFrom:v.nK().required().test("before-timeTo","timeFrom must be before timeTo",function(e){let{timeTo:a}=this.parent;return!e||!a||b()(e).isBefore(b()(a))}),timeTo:v.nK().required().test("after-timeFrom","timeTo must be after timeFrom",function(e){let{timeFrom:a}=this.parent;return!e||!a||b()(e).isAfter(b()(a))}),flags:v.IX().of(v.Ry({weekday:v.Z_().required(),weekdayName:v.Z_().required(),flag:v.O7().required()})).test("at-least-one-checked","At least one weekday must be selected.",function(e){return Array.isArray(e)&&e.some(e=>!0===e.flag)})}),onSubmit:async e=>{await _({extension:d.y.ResourceDowntime.set2,record:JSON.stringify({...e,timeFrom:e.timeFrom?b()(e.timeFrom).format("HH:mm"):"",timeTo:e.timeTo?b()(e.timeTo).format("HH:mm"):""})}).then(async a=>{s.ZP.success((null==e?void 0:e.recordId)?k.Edited:k.Added),e.recordId||q.setFieldValue("recordId",a.recordId),P()})}}),E=!!q.values.recordId;return(0,r.useEffect)(()=>{!async function(){if(x){let e=await p({extension:d.y.ResourceDowntime.get2,parameters:"_recordId=".concat(x)});q.setValues({...e.record,timeFrom:b()(e.record.timeFrom,"HH:mm"),timeTo:b()(e.record.timeTo,"HH:mm")})}else await A({_dataset:Z.v.WEEK_DAY,callback:e=>{e.length>0&&q.setFieldValue("flags",e.map(e=>({weekday:e.key,weekdayName:e.value,flag:!1})))}})}()},[]),(0,l.jsx)(y.Z,{resourceId:m.i.ResourceDowntime,form:q,maxAccess:n,editMode:E,children:(0,l.jsx)(c.R,{children:(0,l.jsx)(h.Q,{children:(0,l.jsxs)(f.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(f.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"name",label:i.name,value:q.values.name,required:!0,maxAccess:n,onChange:q.handleChange,onClear:()=>q.setFieldValue("name",""),error:q.touched.name&&!!q.errors.name})}),null==q?void 0:null===(t=q.values)||void 0===t?void 0:null===(a=t.flags)||void 0===a?void 0:a.map((e,a)=>(0,l.jsx)(f.ZP,{item:!0,xs:6,children:(0,l.jsx)(N.Z,{name:"flags.".concat(a,".flag"),value:e.flag,onChange:e=>q.setFieldValue("flags.".concat(a,".flag"),e.target.checked),label:e.weekdayName,maxAccess:n,required:!0,error:!!q.errors.flags&&q.touched.flags})},e.weekday)),(0,l.jsx)(f.ZP,{item:!0,xs:6}),(0,l.jsx)(f.ZP,{item:!0,xs:6,children:(0,l.jsx)(C.Z,{label:i.timeFrom,name:"timeFrom",required:!0,value:q.values.timeFrom,onChange:q.setFieldValue,onClear:()=>q.setFieldValue("timeFrom",""),use24Hour:!0,maxAccess:n,error:q.touched.timeFrom&&!!q.errors.timeFrom,max:b()(q.values.timeTo,"HH:mm")})}),(0,l.jsx)(f.ZP,{item:!0,xs:6,children:(0,l.jsx)(C.Z,{label:i.timeTo,name:"timeTo",required:!0,value:q.values.timeTo,onChange:q.setFieldValue,onClear:()=>q.setFieldValue("timeTo",""),use24Hour:!0,maxAccess:n,error:q.touched.timeTo&&!!q.errors.timeTo,min:b()(q.values.timeFrom,"HH:mm")})}),(0,l.jsx)(f.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{datasetId:Z.v.RESOURCE_DOWNTIME_TYPE,label:i.type,defaultIndex:0,required:!0,name:"type",values:q.values,valueField:"key",displayField:"value",maxAccess:n,onChange:(e,a)=>q.setFieldValue("type",(null==a?void 0:a.key)||null)})}),(0,l.jsx)(f.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{datasetId:Z.v.MODULE,label:i.module,name:"moduleId",values:q.values,valueField:"key",displayField:"value",maxAccess:n,onChange:(e,a)=>q.setFieldValue("moduleId",(null==a?void 0:a.key)||null)})}),(0,l.jsx)(f.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:T.r.ModuleClassRES.qry,parameters:"_moduleId=".concat(q.values.moduleId||0,"&_filter="),label:i.resource,name:"resourceId",values:q.values,maxAccess:n,valueField:"key",displayField:"value",onChange:(e,a)=>q.setFieldValue("resourceId",(null==a?void 0:a.key)||null)})}),(0,l.jsx)(f.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:d.y.SecurityGroup.qry,parameters:"_startAt=0&_pageSize=1000",label:i.SecurityGroup,name:"sgId",values:q.values,maxAccess:n,valueField:"recordId",displayField:"name",onChange:(e,a)=>q.setFieldValue("sgId",(null==a?void 0:a.recordId)||null)})}),(0,l.jsx)(f.ZP,{item:!0,xs:12,children:(0,l.jsx)(N.Z,{name:"isInactive",value:q.values.isInactive,onChange:e=>q.setFieldValue("isInactive",e.target.checked),label:i.isInactive,maxAccess:n})})]})})})})}var A=()=>{let{getRequest:e,postRequest:a}=(0,r.useContext)(o.$),{platformLabels:t}=(0,r.useContext)(I.l);async function f(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:l=50}=a;return{...await e({extension:d.y.ResourceDowntime.page,parameters:"_startAt=".concat(t,"&_pageSize=").concat(l,"&filter=")}),_startAt:t}}let{stack:v}=(0,p.zY)(),{query:{data:y},labels:g,paginationParameters:F,refetch:j,access:Z,invalidate:w}=(0,u.J)({queryFn:f,endpointId:d.y.ResourceDowntime.page,datasetId:m.i.ResourceDowntime}),N=[{field:"name",headerName:g.name,flex:1},{field:"typeName",headerName:g.type,flex:1},{field:"moduleName",headerName:g.module,flex:1},{field:"resourceName",headerName:g.resource,flex:1},{field:"sgName",headerName:g.SecurityGroup,flex:1},{field:"timeFrom",headerName:g.timeFrom,flex:1,type:"time"},{field:"timeTo",headerName:g.timeTo,flex:1,type:"time"}],C=async e=>{await a({extension:d.y.ResourceDowntime.del,record:JSON.stringify(e)}),w(),s.ZP.success(t.Deleted)};function T(e){v({Component:k,props:{labels:g,recordId:e,maxAccess:Z},width:700,height:550,title:g.resourceDowntime})}return(0,l.jsxs)(c.R,{children:[(0,l.jsx)(x.g,{children:(0,l.jsx)(n.Z,{onAdd:()=>{T()},maxAccess:Z})}),(0,l.jsx)(h.Q,{children:(0,l.jsx)(i.Z,{name:"table",columns:N,gridData:y,rowId:["recordId"],onEdit:e=>{T(null==e?void 0:e.recordId)},onDelete:C,pageSize:50,paginationType:"api",paginationParameters:F,refetch:j,maxAccess:Z})})]})}},28298:function(e,a,t){"use strict";var l=t(52322),r=t(2784),s=t(74143),i=t(44258),n=t(41633),o=t(45297),d=t(94918),u=t(26698),m=t(51909),c=t(90740),x=t(32827),h=t(81576),p=t(7087),f=t.n(p);a.Z=e=>{let{name:a,label:t,value:p,onChange:v,error:y=!1,helperText:g="",disabledRangeTime:F={},variant:I="outlined",size:j="small",fullWidth:Z=!0,required:w=!1,autoFocus:N=!1,disabled:C=!1,disabledTime:T=null,readOnly:_=!1,editMode:b=!1,hasBorder:k=!0,hidden:A=!1,use24Hour:P=!1,min:q=null,max:E=null,...R}=e,[D,S]=(0,r.useState)(!1),[V,H]=(0,r.useState)(!1),{_readOnly:O,_required:B,_hidden:z}=(0,h.W)(a,R.maxAccess,w,_,A);return z?(0,l.jsx)(l.Fragment,{}):(0,l.jsx)(n._,{dateAdapter:c.y,children:(0,l.jsx)(m.j,{variant:I,size:j,value:p,label:t,fullWidth:Z,ampm:!P,minTime:q,maxTime:E,onFocus:()=>H(!0),onBlur:()=>H(!1),autoFocus:N,onChange:e=>v(a,e),onClose:()=>S(!1),open:D,disabled:C,readOnly:O,clearable:!0,slotProps:{textField:{required:B,size:j,fullWidth:Z,error:!!y,helperText:"string"==typeof y?y:g,InputProps:{classes:{root:f().outlinedRoot,notchedOutline:k?f().outlinedFieldset:f().outlinedNoBorder,input:f().inputBase},endAdornment:!(O||C)&&(0,l.jsxs)(s.Z,{position:"end",className:f().inputAdornment,children:[p&&(0,l.jsx)(i.Z,{tabIndex:-1,className:f().iconButton,onClick:()=>v(a,null),children:(0,l.jsx)(o.Z,{className:f().icon})}),(0,l.jsx)(i.Z,{tabIndex:-1,className:f().iconButton,onClick:()=>S(!0),children:(0,l.jsx)(d.Z,{className:f().icon})})]})},InputLabelProps:{className:V||p?f().inputLabelShrink:f().inputLabel}},actionBar:{actions:["accept"]}},slots:{actionBar:e=>(0,l.jsx)(u.Z,{...e,actions:["accept"]}),popper:e=>(0,l.jsx)(x.Z,{...e,matchAnchorWidth:!1,isDateTimePicker:!0})},...R})})}}},function(e){e.O(0,[92515,43553,49774,92888,40179],function(){return e(e.s=48743)}),_N_E=e.O()}]);