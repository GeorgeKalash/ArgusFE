(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28194],{71944:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ca-opening-balances",function(){return n(10643)}])},10643:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return j}});var r=n(52322),c=n(2784),s=n(62202),t=n(69387),l=n(27723),i=n(65950),u=n(2119),d=n(71987),o=n(26612),m=n(31389),f=n(33625),h=n(62362),x=n(61802),g=n(60218),y=n(48601),I=n(82737),p=n(80983),A=n(8661),v=n(38449),b=n(91406),Y=n(19473);function _(e){let{labels:a,maxAccess:n,recordId:t,record:l}=e,{getRequest:f,postRequest:x}=(0,c.useContext)(i.$),{platformLabels:_}=(0,c.useContext)(Y.l),j=(0,d.E)({endpointId:u.G.OpeningBalance.page}),{formik:Z}=(0,p.c)({initialValues:{recordId:t,fiscalYear:"",cashAccountId:"",currencyId:"",currencyRef:"",amount:"",baseAmount:""},maxAccess:n,validateOnChange:!0,validationSchema:y.Ry({fiscalYear:y.Z_().required(),cashAccountId:y.Z_().required(),currencyId:y.Z_().required(),amount:y.Rx().required(),baseAmount:y.Rx().required()}),onSubmit:async e=>{let a=Z.values.currencyId,n=Z.values.fiscalYear,r=Z.values.cashAccountId;await x({extension:u.G.OpeningBalance.set,record:JSON.stringify(e)}),s.ZP.success(a||n||r?_.Edited:_.Added),Z.setValues({...e,recordId:String(1e3*e.fiscalYear)+String(100*e.cashAccountId)+String(10*e.currencyId)}),j()}}),S=!!Z.values.recordId;return(0,c.useEffect)(()=>{!async function(){if(l&&l.currencyId&&l.fiscalYear&&l.cashAccountId&&t){let e=await f({extension:u.G.OpeningBalance.get,parameters:"_fiscalYear=".concat(l.fiscalYear,"&_cashAccountId=").concat(l.cashAccountId,"&_currencyId=").concat(l.currencyId)});Z.setValues({...e.record,recordId:String(1e3*e.record.fiscalYear)+String(100*e.record.cashAccountId)+String(10*e.record.currencyId)})}}()},[]),(0,r.jsx)(I.Z,{resourceId:o.i.OpeningBalance,form:Z,maxAccess:n,editMode:S,children:(0,r.jsx)(m.R,{children:(0,r.jsx)(h.Q,{children:(0,r.jsxs)(g.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(g.ZP,{item:!0,xs:12,children:(0,r.jsx)(A.Z,{endpointId:v.r.FiscalYears.qry,readOnly:S,name:"fiscalYear",label:a.fiscalYear,valueField:"fiscalYear",displayField:"fiscalYear",values:Z.values,required:!0,maxAccess:n,onChange:(e,a)=>{Z.setFieldValue("fiscalYear",null==a?void 0:a.fiscalYear)},error:Z.touched.fiscalYear&&!!Z.errors.fiscalYear})}),(0,r.jsx)(g.ZP,{item:!0,xs:12,children:(0,r.jsx)(A.Z,{endpointId:u.G.CashAccount.qry,parameters:"_type=0",name:"cashAccountId",readOnly:S,required:!0,label:a.accountRef,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:Z.values,maxAccess:n,onChange:(e,a)=>{Z.setFieldValue("cashAccountId",(null==a?void 0:a.recordId)||null)},error:Z.touched.cashAccountId&&!!Z.errors.cashAccountId})}),(0,r.jsx)(g.ZP,{item:!0,xs:12,children:(0,r.jsx)(A.Z,{endpointId:v.r.Currency.qry,name:"currencyId",label:a.currency,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:S,values:Z.values,required:!0,maxAccess:n,onChange:(e,a)=>{Z.setFieldValue("currencyId",(null==a?void 0:a.recordId)||""),Z.setFieldValue("currencyRef",(null==a?void 0:a.reference)||"")},error:Z.touched.currencyId&&!!Z.errors.currencyId})}),(0,r.jsx)(g.ZP,{item:!0,xs:12,children:(0,r.jsx)(b.Z,{name:"amount",required:!0,label:a.amount,value:Z.values.amount,maxAccess:n,onChange:e=>Z.setFieldValue("amount",e.target.value),onClear:()=>Z.setFieldValue("amount",""),error:Z.touched.amount&&!!Z.errors.amount,maxLength:10,decimalScale:2})}),(0,r.jsx)(g.ZP,{item:!0,xs:12,children:(0,r.jsx)(b.Z,{name:"baseAmount",required:!0,label:a.baseAmount,value:Z.values.baseAmount,maxAccess:n,onChange:e=>Z.setFieldValue("baseAmount",e.target.value),onClear:()=>Z.setFieldValue("baseAmount",""),error:Z.touched.baseAmount&&!!Z.errors.baseAmount,maxLength:10,decimalScale:2})})]})})})})}var j=()=>{let{getRequest:e,postRequest:a}=(0,c.useContext)(i.$),{stack:n}=(0,x.zY)();async function g(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0,_pageSize:r=50}=a;return{...await e({extension:u.G.OpeningBalance.page,parameters:"_startAt=".concat(n,"&_pageSize=").concat(r)}),_startAt:n}}let{query:{data:y},labels:I,access:p,paginationParameters:A,refetch:v}=(0,d.J)({queryFn:g,endpointId:u.G.OpeningBalance.page,datasetId:o.i.OpeningBalance}),b=(0,d.E)({endpointId:u.G.OpeningBalance.page}),Y=[{field:"fiscalYear",headerName:I.fiscalYear,flex:1},{field:"cashAccountName",headerName:I.accountName,flex:1},{field:"currencyRef",headerName:I.currencyRef,flex:1},{field:"amount",headerName:I.amount,flex:1,type:"number"},{field:"baseAmount",headerName:I.baseAmount,flex:1,type:"number"}],j=async e=>{await a({extension:u.G.OpeningBalance.del,record:JSON.stringify(e)}),b(),s.ZP.success("Record Deleted Successfully")};function Z(e){n({Component:_,props:{labels:I,record:e,recordId:e?String(1e3*e.fiscalYear)+String(100*e.accountId)+String(10*e.currencyId):null},width:600,height:430,title:I.openingBalance})}return(0,r.jsxs)(m.R,{children:[(0,r.jsx)(f.g,{children:(0,r.jsx)(l.Z,{onAdd:()=>{Z()},maxAccess:p})}),(0,r.jsx)(h.Q,{children:(0,r.jsx)(t.Z,{columns:Y,gridData:y,rowId:["currencyId","fiscalYear","accountId"],onEdit:e=>{Z(e)},onDelete:j,isLoading:!1,pageSize:50,paginationParameters:A,refetch:v,paginationType:"api",maxAccess:p})})]})}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=71944)}),_N_E=e.O()}]);