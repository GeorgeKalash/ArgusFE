(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9231],{11797:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/iv-catalogue",function(){return t(76083)}])},76083:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return y}});var i=t(52322),l=t(2784),n=t(69387),r=t(65950),d=t(71987),o=t(26612),s=t(31389),c=t(33625),u=t(62362),m=t(61802),f=t(36908),x=t(65215),p=t(60218),v=t(82737),h=t(80983),g=t(5088);function N(e){var a,t;let{labels:d,maxAccess:m,record:f}=e,{getRequest:N}=(0,l.useContext)(r.$),{itemId:y,name:_,sku:j}=f,{formik:k}=(0,h.c)({initialValues:{recordId:y,itemId:y,name:_,sku:j,data:[]},maxAccess:m});(0,l.useEffect)(()=>{!async function(){if(y){let a=await N({extension:x.$.Availability.qry,parameters:"_siteId=".concat(0,"&_itemId=").concat(y,"&_startAt=0&_pageSize=1000")});if(a&&(null==a?void 0:a.list)){var e;a.list=null==a?void 0:null===(e=a.list)||void 0===e?void 0:e.map(e=>{var a,t,i;return{...e,committed:null!==(a=null==e?void 0:e.committed)&&void 0!==a?a:0,ordered:null!==(t=null==e?void 0:e.ordered)&&void 0!==t?t:0,onhand:null!==(i=null==e?void 0:e.onhand)&&void 0!==i?i:0}})}k.setValues({data:a,recordId:y,itemId:y,name:_,sku:j})}}()},[]);let C=[{field:"sku",headerName:d.sku,flex:1},{field:"itemName",headerName:d.itemName,flex:1},{field:"siteName",headerName:d.siteName,flex:1},{field:"siteRef",headerName:d.siteReference,flex:1},{field:"categoryRef",headerName:d.category,flex:1},{field:"categoryName",headerName:d.categoryName,flex:1},{field:"onhand",headerName:d.onHand,flex:1,decimal:3,type:"number"},{field:"committed",headerName:d.committed,flex:1,type:"number"},{field:"ordered",headerName:d.ordered,flex:1,type:"number"}];return(0,i.jsx)(v.Z,{resourceId:o.i.Catalogue,form:k,maxAccess:m,editMode:!!y,actions:[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!1}],isInfo:!1,isCleared:!1,isSaved:!1,children:(0,i.jsxs)(s.R,{children:[(0,i.jsx)(c.g,{children:(0,i.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,i.jsx)(p.ZP,{item:!0,xs:4,children:(0,i.jsx)(g.Z,{name:"sku",label:d.sku,value:null==k?void 0:null===(a=k.values)||void 0===a?void 0:a.sku,maxAccess:m,readOnly:!0})}),(0,i.jsx)(p.ZP,{item:!0,xs:8}),(0,i.jsx)(p.ZP,{item:!0,xs:4,children:(0,i.jsx)(g.Z,{name:"name",label:d.itemName,value:null==k?void 0:null===(t=k.values)||void 0===t?void 0:t.name,maxAccess:m,readOnly:!0})})]})}),(0,i.jsx)(u.Q,{children:(0,i.jsx)(n.Z,{name:"catalogueTable",columns:C,gridData:k.values.data,rowId:["recordId"],pagination:!1,maxAccess:m})})]})})}var y=()=>{let{getRequest:e}=(0,l.useContext)(r.$),{stack:a}=(0,m.zY)();async function t(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:i=50,params:l}=a,n=await e({extension:x.$.Catalogue.page,parameters:"_startAt=".concat(t,"&_pageSize=").concat(i,"&_params=").concat(l||"")});if(n&&(null==n?void 0:n.list)){var r;n.list=null==n?void 0:null===(r=n.list)||void 0===r?void 0:r.map(e=>({...e,onHand:parseFloat(null==e?void 0:e.onHand).toFixed(3)}))}return{...n,_startAt:t}}async function p(a){let{filters:i,pagination:l}=a;return(null==i?void 0:i.qry)?await e({extension:x.$.Catalogue.snapshot,parameters:"_filter=".concat(i.qry)}):t({_startAt:l._startAt||0,params:null==i?void 0:i.params})}let{query:{data:v},labels:h,paginationParameters:g,refetch:y,access:_,filterBy:j}=(0,d.J)({queryFn:t,endpointId:x.$.Catalogue.page,datasetId:o.i.Catalogue,filter:{filterFn:p}}),k=[{field:"pictureUrl",headerName:"",type:"image",flex:.5},{field:"sku",headerName:h.sku,flex:1},{field:"name",headerName:h.name,flex:1},{field:"groupName",headerName:h.group,flex:1},{field:"categoryName",headerName:h.category,flex:1},{field:"onHand",headerName:h.onHand,flex:1,type:"number"}];return(0,i.jsxs)(s.R,{children:[(0,i.jsx)(c.g,{children:(0,i.jsx)(f.Z,{maxAccess:_,reportName:"IVIT",filterBy:j,previewReport:o.i.Catalogue})}),(0,i.jsx)(u.Q,{children:(0,i.jsx)(n.Z,{name:"table",columns:k,gridData:null!=v?v:{list:[]},rowId:["recordId"],onEdit:e=>{a({Component:N,props:{labels:h,maxAccess:_,record:e},width:1e3,height:600,title:h.Catalogue})},pageSize:50,paginationType:"api",maxAccess:_,refetch:y,paginationParameters:g})})]})}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=11797)}),_N_E=e.O()}]);