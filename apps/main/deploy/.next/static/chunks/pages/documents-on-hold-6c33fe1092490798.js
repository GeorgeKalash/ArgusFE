(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57180,47441,84622,57981],{10264:function(e){var a;a=function(){"use strict";var e="minute",a=/[+-]\d\d(?::?\d\d)?/g,t=/([+-]|\d\d)/g;return function(n,l,r){var s=l.prototype;r.utc=function(e){var a={date:e,utc:!0,args:arguments};return new l(a)},s.utc=function(a){var t=r(this.toDate(),{locale:this.$L,utc:!0});return a?t.add(this.utcOffset(),e):t},s.local=function(){return r(this.toDate(),{locale:this.$L,utc:!1})};var d=s.parse;s.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),d.call(this,e)};var o=s.init;s.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else o.call(this)};var i=s.utcOffset;s.utcOffset=function(n,l){var r=this.$utils().u;if(r(n))return this.$u?0:r(this.$offset)?i.call(this):this.$offset;if("string"==typeof n&&null===(n=function(e){void 0===e&&(e="");var n=e.match(a);if(!n)return null;var l=(""+n[0]).match(t)||["-",0,0],r=l[0],s=60*+l[1]+ +l[2];return 0===s?0:"+"===r?s:-s}(n)))return this;var s=16>=Math.abs(n)?60*n:n;if(0===s)return this.utc(l);var d=this.clone();if(l)return d.$offset=s,d.$u=!1,d;var o=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(d=this.local().add(s+o,e)).$offset=s,d.$x.$localOffset=o,d};var u=s.format;s.format=function(e){var a=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,a)},s.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()};var c=s.toDate;s.toDate=function(e){return"s"===e&&this.$offset?r(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():c.call(this)};var m=s.diff;s.diff=function(e,a,t){if(e&&this.$u===e.$u)return m.call(this,e,a,t);var n=this.local(),l=r(e).local();return m.call(n,l,a,t)}}},e.exports=a()},61663:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/documents-on-hold",function(){return t(88659)}])},88659:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return r}});var n=t(52322),l=t(38836),r=()=>(0,n.jsx)(l.Z,{})},57393:function(e,a,t){"use strict";t.d(a,{s:function(){return l}});let n="CC.asmx/",l={CashCountTransaction:{snapshot:n+"snapshotTRX",qry:n+"qryTRX",get2:n+"get2TRX",set2:n+"set2TRX",post:n+"postTRX",close:n+"closeTRX",reopen:n+"reopenTRX",del:n+"delTRX"},Generate:{generate:n+"generateTFR"},CcCashNotes:{qry:n+"qryNOT",get:n+"getNOT",set:n+"setNOT",del:n+"delNOT",page:n+"pageNOT"}}},92407:function(e,a,t){"use strict";t.d(a,{y:function(){return l}});let n="EP.asmx/",l={Employee:{snapshot:n+"snapshotEM",get1:n+"getEM1",set:n+"setEM",del:n+"delEM"},CertificateFilters:{qry:n+"qryCL",get:n+"getCL",set:n+"setCL",del:n+"delCL",page:n+"pageCL"},HRDocTypeFilters:{qry:n+"qryDT"},SalaryChangeReason:{qry:n+"qrySC",get:n+"getSC",set:n+"setSC",del:n+"delSC",page:n+"pageSC"},EmploymentStatusFilters:{qry:n+"qryST",page:n+"pageST",set:n+"setST",get:n+"getST",del:n+"delST"},SponsorFilters:{qry:n+"qrySP",page:n+"pageSP",set:n+"setSP",get:n+"getSP",del:n+"delSP"},RelationshipTypes:{page:n+"pageRT",set:n+"setRT",get:n+"getRT",del:n+"delRT"},BonusTypes:{get:n+"getBT",set:n+"setBT",page:n+"pageBT",del:n+"delBT"},BgCheck:{page:n+"pageCT",set:n+"setCT",get:n+"getCT",del:n+"delCT"},NoticePeriods:{get:n+"getNP",set:n+"setNP",del:n+"delNP",qry:n+"qryNP",page:n+"pageNP"},CustomProperties:{get:n+"getUP",set:n+"setUP",del:n+"delUP",page:n+"pageUP",qry:n+"qryUP"},ResignationRequest:{get:n+"getRR",set:n+"setRR",del:n+"delRR",page:n+"pageRR",close:n+"closeRR",reopen:n+"reopenRR"},TerminationReasons:{qry:n+"qryTR",get:n+"getTR",set:n+"setTR",del:n+"delTR",page:n+"pageTR"},JobInfo:{snapshot:n+"snapshotJI",page:n+"pageJI",close:n+"closeJI",reopen:n+"reopenJI",get:n+"getJI",set:n+"setJI",del:n+"delJI",qry:n+"qryJI"},QuickView:{get:n+"getQV"},EmployeePenalty:{page:n+"pagePE",close:n+"closePE",reopen:n+"reopenPE",get:n+"getPE",set:n+"setPE",del:n+"delPE"},EmployeeDeduction:{qry:n+"qryED",page:n+"pageED",del:n+"delED",get:n+"getED",set:n+"setED",snapshot:n+"snapshotED"},FullName:{sync:n+"syncFullName"},EmployeeChart:{page:n+"pageES",qry:n+"qryES",qry2:n+"qryES2"},EmployeeSalary:{qry:n+"qrySA",get:n+"getSA",set:n+"setSA",del:n+"delSA"},SalaryDetails:{qry:n+"qrySD",get:n+"getSD",set2:n+"set2SD",del:n+"delSD"},TerminationEmployee:{get:n+"getTE"},EmployementHistory:{qry:n+"qryEH",del:n+"delEH",get:n+"getEH",set:n+"setEH"},Hiring:{get:n+"getRE",set:n+"setRE"},Skills:{qry:n+"qryCE",del:n+"delCE",get:n+"getCE",set:n+"setCE"},UserDefined:{qry:n+"qryUV",set2:n+"set2UV"},Leaves:{set:n+"setLS",del:n+"delLS",get:n+"getLS"}}},58912:function(e,a,t){"use strict";t.d(a,{I:function(){return l}});let n="IR.asmx/",l={ReplenishmentGroups:{qry:n+"qryGRP",page:n+"pageGRP",get:n+"getGRP",set:n+"setGRP",del:n+"delGRP"},IvReplenishements:{qry:n+"qryHDR",page:n+"pageHDR",get:n+"getHDR",set:n+"setHDR"},IvReplenishementsList:{qry:n+"qryTRX"},GenerateIvReplenishements:{generate:n+"generateTFR"},MaterialReplenishment:{page:n+"pageREQ",del:n+"delREQ",get:n+"getREQ",set2:n+"set2REQ",snapshot:n+"snapshotREQ",close:n+"closeREQ",reopen:n+"reopenREQ",cancel:n+"cancelREQ",print:n+"printREQ"},OrderItem:{qry:n+"qryREI",open:n+"openREI"},MatPlanning:{page:n+"pageMPL",del:n+"delMPL",get:n+"getMPL",set2:n+"set2MPL",reopen:n+"reopenMPL",close:n+"closeMPL",qry:n+"qryMPL",snapshot:n+"snapshotMPL"},MatPlanningItem:{qry:n+"qryMPI",append:n+"appendMPI"},PurchaseRequest:{generate:n+"generatePR"},PlantSettings:{get:n+"getPLT",set:n+"setPLT",del:n+"delPLT"},DocumentTypeDefault:{get:n+"getDTD",set:n+"setDTD",del:n+"delDTD",page:n+"pageDTD"},materialPlaning:{preview:n+"previewMRP"},Transfer:{generate2:n+"generate2TFR"},ConsumptionOfTools:{generate:n+"generateMFCON"}}},50496:function(e,a,t){"use strict";t.d(a,{U:function(){return l}});let n="LM.asmx/",l={IndemnityAccuralsFilters:{qry:n+"qryLT"},LeaveScheduleFilters:{qry:n+"qryLS",page:n+"pageLS",set:n+"setLS",get:n+"getLS",del:n+"delLS"},OpeningBalances:{page:n+"pageOBA",set:n+"setOBA",get:n+"getOBA",del:n+"delOBA",qry:n+"qryOBA"},BalanceAdjustment:{page:n+"pageBA",set:n+"setBA",get:n+"getBA",del:n+"delBA",snapshot:n+"snapshotBA"},EarnedLeave:{page:n+"pageEL",set2:n+"set2EL",get2:n+"get2EL",del:n+"delEL",preview:n+"previewEL",post:n+"postEL"},LeavePeriod:{qry:n+"qryLP",del:n+"delLP",get:n+"getLP",set:n+"setLP"},LeaveRequest:{page:n+"pageLR",qry:n+"qryLR",set:n+"setLR",get:n+"getLR",del:n+"delLR",snapshot:n+"snapshotLR",close:n+"closeLR",reopen:n+"reopenLR",set2:n+"set2LR",get2:n+"get2LR"},LeaveReturn:{page:n+"pageRE",set:n+"setRE",get:n+"getRE",del:n+"delRE",snapshot:n+"snapshotRE",close:n+"closeRE",reopen:n+"reopenRE"},PreviewDays:{preview:n+"previewLD"},Leaves:{qry:n+"qryELB"}}},73581:function(e,a,t){"use strict";t.d(a,{h:function(){return l}});let n="LT.asmx/",l={LoanType:{get:n+"getLT",set:n+"setLT",del:n+"delLT",qry:n+"qryLT",page:n+"pageLT"},Loans:{get:n+"getLR",set:n+"setLR",del:n+"delLR",page:n+"pageLR",close:n+"closeLR",reopen:n+"reopenLR"},LoanDeduction:{page:n+"pageLD",get:n+"getLD",set:n+"setLD",del:n+"delLD"}}},90587:function(e,a,t){"use strict";t.d(a,{u:function(){return l}});let n="MF.asmx/",l={DesignRawMaterial:{qry2:n+"qryDRM2",qry:n+"qryDRM",set2:n+"set2DRM"},JobOrdersItem:{qry:n+"qryJIT",set2:n+"set2JIT"},IssueOfMaterialsItems:{qry:n+"qryIMI",qry2:n+"qryIMI2"},LaborGroup:{snapshot:n+"snapshotLBG",page:n+"pageLBG",qry:n+"qryLBG",set:n+"setLBG",get:n+"getLBG",del:n+"delLBG"},ProductionLine:{page:n+"pageLIN",qry:n+"qryLIN",qry2:n+"qry2LIN",qry3:n+"qry3LIN",set:n+"setLIN",get:n+"getLIN",del:n+"delLIN"},CostGroup:{page:n+"pageCG",set:n+"setCG",get:n+"getCG",del:n+"delCG",qry:n+"qryCG"},WorkCenter:{page:n+"pageWCT",qry:n+"qryWCT",qry3:n+"qryWCT3",set:n+"setWCT",get:n+"getWCT",del:n+"delWCT",snapshot:n+"snapshotWCT"},Routing:{page:n+"pageRTN",qry:n+"qryRTN",set:n+"setRTN",get:n+"getRTN",del:n+"delRTN",snapshot2:n+"snapshot2RTN",snapshot:n+"snapshotRTN"},Operation:{snapshot:n+"snapshotOPR",qry:n+"qryOPR",page:n+"pageOPR",set:n+"setOPR",get:n+"getOPR",del:n+"delOPR"},Labor:{page:n+"pageLBR",qry:n+"qryLBR",qry2:n+"qry2LBR",set:n+"setLBR",get:n+"getLBR",del:n+"delLBR",snapshot:n+"snapshotLBR"},Machine:{page:n+"pageMAC",qry:n+"qryMAC",set:n+"setMAC",get:n+"getMAC",del:n+"delMAC",snapshot:n+"snapshotMAC"},MachineSpecification:{page:n+"pageMAS",qry:n+"qryMAS",set:n+"setMAS",get:n+"getMAS",del:n+"delMAS"},LeanProductionPlanning:{preview:n+"previewPQ",update:n+"updatePQ",snapshot:n+"snapshotPQ",del:n+"delPQ",cancel:n+"cancelPQ"},MaterialsAdjustment:{generate:n+"generateADJ"},ProductionClass:{page:n+"pageCLS",qry:n+"qryCLS",set:n+"setCLS",get:n+"getCLS",del:n+"delCLS",snapshot:n+"qryCLS"},ProductionStandard:{qry:n+"qrySTD",page:n+"pageSTD",set:n+"setSTD",get:n+"getSTD",del:n+"delSTD"},ProductionClassSemiFinished:{qry:n+"qryCSF",set:n+"setCSF",get:n+"getCSF",del:n+"delCSF",set2:n+"set2CSF"},RoutingSequence:{set2:n+"set2RTS",qry:n+"qryRTS"},Overhead:{qry:n+"qryOVH",set:n+"setOVH",get:n+"getOVH",del:n+"delOVH",page:n+"pageOVH",snapshot:n+"snapshotOVH"},Design:{qry:n+"qryDES",set:n+"setDES",get:n+"getDES",del:n+"delDES",snapshot:n+"snapshotDES",page:n+"pageDES"},MFJobOrder:{pack:n+"packJOB",qry:n+"qryJOB",qry2:n+"qryJOB2",set:n+"setJOB",get:n+"getJOB",get2:n+"get2JOB",del:n+"delJOB",snapshot:n+"snapshotJOB",snapshot2:n+"snapshotJOB2",snapshot3:n+"snapshotJOB3",cancel:n+"cancelJOB",post:n+"postJOB",start:n+"startJOB",stop:n+"stopJOB",wip:n+"wipJOB",sync:n+"syncJOB"},ProductionSheet:{page:n+"pagePST",qry:n+"qryPST",get:n+"getPST",set2:n+"set2PST",get2:n+"get2PST",del:n+"delPST",post:n+"postPST",unpost:n+"unpostPST",snapshot:n+"snapshotPST"},ProductionSheetItem:{qry:n+"qryPSI",set:n+"setPSI",get:n+"getPSI",del:n+"delPSI"},DocumentTypeDefault:{qry:n+"qryDTD",get:n+"getDTD",set:n+"setDTD",del:n+"delDTD",page:n+"pageDTD"},RawMaterialCategory:{qry:n+"qryRMC",get:n+"getRMC",set:n+"setRMC",del:n+"delRMC",page:n+"pageRMC"},WorksheetMaterials:{qry:n+"qryIMA",get:n+"getIMA",pack:n+"get2IMA",set:n+"setIMA",set2:n+"set2IMA",del:n+"delIMA",post:n+"postIMA"},ProductionSheetQueue:{qry:n+"qryPSQ"},Damage:{qry:n+"qryDMG",get:n+"getDMG",set:n+"setDMG",del:n+"delDMG",page:n+"pageDMG",snapshot:n+"snapshotDMG",post:n+"postDMG",get2:n+"get2DMG",set2:n+"set2DMG",preview:n+"previewDMG"},JobCategory:{qry:n+"qryJCA"},JobRouting:{qry:n+"qryJRO",get:n+"getJRO",set:n+"setJRO",set2:n+"set2JRO",del:n+"delJRO",sync:n+"syncJRO",close:n+"closeJRO",reopen:n+"reopenJRO"},Worksheet:{snapshot:n+"snapshotWST",get:n+"getWST",pack:n+"getPackWST",set:n+"setWST",del:n+"delWST",page:n+"pageWST",summary:n+"summaryWST",post:n+"postWST",qry2:n+"qryWST2",draft:n+"draftWST"},JobOverhead:{qry:n+"qryJOH",set2:n+"set2JOH",generate:n+"generateJOH"},JobMaterial:{qry:n+"qryJMA"},JobItemSize:{qry:n+"qryJSZ",set2:n+"set2JSZ"},MFSerial:{qry:n+"qrySRL",qry2:n+"qrySRL2",set2:n+"set2SRL",generate:n+"generateSRL"},SamplePack:{qry:n+"qrySPL",set2:n+"set2SPL"},DamageReturn:{get:n+"getDMR",set:n+"setDMR",del:n+"delDMR",page:n+"pageDMR",snapshot:n+"snapshotDMR",post:n+"postDMR"},ProductionOrder:{get2:n+"get2PO",set2:n+"set2PO",del:n+"delPO",page:n+"pagePO",snapshot:n+"snapshotPO",post:n+"postPO",gen:n+"genPO",close:n+"closePO"},BillOfMaterials:{get:n+"getBMA",qry2:n+"qry2BMA",set:n+"setBMA",del:n+"delBMA",page:n+"pageBMA",snapshot:n+"snapshotBMA"},Component:{get:n+"getBMI",qry:n+"qryBMI",del:n+"delBMI",set:n+"setBMI",set2:n+"set2BMI"},Assembly:{get:n+"getASM",set2:n+"set2ASM",del:n+"delASM",page:n+"pageASM",snapshot:n+"snapshotASM",post:n+"postASM",unpost:n+"unpostASM",generate:n+"genASM"},AssemblyItems:{qry:n+"qryASC"},AssemblyLot:{get:n+"getASL",set:n+"setASL"},AssemblyOverhead:{qry:n+"qryAOH",set2:n+"set2AOH"},MeasurementScheduleMap:{qry:n+"qryMSM",set:n+"setMSM",set2:n+"set2MSM",del:n+"delMSM"},JobCategory:{set:n+"setJCA",get:n+"getJCA",del:n+"delJCA",page:n+"pageJCA",qry:n+"qryJCA"},DesignGroup:{qry:n+"qryDEG",set:n+"setDEG",get:n+"getDEG",del:n+"delDEG",page:n+"pageDEG"},Components:{qry:n+"qryDEM",set2:n+"set2DEM"},DesignFamily:{qry:n+"qryDEF",set:n+"setDEF",get:n+"getDEF",del:n+"delDEF",page:n+"pageDEF"},ProductionShifts:{qry:n+"qrySHI",set:n+"setSHI",get:n+"getSHI",del:n+"delSHI",page:n+"pageSHI"},JobOrderWizard:{set2:n+"set2JOZ",get2:n+"get2JOZ",del:n+"delJOZ",page:n+"pageJOZ",snapshot:n+"snapshotJOZ",post:n+"postJOZ"},JobTransfer:{get2:n+"get2TFR",set2:n+"set2TFR",del:n+"delTFR",page:n+"pageTFR",snapshot:n+"snapshotTFR",post:n+"postTFR",close:n+"closeTFR",reopen:n+"reopenTFR",qry:n+"qryTFR"},JobWorkCenter:{qry:n+"qryJWC",close:n+"closeJWC",reopen:n+"reopenJWC",get:n+"getJWC",snapshot:n+"snapshotJWC",verify:n+"verifyJWC"},WorkCenterConsumption:{page:n+"pageCON",snapshot:n+"snapshotCON",del:n+"delCON",set2:n+"set2CON",get:n+"getCON",post:n+"postCON",unpost:n+"unpostCON",close:n+"closeCON",reopen:n+"reopenCON"},ConsumptionItemView:{qry:n+"qryCOI"},LineItemCapacity:{set2:n+"set2LIT",del:n+"delLIT",qry:n+"qryLIT",page:n+"pageLIT"},CostGroupOverhead:{set2:n+"set2CGV",qry:n+"qryCGV"},IssueOfMaterialDimension:{set:n+"setIMD",qry:n+"qryIMD"},JobOrder:{gen:n+"genORD"},RefreshPoItem:{refresh:n+"refreshPOI"},WorkCenterTransferMap:{qry:n+"qryWCTM",set2:n+"set2WCTM"},BatchWorksheet:{get2:n+"get2BWST",set2:n+"set2BWST",del:n+"delBWST",page:n+"pageBWST",snapshot:n+"snapshotBWST",post:n+"postBWST",gen:n+"genBWST",close:n+"closeBWST",reopen:n+"reopenBWST"},ProductionOrderFromSaleOrder:{gen:n+"generatePOFromSO"},BatchTransfer:{page:n+"pageBTFR",set2:n+"set2BTFR",del:n+"delBTFR",snapshot:n+"snapshotBTFR",get:n+"getBTFR",post:n+"postBTFR",unpost:n+"unpostBTFR"},BatchTransferJob:{qry:n+"qryBTFJ"},Disposal:{page:n+"pageDIS",snapshot:n+"snapshotDIS",get:n+"getDIS",set2:n+"set2DIS",del:n+"delDIS"},DisposalItem:{qry:n+"qryDII"},DisposalSerial:{qry:n+"qryDISRL"},MetalSetting:{page:n+"pageMTS",set:n+"setMTS",get:n+"getMTS",del:n+"delMTS"},DamageReason:{qry:n+"qryDRS",page:n+"pageDRS",set:n+"setDRS",get:n+"getDRS",del:n+"delDRS",snapshot:n+"snapshotDRS"},DamageCategory:{qry:n+"qryDCA",page:n+"pageDCA",set:n+"setDCA",get:n+"getDCA",del:n+"delDCA",snapshot:n+"snapshotDCA"}}},83562:function(e,a,t){"use strict";t.d(a,{m:function(){return l}});let n="PY.asmx/",l={Payroll:{qry:n+"qryHE",page:n+"pageHE",get:n+"getHE",set:n+"setHE",del:n+"delHE",close:n+"closeHE",reopen:n+"reopenHE",post:n+"postHE",unpost:n+"unpostHE",snapshot:n+"snapshotHE"},BankTransferFilters:{qry:n+"qrySB",page:n+"pageSB",get:n+"getSB",set:n+"setSB",del:n+"delSB"},Paycode:{qry:n+"qryPC",set:n+"setPC",del:n+"delPC",get:n+"getPC"},SecuritySchedule:{qry:n+"qrySS"},IndemnitySchedule:{page:n+"pageIS",qry:n+"qryIS",get:n+"getIS",set:n+"setIS",del:n+"delIS"},LedgerGroup:{qry:n+"qryGLG",get:n+"getGLG",set:n+"setGLG",del:n+"delGLG"},Arguments:{page:n+"pageAR"},SalaryBatch:{page:n+"pageBAT",get:n+"getBAT",set:n+"setBAT",del:n+"delBAT"},TimeCodes:{page:n+"pageTC",qry:n+"qryTC",get:n+"getTC",set:n+"setTC",del:n+"delTC"},FinalSettlement:{page:n+"pageFS",get:n+"getFS",set:n+"setFS",del:n+"delFS",snapshot:n+"snapshotFS"},IndemnityCompany:{qry:n+"qryID",set2:n+"set2ID"},IndemnityResignation:{qry:n+"qryIR",set2:n+"set2IR"},PenaltyType:{page:n+"pagePT",qry:n+"qryPT",get:n+"getPT",set:n+"setPT",del:n+"delPT"},PenaltyDetail:{qry:n+"qryPD",set2:n+"set2PD"},GeneratePayroll:{gen:n+"genEM",page:n+"pageEM"},PayrollDetails:{qry:n+"qryED",set2:n+"set2ED"},SocialSecurity:{qry:n+"qryES"},FiscalYear:{qry:n+"qryYE"},Period:{qry:n+"qryPE"}}},63518:function(e,a,t){"use strict";t.d(a,{z:function(){return l}});let n="PM.asmx/",l={Designer:{page:n+"pageDSR",get:n+"getDSR",set:n+"setDSR",del:n+"delDSR",snapshot:n+"snapshotDSR",qry:n+"qryDSR"},ThreeDDesign:{page:n+"page3DD",get:n+"get3DD",set:n+"set3DD",del:n+"del3DD",post:n+"post3DD",close:n+"close3DD",reopen:n+"reopen3DD",snapshot:n+"snapshot3DD"},Sketch:{page:n+"pageSKH",get:n+"getSKH",set:n+"setSKH",del:n+"delSKH",close:n+"closeSKH",reopen:n+"reopenSKH",snapshot:n+"snapshotSKH",snapshot2:n+"snapshot2SKH",snapshot3:n+"snapshot3SKH",post:n+"postSKH"},ModelMaker:{snapshot:n+"snapshotMDL",snapshot2:n+"snapshot2MDL",page:n+"pageMDL",get:n+"getMDL",set:n+"setMDL",del:n+"delMDL",post:n+"postMDL",close:n+"closeMDL",reopen:n+"reopenMDL"},ModellingMaterial:{qry:n+"qryMDLM",set2:n+"set2MDLM"},Printing:{page:n+"page3DP",get:n+"get3DP",set:n+"set3DP",del:n+"del3DP",start:n+"start3DP",snapshot:n+"snapshot3DP",snapshot2:n+"snapshot3DP2",post:n+"post3DP",qry:n+"qry3DP"},ThreeDDrawing:{snapshot:n+"snapshot3DD",snapshot2:n+"snapshot23DD",get:n+"get3DD",snapshot3DD2:n+"snapshot3DD2"},Rubber:{page:n+"pageRBR",get:n+"getRBR",set:n+"setRBR",del:n+"delRBR",snapshot:n+"snapshotRBR",post:n+"postRBR",start:n+"startRBR"},Modeling:{qry:n+"qryMDL"},Casting:{page:n+"pageCAS",get:n+"getCAS",set:n+"setCAS",del:n+"delCAS",snapshot:n+"snapshotCAS",post:n+"postCAS"},DocumentTypeDefault:{page:n+"pageDTD",get:n+"getDTD",set:n+"setDTD",del:n+"delDTD"},Samples:{page:n+"pageSPL",get2:n+"get2SPL",set:n+"setSPL",del:n+"delSPL",snapshot:n+"snapshotSPL",set2:n+"set2SPL",close:n+"closeSPL",reopen:n+"reopenSPL",post:n+"postSPL"}}},2454:function(e,a,t){"use strict";t.d(a,{y:function(){return l}});let n="PU.asmx/",l={VendorGroups:{qry:n+"qryGRP",page:n+"pageGRP",get:n+"getGRP",set:n+"setGRP",del:n+"delGRP"},PriceList:{qry:n+"qryPRI",del:n+"delPRI",get:n+"getPRI",set:n+"setPRI"},PUOrderStatus:{qry:n+"qryPOS",page:n+"pagePOS",get:n+"getPOS",set:n+"setPOS",del:n+"delPOS"},DeliveryMethods:{qry:n+"qryDM",page:n+"pageDM",get:n+"getDM",set:n+"setDM",del:n+"delDM"},PaymentTerms:{qry:n+"qryPT",page:n+"pagePT",get:n+"getPT",set:n+"setPT",del:n+"delPT"},Vendor:{snapshot:n+"snapshotVEN",qry:n+"qryVEN",page:n+"pageVEN",get:n+"getVEN",set:n+"setVEN",del:n+"delVEN"},Address:{qry:n+"qryAD",page:n+"pageAD",get:n+"getAD",set:n+"setAD",del:n+"delAD"},DocumentTypeDefault:{qry:n+"qryDTD",get:n+"getDTD",set:n+"setDTD",del:n+"delDTD",page:n+"pageDTD"},PurchaseInvoiceHeader:{qry:n+"qryIVC",get:n+"getIVC",get2:n+"get2IVC",level2_PU:n+"level2_PU",set:n+"setIVC",del:n+"delIVC",snapshot:n+"snapshotIVC",set2:n+"set2IVC",post:n+"postIVC",unpost:n+"unpostIVC",generate:n+"generateIVC",preview:n+"previewIVC",sync:n+"syncIVC",verify:n+"verifyIVC"},Invoice:{snapshot:n+"snapshotINV"},PurchaseReturnHeader:{set2:n+"set2IVR",post:n+"postIVR",unpost:n+"unpostIVR",del:n+"delIVR",qry:n+"qryIVR",snapshot:n+"snapshotIVR"},VendorPrice:{get:n+"getPRI2"},ItemCostHistory:{qry:n+"qryIPH"},ItemPromotion:{qry:n+"qryIVIM"},Serials:{qry:n+"qrySRL",import:n+"importSRL",last:n+"lastSRL",sync:n+"syncSRL"},Shipment:{get:n+"getSHP",set2:n+"set2SHP",del:n+"delSHP",page:n+"pageSHP",snapshot:n+"snapshotSHP",post:n+"postSHP",unpost:n+"unpostSHP",gen:n+"genSHP"},ShipmentItem:{qry:n+"qrySHI"},UnpostedOrderPack:{get:n+"openORD",snapshot:n+"snapshotORD"},PurchaseOrder:{page:n+"pageORD",snapshot:n+"snapshotORD",del:n+"delORD",set2:n+"set2ORD",get2:n+"get2ORD",close:n+"closeORD",reopen:n+"reopenORD",terminate:n+"terminateORD",transfer:n+"transfer1ORD"},PurchaseRequisition:{snapshot:n+"snapshotREQ",page:n+"pageREQ",get:n+"getREQ",set:n+"setREQ",del:n+"delREQ",cancel:n+"cancelREQ",reopen:n+"reopenREQ",close:n+"closeREQ"},RequisitionDetail:{qry:n+"qryREI",set:n+"setREI",get:n+"getREI",del:n+"delREI"},QuotationItem:{preview:n+"previewQTI",qry:n+"qryQTI"},OrderItem:{qry:n+"qryORI",set2:n+"set2ORI"},PUDraftReturn:{set2:n+"set2DRE",get:n+"getDRE",page:n+"pageDRE",snapshot:n+"snapshotDRE",del:n+"delDRE",post:n+"postDRE"},PUDraftReturnSerial:{get2:n+"get2DRS",qry:n+"qryDRS",del:n+"delDRS",append:n+"appendDRS",batch:n+"batchDRS"},FinancialGroup:{qry:n+"qryFII",set2:n+"set2FII"},PUInvoiceRetBalance:{balance:n+"balanceRET"},ItemLastPurchaseInfo:{last:n+"lastIVI"},PurchaseQuotation:{page:n+"pageQTN",set2:n+"set2QTN",get:n+"getQTN",del:n+"delQTN",snapshot:n+"snapshotQTN"},GenerateQTNPRPack:{gen:n+"genQTN"},GeneratePOPRPack:{gen:n+"genPO",gen2:n+"gen2PO"}}},76426:function(e,a,t){"use strict";t.d(a,{x:function(){return l}});let n="SC.asmx/",l={LabelTemplate:{qry:n+"qryLBT",set:n+"setLBT",get:n+"getLBT",del:n+"delLBT"},Item:{qry:n+"qryLBI",set:n+"setLBI",get:n+"getLBI",del:n+"delLBI"},Sites:{qry:n+"qrySIT",set:n+"setSIT",set2:n+"set2SIT",get:n+"getSIT",del:n+"delSIT",reopen:n+"reopenSIT",end:n+"endSIT"},Controller:{qry:n+"qryCRL"},StockCountControllerTab:{qry:n+"qryPHY",set2:n+"set2PHY",set:n+"setPHY",get:n+"getPHY",del:n+"delPHY"},StockCount:{page:n+"pageHDR",post:n+"postHDR",unpost:n+"unpostHDR",qry:n+"qryHDR",get:n+"getHDR",set:n+"setHDR",del:n+"delHDR",close:n+"closeHDR",reopen:n+"reopenHDR",snapshot:n+"snapshotHDR"},StockCountController:{page:n+"pageCRL",set:n+"setCRL",get:n+"getCRL",del:n+"delCRL"},DocumentTypeDefaults:{qry:n+"qryDTD",set:n+"setDTD",get:n+"getDTD",del:n+"delDTD"},StockCountItem:{qry:n+"qryITM",set:n+"setITM",get:n+"getITM",del:n+"delITM"},StockCountSerialSum:{qry:n+"qrySRS"},StockCountItemDetail:{qry:n+"qryITD",set:n+"setITD",get:n+"getITD",del:n+"delITD",set2:n+"set2ITD"},StockCountSerialDetail:{set2:n+"set2SRL",qry:n+"qrySRL",append:n+"appendSRL",del:n+"delSRL",batch:n+"batchSRL"}}},6035:function(e,a,t){"use strict";t.d(a,{f:function(){return l}});let n="TA.asmx/",l={AttendanceScheduleFilters:{qry:n+"qrySD"},ProcessedShiftPunches:{retry:n+"retryPSP"},OvertimeProfiles:{page:n+"pageOTP",set:n+"setOTP",get:n+"getOTP",del:n+"delOTP",qry:n+"qryOTP"},PendingPunches:{page:n+"pagePP",del:n+"delPP",qry:n+"qryPP"},BiometricDevices:{page:n+"pageBM",qry:n+"qryBM",del:n+"delBM",set:n+"setBM",get:n+"getBM"},DSLReasons:{page:n+"pageLR",set:n+"setLR",get:n+"getLR",del:n+"delLR"},TimeVariation:{reset:n+"resetTV",qry:n+"qryTV",qry2:n+"qryTV2",snapshot:n+"snapshotTV",page:n+"pageTV",get:n+"getTV",set:n+"setTV",del:n+"delTV",gen:n+"genTV",close:n+"closeTV",reopen:n+"reopenTV",cancel:n+"cancelTV",override:n+"overrideTV"},ShitLeave:{page:n+"pageLQ",set:n+"setLQ",get:n+"getLQ",del:n+"delLQ",close:n+"closeLQ",reopen:n+"reopenLQ"},FlatSchedule:{qry:n+"qryFS",qry2:n+"qryFS2",copyRange:n+"copyRangeFS",range:n+"rangeFS",del:n+"delRangeFS"},DSLReason:{qry:n+"qryLR"},Calendar:{qry:n+"qryCA"},DayTypes:{page:n+"pageDT",qry:n+"qryDT",set:n+"setDT",get:n+"getDT",del:n+"delDT"},AttendanceDay:{qry:n+"qryAD"},Schedule:{qry:n+"qrySC"},FlatPunch:{qry:n+"qryFP"}}},70104:function(e,a,t){"use strict";t.d(a,{K:function(){return l}});let n="CS.asmx/",l={DivisionFilters:{qry:n+"qryDI"},BranchFilters:{qry:n+"qryBR"},CompanyPositions:{qry:n+"qryPO"},DepartmentFilters:{qry:n+"qryDE"}}},93883:function(e,a,t){"use strict";var n=t(52322),l=t(2784),r=t(74143),s=t(44258),d=t(41633),o=t(45297),i=t(73980),u=t(11886),c=t(26698),m=t(32827),v=t(2494),p=t(81576),y=t(7087),h=t.n(y);a.Z=e=>{let{name:a,label:t,value:y,onChange:f,error:I,disabledRangeDate:x={},max:g=null,min:C=null,variant:D="outlined",size:b="small",views:R=["year","month","day","hours","minutes"],fullWidth:S=!0,required:q=!1,autoFocus:w=!1,disabled:P=!1,disabledDate:Z=null,readOnly:F=!1,editMode:j=!1,hasBorder:k=!0,hidden:T=!1,formatTime:O="hh:mm aa",defaultValue:N,...A}=e,V="".concat(window.localStorage.getItem("default")&&JSON.parse(window.localStorage.getItem("default")).dateFormat," ").concat(O),[L,M]=(0,l.useState)(!1),{_readOnly:E,_required:_,_hidden:J}=(0,p.W)(a,A.maxAccess,q,F,T),B=new Date(x.date);B.setDate(B.getDate()+x.day);let H=void 0===y?(()=>{let e;switch(N){case"today":e=new Date;break;case"yesterday":(e=new Date).setDate(e.getDate()-1);break;case"boy":e=new Date(new Date().getFullYear(),0,1);break;default:e=null}return e})():y;return J?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(d._,{dateAdapter:u.H,children:(0,n.jsx)(v.x,{variant:D,size:b,value:H,label:t,views:R,minDate:C||x.date,maxDate:g||B,fullWidth:S,autoFocus:w,format:V,onChange:e=>f(a,e),onClose:()=>M(!1),open:L,disabled:P,readOnly:E,clearable:!0,shouldDisableDate:Z&&(e=>{let a=new Date(e),t=new Date;return(t.setDate(t.getDate()),a.setDate(a.getDate()),">="===Z)?a>=t:"<"===Z?a<t:">"===Z&&a>t}),slotProps:{popper:{disablePortal:!0},textField:{required:_,size:b,fullWidth:S,error:I,inputProps:{tabIndex:E?-1:0},InputProps:{classes:{root:h().outlinedRoot,notchedOutline:k?h().outlinedFieldset:h().outlinedNoBorder,input:h().inputBase},endAdornment:!(E||P)&&(0,n.jsxs)(r.Z,{position:"end",className:h().inputAdornment,children:[H&&(0,n.jsx)(s.Z,{tabIndex:-1,edge:"start",onClick:()=>f(a,null),className:h().iconButton,children:(0,n.jsx)(o.Z,{className:h().icon})}),(0,n.jsx)(s.Z,{tabIndex:-1,onClick:()=>M(!0),className:h().iconButton,children:(0,n.jsx)(i.Z,{className:h().icon})})]})},InputLabelProps:{classes:{root:h().inputLabel,shrink:h().inputLabelShrink}}},actionBar:{actions:["accept","today"]}},slots:{actionBar:e=>(0,n.jsx)(c.Z,{...e,actions:["accept","today"]}),popper:e=>(0,n.jsx)(m.Z,{isDateTimePicker:!0,...e})}})})}},28298:function(e,a,t){"use strict";var n=t(52322),l=t(2784),r=t(74143),s=t(44258),d=t(41633),o=t(45297),i=t(94918),u=t(26698),c=t(51909),m=t(90740),v=t(32827),p=t(81576),y=t(7087),h=t.n(y);a.Z=e=>{let{name:a,label:t,value:y,onChange:f,error:I=!1,helperText:x="",disabledRangeTime:g={},variant:C="outlined",size:D="small",fullWidth:b=!0,required:R=!1,autoFocus:S=!1,disabled:q=!1,disabledTime:w=null,readOnly:P=!1,editMode:Z=!1,hasBorder:F=!0,hidden:j=!1,use24Hour:k=!1,min:T=null,max:O=null,...N}=e,[A,V]=(0,l.useState)(!1),[L,M]=(0,l.useState)(!1),{_readOnly:E,_required:_,_hidden:J}=(0,p.W)(a,N.maxAccess,R,P,j);return J?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(d._,{dateAdapter:m.y,children:(0,n.jsx)(c.j,{variant:C,size:D,value:y,label:t,fullWidth:b,ampm:!k,minTime:T,maxTime:O,onFocus:()=>M(!0),onBlur:()=>M(!1),autoFocus:S,onChange:e=>f(a,e),onClose:()=>V(!1),open:A,disabled:q,readOnly:E,clearable:!0,slotProps:{textField:{required:_,size:D,fullWidth:b,error:!!I,helperText:"string"==typeof I?I:x,InputProps:{classes:{root:h().outlinedRoot,notchedOutline:F?h().outlinedFieldset:h().outlinedNoBorder,input:h().inputBase},endAdornment:!(E||q)&&(0,n.jsxs)(r.Z,{position:"end",className:h().inputAdornment,children:[y&&(0,n.jsx)(s.Z,{tabIndex:-1,className:h().iconButton,onClick:()=>f(a,null),children:(0,n.jsx)(o.Z,{className:h().icon})}),(0,n.jsx)(s.Z,{tabIndex:-1,className:h().iconButton,onClick:()=>V(!0),children:(0,n.jsx)(i.Z,{className:h().icon})})]})},InputLabelProps:{className:L||y?h().inputLabelShrink:h().inputLabel}},actionBar:{actions:["accept"]}},slots:{actionBar:e=>(0,n.jsx)(u.Z,{...e,actions:["accept"]}),popper:e=>(0,n.jsx)(v.Z,{...e,matchAnchorWidth:!1,isDateTimePicker:!0})},...N})})}},38836:function(e,a,t){"use strict";t.d(a,{Z:function(){return ey}});var n=t(52322),l=t(2784),r=t(23925),s=t(44258),d=t(9737),o=t(69387),i=t(27723),u=t(65950),c=t(68676),m=t(60218),v=t(78711),p=t(62202),y=t(71987),h=t(19473),f=t(23361),I=t(21326);let x=e=>{let{window:a,w:t,responseValue:r,onConfirm:s,fullScreen:d}=e,{platformLabels:o}=(0,l.useContext)(h.l);return(0,I.Z)({title:o.Confirmation,window:a}),(0,n.jsx)(f.Z,{DialogText:2===r?o.ApproveDoc:o.RejectDoc,okButtonAction:()=>{s(),a.close(),t.close()},fullScreen:d,cancelButtonAction:()=>{a.close()}})};x.width=450,x.height=170;var g=t(5088),C=t(21581),D=t(89330),b=t(39812);let R={DocumentsOnHold:{set:"CTDR.asmx/setTRX"}};var S=t(31389),q=t(62362),w=t(61802),P=t(7121),Z=t(1883),F=t(54074);function j(e){let{labels:a,maxAccess:t,functionId:r,seqNo:s,recordId:d,window:o}=e,[i,f]=(0,l.useState)(null),{platformLabels:I}=(0,l.useContext)(h.l),{getRequest:j,postRequest:k}=(0,l.useContext)(u.$),T=(0,y.E)({endpointId:c.y.DocumentsOnHold.qry}),{stack:O}=(0,w.zY)(),N=(0,v.TA)({initialValues:{recordId:null,reference:"",indicatorId:null,functionId:null,seqNo:"",thirdParty:"",date:null,notes:"",responseDate:null,strategyName:""},validateOnChange:!0,onSubmit:async e=>{let a={...e,date:(0,b.ku)(e.date),response:i},t=(0,P.x)(r);t===Z.Y.CurrencyTrading||t===Z.Y.Remittance?await k({extension:R.DocumentsOnHold.set,record:JSON.stringify(a)}):await k({extension:c.y.DocumentsOnHold.set,record:JSON.stringify(a)}),p.ZP.success(r||s||e.recordId||null===i?I.Edited:I.Added),T()}});function A(e){f(e),O({Component:x,props:{fullScreen:!1,responseValue:e,w:o,onConfirm:()=>{console.log("submit"),N.submitForm()}}})}return(0,l.useEffect)(()=>{!async function(){var e;let a=await j({extension:c.y.DocumentsOnHold.get,parameters:"_functionId=".concat(r,"&_seqNo=").concat(s,"&_recordId=").concat(d)});N.setValues({...a.record,date:(0,b.a1)(null==a?void 0:null===(e=a.record)||void 0===e?void 0:e.date)})}()},[]),(0,n.jsx)(F.Z,{actions:[{key:"Reject",condition:!0,onClick:()=>{A(-1)},disabled:!1},{key:"Approve",condition:!0,onClick:()=>{A(2)},disabled:!1}],isSaved:!1,maxAccess:t,children:(0,n.jsx)(S.R,{children:(0,n.jsx)(q.Q,{children:(0,n.jsxs)(m.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(m.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"reference",label:a.reference,value:N.values.reference,readOnly:!0,maxAccess:t,maxLength:"30"})}),(0,n.jsx)(m.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"thirdParty",label:a.thirdParty,value:N.values.thirdParty,readOnly:!0,maxAccess:t})}),(0,n.jsx)(m.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.Z,{name:"date",label:a.date,onChange:N.setFieldValue,value:N.values.date,readOnly:!0,maxAccess:t})}),(0,n.jsx)(m.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"strategyName",label:a.strategy,value:N.values.strategyName,readOnly:!0,maxAccess:t})}),(0,n.jsx)(m.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"notes",label:a.notes,value:N.values.notes,maxLength:"100",rows:2,maxAccess:t,onChange:N.handleChange,onClear:()=>N.setFieldValue("notes",""),error:N.touched.notes&&!!N.errors.notes})})]})})})})}var k=t(26612),T=t(47441),O=t(58974),N=t(25991),A=t(38449),V=t(60352),L=t(53137),M=t(33625),E=t(93741),_=t(57981),J=t(74456),B=t(99090),H=t(69549),Q=t(8324),W=t(99471),G=t(44129),U=t(38096),$=t(58669),Y=t(40300),z=t(89764),K=t(69952),X=t(20899),ee=t(41451),ea=t(73470),et=t(51682),en=t(43933),el=t(21379),er=t(30032),es=t(23427),ed=t(1838),eo=t(86557),ei=t(58583),eu=t(27603),ec=t(32304),em=t(84622),ev=t(35934),ep=t(23476),ey=e=>{let{pageSize:a=50}=e,{getRequest:t}=(0,l.useContext)(u.$),{stack:m}=(0,w.zY)();async function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0}=e;return{...await t({extension:c.y.DocumentsOnHold.qry,parameters:"_startAt=".concat(n,"&_reference=&_sortBy=reference desc&_pageSize=").concat(a)}),_startAt:n}}let{query:{data:p},labels:h,filterBy:f,clearFilter:I,refetch:x,paginationParameters:g,access:C}=(0,y.J)({queryFn:v,endpointId:c.y.DocumentsOnHold.qry,datasetId:k.i.DocumentsOnHold,filter:{endpointId:c.y.DocumentsOnHold.qry,filterFn:D}});async function D(e){let{options:n={},filters:l}=e,{_startAt:r=0}=n;return l.qry&&await t({extension:c.y.DocumentsOnHold.qry,parameters:"&_reference=".concat(l.qry,"&_sortBy=reference desc&_pageSize=").concat(a,"&_startAt=").concat(r)})}let b=async e=>{try{var a;let n=await t({extension:A.r.UserDefaults.get,parameters:"_userId=".concat(e&&e.userId,"&_key=plantId")});return null==n?void 0:null===(a=n.record)||void 0===a?void 0:a.value}catch(e){return""}},R=async e=>{let a;let n=e.recordId;switch(e.functionId){case P.J.CurrencyCreditOrderSale:case P.J.CurrencyCreditOrderPurchase:a=T.Z;break;case P.J.CreditInvoiceSales:case P.J.CreditInvoicePurchase:a=O.Z;break;case P.J.CashCountTransaction:a=E.Z;break;case P.J.CurrencyPurchase:case P.J.CurrencySale:a=N.Z;break;case P.J.KYC:await t({extension:L.L.CtClientIndividual.get,parameters:"_recordId=".concat(e.recordId)}).then(e=>{n=e.record.clientId}),a=V.Z;break;case P.J.ResignationRequest:a=ea.Z;break;case P.J.LeaveRequest:a=et.Z;break;case P.J.Samples:a=en.Z;break;case P.J.PayrollList:a=el.Z;break;case P.J.OutwardsOrder:a=W.Z;break;case P.J.CashTransfer:a=_.Z;break;case P.J.OutwardsModification:a=J.Z;break;case P.J.OutwardsReturn:a=B.Z;break;case P.J.InwardTransfer:a=H.Z;break;case P.J.InwardSettlement:a=Q.Z;break;case P.J.Sketch:a=G.Z;break;case P.J.SalesOrder:a=$.Z;break;case P.J.ThreeDDesign:a=U.Z;break;case P.J.LoanRequest:a=z.Z;break;case P.J.PurchaseRequisition:a=Y.Z;break;case P.J.PurchaseOrder:a=K.Z;break;case P.J.MaterialRequest:a=X.Z;break;case P.J.CostAllocation:a=ee.Z;break;case P.J.MRP:a=er.Z;break;case P.J.ReturnFromLeave:a=es.Z;break;case P.J.Penalty:a=ed.Z;break;case P.J.TimeVariation:a=eo.Z;break;case P.J.DuringShiftLeave:a=ei.Z;break;case P.J.JobInfo:a=eu.Z;break;case P.J.PaymentOrder:a=ec.Z;break;case P.J.WorkCenterConsumption:a=em.Z;break;case P.J.ProductionOrder:a=ev.Z;break;case P.J.StockCount:a=ep.Z}if(a){let e=window.sessionStorage.getItem("userData")?JSON.parse(window.sessionStorage.getItem("userData")):null,t=await b(e);m({Component:a,props:{recordId:n,plantId:t,userData:e}})}},Z=async e=>{await R(e)},F=[{field:"reference",headerName:h.reference,flex:2},{field:"functionName",headerName:h.functionName,flex:2},{field:"thirdParty",headerName:h.thirdParty,flex:2},{field:"strategyName",headerName:h.strategy,flex:2},{field:"date",headerName:h.date,flex:2,type:"date"},{field:"approval",flex:1,cellRenderer:e=>(0,n.jsx)(r.Z,{sx:{display:"flex",width:"100%",justifyContent:"center"},children:(0,n.jsx)(s.Z,{size:"small",onClick:()=>ey(e.data),children:(0,n.jsx)(d.Z,{icon:"mdi:application-edit-outline",fontSize:18})})})}],ey=e=>{m({Component:j,props:{labels:h,maxAccess:h,maxAccess:C,recordId:e.recordId,functionId:e.functionId,seqNo:e.seqNo}})};return(0,n.jsxs)(S.R,{children:[(0,n.jsx)(M.g,{children:(0,n.jsx)(i.Z,{maxAccess:C,onSearch:e=>{f("qry",e)},onSearchClear:()=>{I("qry")},labels:h,inputSearch:!0})}),(0,n.jsx)(q.Q,{children:(0,n.jsx)(o.Z,{columns:F,gridData:p,rowId:["functionId","seqNo","recordId"],onEdit:Z,isLoading:!1,pageSize:a,refetch:x,paginationParameters:g,paginationType:"api",maxAccess:C})})]})}},93741:function(e,a,t){"use strict";t.d(a,{Z:function(){return M}});var n=t(52322),l=t(60218),r=t(2784),s=t(48601),d=t(82737),o=t(62202),i=t(65950),u=t(26612),c=t(5088),m=t(31389),v=t(80983),p=t(27423),y=t(2119),h=t(8661),f=t(38449),I=t(89330),x=t(76399),g=t(33625),C=t(62362),D=t(91406),b=t(57393),R=t(54074);function S(e){var a,t;let{labels:d,maxAccess:o,recordId:u,forceNoteCount:p,row:y,updateRow:h,readOnly:f,window:I}=e,{getRequest:S}=(0,r.useContext)(i.$),{formik:q}=(0,v.c)({maxAccess:o,initialValues:{total:0,currencyNotes:[{id:1,seqNo:"",cashCountId:0,note:"",qty:"",subTotal:""}]},validateOnChange:!0,validationSchema:s.Ry({currencyNotes:s.IX().of(s.Ry().shape({note:s.Z_().required()})).required("Operations array is required")}),onSubmit:async e=>{var a;let t=null===(a=e.currencyNotes.filter(e=>e.qty>0))||void 0===a?void 0:a.map(e=>{let{id:a,seqNo:t,cashCountId:n,qty:l,qty1:r,qty100:s,qty1000:d,...o}=e;return{seqNo:y.id,qty:l,qty1:r||0,qty100:s||0,qty1000:d||0,cashCountId:(null==y?void 0:y.cashCountId)<1?0:null==y?void 0:y.cashCountId,...o}}),n=e.currencyNotes.reduce((e,a)=>{let{subTotal:t}=a;return e+(Number(t)||0)},0);p?h({changes:{counted:n,currencyNotes:t,variation:n-(y.system||0),flag:y.system===n}}):h({changes:{currencyNotes:t}}),I.close()}});(0,r.useEffect)(()=>{(null==y?void 0:y.id)&&w()},[u]);let w=async()=>{var e;let a="_currencyId="+y.currencyId,{list:t}=await S({extension:b.s.CcCashNotes.qry,parameters:a}),n=null===(e=y.currencyNotes)||void 0===e?void 0:e.map((e,a)=>{let{id:t,qty:n,note:l,...r}=e;return{id:a+1,qty:n,note:l,subTotal:n*l,...r}}),l=(null==t?void 0:t.map((e,a)=>{let{...t}=e;return{id:a+1,...t}})).map(e=>{let a={id:e.id,note:e.note,seqNo:null,qty:"",subTotal:0},t=null==n?void 0:n.find(e=>a.note===e.note);return t&&(a.qty=t.qty,a.qty1=t.qty1||"",a.qty100=t.qty100||"",a.qty1000=t.qty1000||"",a.seqNo=t.seqNo,a.subTotal=t.subTotal),a});q.setFieldValue("currencyNotes",l)},P=null===(t=q.values)||void 0===t?void 0:null===(a=t.currencyNotes)||void 0===a?void 0:a.reduce((e,a)=>{let{subTotal:t}=a;return e+(Number(t)||0)},0);function Z(e){let{update:a,newRow:t}=e,n=(null==t?void 0:t.note)||0,l=((null==t?void 0:t.qty1)||0)+100*((null==t?void 0:t.qty100)||0)+1e3*((null==t?void 0:t.qty1000)||0);a({qty:l,subTotal:l*n})}return(0,n.jsx)(R.Z,{onSave:q.handleSubmit,maxAccess:o,children:(0,n.jsxs)(m.R,{children:[(0,n.jsx)(g.g,{children:(0,n.jsx)(l.ZP,{container:!0,xs:6,children:(0,n.jsx)(c.Z,{name:"reference",label:d.currency,value:y.currencyRef,readOnly:!0})})}),(0,n.jsx)(C.Q,{children:(0,n.jsx)(x._,{onChange:e=>q.setFieldValue("currencyNotes",e),value:q.values.currencyNotes,error:q.errors.currencyNotes,columns:[{component:"numberfield",label:d.currencyNote,name:"note",props:{readOnly:!0}},{component:"numberfield",label:d.qty1,name:"qty1",props:{readOnly:f,decimalScale:0,maxLength:2,allowNegative:!1},async onChange(e){let{row:a}=e;Z(a)}},{component:"numberfield",label:d.qty100,name:"qty100",props:{readOnly:f,decimalScale:0,maxLength:3,allowNegative:!1},async onChange(e){let{row:a}=e;Z(a)}},{component:"numberfield",label:d.qty1000,name:"qty1000",props:{readOnly:f,decimalScale:0,allowNegative:!1},async onChange(e){let{row:a}=e;Z(a)}},{component:"numberfield",label:d.qty,name:"qty",props:{readOnly:!0},async onChange(e){let{row:{update:a,newRow:t}}=e,n=(null==t?void 0:t.note)||0;a({subTotal:((null==t?void 0:t.qty)||0)*n})}},{component:"numberfield",label:d.subTotal,name:"subTotal",props:{readOnly:!0}}],allowDelete:!1,allowAddNewLine:!1})}),(0,n.jsx)(g.g,{children:(0,n.jsx)(l.ZP,{container:!0,spacing:2,sx:{mb:3,display:"flex",justifyContent:"right"},children:(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsx)(D.Z,{name:"total",label:d.total,value:P,readOnly:!0})})})})]})})}var q=t(61802),w=t(39812),P=t(7121),Z=t(1685),F=t(71987),j=t(39704),k=t(19473);function T(e){let{cashCountId:a,fromPlantId:t,labels:d,maxAccess:u}=e,{postRequest:c}=(0,r.useContext)(i.$),{platformLabels:I}=(0,r.useContext)(k.l),{formik:x}=(0,v.c)({maxAccess:u,initialValues:{cashCountId:a,fromPlantId:t,toPlantId:"",toAccountId:""},validateOnChange:!0,validationSchema:s.Ry({toPlantId:s.Z_().required(" "),toAccountId:s.Z_().required(" ")}),onSubmit:async e=>{console.log(e);let n={cashCountId:a,fromPlantId:t,toPlantId:e.toPlantId,toAccountId:e.toAccountId};try{await c({extension:b.s.Generate.generate,record:JSON.stringify(n)}),o.ZP.success(I.Generated)}catch(e){}}});return(0,n.jsx)(R.Z,{onSave:x.handleSubmit,maxAccess:u,children:(0,n.jsx)(m.R,{children:(0,n.jsx)(g.g,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{endpointId:f.r.Plant.qry,name:"toPlantId",label:d.toPlant,values:x.values,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,maxAccess:u,onChange:(e,a)=>{x&&x.setFieldValue("toPlantId",null==a?void 0:a.recordId),x.setFieldValue("toAccountId",null),x.setFieldValue("fromCARef",null),x.setFieldValue("fromCAName",null)},error:x.touched.toPlantId&&!!x.errors.toPlantId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(p.U,{endpointId:y.G.CashAccount.snapshot,parameters:{_type:0},filter:{plantId:x.values.toPlantId},firstFieldWidth:5,valueField:"accountNo",displayField:"name",name:"toAccountId",displayFieldWidth:2,required:!0,label:d.toCashAccount,form:x,valueShow:"fromCARef",secondValueShow:"fromCAName",onChange:(e,a)=>{x.setFieldValue("toAccountId",a?a.recordId:null),x.setFieldValue("fromCARef",a?a.accountNo:null),x.setFieldValue("fromCAName",a?a.name:null)},error:x.touched.toAccountId&&!!x.errors.toAccountId,maxAccess:u})})]})})})})}var O=t(98345),N=t(19689),A=t(50023),V=t(21326);let L=e=>{var a,t,D,R,L;let{recordId:M,window:E}=e,{postRequest:_,getRequest:J}=(0,r.useContext)(i.$),{platformLabels:B}=(0,r.useContext)(k.l),[H,Q]=(0,r.useState)(!!M),{stack:W}=(0,q.zY)(),[G,U]=(0,r.useState)(!1),[$,Y]=(0,r.useState)(!1),z=async()=>{let e=(0,Z.m)("userData").userId,a="_userId=".concat(e,"&_functionId=").concat(P.J.CashCountTransaction),{record:t}=await J({extension:f.r.UserFunction.get,parameters:a});t&&et.setFieldValue("dtId",t.dtId);let{record:n}=await J({extension:f.r.UserDefaults.get,parameters:"_userId=".concat(e,"&_key=cashAccountId")}),l=null==n?void 0:n.value;if(l){let{record:e}=await J({extension:y.G.CbBankAccounts.get,parameters:"_recordId=".concat(l)});et.setFieldValue("cashAccountId",l),et.setFieldValue("cashAccountRef",e.reference),et.setFieldValue("cashAccountName",e.name)}let{record:r}=await J({extension:f.r.UserDefaults.get,parameters:"_userId=".concat(e,"&_key=plantId")});r&&et.setFieldValue("plantId",parseInt(r.value))},K=(0,F.E)({endpointId:b.s.CashCountTransaction.qry}),{labels:X,access:ee}=(0,A.Z)({datasetId:u.i.CashCountTransaction,editMode:!!M});(0,V.Z)({title:X.cashCount,window:E});let{maxAccess:ea}=(0,O.H)({functionId:P.J.CashCountTransaction,access:ee,hasDT:!1,enabled:!H}),{formik:et}=(0,v.c)({maxAccess:ea,initialValues:{recordId:null,plantId:null,reference:"",cashAccountId:"",cashAccountRef:"",cashAccountName:"",forceNoteCount:!1,wip:1,status:1,releaseStatus:"",date:new Date,startTime:"",endTime:"",items:[{id:1,cashCountId:"",seqNo:1,currencyId:"",currencyName:"",currencyRef:"",counted:"",system:"",variation:"",flag:"",currencyNotes:[]}]},validateOnChange:!0,validationSchema:s.Ry({cashAccountRef:s.Z_().required(),plantId:s.Z_().required(),items:s.IX().of(s.Ry().shape({currencyId:s.Z_().required(),counted:s.Z_().required()})).required()}),onSubmit:async e=>{let a={header:{recordId:e.recordId,dtId:e.dtId,plantId:e.plantId,shiftId:e.shiftId,currencyId:e.currencyId,cashAccountId:e.cashAccountId,forceNoteCount:e.forceNoteCount,reference:e.reference,date:(0,w.ku)(new Date),startTime:e.startTime,endTime:e.endTime,status:e.status,wip:e.wip,releaseStatus:e.releaseStatus},items:e.items.map((e,a)=>{let{id:t,flag:n,enabled:l,cashCountId:r,currencyNotes:s,...d}=e;return{seqNo:a+1,cashCountId:r||0,currencyNotes:s||[],...d}})},t=(await _({extension:b.s.CashCountTransaction.set2,record:JSON.stringify(a)})).recordId;e.recordId?o.ZP.success(B.Edited):(o.ZP.success(B.Added),en(t)),Q(!0),K()}});(0,r.useEffect)(()=>{H||z(),es()},[]),(0,r.useEffect)(()=>{en(M)},[M]);let en=async e=>{if(e){let{record:{header:a,items:t}}=await J({extension:b.s.CashCountTransaction.get2,parameters:"_recordId=".concat(e)});U(2===a.wip),Y(3===a.status),et.setValues({recordId:a.recordId,plantId:a.plantId,reference:a.reference,cashAccountId:a.cashAccountId,cashAccountRef:a.cashAccountRef,cashAccountName:a.cashAccountName,forceNoteCount:a.forceNoteCount,wip:a.wip,status:a.status,releaseStatus:a.releaseStatus,date:(0,w.a1)(a.date),startTime:a.startTime&&(0,w.s4)(a.startTime),endTime:a.endTime&&(0,w.s4)(a.endTime),items:t.map((e,a)=>{let{seqNo:t,variation:n,...l}=e;return{id:t,seqNo:t,variation:n,flag:0===n,...l}})})}};async function el(){let e=et.values,a={recordId:e.recordId,dtId:e.dtId,plantId:e.plantId,shiftId:e.shiftId,currencyId:e.currencyId,cashAccountId:e.cashAccountId,reference:e.reference,date:e.date,startTime:e.startTime,status:e.status,wip:e.wip,releaseStatus:e.releaseStatus},t=await _({extension:b.s.CashCountTransaction.reopen,record:JSON.stringify(a)}).then(()=>{t.recordId&&(o.ZP.success(B.Reopened),K(),en(null==e?void 0:e.recordId))})}let er=[{key:"Bulk",condition:!0,onClick:function(){W({Component:T,props:{labels:X,cashCountId:et.values.recordId,fromPlantId:et.values.plantId,maxAccess:ea},width:600,height:300,title:X.bulk})},disabled:!$},{key:"WorkFlow",condition:!0,onClick:async()=>{W({Component:j.Z,props:{functionId:P.J.CashCountTransaction,recordId:et.values.recordId}})},disabled:!H},{key:"Locked",condition:!0,onClick:()=>{_({extension:b.s.CashCountTransaction.post,record:JSON.stringify(et.values)}).then(e=>{(null==e?void 0:e.recordId)&&(o.ZP.success(B.Posted),K(),Y(!0))})},disabled:!H||4!==et.values.status||$},{key:"Close",condition:!G,onClick:()=>{_({extension:b.s.CashCountTransaction.close,record:JSON.stringify(et.values)}).then(e=>{(null==e?void 0:e.recordId)&&(o.ZP.success(B.Closed),K(),en(null==e?void 0:e.recordId))})},disabled:G||!H},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!G},{key:"Reopen",condition:G,onClick:el,disabled:!G||!H||3===et.values.releaseStatus},{key:"Account Balance",condition:!0,onClick:"onClickAC",disabled:!1}],es=async()=>{var e;let{record:a}=await J({extension:null===(e=f.r.TimeZone)||void 0===e?void 0:e.get,parameters:""});a&&(H||et.setFieldValue("startTime",(0,w.s4)(null==a?void 0:a.utcDate,"utc")))},ed=async e=>{var a,t;let n=null===(a=et.values)||void 0===a?void 0:a.cashAccountId;if(e&&n){let{record:a}=await J({extension:y.G.AccountBalance.get,parameters:"_currencyId="+e+"&_cashAccountId="+(null===(t=et.values)||void 0===t?void 0:t.cashAccountId)});if(a)return a.balance}};return(0,n.jsx)(d.Z,{actions:er,resourceId:u.i.CashCountTransaction,form:et,maxAccess:ea,editMode:H,functionId:P.J.CashCountTransaction,disabledSubmit:G,previewReport:H,children:(0,n.jsxs)(m.R,{children:[(0,n.jsx)(g.g,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(p.U,{endpointId:y.G.CashAccount.snapshot,parameters:{_type:2},name:"cashAccountRef",required:!0,label:X.cashAccount,readOnly:$||G,valueField:"reference",displayField:"name",valueShow:"cashAccountRef",secondValueShow:"cashAccountName",form:et,onChange:(e,a)=>{et.setValues({...et.values,cashAccountId:(null==a?void 0:a.recordId)||"",cashAccountRef:(null==a?void 0:a.reference)||"",cashAccountName:(null==a?void 0:a.name)||""})},maxAccess:ea})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(I.Z,{name:"date",label:X.date,value:et.values.date,onChange:et.setFieldValue,readOnly:!0,maxAccess:ea})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(h.Z,{endpointId:f.r.Plant.qry,name:"plantId",label:X.plant,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"plant Ref"},{key:"name",value:"Name"}],values:et.values,required:!0,readOnly:$||G,maxAccess:ea,onChange:(e,a)=>{let t=(null==a?void 0:a.recordId)||"";et.setFieldValue("plantId",t)},error:et.touched.plantId&&!!et.errors.plantId})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(c.Z,{name:"startTime",label:X.startTime,value:et.values.startTime,readOnly:!0,maxAccess:ea})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(c.Z,{name:"reference",label:X.reference,value:et.values.reference,readOnly:H,maxAccess:ea,onChange:e=>{et.handleChange(e)},onClear:()=>et.setFieldValue("reference",""),error:et.touched.reference&&!!et.errors.reference})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(c.Z,{name:"endTime",label:X.endTime,value:et.values.endTime,readOnly:!0,maxAccess:ea})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(N.Z,{name:"forceNoteCount",value:null===(a=et.values)||void 0===a?void 0:a.forceNoteCount,onChange:e=>et.setFieldValue("forceNoteCount",e.target.checked),label:X.forceNotesCount,maxAccess:ea,disabled:et.values.items&&((null===(D=et.values)||void 0===D?void 0:null===(t=D.items[0])||void 0===t?void 0:t.currencyId)||(null===(L=et.values)||void 0===L?void 0:null===(R=L.items[0])||void 0===R?void 0:R.currencyId))})})]})}),(0,n.jsx)(C.Q,{children:(0,n.jsx)(x._,{onChange:e=>et.setFieldValue("items",e),value:et.values.items,error:et.errors.items,name:"currency",maxAccess:ea,columns:[{component:"resourcecombobox",label:X.currency,name:"currencyId",props:{readOnly:$||G,endpointId:f.r.Currency.qry,valueField:"recordId",displayField:"reference",mapping:[{from:"recordId",to:"currencyId"},{from:"reference",to:"currencyRef"},{from:"name",to:"currencyName"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:2},propsReducer(e){var a;let{row:t,props:n}=e;return{...n,readOnly:(null===(a=t.currencyNotes)||void 0===a?void 0:a.length)>0}},async onChange(e){let{row:{update:a,newRow:t}}=e;(null==t?void 0:t.currencyId)&&a({system:await ed(null==t?void 0:t.currencyId)})}},{component:"numberfield",name:"counted",label:X.count,props:{readOnly:et.values.forceNoteCount||$||G},async onChange(e){let{row:{update:a,newRow:t}}=e,n=t.counted||0,l=t.system||0;a({variation:n-l,flag:l===n})}},{component:"numberfield",label:X.system,name:"system",props:{readOnly:!0}},{component:"icon",label:X.flag,name:"flag"},{component:"button",name:"enabled",label:X.currencyNotes,props:{onCondition:e=>({disabled:!(null==e?void 0:e.currencyId)})},onClick:(e,a,t,n)=>{W({Component:S,props:{readOnly:$||G,labels:X,maxAccess:ea,forceNoteCount:et.values.forceNoteCount,row:a,updateRow:n},width:700,title:null==X?void 0:X.currencyNotes})}}],allowDelete:!G||!$&&!G})})]})})};L.width=1100,L.height=700;var M=L},57981:function(e,a,t){"use strict";var n=t(52322),l=t(2784),r=t(60218),s=t(48601),d=t(5088),o=t(82737),i=t(26612),u=t(8661),c=t(2119),m=t(65950),v=t(38449),p=t(71987),y=t(89330),h=t(62202),f=t(96026),I=t(7121),x=t(91088),g=t(76399),C=t(21581),D=t(30390),b=t(39812),R=t(31389),S=t(33625),q=t(62362),w=t(61802),P=t(80983),Z=t(1251),F=t(26553),j=t(30657),k=t(39704),T=t(98345),O=t(50023),N=t(21326);let A=e=>{var a,t,A,V;let{recordId:L,plantId:M,cashAccountId:E,dtId:_,refetch:J,window:B}=e,[H,Q]=(0,l.useState)(!!L),{getRequest:W,postRequest:G}=(0,l.useContext)(m.$),{stack:U}=(0,f.V)(),{stack:$}=(0,w.zY)(),[Y,z]=(0,l.useState)(!1),[K,X]=(0,l.useState)(!0),ee=(0,p.E)({endpointId:c.G.CashTransfer.page}),{labels:ea,access:et}=(0,O.Z)({datasetId:i.i.CashTransfer,editMode:!!L});(0,N.Z)({title:ea.cashTransfer,window:B});let[en,el]=(0,l.useState)({recordId:L||null,dtId:parseInt(_),reference:"",date:new Date,toPlantId:parseInt(M),fromPlantId:parseInt(M),fromCashAccountId:parseInt(E),toCashAccountId:"",baseAmount:"",notes:"",wip:"",status:"",statusName:"",releaseStatus:"",rsName:"",wipName:"",transfers:[{id:1,transferId:L||0,seqNo:"",currencyId:"",currencyName:"",currencyRef:"",amount:"",baseAmount:"",exRate:"",rateCalcMethod:"",balance:0}]}),{maxAccess:er}=(0,T.H)({functionId:I.J.CashTransfer,access:et,enabled:!L,hasDT:!1}),{formik:es}=(0,P.c)({maxAccess:er,initialValues:en,validateOnChange:!0,validationSchema:s.Ry({fromCashAccountId:s.Z_().required(),fromPlantId:s.Z_().required(),date:s.Z_().required(),toPlantId:s.Z_().required(),toCashAccountId:s.Z_().nullable().test("",function(e){let{fromPlantId:a,toPlantId:t}=this.parent;return a!=t||!!e}),transfers:s.IX().of(s.Ry().shape({currencyName:s.Z_().required(),amount:s.Z_().nullable().required()})).required()}),onSubmit:async e=>{let a={...e};delete a.transfers,a.date=(0,b.ku)(a.date),a.status=""===a.status?1:a.status,a.wip=""===a.wip?1:a.wip,a.baseAmount=ed;let t=es.values.transfers.map((e,a)=>({...e,seqNo:a+1,transferId:es.values.recordId||0}));if(1===t.length&&""===t[0].currencyId){U({message:"Grid not filled. Please fill the grid before saving."});return}let n=await G({extension:c.G.CashTransfer.set,record:JSON.stringify({header:a,items:t})});if(n.recordId){h.ZP.success("Record Updated Successfully"),es.setFieldValue("recordId",n.recordId),Q(!0);let e=await W({extension:c.G.CashTransfer.get,parameters:"_recordId=".concat(n.recordId)});es.setFieldValue("reference",e.record.reference),ee()}}}),ed=es.values.transfers.reduce((e,a)=>{var t;return e+(parseFloat(null===(t=a.baseAmount)||void 0===t?void 0:t.toString().replace(/,/g,""))||0)},0),eo=async()=>{let{transfers:e,...a}=es.values,t={...a};if(t.date=(0,b.ku)(t.date),t.wip=""===t.wip?1:t.wip,t.status=""===t.status?1:t.status,t.baseAmount=ed,(await G({extension:c.G.CashTransfer.close,record:JSON.stringify(t)})).recordId){var n;h.ZP.success("Record Closed Successfully"),ee(),z(!0);let e=await W({extension:c.G.CashTransfer.get,parameters:"_recordId=".concat(es.values.recordId)});(null==e?void 0:null===(n=e.record)||void 0===n?void 0:n.status)==4&&X(!1)}},ei=async()=>{let{transfers:e,...a}=es.values,t={...a};t.date=(0,b.ku)(t.date),t.wip=""===t.wip?1:t.wip,t.status=""===t.status?1:t.status,t.baseAmount=ed,(await G({extension:c.G.CashTransfer.reopen,record:JSON.stringify(t)})).recordId&&(h.ZP.success("Record Closed Successfully"),ee(),J&&(J(),B.close()),z(!1),X(!0))},eu=async(e,a)=>{let t=(await W({extension:c.G.CurrencyTransfer.qry,parameters:"_transferId=".concat(e)})).list.map(e=>{var a;return{...e,id:e.seqNo,amount:parseFloat(e.amount).toFixed(2),balance:null!==(a=parseFloat(null==e?void 0:e.balance).toFixed(2))&&void 0!==a?a:0}});es.setValues({...a,transfers:t})},ec=async()=>{if(E){let e=await W({extension:c.G.CashAccount.get,parameters:"_recordId=".concat(E)});e.record&&(es.setFieldValue("fromCARef",e.record.accountNo),es.setFieldValue("fromCAName",e.record.name))}};(0,l.useEffect)(()=>{!async function(){if(L){let e=await W({extension:c.G.CashTransfer.get,parameters:"_recordId=".concat(L)});e.record.date=(0,b.a1)(e.record.date),z(2===e.record.wip),X(4!==e.record.status),await eu(L,e.record)}else ec()}()},[]);let em=[{key:"WorkFlow",condition:!0,onClick:async()=>{$({Component:k.Z,props:{functionId:I.J.CashTransfer,recordId:es.values.recordId}})},disabled:!H},{key:"Close",condition:!Y,onClick:eo,disabled:Y||!H},{key:"Reopen",condition:Y,onClick:ei,disabled:!Y||!H||3===es.values.releaseStatus&&3===es.values.status},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!Y},{key:"Shipment",condition:!0,onClick:()=>{$({Component:x.u,props:{recordId:es.values.recordId,functionId:I.J.CashTransfer,editMode:Y,totalBaseAmount:ed}})},disabled:H&&es.values.fromPlantId==es.values.toPlantId||!H},{key:"Account Balance",condition:!0,onClick:"onClickAC",disabled:!1},{key:"Cash Transaction",condition:!0,onClick:"transactionClicked",disabled:!H}];return(0,n.jsx)(o.Z,{resourceId:i.i.CashTransfer,form:es,editMode:H,maxAccess:er,functionId:I.J.CashTransfer,actions:em,disabledSubmit:Y,children:(0,n.jsxs)(R.R,{children:[(0,n.jsx)(S.g,{children:(0,n.jsxs)(r.ZP,{container:!0,children:[(0,n.jsxs)(r.ZP,{container:!0,rowGap:2,xs:6,sx:{px:2},spacing:2,children:[(0,n.jsx)(r.ZP,{item:!0,xs:12,children:(0,n.jsx)(d.Z,{name:"reference",label:ea.reference,value:null==es?void 0:null===(a=es.values)||void 0===a?void 0:a.reference,maxAccess:er,maxLength:"15",readOnly:H,error:es.touched.reference&&!!es.errors.reference})}),(0,n.jsx)(r.ZP,{item:!0,xs:12,children:(0,n.jsx)(u.Z,{endpointId:v.r.Plant.qry,name:"fromPlantId",label:ea.fromPlant,values:es.values,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:!0,required:!0,maxAccess:er,onChange:(e,a)=>{es&&es.setFieldValue("fromPlantId",null==a?void 0:a.recordId)},error:es.touched.fromPlantId&&!!es.errors.fromPlantId})}),(0,n.jsx)(r.ZP,{item:!0,xs:12,children:(0,n.jsx)(u.Z,{endpointId:c.G.CashAccount.qry,parameters:"_type=0",name:"fromCashAccountId",label:ea.fromCashAcc,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:es.values,readOnly:!0,required:!0,maxAccess:er,onChange:(e,a)=>{es.setFieldValue("fromCashAccountId",(null==a?void 0:a.recordId)||null)},error:es.touched.fromCashAccountId&&!!es.errors.fromCashAccountId})})]}),(0,n.jsxs)(r.ZP,{container:!0,rowGap:2,xs:6,sx:{px:2},spacing:2,children:[(0,n.jsx)(r.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{name:"date",required:!0,readOnly:Y,label:ea.date,value:null==es?void 0:null===(t=es.values)||void 0===t?void 0:t.date,onChange:es.setFieldValue,editMode:H,maxAccess:er,onClear:()=>es.setFieldValue("date",""),error:es.touched.date&&!!es.errors.date})}),(0,n.jsx)(r.ZP,{item:!0,xs:12,children:(0,n.jsx)(u.Z,{endpointId:v.r.Plant.qry,name:"toPlantId",label:ea.toPlant,values:es.values,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,readOnly:Y,maxAccess:er,onChange:(e,a)=>{es.setFieldValue("toPlantId",a?a.recordId:null),es.setFieldValue("toCashAccountId",null),es.setFieldValue("toCARef",null),es.setFieldValue("toCAName",null)},error:es.touched.toPlantId&&!!es.errors.toPlantId})}),(0,n.jsx)(r.ZP,{item:!0,xs:12,children:(0,n.jsx)(u.Z,{endpointId:c.G.CashAccount.qry,parameters:"_type=0",name:"toCashAccountId",label:ea.toCashAcc,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:es.values,required:es.values.fromPlantId===es.values.toPlantId,filter:e=>e.plantId===es.values.toPlantId,readOnly:!es.values.toPlantId||Y,maxAccess:er,onChange:(e,a)=>{es.setFieldValue("toCashAccountId",(null==a?void 0:a.recordId)||null)},error:es.touched.toCashAccountId&&!!es.errors.toCashAccountId})})]})]})}),(0,n.jsx)(q.Q,{children:(0,n.jsx)(g._,{onChange:e=>es.setFieldValue("transfers",e),value:es.values.transfers,error:es.errors.transfers,allowDelete:!Y,allowAddNewLine:!Y,maxAccess:er,initialValues:null==es?void 0:null===(V=es.initialValues)||void 0===V?void 0:null===(A=V.transfers)||void 0===A?void 0:A[0],name:"currencies",columns:[{component:"resourcecombobox",label:ea.currency,name:"currencyName",props:{disabled:Y,endpointId:v.r.Currency.qry,displayField:"reference",valueField:"recordId",mapping:[{from:"recordId",to:"currencyId"},{from:"name",to:"currencyName"},{from:"reference",to:"currencyRef"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}]},widthDropDown:200,displayFieldWidth:2,async onChange(e){let{row:{update:a,newRow:t}}=e;if((null==t?void 0:t.currencyId)&&t.currencyId){var n,l,r;let e=await (r=null==t?void 0:t.currencyId,W({extension:Z.q.Currency.get,parameters:"_currencyId=".concat(r,"&_date=").concat((0,b.Uf)(es.values.date),"&_rateDivision=").concat(F.B.FINANCIALS)}));a({exRate:null===(n=e.record)||void 0===n?void 0:n.exRate,rateCalcMethod:null===(l=e.record)||void 0===l?void 0:l.rateCalcMethod})}}},{component:"numberfield",label:ea.amount,name:"amount",props:{readOnly:Y},async onChange(e){let{row:{update:a,newRow:t}}=e;(null==t?void 0:t.amount)&&(null==t?void 0:t.amount)&&a({baseAmount:(0,j.fB)({amount:null==t?void 0:t.amount,exRate:null==t?void 0:t.exRate,baseAmount:null==t?void 0:t.baseAmount,rateCalcMethod:null==t?void 0:t.rateCalcMethod,dirtyField:j.H9}).baseAmount})}},{component:"numberfield",label:ea.baseAmount,name:"baseAmount",props:{readOnly:!0}},{component:"numberfield",name:"balance",label:ea.balance,props:{readOnly:!0}}]})}),(0,n.jsx)(S.g,{children:(0,n.jsx)(D.Z,{container:!0,rowGap:1,xs:7,style:{marginTop:"10px"},children:(0,n.jsx)(C.Z,{name:"notes",label:ea.note,value:es.values.notes,rows:3,readOnly:Y,maxLength:"100",editMode:H,maxAccess:er,onChange:e=>es.setFieldValue("notes",e.target.value),onClear:()=>es.setFieldValue("notes","")})})})]})})};A.width=1100,A.height=650,a.Z=A},47441:function(e,a,t){"use strict";var n=t(52322),l=t(89330),r=t(39812),s=t(60218),d=t(95453),o=t(37691),i=t(6640),u=t(2784),c=t(96026),m=t(48601),v=t(82737),p=t(62202),y=t(65950),h=t(71987),f=t(26612),I=t(5088),x=t(21581),g=t(8661),C=t(38449),D=t(7121),b=t(53621),R=t(17627),S=t(24074),q=t(27423),w=t(61802),P=t(58974),Z=t(50023),F=t(23361),j=t(80983),k=t(30390),T=t(39704),O=t(76399),N=t(31389),A=t(33625),V=t(62362),L=t(19473),M=t(98345),E=t(96333),_=t(91088),J=t(21326),B=t(67920),H=t(91406),Q=t(1685);let W=e=>{var a,t,W,G,U,$,Y,z,K,X,ee,ea,et,en,el;let{recordId:er,window:es}=e,{platformLabels:ed,userDefaultsData:eo}=(0,u.useContext)(L.l),{getRequest:ei,postRequest:eu}=(0,u.useContext)(y.$),{stack:ec}=(0,c.V)(),[em,ev]=(0,u.useState)(D.J.CurrencyCreditOrderPurchase),[ep,ey]=(0,u.useState)(null),{stack:eh}=(0,w.zY)(),ef=(0,Q.m)("userData").userId,eI=parseInt(null==eo?void 0:null===(t=eo.list)||void 0===t?void 0:null===(a=t.find(e=>{let{key:a}=e;return"plantId"===a}))||void 0===a?void 0:a.value),{labels:ex,access:eg}=(0,Z.Z)({datasetId:f.i.CreditOrder,editMode:!!er});(0,J.Z)({title:ex.creditOrder,window:es});let{maxAccess:eC}=(0,M.H)({functionId:em,access:eg,enabled:!er,hasDT:!1}),eD=(0,h.E)({endpointId:R.s.CreditOrder.page}),{schema:eb,requiredFields:eR}=(0,B.m)({currencyRef:e=>null==e?void 0:e.currencyRef,currencyName:e=>null==e?void 0:e.currencyName,qty:e=>null==e?void 0:e.qty,exRate:e=>null==e?void 0:e.exRate,amount:e=>null==e?void 0:e.amount},!0,eC,"rows"),{formik:eS}=(0,j.c)({maxAccess:eC,initialValues:{recordId:er,currencyId:null,currencyRef:"",date:new Date,functionId:D.J.CurrencyCreditOrderPurchase,deliveryDate:new Date,reference:"",dtId:null,plantId:parseInt(eI),corId:null,corRef:"",corName:"",wip:1,status:1,releaseStatus:"",notes:"",amount:0,baseAmount:0,exRate:1,rateCalcMethod:"",rateType:"",isTFRClicked:!1,rows:[{id:1,orderId:er||null,seqNo:"",currencyId:null,qty:"",rateCalcMethod:"",exRate:"",minRate:"",maxRate:"",defaultRate:"",amount:"",baseAmount:"",notes:"",goc:!1}]},validateOnChange:!0,validationSchema:m.Ry({date:m.Z_().required(),plantId:m.Z_().required(),corId:m.Z_().required(),rows:m.IX().of(eb)}),onSubmit:async e=>{var a;let t={...e,date:(0,r.ku)(e.date),deliveryDate:(0,r.ku)(e.deliveryDate),amount:ek,baseAmount:eT};delete t.rows;let n=null===(a=eS.values.rows.filter(e=>{var a;return null===(a=Object.values(eR))||void 0===a?void 0:a.every(a=>a(e))}))||void 0===a?void 0:a.map((e,a)=>({...e,seqNo:a+1,orderId:eS.values.recordId||0})),l=await eu({extension:R.s.CreditOrder.set,record:JSON.stringify({header:t,items:n})}),s=e.recordId?ed.Edited:ed.Added;p.ZP.success(s),await eQ(null==l?void 0:l.recordId),eD()}}),eq=2==eS.values.wip,ew=3===eS.values.releaseStatus&&3!==eS.values.status,eP=!!eS.values.recordId,eZ=async()=>{let e=await eu({extension:R.s.CreditOrder.close,record:JSON.stringify(eS.values)});p.ZP.success(ed.Closed),eD(),eQ(null==e?void 0:e.recordId)},eF=async()=>{let e=await eu({extension:R.s.CreditOrder.reopen,record:JSON.stringify(eS.values)});p.ZP.success(ed.Closed),eD(),eQ(null==e?void 0:e.recordId)},ej=async()=>{let e=await eu({extension:R.s.CreditOrder.tfr,record:JSON.stringify(eS.values)});p.ZP.success(ed.Generated),eD(),await eQ(eS.values.recordId),es.close(),eh({Component:P.Z,props:{recordId:null==e?void 0:e.recordId}})},ek=(null==eS?void 0:null===(G=eS.values)||void 0===G?void 0:null===(W=G.rows)||void 0===W?void 0:W.length)?eS.values.rows.reduce((e,a)=>{var t;return e+(parseFloat(null===(t=a.amount)||void 0===t?void 0:t.toString().replace(/,/g,""))||0)},0):0,eT=(null==eS?void 0:null===($=eS.values)||void 0===$?void 0:null===(U=$.rows)||void 0===U?void 0:U.length)?eS.values.rows.reduce((e,a)=>{var t;return e+(parseFloat(null===(t=a.baseAmount)||void 0===t?void 0:t.toString().replace(/,/g,""))||0)},0):0,eO=async(e,a,t)=>{var n,l,r,s;if(!e)return;let d=await ei({extension:b.d.Correspondent.get,parameters:"_recordId=".concat(e)});eS.setFieldValue("currencyId",(null==d?void 0:null===(n=d.record)||void 0===n?void 0:n.currencyId)||null),eS.setFieldValue("currencyRef",(null==d?void 0:null===(l=d.record)||void 0===l?void 0:l.currencyRef)||"");let o=await ei({extension:S.u.Defaults.get,parameters:"_key=ct_credit_eval_ratetype_id"});eA(t,null==d?void 0:null===(r=d.record)||void 0===r?void 0:r.currencyId,a,null==o?void 0:null===(s=o.record)||void 0===s?void 0:s.value)},eN=async e=>{var a;let t=await ei({extension:C.r.UserFunction.get,parameters:"_userId=".concat(ef,"&_functionId=").concat(e)});eS.setFieldValue("dtId",null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.dtId)};async function eA(e,a,t,n){var l,r,s,d,o;if(!e||!a||!n||!t){e||ec({message:ex.emptyPlant}),a||(eS.setFieldValue("corId",null),eS.setFieldValue("corRef",""),eS.setFieldValue("corName",""),ec({message:ex.emptyToCurrency})),n||ec({message:ex.emptyRate}),t||ec({message:ex.emptyFromCurrency});return}let i=await ei({extension:S.u.ExchangeMap.get,parameters:"_plantId=".concat(e,"&_currencyId=").concat(a,"&_raCurrencyId=").concat(t,"&_rateTypeId=").concat(n)});if(!(null==i?void 0:null===(l=i.record)||void 0===l?void 0:l.rate)){ec({message:ex.undefinedCorRate});return}eS.setFieldValue("currencyId",a),eS.setFieldValue("exRate",null==i?void 0:null===(r=i.record)||void 0===r?void 0:r.rate),eS.setFieldValue("rateCalcMethod",null==i?void 0:null===(s=i.record)||void 0===s?void 0:s.rateCalcMethod),eS.setFieldValue("minRate",null==i?void 0:null===(d=i.record)||void 0===d?void 0:d.minRate),eS.setFieldValue("maxRate",null==i?void 0:null===(o=i.record)||void 0===o?void 0:o.maxRate)}async function eV(e){for(let a in e)if(!e[a]){ec({message:"".concat(a," ").concat(ex.empty)});return}let a=await ei({extension:S.u.ExchangeMap.get,parameters:"_plantId=".concat(e.plantId,"&_currencyId=").concat(e.fromCurrency,"&_raCurrencyId=").concat(e.toCurrency,"&_rateTypeId=").concat(e.rateType)});return null==a?void 0:a.record}let eL=[{component:"resourcecombobox",label:ex.currency,name:"currencyRef",flex:2,props:{endpointId:C.r.Currency.qry,displayField:"reference",valueField:"recordId",mapping:[{from:"recordId",to:"currencyId"},{from:"reference",to:"currencyRef"},{from:"name",to:"currencyName"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:3},async onChange(e){var a,t,n;let{row:{update:l,oldRow:r,newRow:s}}=e;if(!(null==s?void 0:s.currencyId))return;let d=await eV({plantId:eI||eS.values.plantId,toCurrency:null==eS?void 0:null===(a=eS.values)||void 0===a?void 0:a.currencyId,fromCurrency:null==s?void 0:s.currencyId,rateType:null==eS?void 0:null===(t=eS.values)||void 0===t?void 0:t.rateType});if(!(null==d?void 0:d.rate)){l({exRate:0,defaultRate:0,amount:0,baseAmount:0}),ec({message:"".concat(ex.undefinedRate," ").concat(null==s?void 0:s.currencyRef,".")});return}let o=0,i=0;if(null==s?void 0:s.qty){let e=parseFloat(null==s?void 0:null===(n=s.qty)||void 0===n?void 0:n.toString().replace(/,/g,""))||0,a=1===d.rateCalcMethod?e*d.rate:2===d.rateCalcMethod?e/d.rate:0;o=parseFloat(a).toFixed(2),i=parseFloat(1===eS.values.rateCalcMethod?a*eS.values.exRate:2===eS.values.rateCalcMethod?a/eS.values.exRate:0).toFixed(2)}let u=await eM(null==s?void 0:s.currencyId);l({currencyId:d.currencyId,currencyName:d.currencyName,exRate:d.rate.toFixed(7),defaultRate:d.rate.toFixed(7),rateCalcMethod:d.rateCalcMethod,minRate:d.minRate,maxRate:d.maxRate,goc:(null==u?void 0:u.goc)||!1,amount:o,baseAmount:i})}},{component:"textfield",label:ex.name,name:"currencyName",props:{readOnly:!0},flex:3},{component:"numberfield",label:ex.quantity,name:"qty",flex:2,updateOn:"blur",async onChange(e){var a,t;let{row:{update:n,newRow:l}}=e,r=l.rateCalcMethod,s=1===r?parseFloat(null==l?void 0:null===(a=l.qty)||void 0===a?void 0:a.toString().replace(/,/g,""))*(null==l?void 0:l.exRate):2===r?parseFloat(null==l?void 0:null===(t=l.qty)||void 0===t?void 0:t.toString().replace(/,/g,""))/(null==l?void 0:l.exRate):0,d=1===eS.values.rateCalcMethod?parseFloat(s)*eS.values.exRate:2===r?parseFloat(s)/eS.values.exRate:0;n({amount:parseFloat(s).toFixed(2),baseAmount:parseFloat(d).toFixed(2),qty:parseFloat(null==l?void 0:l.qty).toFixed(2)})}},{component:"numberfield",label:ex.defaultRate,name:"defaultRate",props:{readOnly:!0},flex:2},{component:"numberfield",label:ex.exRate,name:"exRate",props:{decimalScale:7},flex:2,updateOn:"blur",async onChange(e){let{row:{update:a,newRow:t}}=e;if(!t.currencyId||!t.exRate){a({exRate:"",defaultRate:"",amount:0,baseAmount:0});return}let n=e=>parseFloat(null==e?void 0:e.toString().replace(/,/g,""))||0,l=n(t.exRate);if(l>0){let e=n(t.minRate),r=n(t.maxRate);if(l>=e&&l<=r){let e=n(t.qty),r=t.rateCalcMethod,s=1===r?e*l:2===r?e/l:0,d=1===eS.values.rateCalcMethod?s*eS.values.exRate:2===eS.values.rateCalcMethod?s/eS.values.exRate:0;a({exRate:l.toFixed(7),amount:s.toFixed(2),baseAmount:d.toFixed(2)})}else ec({message:"".concat(l," ").concat(ex.invalidRange," [").concat(e,"-").concat(r,"]")}),a({exRate:"",amount:0,baseAmount:0})}}},{component:"numberfield",label:"".concat(ex.total," ").concat(eS.values.currencyRef||""),name:"amount",props:{readOnly:!0},flex:2}];async function eM(e){if(!e)return;let a=await ei({extension:b.d.CorrespondentCurrency.get,parameters:"_corId=".concat(eS.values.corId,"&_currencyId=").concat(e)});return null==a?void 0:a.record}let eE=async e=>{var a;let t=await ei({extension:R.s.CreditOrderItem.qry,parameters:"_orderId=".concat(e)});return(null==t?void 0:null===(a=t.list)||void 0===a?void 0:a.length)>0?t.list.map((e,a)=>({...e,id:a+1,qty:parseFloat(null==e?void 0:e.qty).toFixed(2),amount:parseFloat(null==e?void 0:e.amount).toFixed(2),baseAmount:parseFloat(null==e?void 0:e.baseAmount).toFixed(2),exRate:parseFloat(null==e?void 0:e.exRate).toFixed(7),defaultRate:parseFloat(null==e?void 0:e.defaultRate).toFixed(7)})):eS.initialValues.rows};async function e_(e){if(e==D.J.CurrencyCreditOrderPurchase||e==D.J.CurrencyCreditOrderSale){var a;let t=await ei({extension:S.u.Defaults.get,parameters:e==D.J.CurrencyCreditOrderPurchase?"_key=ct_credit_purchase_ratetype_id":e==D.J.CurrencyCreditOrderSale?"_key=ct_credit_sales_ratetype_id":""});eS.setFieldValue("rateType",null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.value),eS.setFieldValue("functionId",e)}}async function eJ(){var e,a;let t=await ei({extension:C.r.Defaults.get,parameters:"_key=baseCurrencyId"});return await eB(null==t?void 0:null===(e=t.record)||void 0===e?void 0:e.value),null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.value}let eB=async e=>{ei({extension:C.r.Currency.get,parameters:"_recordId=".concat(e)}).then(e=>{var a;ey(null==e?void 0:null===(a=e.record)||void 0===a?void 0:a.reference)})};async function eH(e){return await await ei({extension:R.s.CreditOrder.get,parameters:"_recordId=".concat(e)})}async function eQ(e){let a=await eH(e),t=await eE(e);eS.setValues(e=>{var n;return{...e,...a.record,date:(0,r.a1)(a.record.date),deliveryDate:(null==a?void 0:null===(n=a.record)||void 0===n?void 0:n.deliveryDate)?(0,r.a1)(a.record.deliveryDate):null,rows:t}}),await e_(a.record.functionId)}let eW=async()=>{eh({Component:T.Z,props:{functionId:eS.values.functionId,recordId:eS.values.recordId}})},eG=[{key:"Close",condition:!eq,onClick:eZ,disabled:eq||!eP},{key:"Reopen",condition:eq,onClick:eF,disabled:!eq||!eP||3===eS.values.releaseStatus&&3===eS.values.status},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!eq},{key:"Invoice",condition:ej,onClick:()=>{eh({Component:F.Z,props:{DialogText:ex.transferMessage,fullScreen:!1,okButtonAction:ej},width:400,height:150,title:""})},disabled:!ew},{key:"WorkFlow",condition:!0,onClick:eW,disabled:!eP},{key:"Shipment",condition:!0,onClick:()=>{eh({Component:_.u,props:{recordId:eS.values.recordId,functionId:eS.values.functionId,editMode:1!=eS.values.status,totalBaseAmount:eT}})},disabled:!eP},{key:"Transportation",condition:!0,onClick:()=>{eh({Component:E.R,props:{recordId:eS.values.recordId,functionId:eS.values.functionId,editMode:1!=eS.values.status}})},disabled:!eP}];return(0,u.useEffect)(()=>{!async function(){er?(await eQ(er),await eJ()):(await e_(D.J.CurrencyCreditOrderPurchase),await eN(D.J.CurrencyCreditOrderPurchase))}()},[]),(0,n.jsx)(v.Z,{resourceId:f.i.CreditOrder,form:eS,maxAccess:eC,editMode:eP,actions:eG,previewReport:eP,disabledSubmit:eq,children:(0,n.jsxs)(N.R,{children:[(0,n.jsx)(A.g,{children:(0,n.jsxs)(s.ZP,{container:!0,xs:12,spacing:2,children:[(0,n.jsx)(k.Z,{hideonempty:!0,item:!0,xs:4,children:(0,n.jsx)(l.Z,{name:"date",required:!0,readOnly:eq,label:ex.date,value:null==eS?void 0:null===(Y=eS.values)||void 0===Y?void 0:Y.date,onChange:eS.setFieldValue,maxAccess:eC,onClear:()=>eS.setFieldValue("date",null),error:eS.touched.date&&!!eS.errors.date})}),(0,n.jsx)(s.ZP,{item:!0,xs:4,children:(0,n.jsx)(g.Z,{endpointId:C.r.Plant.qry,name:"plantId",label:ex.plant,readOnly:!0,values:eS.values,valueField:"recordId",displayField:["reference","name"],required:!0,maxAccess:eC,onChange:(e,a)=>{eS.setFieldValue("plantId",(null==a?void 0:a.recordId)||null)},error:eS.touched.plantId&&!!eS.errors.plantId})}),(0,n.jsx)(s.ZP,{item:!0,xs:4,children:(0,n.jsx)(I.Z,{name:"reference",label:ex.reference,value:null==eS?void 0:null===(z=eS.values)||void 0===z?void 0:z.reference,maxAccess:eC,maxLength:"30",readOnly:eP,onChange:eS.handleChange,onClear:()=>eS.setFieldValue("reference",""),error:eS.touched.reference&&!!eS.errors.reference})}),(0,n.jsx)(s.ZP,{item:!0,xs:8,children:(0,n.jsx)(q.U,{endpointId:b.d.Correspondent.snapshot,valueField:"reference",displayField:"name",name:"corId",label:ex.correspondent,form:eS,required:!0,firstFieldWidth:4,displayFieldWidth:3,valueShow:"corRef",secondValueShow:"corName",readOnly:eq||(null==eS?void 0:null===(X=eS.values)||void 0===X?void 0:null===(K=X.rows)||void 0===K?void 0:K.some(e=>!!e.currencyId)),maxAccess:eC,onChange:async(e,a)=>{if(a){let e=await eJ();eO(null==a?void 0:a.recordId,e,eS.values.plantId)}eS.setFieldValue("corName",a?a.name:""),eS.setFieldValue("corRef",a?a.reference:""),eS.setFieldValue("corId",a?a.recordId:null)},errorCheck:"corId"})}),(0,n.jsx)(s.ZP,{item:!0,xs:4,children:(0,n.jsx)(l.Z,{name:"deliveryDate",readOnly:eq,label:ex.deliveryDate,value:null==eS?void 0:null===(ee=eS.values)||void 0===ee?void 0:ee.deliveryDate,onChange:eS.setFieldValue,maxAccess:eC,disabledRangeDate:{date:eS.values.date,day:30},onClear:()=>eS.setFieldValue("deliveryDate",null),error:eS.touched.deliveryDate&&!!eS.errors.deliveryDate})}),(0,n.jsx)(s.ZP,{item:!0,xs:6,children:(0,n.jsxs)(d.Z,{row:!0,value:eS.values.functionId,defaultValue:D.J.CurrencyCreditOrderPurchase,onChange:async e=>{await e_(e.target.value),await eN(e.target.value),ev(e.target.value),eS.setFieldValue("reference","")},children:[(0,n.jsx)(o.Z,{value:D.J.CurrencyCreditOrderPurchase,control:(0,n.jsx)(i.Z,{}),label:ex.purchase,disabled:null==eS?void 0:null===(et=eS.values)||void 0===et?void 0:null===(ea=et.rows)||void 0===ea?void 0:ea.some(e=>!!e.currencyId)}),(0,n.jsx)(o.Z,{value:D.J.CurrencyCreditOrderSale,control:(0,n.jsx)(i.Z,{}),label:ex.sale,disabled:null==eS?void 0:null===(el=eS.values)||void 0===el?void 0:null===(en=el.rows)||void 0===en?void 0:en.some(e=>!!e.currencyId)})]})})]})}),(0,n.jsx)(V.Q,{children:(0,n.jsx)(O._,{onChange:e=>eS.setFieldValue("rows",e),disabled:!eS.values.corId||eq,value:eS.values.rows,name:"rows",error:eS.errors.rows,columns:eL,allowAddNewLine:!eq,maxAccess:eC,allowDelete:!eq,bg:eS.values.functionId&&(eS.values.functionId!=D.J.CurrencyCreditOrderPurchase?"#C7F6C7":"rgb(245, 194, 193)")})}),(0,n.jsx)(A.g,{children:(0,n.jsxs)(s.ZP,{container:!0,spacing:2,xs:12,children:[(0,n.jsx)(k.Z,{item:!0,xs:8,children:(0,n.jsx)(x.Z,{name:"notes",label:ex.notes,value:eS.values.notes,rows:3,maxAccess:eC,readOnly:eq,onChange:e=>eS.setFieldValue("notes",e.target.value),onClear:()=>eS.setFieldValue("notes",""),error:eS.touched.notes&&!!eS.errors.notes})}),(0,n.jsx)(s.ZP,{item:!0,xs:4,children:(0,n.jsxs)(s.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(H.Z,{name:"totalCUR",label:"".concat(ex.total," ").concat(eS.values.currencyRef||""),value:ek,readOnly:!0,align:"right"})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(H.Z,{name:"baseAmount",label:"".concat(ex.total," ").concat(ep||""),value:eT,readOnly:!0,align:"right"})})]})})]})})]})})};W.width=1e3,W.height=650,a.Z=W},23476:function(e,a,t){"use strict";t.d(a,{Z:function(){return J}});var n=t(52322),l=t(29326),r=t(9522),s=t(2784),d=t(60218),o=t(48601),i=t(82737),u=t(62202),c=t(65950),m=t(26612),v=t(80983),p=t(62362),y=t(31389),h=t(19473),f=t(71987),I=t(76426),x=t(8661),g=t(38449),C=t(21581),D=t(84100),b=t(27423),R=t(22341),S=t(89330),q=t(98345),w=t(7121),P=t(5088),Z=t(39704),F=t(39812),j=t(61802),k=t(19689);function T(e){var a,t,l,r;let{labels:T,maxAccess:O,setStore:N,store:A,plantId:V}=e,{recordId:L}=A,{getRequest:M,postRequest:E}=(0,s.useContext)(c.$),{platformLabels:_}=(0,s.useContext)(h.l),{stack:J}=(0,j.zY)(),B=!!A.recordId,H=(0,f.E)({endpointId:I.x.StockCount.qry}),{documentType:Q,maxAccess:W,changeDT:G}=(0,q.H)({functionId:w.J.StockCount,access:O}),{formik:U}=(0,v.c)({documentType:{key:"dtId",value:null==Q?void 0:Q.dtId},initialValues:{recordId:L||null,reference:null,dtId:null,date:new Date,plantId:parseInt(V),notes:"",type:1,clientId:null,currencyId:null,genVar:1,wip:1,status:1,disableItemDuplicate:!1},maxAccess:W,validateOnChange:!0,validationSchema:o.Ry({genVar:o.Z_().required(),plantId:o.Rx().required(),clientId:o.Z_().nullable().test("",function(e){let{type:a}=this.parent;return 2!==a&&"2"!==a||!!e}),currencyId:o.Z_().nullable().test("",function(e){let{type:a}=this.parent;return 2!==a&&"2"!==a||!!e})}),onSubmit:async e=>{let a=await E({extension:I.x.StockCount.set,record:JSON.stringify(e)});if(e.recordId)u.ZP.success(_.Edited);else{N(e=>({...e,recordId:a.recordId})),u.ZP.success(_.Added),U.setFieldValue("recordId",a.recordId);let e=await Y(a.recordId);U.setValues({...e.record,date:(0,F.a1)(e.record.date)})}H()}}),$=async()=>{J({Component:Z.Z,props:{functionId:w.J.StockCount,recordId:U.values.recordId}})};async function Y(e){return await M({extension:I.x.StockCount.get,parameters:"_recordId=".concat(e)})}async function z(e){let a=await Y(e);return a.record.date=(0,F.a1)(a.record.date),a}let K=2===U.values.wip,X=3===U.values.status,ee=async e=>{let a=await E({extension:I.x.StockCount.close,record:JSON.stringify({recordId:e})});u.ZP.success(_.Closed),H();let t=await z(a.recordId);U.setValues(t.record),N(e=>({...e,isClosed:2===t.record.wip}))},ea=[{key:"WorkFlow",condition:!0,onClick:$,disabled:!B},{key:"Close",condition:!K,onClick:()=>ee(U.values.recordId),disabled:X||K||!B},{key:"Reopen",condition:K,onClick:async function(){let e=await E({extension:I.x.StockCount.reopen,record:JSON.stringify(U.values)});u.ZP.success(_.Reopened),H();let a=await z(e.recordId);U.setValues(a.record),N(e=>({...e,isClosed:2===a.record.wip}))},disabled:!K||X},{key:"Unlocked",condition:!X,onClick:async()=>{let e={...U.values};e.date=(0,F.ku)(e.date);let a=await E({extension:I.x.StockCount.post,record:JSON.stringify(e)});u.ZP.success(_.Posted),H();let t=await z(a.recordId);U.setValues(t.record),N(e=>({...e,isPosted:3===t.record.status}))},disabled:!B||!K},{key:"Locked",condition:X,onClick:"onUnpostConfirmation",onSuccess:async()=>{let e={...U.values};e.date=(0,F.ku)(e.date);let a=await E({extension:I.x.StockCount.unpost,record:JSON.stringify(e)});u.ZP.success(_.Unposted),H();let t=await z(a.recordId);U.setValues(t.record),N(e=>({...e,isPosted:3!==t.record.status}))},disabled:!B||!K}];return(0,s.useEffect)(()=>{!async function(){if(L){let e=await Y(L);N(a=>({...a,isPosted:3===e.record.status,isClosed:2===e.record.wip})),U.setValues({...e.record,date:(0,F.a1)(e.record.date)})}}()},[]),(0,n.jsx)(i.Z,{resourceId:m.i.StockCounts,form:U,maxAccess:W,editMode:B,actions:ea,disabledSubmit:X||K,disableSubmitAndClear:X||K,children:(0,n.jsx)(y.R,{children:(0,n.jsx)(p.Q,{children:(0,n.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:g.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(w.J.StockCount),name:"dtId",readOnly:B||X||K,label:T.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:U.values,maxAccess:W,onChange:(e,a)=>{G(a),U&&U.setFieldValue("dtId",null==a?void 0:a.recordId)},error:U.touched.dtId&&!!U.errors.dtId})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(P.Z,{name:"reference",label:T.reference,value:null==U?void 0:null===(a=U.values)||void 0===a?void 0:a.reference,maxAccess:!B&&W,maxLength:"30",readOnly:B||X||K,onChange:U.handleChange,error:U.touched.reference&&!!U.errors.reference})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{name:"date",label:T.date,value:null===(t=U.values)||void 0===t?void 0:t.date,onChange:U.setFieldValue,onClear:()=>U.setFieldValue("date",""),readOnly:B||X||K,error:U.touched.date&&!!U.errors.date,maxAccess:W})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:g.r.Plant.qry,name:"plantId",label:T.plant,required:!0,valueField:"recordId",readOnly:B||X||K,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:U.values,onChange:(e,a)=>{U.setFieldValue("plantId",a?null==a?void 0:a.recordId:null)},error:U.touched.plantId&&!!U.errors.plantId})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"notes",type:"text",label:T.notes,value:null===(l=U.values)||void 0===l?void 0:l.notes,rows:3,readOnly:X||K,maxAccess:W,onChange:e=>U.setFieldValue("notes",e.target.value),onClear:()=>U.setFieldValue("notes",""),error:U.touched.notes&&!!U.errors.notes})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{datasetId:D.v.SC_TYPE,name:"type",label:T.type,values:U.values,valueField:"key",displayField:"value",readOnly:B||X||K,maxAccess:W,onChange:(e,a)=>{U&&U.setFieldValue("type",a?a.key:"")},error:U.touched.type&&!!U.errors.type})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.U,{endpointId:R.P.Client.snapshot,parameters:{_category:0},valueField:"reference",displayField:"name",name:"clientId",label:T.client,form:U,readOnly:B||X||K||"1"===U.values.type||1===U.values.type,required:"2"===U.values.type||2===U.values.type,displayFieldWidth:2,valueShow:"clientRef",secondValueShow:"clientName",maxAccess:W,columnsInDropDown:[{key:"reference",value:"Ref."},{key:"name",value:"Name"}],onChange:async(e,a)=>{U.setFieldValue("clientId",a?a.recordId:""),U.setFieldValue("clientName",a?a.name:""),U.setFieldValue("clientRef",a?a.reference:"")},errorCheck:"clientId"})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:g.r.Currency.qry,name:"currencyId",label:T.currency,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:U.values,readOnly:B||X||K||"1"===U.values.type||1===U.values.type,required:"2"===U.values.type||2===U.values.type,maxAccess:W,onChange:(e,a)=>{U.setFieldValue("currencyId",(null==a?void 0:a.recordId)||0)},error:U.touched.currencyId&&!!U.errors.currencyId})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{datasetId:D.v.GENERATE_VARIATIONS,name:"genVar",label:T.generateVariations,values:U.values,valueField:"key",displayField:"value",readOnly:B||X||K,maxAccess:W,onChange:(e,a)=>{U&&U.setFieldValue("genVar",a?a.key:"")},required:!0,error:U.touched.genVar&&!!U.errors.genVar})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(k.Z,{name:"disableItemDuplicate",value:null===(r=U.values)||void 0===r?void 0:r.disableItemDuplicate,onChange:e=>U.setFieldValue("disableItemDuplicate",e.target.checked),label:T.disableItemDuplicate,maxAccess:W})})]})})})})}var O=t(33625),N=t(76399),A=t(54074),V=e=>{let{store:a,maxAccess:t,labels:l,setRefreshController:r,refreshController:d}=e,{recordId:o,isPosted:i,isClosed:m}=a,{getRequest:f,postRequest:x}=(0,s.useContext)(c.$),{platformLabels:g}=(0,s.useContext)(h.l),{formik:C}=(0,v.c)({maxAccess:t,validateOnChange:!0,initialValues:{search:"",rows:[]},onSubmit:async()=>{let e=C.values.rows.map((e,a)=>({...e,id:a+1,status:e.status||1})).filter(e=>e.isChecked);await x({extension:I.x.Sites.set2,record:JSON.stringify({stockCountId:o,sites:e})}),await D(o),r(!d),u.ZP.success(g.Updated),C.setFieldValue("search","")}}),D=async e=>{if(e){let a=(await f({extension:I.x.Sites.qry,parameters:"_stockCountId=".concat(e)})).list.map((e,a)=>({...e,id:a+1}));C.setValues({rows:a})}},b=C.values.search?C.values.rows.filter(e=>e.siteRef&&e.siteRef.toString().includes(C.values.search.toLowerCase())||e.siteName&&e.siteName.toLowerCase().includes(C.values.search.toLowerCase())):C.values.rows,R=[{component:"checkbox",label:" ",name:"isChecked",flex:1,props:{disabled:i||m}},{component:"textfield",name:"siteRef",label:l.siteRef,flex:1,props:{readOnly:!0}},{component:"textfield",name:"siteName",label:l.name,flex:1,props:{readOnly:!0}},{component:"textfield",name:"statusName",label:l.statusName,flex:1,props:{readOnly:!0}},{component:"textfield",name:"notes",label:l.notes,flex:2,props:{readOnly:!1},propsReducer(e){let{row:a,props:t}=e;return{...t,readOnly:"Processed"===a.statusName||i||m}}}];return(0,s.useEffect)(()=>{!async function(){o&&await D(o)}()},[o]),(0,n.jsx)(A.Z,{onSave:C.handleSubmit,maxAccess:t,disabledSubmit:m,children:(0,n.jsx)(y.R,{children:(0,n.jsxs)(p.Q,{children:[(0,n.jsx)(O.g,{children:(0,n.jsx)(P.Z,{name:"search",value:C.values.search,label:l.search,readOnly:i||m,onClear:()=>{C.setFieldValue("search",""),D()},sx:{width:"30%"},onChange:e=>{let{value:a}=e.target;C.setFieldValue("search",a)}})}),(0,n.jsx)(p.Q,{children:(0,n.jsx)(N._,{onChange:e=>(function(e){let a=C.values.rows.map(a=>e.find(e=>e.id===a.id)||a);C.setFieldValue("rows",a)})(e),value:b,error:C.errors.rows,columns:R,allowAddNewLine:!1,allowDelete:!1})})]})})})},L=e=>{let{store:a,maxAccess:t,labels:l}=e,{recordId:r,isPosted:d,isClosed:i}=a,{getRequest:m,postRequest:f}=(0,s.useContext)(c.$),{platformLabels:g}=(0,s.useContext)(h.l),{formik:C}=(0,v.c)({maxAccess:t,validateOnChange:!0,initialValues:{stockCountId:"",siteId:null,rows:[]},validationSchema:o.Ry({siteId:o.Rx().required()}),onSubmit:async()=>{let e=C.values.rows.map((e,a)=>({...e,id:a+1,status:e.status||1,controllerId:e.recordId,siteId:C.values.siteId,stockCountId:r})).filter(e=>e.isChecked),a={stockCountId:r,siteId:C.values.siteId,items:e};if(await f({extension:I.x.StockCountControllerTab.set2,record:JSON.stringify(a)}),u.ZP.success(g.Updated),C.values.siteId){let e=await D(r,C.values.siteId);C.setValues({rows:e.list})}}}),D=async(e,a)=>{var t;let n=await m({extension:I.x.Controller.qry,parameters:"_siteId=".concat(a)}),l=await m({extension:I.x.StockCountControllerTab.qry,parameters:"_siteId=".concat(a,"&_stockCountId=").concat(e)});n.list.map((e,a)=>{let t=l.list.find(a=>a.controllerId===e.recordId);return t&&(e.isChecked=!0,e.statusName=t.statusName,e.status=t.status),{...e,id:a+1}}),n.list=null==n?void 0:null===(t=n.list)||void 0===t?void 0:t.map((e,a)=>({...e,id:a,isChecked:(null==e?void 0:e.isChecked)!==void 0&&(null==e?void 0:e.isChecked)})),C.setFieldValue("stockCountId",e),C.setValues({rows:n.list}),C.setFieldValue("siteId",a)},b=[{component:"checkbox",label:" ",name:"isChecked",flex:.2,props:{disabled:d||i}},{component:"textfield",name:"name",label:l.name,flex:1,props:{readOnly:!0}},{component:"textfield",name:"statusName",label:l.statusName,flex:1,props:{readOnly:!0}}];return(0,n.jsx)(A.Z,{onSave:C.handleSubmit,maxAccess:t,disabledSubmit:d||i,children:(0,n.jsx)(y.R,{children:(0,n.jsxs)(p.Q,{children:[(0,n.jsx)(O.g,{children:(0,n.jsx)(x.Z,{name:"siteId",endpointId:I.x.Sites.qry,parameters:r?"_stockCountId=".concat(r):"",label:l.sites,filter:e=>e.isChecked,valueField:"siteId",required:!0,displayField:"siteName",values:C.values,onChange:async(e,a)=>{(null==a?void 0:a.siteId)&&(C.setFieldValue("siteId",a?null==a?void 0:a.siteId:null),await D(r,null==a?void 0:a.siteId))},error:C.touched.siteId&&!!C.errors.siteId,maxAccess:t})}),(0,n.jsx)(N._,{onChange:e=>(function(e){let a=C.values.rows.map(a=>e.find(e=>e.id===a.id)||a);C.setFieldValue("rows",a)})(e),value:C.values.rows,error:C.errors.rows,columns:b,allowAddNewLine:!1,allowDelete:!1})]})})})},M=t(50023),E=t(21326);let _=e=>{let{recordId:a,plantId:t,window:d}=e,[o,i]=(0,s.useState)(0),[u,c]=(0,s.useState)({recordId:a||null,isPosted:!1,isClosed:!1}),{labels:v,access:p}=(0,M.Z)({datasetId:m.i.StockCounts,editMode:!!a});(0,E.Z)({title:v.cycleCounts,window:d});let[y,h]=(0,s.useState)(!1),f=!!u.recordId,I=[{label:v.cycleCounts},{label:v.sites,disabled:!f},{label:v.controller,disabled:!f}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Y,{tabs:I,activeTab:o,setActiveTab:i,maxAccess:p}),(0,n.jsx)(l.Z,{index:0,value:o,maxAccess:p,children:(0,n.jsx)(T,{labels:v,setStore:c,store:u,maxAccess:p,plantId:t})}),(0,n.jsx)(l.Z,{index:1,value:o,maxAccess:p,children:(0,n.jsx)(V,{labels:v,maxAccess:p,store:u,setRefreshController:h,refreshController:y})}),(0,n.jsx)(l.Z,{index:2,value:o,maxAccess:p,children:(0,n.jsx)(L,{labels:v,maxAccess:p,store:u},y)})]})};_.width=650,_.height=750;var J=_},1838:function(e,a,t){"use strict";t.d(a,{Z:function(){return Z}});var n=t(52322),l=t(60218),r=t(2784),s=t(48601),d=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(8661),v=t(5088),p=t(80983),y=t(31389),h=t(62362),f=t(19473),I=t(39812),x=t(89330),g=t(91406),C=t(21581),D=t(27423),b=t(92407),R=t(98345),S=t(7121),q=t(83562),w=t(21326),P=t(50023);function Z(e){var a;let{recordId:t,window:Z}=e,{getRequest:F,postRequest:j}=(0,r.useContext)(i.$),{platformLabels:k}=(0,r.useContext)(f.l),{labels:T,access:O}=(0,P.Z)({datasetId:c.i.EmployeePenalties,editMode:!!t});(0,w.Z)({title:T.empPenalty,window:Z});let{maxAccess:N}=(0,R.H)({functionId:S.J.Penalty,access:O,enabled:!t}),{formik:A}=(0,p.c)({initialValues:{recordId:t||null,reference:"",penaltyId:null,employeeId:null,employeeRef:"",employeeName:"",date:new Date,amount:null,notes:"",status:1,wip:1},maxAccess:N,validateOnChange:!0,validationSchema:s.Ry({date:s.hT().required().test(function(e){return e<=new Date}),penaltyId:s.Rx().required(),amount:s.Rx().required(),employeeId:s.Rx().required()}),onSubmit:async e=>{let{employeeName:a,employeeRef:t,date:n,...l}=e,r=await j({extension:b.y.EmployeePenalty.set,record:JSON.stringify({...l,date:(0,I.ku)(n)})});o.ZP.success(l.recordId?k.Edited:k.Added),E(r.recordId),V()}}),V=(0,u.E)({endpointId:b.y.EmployeePenalty.page}),L=!!A.values.recordId,M=2===A.values.wip;async function E(e){if(e){let{record:a}=await F({extension:b.y.EmployeePenalty.get,parameters:"_recordId=".concat(e)});A.setValues({...a,date:(0,I.a1)(a.date)})}}(0,r.useEffect)(()=>{E(t)},[]);let{employeeName:_,employeeRef:J,date:B,...H}=A.values,Q=[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!L},{key:"Close",condition:!M,onClick:async()=>{await j({extension:b.y.EmployeePenalty.close,record:JSON.stringify({...H,date:(0,I.ku)(B)})}),o.ZP.success(k.Closed),E(A.values.recordId),V()},disabled:M||!L},{key:"Reopen",condition:M,onClick:async()=>{await j({extension:b.y.EmployeePenalty.reopen,record:JSON.stringify({...H,date:(0,I.ku)(B)})}),o.ZP.success(k.Reopened),E(A.values.recordId),V()},disabled:!M},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!M}];return(0,n.jsx)(d.Z,{resourceId:c.i.EmployeePenalties,functionId:S.J.Penalty,form:A,actions:Q,maxAccess:N,editMode:L,children:(0,n.jsx)(y.R,{children:(0,n.jsx)(h.Q,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(v.Z,{name:"reference",label:T.ref,value:A.values.reference,maxAccess:N,readOnly:L,maxLength:"10",onChange:A.handleChange,onClear:()=>A.setFieldValue("reference",""),error:A.touched.reference&&!!A.errors.reference})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{name:"date",required:!0,label:T.date,value:null===(a=A.values)||void 0===a?void 0:a.date,onChange:A.setFieldValue,onClear:()=>A.setFieldValue("date",null),error:A.touched.date&&!!A.errors.date,maxAccess:N,readOnly:M,max:new Date})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Z,{endpointId:q.m.PenaltyType.qry,name:"penaltyId",label:T.penalty,required:!0,valueField:"recordId",readOnly:M,displayField:"name",values:A.values,maxAccess:N,onChange:(e,a)=>{A.setFieldValue("penaltyId",(null==a?void 0:a.recordId)||null)},error:A.touched.penaltyId&&!!A.errors.penaltyId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.U,{endpointId:b.y.Employee.snapshot,parameters:{_branchId:0},filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,readOnly:M,label:T.employee,secondFieldLabel:T.empName,form:A,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:N,onChange:async(e,a)=>{A.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),A.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),A.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"amount",label:T.amount,value:A.values.amount,maxAccess:N,readOnly:M,required:!0,onChange:A.handleChange,onClear:()=>A.setFieldValue("amount",null),error:A.touched.amount&&!!A.errors.amount})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"notes",label:T.notes,value:A.values.notes,rows:3,readOnly:M,maxAccess:N,onChange:e=>A.setFieldValue("notes",e.target.value),onClear:()=>A.setFieldValue("notes",""),error:A.touched.notes&&!!A.errors.notes})})]})})})})}Z.width=600,Z.height=470},51682:function(e,a,t){"use strict";t.d(a,{Z:function(){return Z}});var n=t(52322),l=t(60218),r=t(2784),s=t(48601),d=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(80983),p=t(19473),y=t(31389),h=t(62362),f=t(50496),I=t(27423),x=t(92407),g=t(89330),C=t(91406),D=t(21581),b=t(39812),R=t(7121),S=t(98345),q=t(8661),w=t(50023),P=t(21326);function Z(e){var a,t,Z;let{recordId:F,window:j}=e,{getRequest:k,postRequest:T}=(0,r.useContext)(i.$),{platformLabels:O}=(0,r.useContext)(p.l),{labels:N,access:A}=(0,w.Z)({datasetId:c.i.LeaveRequest,editMode:!!F});(0,P.Z)({title:N.title,window:j});let V=(0,u.E)({endpointId:f.U.LeaveRequest.page}),{maxAccess:L}=(0,S.H)({functionId:R.J.LeaveRequest,access:A,enabled:!F}),{formik:M}=(0,v.c)({initialValues:{recordId:null,name:"",startDate:null,endDate:null,date:new Date,employeeId:null,justification:"",destination:"",ltId:null,status:1,reference:"",hours:null,multiDayLeave:1,wip:1},maxAccess:L,validateOnChange:!0,validationSchema:s.Ry({hours:s.Rx().required(),startDate:s.hT().required(),date:s.hT().required(),destination:s.Z_().required(),employeeId:s.Rx().required(),ltId:s.Rx().required(),justification:s.Z_().required()}),onSubmit:async e=>{let a=await T({extension:f.U.LeaveRequest.set,record:JSON.stringify({...e,date:(0,b.ku)(e.date),startDate:(0,b.ku)(e.startDate),endDate:(0,b.ku)(e.endDate)})});o.ZP.success(e.recordId?O.Edited:O.Added),J(a.recordId),V()}}),E=!!M.values.recordId,_=(null==M?void 0:null===(a=M.values)||void 0===a?void 0:a.wip)===2;async function J(e){if(e){let{record:a}=await k({extension:f.U.LeaveRequest.get,parameters:"_recordId=".concat(e)});M.setValues({...a,date:(0,b.a1)(a.date),startDate:(0,b.a1)(a.startDate),endDate:(0,b.a1)(a.endDate)})}}(0,r.useEffect)(()=>{J(F)},[]);let B=[{key:"Close",condition:!_,onClick:async()=>{await T({extension:f.U.LeaveRequest.close,record:JSON.stringify({...M.values,date:(0,b.ku)(M.values.date),startDate:(0,b.ku)(M.values.startDate),endDate:(0,b.ku)(M.values.endDate)})}),o.ZP.success(O.Closed),J(M.values.recordId),V()},disabled:_||!E},{key:"Reopen",condition:_,onClick:async()=>{await T({extension:f.U.LeaveRequest.reopen,record:JSON.stringify({...M.values,date:(0,b.ku)(M.values.date),startDate:(0,b.ku)(M.values.startDate),endDate:(0,b.ku)(M.values.endDate)})}),o.ZP.success(O.Reopened),J(M.values.recordId),V()},disabled:!_||!E||3===M.values.releaseStatus},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!_}];return(0,n.jsx)(d.Z,{resourceId:c.i.LeaveRequest,functionId:R.J.LeaveRequest,previewReport:E,form:M,maxAccess:L,editMode:E,actions:B,children:(0,n.jsx)(y.R,{children:(0,n.jsx)(h.Q,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Z,{name:"reference",label:N.ref,value:M.values.reference,maxAccess:L,maxLength:"30",readOnly:_,onChange:M.handleChange,onClear:()=>M.setFieldValue("reference",""),error:M.touched.reference&&!!M.errors.reference})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.U,{endpointId:x.y.Employee.snapshot,parameters:{_branchId:0},filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,label:N.employee,secondFieldLabel:N.employeeName,form:M,readOnly:_,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:L,onChange:async(e,a)=>{M.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),M.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),M.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"date",label:N.date,value:null===(t=M.values)||void 0===t?void 0:t.date,required:!0,readOnly:_,onChange:(e,a)=>{M.setFieldValue("date",a||null)},onClear:()=>M.setFieldValue("date",null),error:M.touched.date&&!!M.errors.date,maxAccess:L})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"startDate",label:N.startDate,value:null===(Z=M.values)||void 0===Z?void 0:Z.startDate,required:!0,readOnly:_,onChange:(e,a)=>{M.setFieldValue("startDate",a||null),M.setFieldValue("endDate",a||null)},onClear:()=>{M.setFieldValue("startDate",null),M.setFieldValue("endDate",null)},error:M.touched.startDate&&!!M.errors.startDate,maxAccess:L})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"hours",label:N.hours,value:M.values.hours,maxAccess:L,readOnly:_,required:!0,onChange:e=>M.setFieldValue("hours",e.target.value),onClear:()=>M.setFieldValue("hours",null),error:M.touched.hours&&!!M.errors.hours,decimalScale:2})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.Z,{name:"justification",label:N.justification,value:M.values.justification,rows:3,required:!0,readOnly:_,maxAccess:L,onChange:M.handleChange,onClear:()=>M.setFieldValue("justification",""),error:M.touched.justification&&!!M.errors.justification})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Z,{name:"destination",label:N.destination,value:M.values.destination,onChange:M.handleChange,required:!0,readOnly:_,maxLength:100,maxAccess:L,onClear:()=>M.setFieldValue("destination",""),error:M.touched.destination&&!!M.errors.destination})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(q.Z,{endpointId:f.U.IndemnityAccuralsFilters.qry,name:"ltId",label:N.leaveType,valueField:"recordId",values:M.values,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,readOnly:E,maxAccess:L,onChange:(e,a)=>{M.setFieldValue("ltId",null==a?void 0:a.recordId)},error:M.touched.ltId&&!!M.errors.ltId})})]})})})})}Z.width=800,Z.height=500},23427:function(e,a,t){"use strict";t.d(a,{Z:function(){return Z}});var n=t(52322),l=t(60218),r=t(2784),s=t(48601),d=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(80983),p=t(19473),y=t(31389),h=t(62362),f=t(50496),I=t(27423),x=t(92407),g=t(89330),C=t(21581),D=t(39812),b=t(7121),R=t(98345),S=t(8661),q=t(84100),w=t(50023),P=t(21326);function Z(e){var a,t,Z,F;let{recordId:j,window:k}=e,{getRequest:T,postRequest:O}=(0,r.useContext)(i.$),{platformLabels:N}=(0,r.useContext)(p.l),A=(0,u.E)({endpointId:f.U.LeaveReturn.page}),{labels:V,access:L}=(0,w.Z)({datasetId:c.i.LeaveReturn,editMode:!!j});(0,P.Z)({title:V.title,window:k});let{maxAccess:M}=(0,R.H)({functionId:b.J.ReturnFromLeave,access:L,enabled:!j}),{formik:E}=(0,v.c)({initialValues:{recordId:null,date:null,employeeId:null,employeeRef:"",employeeName:"",justification:"",leaveId:null,status:1,reference:"",returnType:null,wip:1,minDate:null,maxDate:null},maxAccess:M,validateOnChange:!0,validationSchema:s.Ry({date:s.hT().typeError().required().test(function(e){let{minDate:a,maxDate:t}=this.parent;return!e||!(a&&e<=new Date(a)||t&&e>=new Date(t))}),leaveId:s.Rx().required(),returnType:s.Rx().required(),justification:s.Z_().required()}),onSubmit:async e=>{let{minDate:a,maxDate:t,employeeName:n,date:l,...r}=e,s=await O({extension:f.U.LeaveReturn.set,record:JSON.stringify({...r,date:(0,D.ku)(l)})});o.ZP.success(e.recordId?N.Edited:N.Added),B(s.recordId),A()}}),_=!!E.values.recordId,J=(null==E?void 0:null===(a=E.values)||void 0===a?void 0:a.wip)===2;async function B(e){if(e){let{record:a}=await T({extension:f.U.LeaveReturn.get,parameters:"_recordId=".concat(e)}),t=await Y(a.returnType,a.leaveId);E.setValues({...a,date:(0,D.a1)(a.date),minDate:t.minDate,maxDate:t.maxDate})}}(0,r.useEffect)(()=>{B(j)},[]);let{minDate:H,maxDate:Q,employeeName:W,date:G,...U}=E.values,$=[{key:"Close",condition:!J,onClick:async()=>{await O({extension:f.U.LeaveReturn.close,record:JSON.stringify({...U,date:(0,D.ku)(G)})}),o.ZP.success(N.Closed),B(U.recordId),A()},disabled:J||!_},{key:"Reopen",condition:J,onClick:async()=>{await O({extension:f.U.LeaveReturn.reopen,record:JSON.stringify({...U,date:(0,D.ku)(G)})}),o.ZP.success(N.Reopened),B(U.recordId),A()},disabled:!J},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!J}];async function Y(e,a){let t={date:null,minDate:null,maxDate:null};if(!a||!e)return;let{record:n}=await T({extension:f.U.LeaveRequest.get,parameters:"_recordId=".concat(a)});switch(e){case"1":t.date=(0,D.a1)(n.startDate);break;case"2":t.minDate=(0,D.a1)(n.startDate),t.endDate=(0,D.a1)(n.endDate),t.date=new Date;break;case"3":let l=new Date((0,D.a1)(n.endDate));l.setDate(l.getDate()+1),t.date=l;break;case"4":t.date=new Date,t.minDate=n.startDate}return t}return(0,n.jsx)(d.Z,{resourceId:c.i.LeaveReturn,functionId:b.J.ReturnFromLeave,previewReport:_,form:E,maxAccess:M,editMode:_,actions:$,disabledSubmit:J,children:(0,n.jsx)(y.R,{children:(0,n.jsx)(h.Q,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Z,{name:"reference",label:V.reference,value:E.values.reference,maxAccess:M,maxLength:"30",readOnly:J,onChange:E.handleChange,onClear:()=>E.setFieldValue("reference",""),error:E.touched.reference&&!!E.errors.reference})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.U,{endpointId:x.y.Employee.snapshot,parameters:{_branchId:0},filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeId",label:V.employee,secondFieldLabel:V.employeeName,form:E,readOnly:J,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:M,onChange:async(e,a)=>{E.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),E.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),E.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{endpointId:E.values.employeeId&&f.U.LeaveRequest.qry,parameters:"_filter=&_multiDayLeave=2&_params=1|".concat(E.values.employeeId,"&_sortBy=recordId&_startAt=0&_size=100"),filter:e=>4==e.status,displayField:["reference",{name:"startDate",type:"date"},{name:"endDate",type:"date"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"startDate",value:"Start Date",type:"date"},{key:"endDate",value:"End date",type:"date"}],name:"leaveId",label:V.leave,valueField:"recordId",required:!0,values:E.values,onChange:(e,a)=>{E.setFieldValue("leaveId",(null==a?void 0:a.recordId)||null)},readOnly:J,maxAccess:M,error:(null==E?void 0:null===(t=E.touched)||void 0===t?void 0:t.leaveId)&&!!(null==E?void 0:null===(Z=E.errors)||void 0===Z?void 0:Z.leaveId)})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{datasetId:q.v.LEAVE_RETURN_TYPE,name:"returnType",label:V.returnType,valueField:"key",displayField:"value",values:E.values,required:!0,readOnly:J,maxAccess:M,onChange:async(e,a)=>{let t=await Y(null==a?void 0:a.key,E.values.leaveId);E.setValues({...E.values,maxDate:(null==t?void 0:t.maxDate)||null,minDate:(null==t?void 0:t.minDate)||null,date:(null==t?void 0:t.date)||null,returnType:(null==a?void 0:a.key)||null})},error:E.touched.returnType&&!!E.errors.returnType})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"date",label:V.date,value:null===(F=E.values)||void 0===F?void 0:F.date,required:!0,readOnly:J||"1"==E.values.returnType||"3"==E.values.returnType,onChange:(e,a)=>{E.setFieldValue("date",a||null)},min:E.values.minDate,max:E.values.maxDate,onClear:()=>E.setFieldValue("date",null),error:E.touched.date&&!!E.errors.date,maxAccess:M})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"justification",label:V.justification,value:E.values.justification,rows:3,required:!0,readOnly:J,maxAccess:M,onChange:E.handleChange,onClear:()=>E.setFieldValue("justification",""),error:E.touched.justification&&!!E.errors.justification})})]})})})})}Z.width=800,Z.height=500},89764:function(e,a,t){"use strict";t.d(a,{Z:function(){return J}});var n=t(52322),l=t(29326),r=t(9522),s=t(2784),d=t(60218),o=t(48601),i=t(82737),u=t(62202),c=t(65950),m=t(71987),v=t(26612),p=t(5088),y=t(80983),h=t(19473),f=t(31389),I=t(33625),x=t(8661),g=t(84100),C=t(73581),D=t(91406),b=t(27423),R=t(92407),S=t(70104),q=t(38449),w=t(89330),P=t(21581),Z=t(39812),F=t(7121);function j(e){var a,t,l,r,j,k,T,O,N,A;let{labels:V,maxAccess:L,store:M,setStore:E,window:_}=e,{getRequest:J,postRequest:B}=(0,s.useContext)(c.$),{platformLabels:H,defaultsData:Q}=(0,s.useContext)(h.l),{recordId:W}=M,G=(0,m.E)({endpointId:C.h.Loans.page}),U=null==Q?void 0:null===(t=Q.list)||void 0===t?void 0:null===(a=t.find(e=>{let{key:a}=e;return"currencyId"===a}))||void 0===a?void 0:a.value,$=null==Q?void 0:null===(r=Q.list)||void 0===r?void 0:null===(l=r.find(e=>{let{key:a}=e;return"ldMethod"===a}))||void 0===l?void 0:l.value,Y=null==Q?void 0:null===(k=Q.list)||void 0===k?void 0:null===(j=k.find(e=>{let{key:a}=e;return"ldValue"===a}))||void 0===j?void 0:j.value,{formik:z}=(0,y.c)({initialValues:{recordId:null,status:1,releaseStatus:null,wip:1,reference:"",date:new Date,employeeId:null,branchId:null,departmentName:"",positionName:"",ltId:null,ltName:"",loanBalance:null,currencyId:parseInt(U),amount:null,purpose:"",effectiveDate:new Date,ldMethod:parseInt($),ldmName:"",ldValue:parseInt(Y),disableEditing:!1},maxAccess:L,validationSchema:o.Ry({reference:o.Z_().required(),employeeId:o.Rx().required(),date:o.hT().required(),ltId:o.Rx().required(),currencyId:o.Rx().required(),amount:o.Rx().min(1).required(),purpose:o.Z_().required(),ldValue:o.Rx().min(1).required(),effectiveDate:o.hT().required(),ldMethod:o.Rx().required()}),onSubmit:async e=>{let a={...e,date:(0,Z.ku)(e.date),effectiveDate:(0,Z.ku)(e.effectiveDate)};await B({extension:C.h.Loans.set,record:JSON.stringify(a)}),u.ZP.success(e.recordId?H.Edited:H.Added),G(),_.close()}}),K=!!(null==z?void 0:null===(T=z.values)||void 0===T?void 0:T.recordId),X=2==z.values.wip;(0,s.useEffect)(()=>{W&&ee(W)},[]);let ee=async e=>{let a=await J({extension:C.h.Loans.get,parameters:"_recordId=".concat(e)});if(null==a?void 0:a.record){let{record:e}=a;z.setValues({...e,date:(0,Z.a1)(e.date),effectiveDate:(0,Z.a1)(e.effectiveDate)}),E(t=>{var n;return{...t,isClosed:2===e.wip,loanAmount:null!==(n=e.amount)&&void 0!==n?n:0,effectiveDate:(0,Z.a1)(a.record.effectiveDate)}}),await ea(e.employeeId)}return a},ea=async e=>{if(!e){et();return}let{record:a}=await J({extension:R.y.QuickView.get,parameters:"_recordId=".concat(e,"&_asOfDate=").concat((0,Z.uQ)(new Date))});z.setValues(t=>{var n;return{...t,employeeId:e,employeeRef:(null==a?void 0:a.reference)||"",employeeName:(null==a?void 0:a.fullName)||"",positionName:(null==a?void 0:a.positionName)||"",departmentName:(null==a?void 0:a.departmentName)||"",loanBalance:null!==(n=null==a?void 0:a.loanBalance)&&void 0!==n?n:0,branchId:(null==a?void 0:a.branchId)||null}})},et=()=>{z.setValues(e=>({...e,employeeId:null,employeeRef:"",employeeName:"",positionName:"",departmentName:"",loanBalance:0,branchId:null}))},en=async e=>{let a=await ee(e);(null==a?void 0:a.record)&&(z.setValues(e=>({...e,...a.record,date:(0,Z.a1)(a.record.date),effectiveDate:(0,Z.a1)(a.record.effectiveDate)})),E(e=>({...e,isClosed:2===a.record.wip,effectiveDate:(0,Z.a1)(a.record.effectiveDate)})))},el=[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!K},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!X||!K},{key:"Close",condition:!X,onClick:async()=>{let e=await B({extension:C.h.Loans.close,record:JSON.stringify(z.values)});u.ZP.success(H.Closed),G(),en(e.recordId)},disabled:X||!K},{key:"Reopen",condition:X,onClick:async()=>{let e=await B({extension:C.h.Loans.reopen,record:JSON.stringify(z.values)});u.ZP.success(H.Reopened),G(),en(e.recordId)},disabled:!X||!K}];return(0,n.jsx)(i.Z,{resourceId:v.i.Loans,form:z,maxAccess:L,editMode:K,actions:el,disabledSubmit:X,functionId:F.J.LoanRequest,children:(0,n.jsx)(f.R,{children:(0,n.jsx)(I.g,{children:(0,n.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(p.Z,{name:"reference",label:V.reference,value:z.values.reference,required:!0,readOnly:K,maxAccess:L,maxLength:"20",onChange:z.handleChange,onClear:()=>z.setFieldValue("reference",""),error:z.touched.reference&&!!z.errors.reference})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(w.Z,{name:"date",required:!0,max:z.values.effectiveDate,readOnly:X,label:V.date,value:null==z?void 0:null===(O=z.values)||void 0===O?void 0:O.date,onChange:z.setFieldValue,maxAccess:L,onClear:()=>z.setFieldValue("date",null),error:z.touched.date&&!!z.errors.date})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.U,{endpointId:R.y.Employee.snapshot,parameters:{_branchId:0},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,readOnly:X,displayFieldWidth:2,label:V.employeeName,form:z,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:L,onChange:(e,a)=>{ea((null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:S.K.BranchFilters.qry,name:"branchId",label:V.branch,readOnly:!0,valueField:"recordId",displayField:["reference","name"],values:z.values,maxAccess:L,onChange:(e,a)=>z.setFieldValue("branchId",(null==a?void 0:a.recordId)||null),error:z.touched.branchId&&!!z.errors.branchId})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(p.Z,{name:"departmentName",label:V.department,value:z.values.departmentName,readOnly:!0,maxAccess:L,error:z.touched.departmentName&&!!z.errors.departmentName})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(p.Z,{name:"positionName",label:V.position,value:z.values.positionName,readOnly:!0,maxAccess:L,error:z.touched.positionName&&!!z.errors.positionName})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:C.h.LoanType.qry,name:"ltId",label:V.ltype,required:!0,readOnly:X,valueField:"recordId",displayField:"name",values:z.values,onChange:(e,a)=>{z.setFieldValue("disableEditing",(null==a?void 0:a.disableEditing)||!1),z.setFieldValue("ldMethod",(null==a?void 0:a.ldMethod)||null),z.setFieldValue("ldValue",(null==a?void 0:a.ldValue)||0),z.setFieldValue("ltId",(null==a?void 0:a.recordId)||null)},error:z.touched.ltId&&!!z.errors.ltId})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.Z,{name:"loanBalance",label:V.loanBalance,value:null==z?void 0:null===(N=z.values)||void 0===N?void 0:N.loanBalance,maxAccess:L,readOnly:!0})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:q.r.Currency.qry,filter:e=>1===e.currencyType,name:"currencyId",label:V.currency,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:z.values,required:!0,readOnly:X,maxAccess:L,onChange:async(e,a)=>{z.setFieldValue("currencyName",(null==a?void 0:a.name)||""),z.setFieldValue("currencyRef",(null==a?void 0:a.reference)||""),z.setFieldValue("currencyId",(null==a?void 0:a.recordId)||null)},error:z.touched.currencyId&&!!z.errors.currencyId})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.Z,{name:"amount",label:V.amount,value:z.values.amount,required:!0,readOnly:X,maxAccess:L,onChange:e=>z.setFieldValue("amount",e.target.value),onClear:async()=>{z.setFieldValue("amount",null)},error:z.touched.amount&&!!z.errors.amount,maxLength:10})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(P.Z,{name:"purpose",label:V.purpose,required:!0,rows:2,readOnly:X,value:z.values.purpose,maxAccess:L,onChange:e=>z.setFieldValue("purpose",e.target.value),onClear:()=>z.setFieldValue("purpose",""),error:z.touched.purpose&&!!z.errors.purpose})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(w.Z,{name:"effectiveDate",label:V.effectiveDate,value:null==z?void 0:null===(A=z.values)||void 0===A?void 0:A.effectiveDate,required:!0,min:z.values.date,readOnly:X,onChange:z.setFieldValue,maxAccess:L,onClear:()=>z.setFieldValue("effectiveDate",null),error:z.touched.effectiveDate&&!!z.errors.effectiveDate})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{datasetId:g.v.LOAN_DEDUCTION_METHOD,name:"ldMethod",label:V.ldMethod,required:!0,readOnly:X||z.values.disableEditing,valueField:"key",displayField:"value",values:z.values,maxAccess:L,onChange:(e,a)=>z.setFieldValue("ldMethod",(null==a?void 0:a.key)||null),onClear:async()=>{z.setFieldValue("ldMethod",null),z.setFieldValue("ldValue",null)},error:z.touched.ldMethod&&!!z.errors.ldMethod})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.Z,{name:"ldValue",label:V.ldValue,value:z.values.ldValue,required:!0,readOnly:X||z.values.disableEditing,maxAccess:L,onChange:e=>z.setFieldValue("ldValue",e.target.value),onClear:()=>z.setFieldValue("ldValue",null),error:z.touched.ldValue&&!!z.errors.ldValue,maxLength:10})})]})})})})}var k=t(69387),T=t(62362),O=t(27723),N=t(61802),A=t(19689);function V(e){var a,t;let{labels:l,recordId:r,store:p,maxAccess:I,loanAmount:b,window:R}=e,{getRequest:S,postRequest:q}=(0,s.useContext)(c.$),{platformLabels:F}=(0,s.useContext)(h.l),j=(0,m.E)({endpointId:C.h.LoanDeduction.page}),{formik:k}=(0,y.c)({maxAccess:I,initialValues:{loanId:p.recordId,recordId:null,payrollDeduction:!1,amount:null,date:new Date,type:null,notes:""},validationSchema:o.Ry({amount:o.Rx().required().max(b),date:o.hT().required(),type:o.Z_().required()}),onSubmit:e=>{let a={...e,date:(0,Z.ku)(e.date),payrollDeduction:1===e.type};q({extension:C.h.LoanDeduction.set,record:JSON.stringify(a)}).then(a=>{u.ZP.success(e.recordId?F.Edited:F.Added),k.setFieldValue("recordId",a.recordId),j(),R.close()})}}),O=!!k.values.recordId;return(0,s.useEffect)(()=>{!async function(){if(r){var e;let a=await S({extension:C.h.LoanDeduction.get,parameters:"_recordId=".concat(r)});k.setValues({...null==a?void 0:a.record,date:(0,Z.a1)(null==a?void 0:null===(e=a.record)||void 0===e?void 0:e.date)})}}()},[]),(0,n.jsx)(i.Z,{resourceId:v.i.Loans,form:k,maxAccess:I,disabledSubmit:!p.isClosed||k.values.payrollDeduction,editMode:O,isInfo:!1,isCleared:!1,children:(0,n.jsx)(f.R,{children:(0,n.jsx)(T.Q,{children:(0,n.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(d.ZP,{item:!0,xs:6,children:(0,n.jsx)(A.Z,{name:"payrollDeduction",value:null===(a=k.values)||void 0===a?void 0:a.payrollDeduction,readOnly:!0,label:l.payrollDeduction,maxAccess:I})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.Z,{name:"amount",label:l.deductionAmount,value:k.values.amount,required:!0,readOnly:!p.isClosed||k.values.payrollDeduction,maxAccess:I,onChange:async e=>{var a;k.setFieldValue("amount",(null==e?void 0:null===(a=e.target)||void 0===a?void 0:a.value)||null)},onClear:async()=>{k.setFieldValue("amount",null)},error:k.touched.amount&&!!k.errors.amount,maxLength:10})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(w.Z,{name:"date",label:l.date,required:!0,min:p.effectiveDate,readOnly:!p.isClosed||k.values.payrollDeduction,value:null==k?void 0:null===(t=k.values)||void 0===t?void 0:t.date,onChange:k.setFieldValue,maxAccess:I,onClear:()=>k.setFieldValue("date",null),error:k.touched.date&&!!k.errors.date})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{datasetId:g.v.LOAN_TYPE,name:"type",label:l.type,required:!0,readOnly:!p.isClosed||k.values.payrollDeduction,valueField:"key",displayField:"value",values:k.values,maxAccess:I,onChange:(e,a)=>{k.setFieldValue("type",(null==a?void 0:a.key)||null)},error:k.touched.type&&!!k.errors.type})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(P.Z,{name:"notes",label:l.notes,readOnly:!p.isClosed||k.values.payrollDeduction,value:k.values.notes,maxLength:"100",maxAccess:I,onChange:e=>k.setFieldValue("notes",e.target.value),onClear:()=>k.setFieldValue("notes",""),error:k.touched.notes&&!!k.errors.notes})})]})})})})}var L=e=>{var a;let{store:t,labels:l}=e,{recordId:r}=t,{getRequest:o,postRequest:i}=(0,s.useContext)(c.$),{platformLabels:p}=(0,s.useContext)(h.l),{stack:y}=(0,N.zY)(),x=[{field:"payrollDeduction",headerName:l.payrollDeduction,type:"checkbox",flex:1},{field:"amount",headerName:l.amount,flex:1,type:"number"},{field:"date",headerName:l.date,flex:1,type:"date"},{field:"typeName",headerName:l.type,flex:1},{field:"notes",headerName:l.notes,flex:1}];async function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:t=50}=e;return{...await o({extension:C.h.LoanDeduction.page,parameters:"_loanId=".concat(r,"&_pageSize=").concat(t,"&_startAt=").concat(a)}),_startAt:a}}let{query:{data:b},access:R,invalidate:S,paginationParameters:q,refetch:w}=(0,m.J)({queryFn:g,endpointId:C.h.LoanDeduction.page,datasetId:v.i.Loans,enabled:!!r}),P=parseFloat((null==b?void 0:null===(a=b.list)||void 0===a?void 0:a.reduce((e,a)=>e+(a.amount||0),0))||0).toFixed(2),Z=parseFloat((t.loanAmount||0)-P).toFixed(2);function F(e){y({Component:V,props:{labels:l,store:t,maxAccess:R,loanAmount:t.loanAmount,recordId:e},width:600,height:500,title:l.Deduction})}let j=async e=>{await i({extension:C.h.LoanDeduction.del,record:JSON.stringify(e)}),S(),u.ZP.success(p.Deleted)};return(0,n.jsxs)(f.R,{children:[(0,n.jsx)(I.g,{children:(0,n.jsx)(O.Z,{disableAdd:!t.isClosed,onAdd:()=>F(),maxAccess:R})}),(0,n.jsx)(T.Q,{children:(0,n.jsx)(k.Z,{name:"deductionTable",columns:x,gridData:b,rowId:"recordId",onEdit:e=>F(e.recordId),onDelete:t.isClosed&&j,actionCondition:(e,a)=>"delete"!==a||!1===e.payrollDeduction,pageSize:50,paginationType:"api",paginationParameters:q,refetch:w,maxAccess:R})}),(0,n.jsx)(I.g,{children:(0,n.jsxs)(d.ZP,{container:!0,sx:{p:2},spacing:2,children:[(0,n.jsx)(d.ZP,{item:!0,xs:4,children:(0,n.jsx)(D.Z,{name:"loanAmount",label:l.loanAmount,value:parseFloat(t.loanAmount).toFixed(2),readOnly:!0})}),(0,n.jsx)(d.ZP,{item:!0,xs:4,children:(0,n.jsx)(D.Z,{name:"deductedAmount",label:l.deductedAmount,value:P,readOnly:!0})}),(0,n.jsx)(d.ZP,{item:!0,xs:4,children:(0,n.jsx)(D.Z,{name:"remainingBalance",label:l.remainingBalance,value:Z,readOnly:!0})})]})})]})},M=t(21326),E=t(50023);let _=e=>{let{recordId:a,window:t}=e,[d,o]=(0,s.useState)(0),[i,u]=(0,s.useState)({recordId:a,isClosed:!1,loanAmount:0,effectiveDate:null}),{labels:c,access:m}=(0,E.Z)({datasetId:v.i.Loans,editMode:!!a});(0,M.Z)({title:c.Loans,window:t});let p=[{label:c.LoanInfo},{label:c.Deduction,disabled:!i.recordId}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Y,{tabs:p,activeTab:d,setActiveTab:o}),(0,n.jsx)(l.Z,{index:0,value:d,children:(0,n.jsx)(j,{labels:c,setStore:u,store:i,maxAccess:m,window:t})}),(0,n.jsx)(l.Z,{index:1,value:d,children:(0,n.jsx)(L,{labels:c,store:i})})]})};_.width=800,_.height=600;var J=_},20899:function(e,a,t){"use strict";t.d(a,{Z:function(){return V}});var n=t(52322),l=t(60218),r=t(2784),s=t(48601),d=t(82737),o=t(62202),i=t(76399),u=t(65950),c=t(71987),m=t(26612),v=t(5088),p=t(80983),y=t(19473),h=t(31389),f=t(62362),I=t(89330),x=t(8661),g=t(38449),C=t(7121),D=t(21581),b=t(98345),R=t(39812),S=t(39704),q=t(61802),w=t(65215),P=t(96026),Z=t(70104),F=t(58912),j=t(92407),k=t(33625),T=t(27423),O=t(90587),N=t(21326),A=t(50023);function V(e){var a,t,V,L,M,E,_,J;let{recordId:B,window:H}=e,{getRequest:Q,postRequest:W}=(0,r.useContext)(u.$),{platformLabels:G,defaultsData:U}=(0,r.useContext)(y.l),{stack:$}=(0,q.zY)(),{stack:Y}=(0,P.V)(),[z,K]=(0,r.useState)([]),X=(0,r.useRef)([]),{labels:ee,access:ea}=(0,A.Z)({datasetId:m.i.MaterialReplenishment,editMode:!!B});(0,N.Z)({title:ee.MaterialRequest,window:H});let{documentType:et,maxAccess:en,changeDT:el}=(0,b.H)({functionId:C.J.MaterialRequest,access:ea,enabled:!B}),er=(0,c.E)({endpointId:F.I.MaterialReplenishment.page});async function es(){if(!ev&&(null==et||!et.dtId)){var e;let a=null==U?void 0:null===(e=U.list)||void 0===e?void 0:e.find(e=>{let{key:a}=e;return"de_siteId"===a});(null==a?void 0:a.value)&&ei.setFieldValue("fromSiteId",parseInt(null==a?void 0:a.value))}}let ed=null===(a=JSON.parse(window.sessionStorage.getItem("userData")))||void 0===a?void 0:a.userId,eo=async()=>{var e,a;let t=await Q({extension:g.r.Users.get,parameters:"_recordId=".concat(ed)});if(null==t?void 0:null===(e=t.record)||void 0===e?void 0:e.employeeId){let e=await Q({extension:j.y.Employee.get1,parameters:"_recordId=".concat(null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.employeeId)});ei.setFieldValue("departmentId",e.record.departmentId)}},{formik:ei}=(0,p.c)({documentType:{key:"dtId",value:null==et?void 0:et.dtId},initialValues:{recordId:null,functionId:C.J.MaterialRequest,reference:"",dtId:null,siteId:null,siteName:"",date:new Date,fromSiteId:"",departmentId:null,departmentName:"",statusName:"",rsName:"",wipName:"",notes:"",workCenterId:null,wcName:"",wcRef:"",status:1,wip:1,items:[{id:1,requestId:B||0,seqNo:1,sku:"",itemName:null,itemId:null,qty:null,notes:"",onHandSite:0,onHandGlobal:null,deliveredQty:null,deliveryStatus:"",muId:null,muQty:"",muRef:"",muName:"",msId:null}]},maxAccess:en,validateOnChange:!0,validationSchema:s.Ry({date:s.hT().required(),fromSiteId:s.Z_().required(),items:s.IX().of(s.Ry().shape({sku:s.Z_().required(),qty:s.Z_().required().min(1)})).required()}),onSubmit:async e=>{let a={...e,date:(0,R.ku)(null==e?void 0:e.date)||null};delete a.items;let t=null==e?void 0:e.items.map((a,t)=>({...a,seqNo:t+1,requestId:e.recordId||0}));if(e.fromSiteId===e.siteId){Y({message:ee.errorMessage});return}let n=await W({extension:F.I.MaterialReplenishment.set2,record:JSON.stringify({header:a,items:t})});if(e.recordId)o.ZP.success(G.Edited);else{o.ZP.success(G.Added),ei.setFieldValue("recordId",n.recordId);let e=await eI(n.recordId),a=await eb(n.recordId);ei.setValues({...e.record,items:a}),er()}}});async function eu(e){var a,t;if(!e)return;let n=null===(t=ei.values.items)||void 0===t?void 0:null===(a=t.find(a=>parseInt(a.itemId)===e))||void 0===a?void 0:a.msId,l=(null==z?void 0:z.filter(e=>e.msId===n))||[];X.current=l}let ec=2===ei.values.wip,em=-1==ei.values.status,ev=!!ei.values.recordId,ep=async()=>await Q({extension:w.$.MeasurementUnit.qry,parameters:"_msId=0"});async function ey(e){let a=await Q({extension:w.$.Item.get,parameters:"_recordId=".concat(e)});return null==a?void 0:a.record}async function eh(e){let a=await Q({extension:w.$.Availability.qry,parameters:"_siteId=".concat(ei.values.fromSiteId||0,"&_itemId=").concat(e,"&_startAt=0&_pageSize=1000")}),t=(null==a?void 0:a.count)>0,n=t&&0!==a.list[0].siteId;return t&&n?(ei.setFieldValue("onHandSite",a.list[0].onhand),a.list[0].onhand):(ei.setFieldValue("onHandSite",0),null)}let ef=[{component:"resourcelookup",label:ee.sku,name:"sku",props:{endpointId:w.$.Item.snapshot,valueField:"sku",displayField:"sku",mandatory:!0,readOnly:ec||em,displayFieldWidth:3,mapping:[{from:"recordId",to:"itemId"},{from:"msId",to:"msId"},{from:"onHandGlobal",to:"onHandGlobal"},{from:"deliveredQty",to:"deliveredQty"},{from:"sku",to:"sku"},{from:"name",to:"itemName"},{from:"isInactive",to:"isInactive"}],columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"},{key:"flName",value:"flName"}]},async onChange(e){let{row:{update:a,newRow:t}}=e;if(!(null==t?void 0:t.itemId)){a({details:!1});return}if(t.isInactive){a({...ei.initialValues.items[0],id:t.id}),Y({message:ee.inactiveItem});return}if(null==t?void 0:t.itemId){var n,l,r;let e=await ey(t.itemId);eu(null==t?void 0:t.itemId);let s=null==z?void 0:z.filter(a=>a.msId===(null==e?void 0:e.msId)),d=null!==(r=await eh(null==t?void 0:t.itemId))&&void 0!==r?r:0;a({msId:null==e?void 0:e.msId,onHandSite:d,muRef:null==s?void 0:null===(n=s[0])||void 0===n?void 0:n.reference,muId:null==s?void 0:null===(l=s[0])||void 0===l?void 0:l.recordId})}}},{component:"textfield",label:ee.itemName,name:"itemName",props:{readOnly:!0}},{component:"resourcecombobox",label:ee.muId,name:"muRef",props:{store:null==X?void 0:X.current,displayField:"reference",valueField:"recordId",readOnly:ec||em,mapping:[{from:"reference",to:"muRef"},{from:"recordId",to:"muId"}]},async onChange(e){var a;let{row:{update:t,newRow:n}}=e,l=null==X?void 0:X.current.filter(e=>e.recordId===(null==n?void 0:n.muId));t({qtyInBase:(null==n?void 0:n.qty)*(null==l?void 0:l.muQty),muQty:null==n?void 0:n.muQty})},propsReducer(e){let{row:a,props:t}=e;return{...t,store:null==X?void 0:X.current}}},{component:"numberfield",label:ee.qty,name:"qty",props:{readOnly:ec||em,mandatory:!0},async onChange(e){let{row:{update:a,newRow:t}}=e;if(t){var n;a({qtyInBase:(null==t?void 0:t.qty)*(null==t?void 0:t.muQty)})}}},{component:"numberfield",label:ee.onHandSite,name:"onHandSite",props:{readOnly:!0}},{component:"textfield",label:ee.notes,name:"notes",props:{readOnly:ec||em}}];async function eI(e){var a;let t=await Q({extension:F.I.MaterialReplenishment.get,parameters:"_requestId=".concat(e,"&_params=")});return t.record.date=(0,R.a1)(null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.date),t}let ex=async e=>{await W({extension:F.I.MaterialReplenishment.close,record:JSON.stringify({recordId:e})}),o.ZP.success(G.Closed),er();let a=await eI(e),t=await eb(e);ei.setValues({...a.record,items:t})},eg=async e=>{var a;let t={...ei.values,date:(0,R.ku)(null===(a=ei.values)||void 0===a?void 0:a.date)||null};delete t.items,await W({extension:F.I.MaterialReplenishment.reopen,record:JSON.stringify(t)}),o.ZP.success(G.Reopened),er();let n=await eI(e),l=await eb(e);ei.setValues({...n.record,items:l})},eC=async e=>{var a;let t={...ei.values,date:(0,R.ku)(null===(a=ei.values)||void 0===a?void 0:a.date)||null};delete t.items,await W({extension:F.I.MaterialReplenishment.cancel,record:JSON.stringify(t)}),o.ZP.success(G.Cancelled),er();let n=await eI(e),l=await eb(e);ei.setValues({...n.record,items:l})},eD=[{key:"Approval",condition:!0,onClick:"onApproval",disabled:!ec},{key:"Close",condition:!ec,onClick:()=>ex(ei.values.recordId),disabled:!ev||em},{key:"Reopen",condition:ec,onClick:()=>eg(ei.values.recordId),disabled:!ev||em},{key:"WorkFlow",condition:!0,onClick:async()=>{$({Component:S.Z,props:{functionId:C.J.MaterialRequest,recordId:ei.values.recordId}})},disabled:!ev},{key:"Cancel",condition:!0,onClick:()=>eC(ei.values.recordId),disabled:!ev||em||ec}];async function eb(e){var a,t;let n=await Q({extension:F.I.OrderItem.qry,parameters:"_requestId=".concat(e,"&_functionId=").concat(C.J.MaterialRequest,"&_params=&_startAt=0")});return(null==n?void 0:null===(a=n.list)||void 0===a?void 0:a.length)?await Promise.all(null==n?void 0:null===(t=n.list)||void 0===t?void 0:t.map(async e=>({...e,id:e.seqNo,onHandSite:e.onhandSite}))):[]}return(0,r.useEffect)(()=>{!async function(){let e=await ep();K(null==e?void 0:e.list),es(),await eo()}()},[]),(0,r.useEffect)(()=>{!async function(){if(B&&z){let e=await eI(B),a=await eb(B);ei.setValues({...e.record,items:a})}}()},[B,z]),(0,n.jsx)(d.Z,{resourceId:m.i.MaterialReplenishment,form:ei,maxAccess:en,editMode:ev,previewReport:ev,actions:eD,functionId:C.J.MaterialRequest,disabledSubmit:ec||em,children:(0,n.jsxs)(h.R,{children:[(0,n.jsx)(k.g,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:g.r.DocumentType.qry,parameters:"_dgId=".concat(C.J.MaterialRequest,"&_startAt=0&_pageSize=50"),filter:ev?void 0:e=>1===e.activeStatus,name:"dtId",label:ee.documentType,readOnly:ec||em,valueField:"recordId",displayField:"name",values:null==ei?void 0:ei.values,onChange:async(e,a)=>{ei.setFieldValue("dtId",(null==a?void 0:a.recordId)||null),el(a)},error:ei.touched.dtId&&!!ei.errors.dtId,maxAccess:en})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(v.Z,{name:"reference",label:ee.reference,value:null==ei?void 0:null===(t=ei.values)||void 0===t?void 0:t.reference,readOnly:ev,maxAccess:!ev&&en,onChange:ei.handleChange,onClear:()=>ei.setFieldValue("reference",""),error:ei.touched.reference&&!!ei.errors.reference})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{name:"date",label:ee.date,value:null==ei?void 0:null===(V=ei.values)||void 0===V?void 0:V.date,required:!0,onChange:ei.setFieldValue,onClear:()=>ei.setFieldValue("date",null),readOnly:ec||em,error:ei.touched.date&&!!ei.errors.date,maxAccess:en})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:Z.K.DepartmentFilters.qry,parameters:"_filter=&_size=1000&_startAt=0&_type=0&_activeStatus=0&_sortBy=recordId",name:"departmentId",readOnly:ec||em,label:ee.department,values:ei.values,displayField:"name",maxAccess:en,onChange:(e,a)=>{ei.setFieldValue("departmentId",(null==a?void 0:a.recordId)||null)},error:ei.touched.departmentId&&!!ei.errors.departmentId})})]})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(T.U,{endpointId:O.u.WorkCenter.snapshot,name:"workCenterId",label:ee.workCenter,valueField:"reference",displayField:"name",valueShow:"wcRef",secondValueShow:"wcName",displayFieldWidth:2,form:ei,onChange:(e,a)=>{ei.setFieldValue("workCenterId",(null==a?void 0:a.recordId)||null),ei.setFieldValue("wcRef",(null==a?void 0:a.reference)||""),ei.setFieldValue("wcName",(null==a?void 0:a.name)||"")},error:ei.touched.workCenterId&&!!ei.errors.workCenterId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:w.$.Site.qry,name:"siteId",readOnly:ec||em,refresh:ev,label:ee.site,values:ei.values,displayField:"name",maxAccess:en,onChange:(e,a)=>{ei.setFieldValue("siteId",(null==a?void 0:a.recordId)||null)},error:ei.touched.siteId&&!!ei.errors.siteId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.Z,{endpointId:w.$.Site.qry,name:"fromSiteId",readOnly:ec||em||(null==ei?void 0:null===(M=ei.values)||void 0===M?void 0:null===(L=M.items)||void 0===L?void 0:L.some(e=>e.sku)),label:ee.fromSite,values:ei.values,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:1,required:!0,maxAccess:en,onChange:(e,a)=>{ei.setFieldValue("fromSiteId",(null==a?void 0:a.recordId)||null)},error:ei.touched.fromSiteId&&!!ei.errors.fromSiteId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.Z,{name:"notes",label:ee.notes,value:null==ei?void 0:null===(E=ei.values)||void 0===E?void 0:E.notes,readOnly:ec||em,maxLength:"200",maxAccess:en,onChange:ei.handleChange,onClear:()=>ei.setFieldValue("notes",""),error:ei.touched.notes&&!!ei.errors.notes})})]})})]})}),(0,n.jsx)(f.Q,{children:(0,n.jsx)(i._,{onChange:e=>{let a=null==e?void 0:e.map(e=>({...e,details:!1,qtyInBase:0}));null==ei||ei.setFieldValue("items",a)},onSelectionChange:(e,a,t)=>{"muRef"==t&&eu(null==e?void 0:e.itemId)},name:"items",maxAccess:en,value:null==ei?void 0:null===(_=ei.values)||void 0===_?void 0:_.items,error:null==ei?void 0:null===(J=ei.errors)||void 0===J?void 0:J.items,columns:ef,allowDelete:!ec&&!em})})]})})}V.width=1e3,V.height=680},74456:function(e,a,t){"use strict";var n=t(52322),l=t(60218),r=t(48601),s=t(2784),d=t(5088),o=t(82737),i=t(89330),u=t(88469),c=t(65950),m=t(26612),v=t(80983),p=t(31389),y=t(62362),h=t(91406),f=t(27423),I=t(39812),x=t(75991),g=t(46553),C=t(17720),D=t(62202),b=t(7121),R=t(98345),S=t(84141),q=t(61802),w=t(19473),P=t(71987),Z=t(33625),F=t(8661),j=t(84100),k=t(50023),T=t(21326);let O=e=>{var a,t,O,N,A,V,L,M,E,_,J,B;let{recordId:H,window:Q}=e,{getRequest:W,postRequest:G}=(0,s.useContext)(c.$),{stack:U}=(0,q.zY)(),{platformLabels:$}=(0,s.useContext)(w.l),[Y,z]=(0,s.useState)(!1),[K,X]=(0,s.useState)(!1),[ee,ea]=(0,s.useState)(!1),{labels:et,access:en}=(0,k.Z)({datasetId:m.i.OutwardsModification,editMode:!!H});(0,T.Z)({title:et.outwardsModification,window:Q});let{maxAccess:el}=(0,R.H)({functionId:b.J.OutwardsModification,access:en,hasDT:!1}),er=(0,P.E)({endpointId:u.N.OutwardsModification.page}),{formik:es}=(0,v.c)({maxAccess:el,initialValues:{recordId:null,reference:"",date:new Date,outwardsDate:null,owoId:"",owRef:"",ttNo:"",productName:"",clientId:"",currencyId:"",clientRef:"",clientName:"",cellPhone:"",dispersalType:"",countryId:"",headerBenId:"",headerBenName:"",headerBenSeqNo:"",newBeneficiaryId:"",newBeneficiarySeqNo:"",corId:"",oldBeneficiaryId:"",oldBeneficiarySeqNo:"",oldBeneficiarySeqName:"",wip:"",releaseStatus:"",status:"",otpVerified:!1,owtId:"",owtRef:"",plantId:"",seqNo:"",modificationType:"",beneficiaryData:{}},validateOnChange:!0,validationSchema:r.Ry({owRef:r.Z_().required(),date:r.Z_().required(),modificationType:r.Z_().required()}),onSubmit:async()=>{X(!0)}}),ed=!!es.values.recordId,eo=2===es.values.wip,ei=4===es.values.status,eu=es.values.dispersalType;async function ec(e){return await W({extension:u.N.OutwardsModification.get,parameters:"_recordId=".concat(e)})}let em=async e=>{let a=await G({extension:u.N.OutwardsModification.close,record:JSON.stringify({recordId:e})});H&&D.ZP.success($.Closed),er(),await ex(a.recordId)};function ev(e){es.setValues({...es.values,beneficiaryData:e})}function ep(e){for(let[a,t]of Object.entries(e))es.setFieldValue(a,null!=t?t:"")}async function ey(e){var a,t,n,l;ep(e);let{headerView:r,ttNo:s}=(await W({extension:u.N.OutwardsOrder.get2,parameters:"_recordId=".concat(null==e?void 0:e.owoId)})).record;ep({outwardsDate:(0,I.a1)(r.date),amount:r.amount,productName:r.productName,clientId:r.clientId,currencyId:r.currencyId,clientRef:r.clientRef,clientName:r.clientName,cellPhone:r.cellPhone,ttNo:s,dispersalType:r.dispersalType,countryId:r.countryId,corId:r.corId,modificationType:null==e?void 0:e.modificationType}),ef({headerBenId:null!==(a=e.newBeneficiaryId)&&void 0!==a?a:"",headerBenName:null!==(t=e.newBeneficiaryName)&&void 0!==t?t:"",headerBenSeqNo:null!==(n=e.newBeneficiarySeqNo)&&void 0!==n?n:"",dispersalType:null!==(l=r.dispersalType)&&void 0!==l?l:""})}function eh(){es.resetForm(),z(!0)}async function ef(e){es.setFieldValue("newBeneficiaryId",e.headerBenId),es.setFieldValue("newBeneficiarySeqNo",e.headerBenSeqNo),es.setFieldValue("dispersalType",e.dispersalType)}let eI=[{key:"Close",condition:!eo,onClick:()=>em(es.values.recordId),disabled:eo||!ed},{key:"Reopen",condition:eo,onClick:async()=>{let e=await G({extension:u.N.OutwardsModification.reopen,record:JSON.stringify({recordId:es.values.recordId})});D.ZP.success($.Reopened),er(),await ex(e.recordId)},disabled:!eo},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!eo},{key:"Locked",condition:!0,onClick:async()=>{let e=await G({extension:u.N.OutwardsModification.post,record:JSON.stringify({recordId:es.values.recordId})});D.ZP.success($.Posted),er(),await ex(e.recordId)},disabled:!ei}];async function ex(e){let a=await ec(e);a.record.date=(0,I.a1)(a.record.date),await ey(a.record)}async function eg(e){if(e)return await W({extension:u.N.OutwardsOrder.get,parameters:"_recordId=".concat(e)})}return(0,s.useEffect)(()=>{!async function(){if(ee){var e;X(!1),ea(!1);let a={owoId:es.values.owoId,modificationType:es.values.modificationType,owtId:es.values.owtId,beneficiaryCashPack:1===eu?es.values.beneficiaryData:null,beneficiaryBankPack:2===eu?es.values.beneficiaryData:null},t=await G({extension:u.N.OutwardsModification.set2,record:JSON.stringify(a)}),n=ed?$.Edited:$.Added;D.ZP.success(n),await ex(t.recordId),er(),H||(e=t.recordId,U({Component:S.Z,props:{values:es.values,recordId:e,functionId:b.J.OutwardsModification,onSuccess:()=>{em(e)}}}))}}()},[ee]),(0,s.useEffect)(()=>{!async function(){H&&await ex(H)}()},[]),(0,n.jsx)(o.Z,{resourceId:m.i.OutwardsModification,form:es,maxAccess:el,editMode:ed,disabledSubmit:ed,onClose:em,isClosed:eo,actions:eI,functionId:b.J.OutwardsModification,previewReport:ed,children:(0,n.jsx)(p.R,{children:(0,n.jsx)(y.Q,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(Z.g,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsx)(d.Z,{name:"reference",label:et.reference,value:es.values.reference,maxAccess:el,readOnly:!0})}),(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsx)(i.Z,{name:"date",required:!0,readOnly:ed,label:et.date,value:es.values.date,editMode:ed,maxAccess:el,onChange:es.setFieldValue,onClear:()=>es.setFieldValue("date",""),error:es.touched.date&&!!es.errors.date})}),(0,n.jsx)(l.ZP,{item:!0,xs:2,children:(0,n.jsx)(f.U,{endpointId:u.N.OutwardsOrder.snapshot,valueField:"reference",displayField:"reference",name:"owRef",secondDisplayField:!1,required:!0,readOnly:ed||es.values.owtRef,label:et.outwardOrder,form:es,onChange:(e,a)=>{(null==a?void 0:a.recordId)?ey({owoId:null==a?void 0:a.recordId,owRef:null==a?void 0:a.reference,oldBeneficiaryId:null==a?void 0:a.beneficiaryId,oldBeneficiarySeqNo:null==a?void 0:a.beneficiarySeqNo,oldBeneficiaryName:null==a?void 0:a.beneficiaryName,newBeneficiaryId:null==a?void 0:a.beneficiaryId,newBeneficiarySeqNo:null==a?void 0:a.beneficiarySeqNo,newBeneficiaryName:null==a?void 0:a.beneficiaryName,dispersalType:null==a?void 0:a.dispersalType}):eh()},error:es.touched.owRef&&!!es.errors.owRef,maxAccess:el})}),(0,n.jsx)(l.ZP,{item:!0,xs:2,children:(0,n.jsx)(f.U,{endpointId:u.N.OutwardsTransfer.snapshot,valueField:"reference",displayField:"reference",name:"owtRef",secondDisplayField:!1,readOnly:ed||es.values.owRef,label:et.outwardTransfer,form:es,onChange:async(e,a)=>{var t,n,l,r,s,d,o,i;(null==a?void 0:a.recordId)||eh();let u=await eg(null==a?void 0:a.owoId);await ey({owoId:null==a?void 0:a.owoId,owRef:null==u?void 0:null===(t=u.record)||void 0===t?void 0:t.reference,owtId:null==a?void 0:a.recordId,owtRef:null==a?void 0:a.reference,oldBeneficiaryId:null==u?void 0:null===(n=u.record)||void 0===n?void 0:n.beneficiaryId,oldBeneficiarySeqNo:null==u?void 0:null===(l=u.record)||void 0===l?void 0:l.beneficiarySeqNo,oldBeneficiaryName:null==u?void 0:null===(r=u.record)||void 0===r?void 0:r.beneficiaryName,newBeneficiaryId:null==u?void 0:null===(s=u.record)||void 0===s?void 0:s.beneficiaryId,newBeneficiarySeqNo:null==u?void 0:null===(d=u.record)||void 0===d?void 0:d.beneficiarySeqNo,newBeneficiaryName:null==u?void 0:null===(o=u.record)||void 0===o?void 0:o.beneficiaryName,dispersalType:null==u?void 0:null===(i=u.record)||void 0===i?void 0:i.dispersalType})},error:es.touched.owtRef&&!!es.errors.owtRef,maxAccess:el})}),(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsx)(d.Z,{name:"ttNo",label:et.ttNo,value:es.values.ttNo,readOnly:!0,error:es.touched.ttNo&&!!es.errors.ttNo,maxAccess:el})}),(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsx)(i.Z,{name:"outwardsDate",label:et.outwardsDate,value:es.values.outwardsDate,editMode:ed,maxAccess:el,readOnly:!0,error:es.touched.outwardsDate&&!!es.errors.outwardsDate})}),(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsx)(d.Z,{name:"productName",label:et.product,value:es.values.productName,readOnly:!0,error:es.touched.ttNo&&!!es.errors.productName,maxAccess:el})}),(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsx)(h.Z,{name:"amount",label:et.amount,value:es.values.amount,maxAccess:el,readOnly:!0,error:es.touched.amount&&!!es.errors.amount})}),(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsx)(F.Z,{datasetId:j.v.OW_MODIFICATION_TYPE,name:"modificationType",label:et.modificationType,values:es.values,valueField:"key",displayField:"value",required:!0,readOnly:ed,maxAccess:el,onChange:(e,a)=>{es.setFieldValue("modificationType",null==a?void 0:a.key),(null==a?void 0:a.key)==3&&(z(!0),es.setFieldValue("newBeneficiaryId",""),es.setFieldValue("newBeneficiarySeqNo",""),es.setFieldValue("headerBenName",""))},error:es.touched.modificationType&&!!es.errors.modificationType})}),(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsx)(f.U,{endpointId:u.N.Beneficiary.snapshot2,parameters:{_clientId:es.values.clientId,_dispersalType:es.values.dispersalType,_currencyId:es.values.currencyId},valueField:"name",displayField:"name",name:"headerBenName",label:et.beneficiary,form:es,readOnly:!es.values.clientId||!es.values.dispersalType||ed||ei||2!=es.values.modificationType,maxAccess:el,editMode:ed,secondDisplayField:!1,onChange:async(e,a)=>{(null==a?void 0:a.beneficiaryId)?ef({headerBenId:null==a?void 0:a.beneficiaryId,headerBenName:null==a?void 0:a.name,headerBenSeqNo:null==a?void 0:a.seqNo,dispersalType:null==a?void 0:a.dispersalType}):(es.setFieldValue("headerBenId",""),es.setFieldValue("headerBenName",""),es.setFieldValue("headerBenSeqNo",""))},errorCheck:"headerBenId"})})]})})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Q,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsxs)(x.Z,{title:et.benOld,form:!0,children:[2===eu&&(0,n.jsx)(C.Z,{client:{clientId:es.values.clientId,clientName:es.values.clientName,clientRef:es.values.clientRef},beneficiary:{beneficiaryId:es.values.oldBeneficiaryId,beneficiarySeqNo:es.values.oldBeneficiarySeqNo},dispersalType:es.values.dispersalType,countryId:es.values.countryId,corId:es.values.corId,recordId:(null===(a=es.values)||void 0===a?void 0:a.clientId)&&(null===(t=es.values)||void 0===t?void 0:t.oldBeneficiaryId)&&(null===(O=es.values)||void 0===O?void 0:O.oldBeneficiarySeqNo)?(100*es.values.clientId).toString()+(10*es.values.oldBeneficiaryId).toString()+es.values.oldBeneficiarySeqNo:null,viewBtns:!1}),1===eu&&(0,n.jsx)(g.Z,{client:{clientId:es.values.clientId,clientName:es.values.clientName,clientRef:es.values.clientRef},beneficiary:{beneficiaryId:es.values.oldBeneficiaryId,beneficiarySeqNo:es.values.oldBeneficiarySeqNo},dispersalType:es.values.dispersalType,countryId:es.values.countryId,corId:es.values.corId,recordId:(null===(N=es.values)||void 0===N?void 0:N.clientId)&&(null===(A=es.values)||void 0===A?void 0:A.oldBeneficiaryId)&&(null===(V=es.values)||void 0===V?void 0:V.oldBeneficiarySeqNo)?(100*es.values.clientId).toString()+(10*es.values.oldBeneficiaryId).toString()+es.values.oldBeneficiarySeqNo:null,viewBtns:!1})]})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsxs)(x.Z,{title:et.benNew,form:!0,children:[2===eu&&(0,n.jsx)(C.Z,{viewBtns:!1,resetForm:Y,setResetForm:z,onChange:ev,submitted:K,setSubmitted:X,setValidSubmit:ea,forceEdit:ed,client:{clientId:es.values.clientId,clientName:es.values.clientName,clientRef:es.values.clientRef},beneficiary:{beneficiaryId:es.values.newBeneficiaryId,beneficiarySeqNo:es.values.newBeneficiarySeqNo},dispersalType:es.values.dispersalType,corId:es.values.corId,recordId:(null===(L=es.values)||void 0===L?void 0:L.clientId)&&(null===(M=es.values)||void 0===M?void 0:M.newBeneficiaryId)&&(null===(E=es.values)||void 0===E?void 0:E.newBeneficiarySeqNo)?(100*es.values.clientId).toString()+(10*es.values.newBeneficiaryId).toString()+es.values.newBeneficiarySeqNo:null,submitMainForm:!1}),1===eu&&(0,n.jsx)(g.Z,{viewBtns:!1,forceEdit:ed,resetForm:Y,setResetForm:z,onChange:ev,submitted:K,setSubmitted:X,setValidSubmit:ea,client:{clientId:es.values.clientId,clientName:es.values.clientName,clientRef:es.values.clientRef},beneficiary:{beneficiaryId:es.values.newBeneficiaryId,beneficiarySeqNo:es.values.newBeneficiarySeqNo},dispersalType:es.values.dispersalType,countryId:es.values.countryId,corId:es.values.corId,recordId:(null===(_=es.values)||void 0===_?void 0:_.clientId)&&(null===(J=es.values)||void 0===J?void 0:J.newBeneficiaryId)&&(null===(B=es.values)||void 0===B?void 0:B.newBeneficiarySeqNo)?(100*es.values.clientId).toString()+(10*es.values.newBeneficiaryId).toString()+es.values.newBeneficiarySeqNo:null,submitMainForm:!1})]})})]})})})]})})})})};O.width=1200,O.height=650,a.Z=O},21379:function(e,a,t){"use strict";t.d(a,{Z:function(){return Z}});var n=t(52322),l=t(60218),r=t(2784),s=t(48601),d=t(62202),o=t(39812),i=t(65950),u=t(19473),c=t(71987),m=t(83562),v=t(7121),p=t(98345),y=t(80983),h=t(26612),f=t(82737),I=t(31389),x=t(62362),g=t(8661),C=t(38449),D=t(5088),b=t(89330),R=t(84100),S=t(91406),q=t(21581),w=t(50023),P=t(21326);function Z(e){var a,t,Z,F,j,k,T,O,N,A,V;let{recordId:L,window:M}=e,{getRequest:E,postRequest:_}=(0,r.useContext)(i.$),{platformLabels:J,defaultsData:B}=(0,r.useContext)(u.l),H=parseInt(null==B?void 0:null===(t=B.list)||void 0===t?void 0:null===(a=t.find(e=>{let{key:a}=e;return"pytvStartDate"===a}))||void 0===a?void 0:a.value)||null,Q=parseInt(null==B?void 0:null===(F=B.list)||void 0===F?void 0:null===(Z=F.find(e=>{let{key:a}=e;return"pytvEndDate"===a}))||void 0===Z?void 0:Z.value)||null,W=(0,c.E)({endpointId:m.m.Payroll.page}),{labels:G,access:U}=(0,w.Z)({datasetId:h.i.PayrollHeader,editMode:!!L});(0,P.Z)({title:G.payrollList,window:M});let{documentType:$,maxAccess:Y,changeDT:z}=(0,p.H)({functionId:v.J.PayrollList,access:U,enabled:!L}),{formik:K}=(0,y.c)({maxAccess:Y,documentType:{key:"dtId",value:null==$?void 0:$.dtId,reference:null==$?void 0:$.reference},initialValues:{recordId:null,dtId:null,reference:"",fiscalYear:null,salaryType:5,date:new Date,payDate:null,startDate:null,endDate:null,taStartDate:null,taEndDate:null,calendarDays:null,periodId:null,notes:"",status:1},validationSchema:s.Ry({periodId:s.Rx().required(),date:s.hT().required(),payDate:s.hT().required(),startDate:s.hT().required(),endDate:s.hT().required(),fiscalYear:s.Rx().required()}),onSubmit:async e=>{await _({extension:m.m.Payroll.set,record:JSON.stringify(e)}),d.ZP.success(e.recordId?J.Edited:J.Added),W(),M.close()}}),X=!!K.values.recordId,ee=2==K.values.wip,ea=3===K.values.status,et=async e=>{if(e){let a=await E({extension:m.m.Payroll.get,parameters:"_recordId=".concat(e)});K.setValues({...a.record,date:(0,o.a1)(a.record.date),payDate:(0,o.a1)(a.record.payDate),startDate:(0,o.a1)(a.record.startDate),endDate:(0,o.a1)(a.record.endDate),taStartDate:(0,o.a1)(a.record.taStartDate),taEndDate:(0,o.a1)(a.record.taEndDate)})}};(0,r.useEffect)(()=>{et(L)},[]);let en=async()=>{let e=await _({extension:m.m.Payroll.close,record:JSON.stringify({...K.values,date:(0,o.ku)(K.values.date),payDate:(0,o.ku)(K.values.payDate),startDate:(0,o.ku)(K.values.startDate),endDate:(0,o.ku)(K.values.endDate),taStartDate:(0,o.ku)(K.values.taStartDate),taEndDate:(0,o.ku)(K.values.taEndDate)})});d.ZP.success(J.Closed),et(null==e?void 0:e.recordId),W()},el=async()=>{await _({extension:m.m.Payroll.post,record:JSON.stringify({...K.values,date:(0,o.ku)(K.values.date),payDate:(0,o.ku)(K.values.payDate),startDate:(0,o.ku)(K.values.startDate),endDate:(0,o.ku)(K.values.endDate),taStartDate:(0,o.ku)(K.values.taStartDate),taEndDate:(0,o.ku)(K.values.taEndDate)})}),d.ZP.success(J.Posted),et(L),W()},er=async()=>{let e=await _({extension:m.m.Payroll.unpost,record:JSON.stringify({...K.values,date:(0,o.ku)(K.values.date),payDate:(0,o.ku)(K.values.payDate),startDate:(0,o.ku)(K.values.startDate),endDate:(0,o.ku)(K.values.endDate),taStartDate:(0,o.ku)(K.values.taStartDate),taEndDate:(0,o.ku)(K.values.taEndDate)})});d.ZP.success(J.Unposted),et(null==e?void 0:e.recordId),W()},es=async()=>{let e=await _({extension:m.m.Payroll.reopen,record:JSON.stringify({...K.values,date:(0,o.ku)(K.values.date),payDate:(0,o.ku)(K.values.payDate),startDate:(0,o.ku)(K.values.startDate),endDate:(0,o.ku)(K.values.endDate),taStartDate:(0,o.ku)(K.values.taStartDate),taEndDate:(0,o.ku)(K.values.taEndDate)})});d.ZP.success(J.Reopened),et(null==e?void 0:e.recordId),W()},ed=[{key:"GL",condition:!0,onClick:"onClickGL",datasetId:h.i.GLPayrollList,disabled:!X},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!ee},{key:"Close",condition:!ee,onClick:en,disabled:ee||!X},{key:"Reopen",condition:ee,onClick:es,disabled:!ee||ea},{key:"Unlocked",condition:!ea,onClick:el,disabled:!X||!ee},{key:"Locked",condition:ea,onClick:"onUnpostConfirmation",onSuccess:er,disabled:!X||!ee}],eo=(e,a,t,n)=>{if(!e||!a)return{};let l=new Date(e),r=new Date(a),s=new Date(r.getFullYear(),r.getMonth(),n),d=l.getMonth(),o=l.getFullYear();return t>l.getDate()&&(d-=1)<0&&(d=11,o-=1),{taStartDate:new Date(o,d,t),taEndDate:s}};return(0,n.jsx)(f.Z,{resourceId:h.i.PayrollHeader,form:K,maxAccess:Y,editMode:X,actions:ed,functionId:v.J.PayrollList,disabledSubmit:ee,children:(0,n.jsx)(I.R,{children:(0,n.jsx)(x.Q,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{endpointId:C.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(v.J.PayrollList),name:"dtId",label:G.docType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:X,valueField:"recordId",displayField:["reference","name"],values:K.values,maxAccess:Y,onChange:async(e,a)=>{await z(a),K.setFieldValue("dtId",(null==a?void 0:a.recordId)||null)},error:K.touched.dtId&&!!K.errors.dtId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.Z,{name:"reference",label:G.reference,value:null==K?void 0:null===(j=K.values)||void 0===j?void 0:j.reference,maxAccess:!X&&Y,readOnly:X,onChange:K.handleChange,onClear:()=>K.setFieldValue("reference",""),error:K.touched.reference&&!!K.errors.reference})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.Z,{name:"date",required:!0,label:G.date,value:null==K?void 0:null===(k=K.values)||void 0===k?void 0:k.date,maxAccess:Y,readOnly:ee,onChange:K.setFieldValue,onClear:()=>K.setFieldValue("date",null),error:K.touched.date&&!!K.errors.date})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{endpointId:m.m.FiscalYear.qry,name:"fiscalYear",label:G.fiscalYear,valueField:"fiscalYear",displayField:"fiscalYear",values:K.values,readOnly:ee,required:!0,maxAccess:Y,onChange:(e,a)=>{K.setFieldValue("fiscalYear",(null==a?void 0:a.fiscalYear)||null)},error:K.touched.fiscalYear&&!!K.errors.fiscalYear})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{datasetId:R.v.SALARY_TYPE,name:"salaryType",label:G.salaryType,valueField:"key",displayField:"value",values:K.values,maxAccess:Y,readOnly:!0,onChange:(e,a)=>K.setFieldValue("salaryType",(null==a?void 0:a.key)||null),error:K.touched.salaryType&&!!K.errors.salaryType})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{endpointId:m.m.Period.qry,parameters:K.values.fiscalYear&&K.values.salaryType&&"_year=".concat(K.values.fiscalYear,"&_salaryType=").concat(K.values.salaryType,"&_status=0"),name:"periodId",label:G.period,valueField:"periodId",required:!0,displayField:"periodName",values:K.values,readOnly:ee,maxAccess:Y,onChange:(e,a)=>K.setFieldValue("periodId",(null==a?void 0:a.periodId)||null),error:K.touched.periodId&&!!K.errors.periodId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.Z,{name:"payDate",required:!0,label:G.payDate,value:null==K?void 0:null===(T=K.values)||void 0===T?void 0:T.payDate,maxAccess:Y,readOnly:ee,onChange:(e,a)=>{if(a&&5===K.values.salaryType){let e=new Date(a),t=new Date(e.getFullYear(),e.getMonth(),1),n=new Date(e.getFullYear(),e.getMonth()+1,0),l=n.getTime()-t.getTime();if(K.setFieldValue("calendarDays",l/864e5+1),K.setFieldValue("startDate",t),K.setFieldValue("endDate",n),K.setFieldTouched("startDate",!1,!1),K.setFieldTouched("endDate",!1,!1),H&&Q){let{taStartDate:e,taEndDate:a}=eo(t,n,H,Q);K.setFieldValue("taStartDate",e),K.setFieldValue("taEndDate",a)}}K.setFieldValue("payDate",a)},onClear:()=>{K.setFieldValue("payDate",null),K.setFieldValue("calendarDays",""),K.setFieldValue("startDate",null),K.setFieldValue("endDate",null),K.setFieldValue("taStartDate",null),K.setFieldValue("taEndDate",null)},error:K.touched.payDate&&!!K.errors.payDate})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.Z,{name:"startDate",label:G.startDate,value:null==K?void 0:null===(O=K.values)||void 0===O?void 0:O.startDate,maxAccess:Y,readOnly:!0,required:!0,onChange:K.setFieldValue,onClear:()=>K.setFieldValue("startDate",null),error:K.touched.startDate&&!!K.errors.startDate})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.Z,{name:"endDate",label:G.endDate,value:null==K?void 0:null===(N=K.values)||void 0===N?void 0:N.endDate,onChange:K.setFieldValue,maxAccess:Y,readOnly:!0,required:!0,onClear:()=>K.setFieldValue("endDate",null),error:K.touched.endDate&&!!K.errors.endDate})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.Z,{name:"taStartDate",label:G.taStartDate,value:null==K?void 0:null===(A=K.values)||void 0===A?void 0:A.taStartDate,onChange:K.setFieldValue,maxAccess:Y,readOnly:!0,onClear:()=>K.setFieldValue("taStartDate",null),error:K.touched.taStartDate&&!!K.errors.taStartDate})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.Z,{name:"taEndDate",label:G.taEndDate,value:null==K?void 0:null===(V=K.values)||void 0===V?void 0:V.taEndDate,onChange:K.setFieldValue,maxAccess:Y,readOnly:!0,onClear:()=>K.setFieldValue("taEndDate",null),error:K.touched.taEndDate&&!!K.errors.taEndDate})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{name:"calendarDays",label:G.calendarDays,value:K.values.calendarDays,onChange:K.handleChange,onClear:()=>K.setFieldValue("calendarDays",""),readOnly:!0,maxAccess:Y,error:K.touched.calendarDays&&!!K.errors.calendarDays})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(q.Z,{name:"notes",label:G.notes,value:K.values.notes,maxAccess:Y,readOnly:ee,rows:3,maxLength:"128",onChange:e=>K.setFieldValue("notes",e.target.value),onClear:()=>K.setFieldValue("notes",""),error:K.touched.notes&&!!K.errors.notes})})]})})})})}Z.width=850,Z.height=700},73470:function(e,a,t){"use strict";t.d(a,{Z:function(){return F}});var n=t(52322),l=t(89330),r=t(39812),s=t(60218),d=t(2784),o=t(48601),i=t(82737),u=t(62202),c=t(65950),m=t(71987),v=t(26612),p=t(5088),y=t(21581),h=t(8661),f=t(7121),I=t(27423),x=t(62362),g=t(31389),C=t(91406),D=t(80983),b=t(19473),R=t(92407),S=t(75991),q=t(68676),w=t(96026),P=t(21326),Z=t(50023);function F(e){var a,t,F,j,k,T,O,N,A;let{recordId:V,window:L}=e,{getRequest:M,postRequest:E}=(0,d.useContext)(c.$),{platformLabels:_}=(0,d.useContext)(b.l),{stack:J}=(0,w.V)(),{labels:B,access:H}=(0,Z.Z)({datasetId:v.i.ResignationRequest,editMode:!!V});(0,P.Z)({title:B.ResignationReq,window:L});let Q=(0,m.E)({endpointId:R.y.ResignationRequest.page}),{formik:W}=(0,D.c)({maxAccess:H,initialValues:{recordId:V||null,reference:"",date:new Date,effectiveDate:null,employeeId:null,department:null,position:null,branch:null,hireDate:null,serviceDuration:null,netSalary:null,explanation:"",status:1,wip:1,reasonId:null,releaseStatus:null},validateOnChange:!0,validationSchema:o.Ry({employeeId:o.Rx().required(),effectiveDate:o.hT().required(),date:o.hT().required(),reasonId:o.Rx().required()}),onSubmit:async e=>{let{hireDate:a,department:t,position:n,branch:l,serviceDuration:s,netSalary:d,...o}=e;E({extension:R.y.ResignationRequest.set,record:JSON.stringify({...o,date:(0,r.OZ)(new Date(e.date)),effectiveDate:(0,r.OZ)(new Date(e.effectiveDate))})}).then(async e=>{u.ZP.success(V?_.Edited:_.Added),W.setFieldValue("recordId",e.recordId),await G(e.recordId),Q()})}});function G(e){M({extension:R.y.ResignationRequest.get,parameters:"_recordId=".concat(e)}).then(e=>{!function(e){M({extension:R.y.QuickView.get,parameters:"_recordId=".concat(null==e?void 0:e.employeeId,"&_asOfDate=").concat((0,r.Uf)((0,r.a1)(null==e?void 0:e.date)))}).then(a=>{var t,n,l,s,d,o;W.setValues({...W.values,...e,effectiveDate:(0,r.a1)(null==e?void 0:e.effectiveDate),date:(0,r.a1)(null==e?void 0:e.date),hireDate:(0,r.a1)(null==a?void 0:null===(t=a.record)||void 0===t?void 0:t.hireDate),department:null==a?void 0:null===(n=a.record)||void 0===n?void 0:n.departmentName,position:null==a?void 0:null===(l=a.record)||void 0===l?void 0:l.positionName,branch:null==a?void 0:null===(s=a.record)||void 0===s?void 0:s.branchName,serviceDuration:null==a?void 0:null===(d=a.record)||void 0===d?void 0:d.serviceDuration,netSalary:null==a?void 0:null===(o=a.record)||void 0===o?void 0:o.salary})})}(e.record)})}async function U(e){if(e){var a;await M({extension:R.y.QuickView.get,parameters:"_recordId=".concat(e,"&_asOfDate=").concat((0,r.Uf)(null==W?void 0:null===(a=W.values)||void 0===a?void 0:a.date))}).then(e=>{var a,t,n,l,s,d;W.setFieldValue("hireDate",(0,r.a1)(null==e?void 0:null===(a=e.record)||void 0===a?void 0:a.hireDate)||null),W.setFieldValue("department",(null==e?void 0:null===(t=e.record)||void 0===t?void 0:t.departmentName)||null),W.setFieldValue("position",(null==e?void 0:null===(n=e.record)||void 0===n?void 0:n.positionName)||null),W.setFieldValue("branch",(null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.branchName)||null),W.setFieldValue("serviceDuration",(null==e?void 0:null===(s=e.record)||void 0===s?void 0:s.serviceDuration)||null),W.setFieldValue("netSalary",(null==e?void 0:null===(d=e.record)||void 0===d?void 0:d.salary)||0)})}else W.setFieldValue("hireDate",null),W.setFieldValue("department",null),W.setFieldValue("position",null),W.setFieldValue("branch",null),W.setFieldValue("serviceDuration",null),W.setFieldValue("netSalary",null)}let $=!!W.values.recordId,Y=2===W.values.wip;async function z(){var e,a;let{hireDate:t,department:n,position:l,branch:s,serviceDuration:d,netSalary:o,...i}=null==W?void 0:W.values;await E({extension:R.y.ResignationRequest.reopen,record:JSON.stringify({...i,date:(0,r.OZ)(new Date(null==W?void 0:null===(e=W.values)||void 0===e?void 0:e.date)),effectiveDate:(0,r.OZ)(new Date(null==W?void 0:null===(a=W.values)||void 0===a?void 0:a.effectiveDate))})}).then(()=>{var e;u.ZP.success(_.Reopened),Q(),G(null==W?void 0:null===(e=W.values)||void 0===e?void 0:e.recordId)})}let K=[{key:"Close",condition:!Y,onClick:async function(){var e,a;let{hireDate:t,department:n,position:l,branch:s,serviceDuration:d,netSalary:o,...i}=null==W?void 0:W.values;await E({extension:R.y.ResignationRequest.close,record:JSON.stringify({...i,date:(0,r.OZ)(new Date(null==W?void 0:null===(e=W.values)||void 0===e?void 0:e.date)),effectiveDate:(0,r.OZ)(new Date(null==W?void 0:null===(a=W.values)||void 0===a?void 0:a.effectiveDate))})}).then(()=>{var e;u.ZP.success(_.Closed),Q(),G(null==W?void 0:null===(e=W.values)||void 0===e?void 0:e.recordId)})},disabled:Y||!$},{key:"Reopen",condition:Y,onClick:async function(){var e,a;(null==W?void 0:null===(e=W.values)||void 0===e?void 0:e.releaseStatus)?await M({extension:q.y.ReleaseIndicator.get,parameters:"_recordId=".concat(null==W?void 0:null===(a=W.value)||void 0===a?void 0:a.releaseStatus)}).then(e=>{var a;(null==e?void 0:null===(a=e.record)||void 0===a?void 0:a.isReleased)?J({message:B.documentReleasedError}):z()}):z()},disabled:!Y||!$},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!Y}];return(0,d.useEffect)(()=>{V&&G(V)},[]),(0,n.jsx)(i.Z,{resourceId:v.i.ResignationRequest,functionId:f.J.ResignationRequest,form:W,maxAccess:H,actions:K,editMode:$,isClosed:Y,disabledSubmit:Y,children:(0,n.jsx)(g.R,{children:(0,n.jsx)(x.Q,{children:(0,n.jsxs)(s.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(s.ZP,{item:!0,xs:6,children:(0,n.jsx)(p.Z,{name:"reference",label:B.reference,value:null==W?void 0:null===(a=W.values)||void 0===a?void 0:a.reference,maxAccess:H,readOnly:!$||Y,onChange:W.handleChange,onClear:()=>W.setFieldValue("reference",""),error:W.touched.reference&&!!W.errors.reference})}),(0,n.jsx)(s.ZP,{item:!0,xs:6,children:(0,n.jsx)(l.Z,{name:"effectiveDate",required:!0,label:B.effectiveDate,value:null==W?void 0:null===(t=W.values)||void 0===t?void 0:t.effectiveDate,onChange:W.setFieldValue,readOnly:Y,maxAccess:H,onClear:()=>W.setFieldValue("effectiveDate",null),error:W.touched.effectiveDate&&!!W.errors.effectiveDate})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.U,{endpointId:R.y.Employee.snapshot,parameters:{_branchId:0},required:!0,form:W,filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeRef",readOnly:Y,label:B.employee,secondFieldLabel:B.name,secondDisplayField:!0,secondValue:W.values.employeeName,onChange:(e,a)=>{W.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null),W.setFieldValue("employeeRef",(null==a?void 0:a.reference)||null),W.setFieldValue("employeeName",(null==a?void 0:a.fullName)||null),U(null==a?void 0:a.recordId)},error:W.touched.employeeId&&!!W.errors.employeeId})}),(0,n.jsx)(s.ZP,{item:!0,xs:6,children:(0,n.jsx)(l.Z,{name:"date",required:!0,readOnly:Y,label:B.date,value:null==W?void 0:null===(F=W.values)||void 0===F?void 0:F.date,onChange:W.setFieldValue,maxAccess:H,onClear:()=>W.setFieldValue("date",null),error:W.touched.date&&!!W.errors.date})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsxs)(S.Z,{title:B.jobInfo,children:[(0,n.jsx)(s.ZP,{item:!0,xs:6,children:(0,n.jsxs)(s.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(p.Z,{name:"department",label:B.department,value:null==W?void 0:null===(j=W.values)||void 0===j?void 0:j.department,maxAccess:H,readOnly:!0})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(p.Z,{name:"position",label:B.position,value:null==W?void 0:null===(k=W.values)||void 0===k?void 0:k.position,maxAccess:H,readOnly:!0})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(p.Z,{name:"branch",label:B.branch,value:null==W?void 0:null===(T=W.values)||void 0===T?void 0:T.branch,maxAccess:H,readOnly:!0})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(l.Z,{name:"hireDate",label:B.hireDate,value:null==W?void 0:null===(O=W.values)||void 0===O?void 0:O.hireDate,readOnly:!0,maxAccess:H})})]})}),(0,n.jsx)(s.ZP,{item:!0,xs:6,children:(0,n.jsxs)(s.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(p.Z,{name:"serviceDuration",label:B.YIS,value:null==W?void 0:null===(N=W.values)||void 0===N?void 0:N.serviceDuration,maxAccess:H,readOnly:!0})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"netSalary",label:B.netSalary,value:null==W?void 0:null===(A=W.values)||void 0===A?void 0:A.netSalary,maxAccess:H,readOnly:!0})})]})})]})}),(0,n.jsx)(s.ZP,{item:!0,xs:6,children:(0,n.jsx)(h.Z,{endpointId:R.y.TerminationReasons.qry,name:"reasonId",label:B.reason,valueField:"recordId",required:!0,displayField:"name",readOnly:Y,values:W.values,onChange:(e,a)=>{W.setFieldValue("reasonId",(null==a?void 0:a.recordId)||null)},error:W.touched.reasonId&&!!W.errors.reasonId,maxAccess:H})}),(0,n.jsx)(s.ZP,{item:!0,xs:7,children:(0,n.jsx)(y.Z,{name:"explanation",label:B.explanation,value:W.values.explanation,rows:3,readOnly:Y,maxAccess:H,onChange:e=>W.setFieldValue("explanation",e.target.value),onClear:()=>W.setFieldValue("explanation",""),error:W.touched.explanation&&!!W.errors.explanation})})]})})})})}F.width=850,F.height=630},58583:function(e,a,t){"use strict";t.d(a,{Z:function(){return F}});var n=t(52322),l=t(60218),r=t(2784),s=t(48601),d=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(31389),p=t(80983),y=t(8661),h=t(89330),f=t(39812),I=t(7121),x=t(98345),g=t(19473),C=t(21581),D=t(27423),b=t(92407),R=t(6035),S=t(28298),q=t(28879),w=t.n(q),P=t(21326),Z=t(50023);function F(e){var a,t,q,F,j;let{recordId:k,window:T}=e,{platformLabels:O}=(0,r.useContext)(g.l),{getRequest:N,postRequest:A}=(0,r.useContext)(i.$),{labels:V,access:L}=(0,Z.Z)({datasetId:c.i.ShiftLeave,editMode:!!k});(0,P.Z)({title:V.duringShiftLeave,window:T});let{maxAccess:M}=(0,x.H)({functionId:I.J.DuringShiftLeave,access:L,enabled:!k}),E=(0,u.E)({endpointId:R.f.ShitLeave.page}),{formik:_}=(0,p.c)({initialValues:{recordId:null,employeeId:null,employeeRef:"",employeeName:"",reference:"",date:new Date,leaveDate:null,reasonId:null,fromTime:null,toTime:null,realDuration:null,destination:null,notes:"",status:1,wip:1,departmentRef:"",departmentName:"",reportToRef:"",reportToName:"",departmentHeadName:"",departmentHeadRef:"",position:"",schedule:""},maxAccess:M,validateOnChange:!0,validationSchema:s.Ry({employeeId:s.Rx().required(),reasonId:s.Rx().required(),duration:s.Z_().required(),destination:s.Z_().required(),leaveDate:s.hT().required(),fromTime:s.Z_().required(),toTime:s.Z_().required()}),onSubmit:async e=>{let{date:a,leaveDate:t,fromTime:n,toTime:l,returnTime:r,statusName:s,rsName:d,wipName:i,employeeRef:u,employeeName:c,departmentRef:m,departmentName:v,reportToRef:p,reportToName:y,departmentHeadName:h,departmentHeadRef:I,position:x,schedule:g,...C}=e,D=await A({extension:R.f.ShitLeave.set,record:JSON.stringify({...C,date:(0,f.ku)(a),leaveDate:(0,f.ku)(t),fromTime:w()(n).format("HH:mm"),toTime:w()(l).format("HH:mm"),returnTime:w()(r).format("HH:mm")})});o.ZP.success(e.recordId?O.Edited:O.Added),ec(D.recordId),E()}}),J=!!(null===(a=_.values)||void 0===a?void 0:a.recordId),B=(null==_?void 0:null===(t=_.values)||void 0===t?void 0:t.wip)===2,{date:H,leaveDate:Q,fromTime:W,toTime:G,returnTime:U,statusName:$,rsName:Y,wipName:z,employeeRef:K,employeeName:X,departmentRef:ee,departmentName:ea,reportToRef:et,reportToName:en,departmentHeadName:el,departmentHeadRef:er,position:es,schedule:ed,...eo}=_.values,ei=async()=>{await A({extension:R.f.ShitLeave.close,record:JSON.stringify({...eo,date:(0,f.ku)(H),leaveDate:(0,f.ku)(Q),fromTime:w()(W).format("HH:mm"),toTime:w()(G).format("HH:mm"),returnTime:w()(U).format("HH:mm")})}),o.ZP.success(O.Closed),ec(_.values.recordId),E()},eu=async()=>{await A({extension:R.f.ShitLeave.reopen,record:JSON.stringify({...eo,date:(0,f.ku)(H),leaveDate:(0,f.ku)(Q),fromTime:w()(W).format("HH:mm"),toTime:w()(G).format("HH:mm"),returnTime:w()(U).format("HH:mm")})}),o.ZP.success(O.Reopened),ec(_.values.recordId),E()};async function ec(e){var a;let{record:t}=await N({extension:R.f.ShitLeave.get,parameters:"_recordId=".concat(e)});return _.setValues({...t,date:(0,f.a1)(t.date),leaveDate:(0,f.a1)(t.leaveDate),fromTime:w()(t.fromTime,"HH:mm"),toTime:w()(t.toTime,"HH:mm"),returnTime:(null==t?void 0:null===(a=t.returnTime)||void 0===a?void 0:a.trim())?w()(null==t?void 0:t.returnTime,"HH:mm"):null}),ey(t.employeeId),t}(0,r.useEffect)(()=>{k&&ec(k)},[]);let em=[{key:"Close",condition:!B,onClick:ei,disabled:B||!J},{key:"Reopen",condition:B,onClick:eu,disabled:!B},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!B}],ev=e=>{let a=new Date(e),t=a.getFullYear(),n=String(a.getMonth()+1).padStart(2,"0"),l=String(a.getDate()).padStart(2,"0");return"".concat(t).concat(n).concat(l)};(0,r.useEffect)(()=>{!async function(){if(_.values.leaveDate&&_.values.employeeId){let{list:e}=await N({extension:R.f.FlatSchedule.qry,parameters:"_params=1|"+_.values.employeeId+"^2|"+ev(_.values.leaveDate)+"^3|"+ev(_.values.leaveDate)}),a=null==e?void 0:e.map(e=>{let a=w()((0,f.a1)(e.dtFrom)).format("HH:mm"),t=w()((0,f.a1)(e.dtTo)).format("HH:mm");return"[".concat(a,"..").concat(t,"]")}).join(" ");_.setFieldValue("schedule",a)}}()},[_.values.employeeId,_.values.leaveDate]),(0,r.useEffect)(()=>{let e=ep(w()(_.values.fromTime).format("HH:mm"),w()(_.values.toTime).format("HH:mm"));_.setFieldValue("duration",e||0)},[_.values.fromTime,_.values.toTime]),(0,r.useEffect)(()=>{if(_.values.returnTime){let e=ep(w()(_.values.fromTime).format("HH:mm"),w()(_.values.returnTime).format("HH:mm"));_.setFieldValue("realDuration",e||0)}else _.setFieldValue("realDuration",null)},[_.values.fromTime,_.values.returnTime]);let ep=(e,a)=>{if(!e||!a||"Invalid Date"===a||"Invalid Date"===e)return;let[t,n]=e.split(":").map(Number),[l,r]=a.split(":").map(Number),s=new Date(0,0,0,t,n),d=(new Date(0,0,0,l,r)-s)/6e4;return d<0&&(d+=1440),Number((d/60).toFixed(2))};async function ey(e){if(e){let{record:a}=await N({extension:b.y.QuickView.get,parameters:"_recordId=".concat(e,"&_asOfDate=").concat((0,f.Uf)(_.values.date))});_.setFieldValue("departmentRef",null==a?void 0:a.departmentRef),_.setFieldValue("departmentName",null==a?void 0:a.departmentName),_.setFieldValue("departmentHeadRef",null==a?void 0:a.departmentHeadRef),_.setFieldValue("departmentHeadName",null==a?void 0:a.departmentHeadName),_.setFieldValue("reportToRef",null==a?void 0:a.reportToRef),_.setFieldValue("reportToName",null==a?void 0:a.reportToName),_.setFieldValue("position","".concat((null==a?void 0:a.positionName)||"").concat((null==a?void 0:a.positionRef)?" ".concat(a.positionRef):""))}}return(0,n.jsx)(d.Z,{form:_,resourceId:c.i.ShiftLeave,functionId:I.J.DuringShiftLeave,maxAccess:M,editMode:J,previewReport:J,actions:em,disabledSubmit:B,children:(0,n.jsx)(v.R,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:8,children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(m.Z,{name:"reference",label:V.ref,value:_.values.reference,maxAccess:M,maxLength:"30",readOnly:J,onChange:_.handleChange,onClear:()=>_.setFieldValue("reference",""),error:_.touched.reference&&!!_.errors.reference})}),(0,n.jsx)(l.ZP,{item:!0,xs:6}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(h.Z,{name:"date",label:V.date,value:_.values.date,onChange:_.setFieldValue,maxAccess:L,readOnly:!0,onClear:()=>_.setFieldValue("date",""),error:_.touched.date&&!!_.errors.date})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.U,{endpointId:b.y.Employee.snapshot,parameters:{_branchId:0},filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,readOnly:B,label:V.employee,secondFieldLabel:V.employee,form:_,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:M,onChange:async(e,a)=>{await ey(null==a?void 0:a.recordId),_.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),_.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),_.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.U,{name:"department",readOnly:!0,label:V.department,secondFieldLabel:V.department,form:_,valueShow:"departmentRef",secondValueShow:"departmentName",maxAccess:M})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.U,{name:"reportTo",readOnly:!0,label:V.reportTo,secondFieldLabel:V.reportTo,form:_,valueShow:"reportToRef",secondValueShow:"reportToName",maxAccess:M})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.U,{name:"depManager",readOnly:!0,label:V.depManager,secondFieldLabel:V.depManager,form:_,valueShow:"departmentHeadRef",secondValueShow:"departmentHeadName",maxAccess:M})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(m.Z,{name:"position",label:V.empPosition,value:_.values.position,readOnly:!0,maxAccess:M})}),(0,n.jsx)(l.ZP,{item:!0,xs:6}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(m.Z,{name:"schedule",label:V.schedule,value:_.values.schedule,readOnly:!0,maxAccess:M})})]})}),(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{name:"leaveDate",label:V.dateOfLeave,value:null===(q=_.values)||void 0===q?void 0:q.leaveDate,required:!0,readOnly:B,onBlur:(e,a)=>{_.setFieldValue("leaveDate",a||null)},onAccept:e=>{_.setFieldValue("leaveDate",e||null)},onClear:()=>_.setFieldValue("leaveDate",null),error:_.touched.leaveDate&&!!_.errors.leaveDate,maxAccess:M})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{label:V.from,name:"fromTime",required:!0,use24Hour:!0,readOnly:B,value:_.values.fromTime,onChange:_.setFieldValue,onClear:()=>_.setFieldValue("fromTime",""),maxAccess:M,error:_.touched.fromTime&&!!_.errors.fromTime})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{label:V.to,name:"toTime",readOnly:B,use24Hour:!0,required:!0,value:_.values.toTime,onChange:_.setFieldValue,onClear:()=>_.setFieldValue("toTime",""),maxAccess:M,error:_.touched.toTime&&!!_.errors.toTime})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Z,{name:"duration",label:V.leaveDuration,value:_.values.duration,readOnly:!0,required:!0,maxAccess:M,error:_.touched.duration&&!!_.errors.duration})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(y.Z,{endpointId:R.f.DSLReason.qry,name:"reasonId",label:V.dsltype,valueField:"recordId",displayField:"name",required:!0,values:_.values,onChange:(e,a)=>{_.setFieldValue("reasonId",(null==a?void 0:a.recordId)||null)},readOnly:B,maxAccess:M,error:(null==_?void 0:null===(F=_.touched)||void 0===F?void 0:F.reasonId)&&!!(null==_?void 0:null===(j=_.errors)||void 0===j?void 0:j.reasonId)})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{label:V.returnTime,name:"returnTime",use24Hour:!0,readOnly:B,value:_.values.returnTime,onChange:_.setFieldValue,onClear:()=>_.setFieldValue("returnTime",""),maxAccess:M,error:_.touched.returnTime&&!!_.errors.returnTime})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Z,{name:"realDuration",label:V.duration,value:_.values.realDuration,readOnly:!0,maxAccess:M})})]})}),(0,n.jsx)(l.ZP,{item:!0,xs:8,children:(0,n.jsx)(m.Z,{name:"destination",label:V.destination,value:_.values.destination,onChange:_.handleChange,required:!0,maxLength:100,readOnly:B,maxAccess:M,onClear:()=>_.setFieldValue("destination",""),error:_.touched.destination&&!!_.errors.destination})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"notes",label:V.notes,value:_.values.notes,rows:2,readOnly:B,maxAccess:M,onChange:_.handleChange,onClear:()=>_.setFieldValue("notes",""),error:_.touched.notes&&!!_.errors.notes})})]})})})}F.width=1e3,F.height=500},86557:function(e,a,t){"use strict";t.d(a,{Z:function(){return O}});var n=t(52322),l=t(60218),r=t(5088),s=t(8661),d=t(82737),o=t(26612),i=t(65950),u=t(2784),c=t(48601),m=t(62202),v=t(71987),p=t(80983),y=t(19473),h=t(21581),f=t(6035),I=t(50023),x=t(21326),g=t(62362),C=t(31389),D=t(27423),b=t(92407),R=t(89330),S=t(84100),q=t(91406),w=t(39812),P=t(28879),Z=t.n(P),F=t(10264),j=t.n(F),k=t(3191),T=t(7121);function O(e){var a,t,P,F,O,N;let{recordId:A,window:V}=e,{getRequest:L,postRequest:M}=(0,u.useContext)(i.$),{platformLabels:E}=(0,u.useContext)(y.l),_=(0,u.useRef)([]);Z().extend(j());let{labels:J,access:B}=(0,I.Z)({datasetId:o.i.TimeVariation,editMode:!!A});(0,x.Z)({title:null==J?void 0:J.timeVariation,window:V});let H=(0,v.E)({endpointId:f.f.TimeVariation.page}),{formik:Q}=(0,p.c)({maxAccess:B,initialValues:{recordId:A,reference:"",date:new Date,employeeId:null,dataSource:2,timeCode:20,clockDuration:X(0),duration:0,damageLevel:null,justification:"",releaseStatus:null,wip:1,status:1},validationSchema:c.Ry({employeeId:c.Rx().required(),date:c.hT().required(),timeCode:c.Rx().required(),damageLevel:c.Rx().required()}),onSubmit:async e=>{await M({extension:f.f.TimeVariation.gen,record:JSON.stringify({...e,clockDuration:0,date:(0,w.ku)(e.date)})}),m.ZP.success(e.recordId?E.Edited:E.Added),H(),V.close()}}),W=!!Q.values.recordId,G=2==Q.values.wip,U=-1==Q.values.status,$=[{key:"Approval",condition:!0,onClick:"onApproval",disabled:!G},{key:"Close",condition:!G,onClick:"onCloseConfirmation",action:Y,disabled:U||G||!W},{key:"Reopen",condition:G,onClick:"onOpenConfirmation",action:z,disabled:U||!G||!W},{key:"Cancel",condition:!0,onClick:K,disabled:!W||G||U}];async function Y(){var e;let a=await M({extension:f.f.TimeVariation.close,record:JSON.stringify({...Q.values,date:(0,w.ku)(null===(e=Q.values)||void 0===e?void 0:e.date),clockDuration:0})});m.ZP.success(E.Closed),H(),er(a.recordId)}async function z(){var e;let a=await M({extension:f.f.TimeVariation.reopen,record:JSON.stringify({...Q.values,date:(0,w.ku)(null===(e=Q.values)||void 0===e?void 0:e.date),clockDuration:0})});m.ZP.success(E.Reopened),H(),er(a.recordId)}async function K(){var e;let a=await M({extension:f.f.TimeVariation.cancel,record:JSON.stringify({...Q.values,date:(0,w.ku)(null===(e=Q.values)||void 0===e?void 0:e.date),clockDuration:0})});m.ZP.success(E.Cancelled),H(),er(a.recordId)}function X(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0==e)return"00:00";let a=Math.abs(e),t=String(Math.floor(a/60)).padStart(2,"0"),n=String(a%60).padStart(2,"0");return(e<0?"-":"")+"".concat(t,":").concat(n)}async function ee(e,a){let{list:t}=await L({extension:f.f.FlatSchedule.qry,parameters:"_params=1|"+e+"^2|"+Z()(a).format("YYYYMMDD")+"^3|"+Z()(a).format("YYYYMMDD")}),n=null==t?void 0:t.map(e=>{let a=Z().utc((0,w.a1)(e.dtFrom)).format("hh:mm A"),t=Z().utc((0,w.a1)(e.dtTo)).format("hh:mm A");return{...e,dtRange:"".concat(a," - ").concat(t)}});return _.current=n||[],n||[]}async function ea(e,a,t){if(!e){en();return}let n=await ee(e,a);if(!(null==n?void 0:n.length)){en();return}let{recordId:l,duration:r}=n[0];20!=t&&(Q.setFieldValue("shiftId",l),Q.setFieldValue("duration",r),Q.setFieldValue("clockDuration",X(r)))}async function et(e){var a;if(!e){Q.setFieldValue("terminationDate",null);return}let t=await L({extension:b.y.QuickView.get,parameters:"_recordId=".concat(e,"&_asOfDate=").concat((0,w.uQ)(new Date))});Q.setFieldValue("terminationDate",(null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.terminationDate)||null)}function en(){Q.setFieldValue("shiftId",null),Q.setFieldValue("duration",0),Q.setFieldValue("clockDuration",X(0))}async function el(e){if(e)return await L({extension:f.f.TimeVariation.get,parameters:"_recordId=".concat(e)})}async function er(e){var a,t;let n=await el(e);Q.setValues({...n.record,date:(0,w.a1)(null==n?void 0:null===(a=n.record)||void 0===a?void 0:a.date),clockDuration:X(null==n?void 0:null===(t=n.record)||void 0===t?void 0:t.duration)})}return(0,u.useEffect)(()=>{!async function(){if(A){var e,a,t,n;let l=await el(A);await ee(null==l?void 0:null===(e=l.record)||void 0===e?void 0:e.employeeId,(0,w.a1)(null==l?void 0:null===(a=l.record)||void 0===a?void 0:a.date)),Q.setValues({...l.record,date:(0,w.a1)(null==l?void 0:null===(t=l.record)||void 0===t?void 0:t.date),clockDuration:X(null==l?void 0:null===(n=l.record)||void 0===n?void 0:n.duration)})}}()},[]),(0,n.jsx)(d.Z,{form:Q,resourceId:o.i.TimeVariation,maxAccess:B,editMode:W,actions:$,isCleared:!1,functionId:T.J.TimeVariation,disabledSubmit:U||G,children:(0,n.jsx)(C.R,{children:(0,n.jsx)(g.Q,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(r.Z,{name:"reference",label:null==J?void 0:J.reference,value:null===(a=Q.values)||void 0===a?void 0:a.reference,readOnly:!0,maxAccess:B,onChange:Q.handleChange,onClear:()=>Q.setFieldValue("reference",""),error:Q.touched.reference&&!!Q.errors.reference})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.U,{endpointId:b.y.Employee.snapshot,parameters:{_branchId:0},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,readOnly:U||G,label:J.employee,form:Q,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:B,onChange:async(e,a)=>{await ea(null==a?void 0:a.recordId,Q.values.date,Q.values.timeCode),await et(null==a?void 0:a.recordId),Q.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),Q.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),Q.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(R.Z,{name:"date",required:!0,label:J.date,value:null===(t=Q.values)||void 0===t?void 0:t.date,onChange:async(e,a)=>{var t,n;await ea(null===(t=Q.values)||void 0===t?void 0:t.employeeId,a,null===(n=Q.values)||void 0===n?void 0:n.timeCode),Q.setFieldValue("date",a)},onClear:()=>{en(),Q.setFieldValue("date",null)},error:Q.touched.date&&!!Q.errors.date,maxAccess:B,readOnly:U||G})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(s.Z,{datasetId:S.v.TIME_CODE,name:"timeCode",readOnly:U||W,label:J.timeCode,valueField:"key",displayField:"value",required:!0,values:Q.values,maxAccess:B,onChange:async(e,a)=>{var t,n;a&&(null==a?void 0:a.key)!=20||en(),await ea(null===(t=Q.values)||void 0===t?void 0:t.employeeId,null===(n=Q.values)||void 0===n?void 0:n.date,null==a?void 0:a.key),Q.setFieldValue("timeCode",(null==a?void 0:a.key)||null)},error:Q.touched.timeCode&&!!Q.errors.timeCode})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(k.Z,{name:"shiftId",label:J.shift,valueField:"recordId",displayField:"dtRange",store:null==_?void 0:_.current,value:Q.values.shiftId,readOnly:U||G||(null===(P=Q.values)||void 0===P?void 0:P.timeCode)==20,onChange:(e,a)=>Q.setFieldValue("shiftId",(null==a?void 0:a.recordId)||null),error:Q.touched.shiftId&&!!Q.errors.shiftId,maxAccess:B})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(r.Z,{name:"clockDuration",label:null==J?void 0:J.clockDuration,value:null===(F=Q.values)||void 0===F?void 0:F.clockDuration,readOnly:!0,onChange:Q.handleChange,onClear:()=>Q.setFieldValue("clockDuration",X(0)),error:Q.touched.clockDuration&&!!Q.errors.clockDuration,maxAccess:B})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(q.Z,{name:"duration",label:J.duration,value:Q.values.duration,maxAccess:B,readOnly:U||G||(null===(O=Q.values)||void 0===O?void 0:O.timeCode)==20||(null===(N=Q.values)||void 0===N?void 0:N.timeCode)==21,min:20==Q.values.timeCode||21==Q.values.timeCode?0:1,onChange:Q.handleChange,onClear:()=>Q.setFieldValue("duration",null),error:Q.touched.duration&&!!Q.errors.duration})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(s.Z,{name:"damageLevel",label:J.damage,datasetId:S.v.DAMAGE_LEVEL,values:Q.values,valueField:"key",displayField:"value",required:!0,readOnly:U||G,maxAccess:B,onChange:(e,a)=>Q.setFieldValue("damageLevel",(null==a?void 0:a.key)||null),error:Q.touched.damageLevel&&!!Q.errors.damageLevel})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{name:"justification",label:J.justification,value:Q.values.justification,rows:2,readOnly:U||G,maxAccess:B,onChange:Q.handleChange,onClear:()=>Q.setFieldValue("justification",""),error:Q.touched.justification&&!!Q.errors.justification})})]})})})})}O.width=550,O.height=550},84622:function(e,a,t){"use strict";t.d(a,{Z:function(){return N}});var n=t(52322),l=t(60218),r=t(2784),s=t(48601),d=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(31389),p=t(62362),y=t(80983),h=t(38449),f=t(8661),I=t(89330),x=t(39812),g=t(91406),C=t(7121),D=t(98345),b=t(19473),R=t(65215),S=t(76399),q=t(90587),w=t(33625),P=t(21581),Z=t(27423),F=t(96026),j=t(61802),k=t(9657),T=t(21326),O=t(50023);function N(e){var a,t,N,A,V,L,M,E,_,J,B,H,Q,W,G,U,$,Y,z,K,X,ee,ea,et,en,el,er,es;let{recordId:ed,window:eo}=e,{stack:ei}=(0,j.zY)(),{platformLabels:eu}=(0,r.useContext)(b.l),{getRequest:ec,postRequest:em}=(0,r.useContext)(i.$),ev=(0,r.useRef)([]),{stack:ep}=(0,F.V)(),[ey,eh]=(0,r.useState)([]),[ef,eI]=(0,r.useState)(!1),{labels:ex,access:eg}=(0,O.Z)({datasetId:c.i.WorkCenterConsumptions,editMode:!!ed});(0,T.Z)({title:ex.workCenterConsumption,window:eo});let{documentType:eC,maxAccess:eD,changeDT:eb}=(0,D.H)({functionId:C.J.WorkCenterConsumption,access:eg,enabled:!ed,objectName:"header"}),eR=(0,u.E)({endpointId:q.u.WorkCenterConsumption.page});function eS(e){return("qty"===e?s.Rx().nullable().max(999999999.999," "):s.nK()).test(function(e){let{sku:a,qty:t,itemName:n}=this.parent;return!a&&!t&&!n||!!e})}let eq=s.Ry({itemName:eS("itemName"),sku:eS("sku"),qty:eS("qty")}),{formik:ew}=(0,y.c)({documentType:{key:"header.dtId",value:null==eC?void 0:eC.dtId,reference:null==eC?void 0:eC.reference},initialValues:{recordId:ed,header:{recordId:null,reference:"",dtId:null,date:new Date,plantId:null,siteId:null,workCenterId:null,WcRef:"",WcName:"",weight:0,totalQty:0,description:"",status:1,wip:1},items:[{id:1,seqNo:1,itemId:null,consumptionId:ed,qty:0,unitCost:0,muId:null,msId:null,itemName:"",totalCost:0,baseQty:null}]},maxAccess:eD,validateOnChange:!0,validationSchema:s.Ry({header:s.Ry({date:s.hT().required(),workCenterId:s.Rx().required()}),items:s.IX().of(eq)}),onSubmit:async e=>{var a;let{items:t,header:n}=e,l=null==t?void 0:null===(a=t.filter(e=>e.sku))||void 0===a?void 0:a.map((a,t)=>({...a,seqNo:t+1,consumptionId:e.recordId||0})),r=await em({extension:q.u.WorkCenterConsumption.set2,record:JSON.stringify({header:n,items:l})}),s=e.recordId?eu.Edited:eu.Added;o.ZP.success(s),e_(r.recordId),eR()}}),eP=!!(null===(a=ew.values)||void 0===a?void 0:a.recordId),eZ=(null==ew?void 0:null===(N=ew.values)||void 0===N?void 0:null===(t=N.header)||void 0===t?void 0:t.status)===3,eF=(null==ew?void 0:null===(V=ew.values)||void 0===V?void 0:null===(A=V.header)||void 0===A?void 0:A.wip)===2,ej=ew.values.items.reduce((e,a)=>e+(Number(null==a?void 0:a.totalCost)||0),0),ek=ef?ew.values.items.reduce((e,a)=>e+(Number(null==a?void 0:a.qty)||0),0):(null===(L=ew.values)||void 0===L?void 0:L.header.totalQty)||0,eT=async()=>await ec({extension:R.$.MeasurementUnit.qry,parameters:"_msId=0"});async function eO(e,a){if(!e)return;let t=(null==ey?void 0:ey.filter(e=>e.msId==a))||[];ev.current=t}let eN=async e=>{if(!e)return;let a=await ec({extension:q.u.WorkCenterConsumption.get,parameters:"_recordId=".concat(e)});return{...null==a?void 0:a.record,date:(0,x.a1)(null==a?void 0:a.record.date)}},eA=async e=>{var a;if(!e)return;let t=await ec({extension:q.u.ConsumptionItemView.qry,parameters:"_consumptionId=".concat(e)});return(null==t?void 0:null===(a=t.list)||void 0===a?void 0:a.length)>0?t.list.map((e,a)=>({...e,id:a+1,seqNo:a+1})):ew.values.items},eV=async()=>{await em({extension:q.u.WorkCenterConsumption.post,record:JSON.stringify(ew.values.header)}),o.ZP.success(eu.Posted),eR(),eo.close()},eL=async()=>{await em({extension:q.u.WorkCenterConsumption.unpost,record:JSON.stringify(ew.values.header)}),e_(ew.values.recordId),o.ZP.success(eu.Unposted),eR()},eM=async()=>{await em({extension:q.u.WorkCenterConsumption.close,record:JSON.stringify(ew.values.header)}),o.ZP.success(eu.Closed),e_(ew.values.recordId),eR()},eE=async()=>{await em({extension:q.u.WorkCenterConsumption.reopen,record:JSON.stringify(ew.values.header)}),o.ZP.success(eu.Reopened),e_(ew.values.recordId),eR()};async function e_(e){let a=await eN(e),t=await eA(e);ew.setValues({...ew.values,recordId:a.recordId,header:{...ew.values.header,...a},items:t})}let eJ=async e=>{var a;let t=await ec({extension:R.$.CurrentCost.get,parameters:"_itemId=".concat(e)});return null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.currentCost},eB=[{component:"resourcelookup",label:ex.sku,name:"sku",props:{endpointId:R.$.Item.snapshot,valueField:"sku",displayField:"sku",mandatory:!0,readOnly:eF,displayFieldWidth:3,mapping:[{from:"recordId",to:"itemId"},{from:"msId",to:"msId"},{from:"sku",to:"sku"},{from:"name",to:"itemName"}],columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"}]},async onChange(e){let{row:{update:a,newRow:t}}=e;if(!(null==t?void 0:t.itemId)){ev.current=[],a({muRef:null,muId:null,baseQty:0,muQty:0,qty:0,totalCost:0});return}if(t.isInactive){a({...ew.initialValues.items[0],id:t.id}),ep({message:ex.inactiveItem});return}if(null==t?void 0:t.itemId){var n,l,r,s,d,o,i,u;eO(null==t?void 0:t.itemId,t.msId),a({unitCost:((null==t?void 0:t.itemId)?await eJ(null==t?void 0:t.itemId):0)||0,muRef:(null==ev?void 0:null===(l=ev.current)||void 0===l?void 0:null===(n=l[0])||void 0===n?void 0:n.reference)||null,muId:(null==ev?void 0:null===(s=ev.current)||void 0===s?void 0:null===(r=s[0])||void 0===r?void 0:r.recordId)||null,muQty:(null==ev?void 0:null===(o=ev.current)||void 0===o?void 0:null===(d=o[0])||void 0===d?void 0:d.qty)||0,baseQty:(null==ev?void 0:null===(u=ev.current)||void 0===u?void 0:null===(i=u[0])||void 0===i?void 0:i.qty)||(null==t?void 0:t.qty),qty:(null==t?void 0:t.qty)||0})}}},{component:"textfield",label:ex.itemName,name:"itemName",flex:2,props:{readOnly:!0}},{component:"resourcecombobox",label:ex.MU,name:"muRef",props:{store:null==ev?void 0:ev.current,displayField:"reference",valueField:"recordId",readOnly:eF,mapping:[{from:"reference",to:"muRef"},{from:"name",to:"muName"},{from:"qty",to:"muQty"},{from:"recordId",to:"muId"}]},async onChange(e){let{row:{update:a,newRow:t}}=e;eI(!0),t&&a(t.muId?{baseQty:(null==t?void 0:t.qty)?(null==t?void 0:t.qty)*(null==t?void 0:t.muQty):null==t?void 0:t.muQty}:{baseQty:0})},propsReducer(e){let{row:a,props:t}=e;return{...t,store:null==ev?void 0:ev.current}}},{component:"numberfield",name:"qty",label:ex.qty,async onChange(e){let{row:{update:a,newRow:t}}=e;eI(!0),a({totalCost:parseFloat((null==t?void 0:t.unitCost)*(null==t?void 0:t.qty)).toFixed(2),baseQty:(null==t?void 0:t.muQty)?(null==t?void 0:t.muQty)*(null==t?void 0:t.qty):null==t?void 0:t.qty})},props:{decimalScale:2,readOnly:eF}},{component:"numberfield",name:"unitCost",label:ex.unitCost,props:{decimalScale:2,readOnly:!0}},{component:"numberfield",name:"totalCost",label:ex.totalCost,props:{decimalScale:2,readOnly:!0}}];async function eH(){ei({Component:k.Z,props:{resourceId:c.i.WCConsumptionImport,access:eD,onSuccess:async e=>{var a;if(null==ew?void 0:null===(a=ew.values)||void 0===a?void 0:a.recordId){let e=await eN(null==ew?void 0:ew.values.recordId),a=await eA(null==ew?void 0:ew.values.recordId);ew.setValues({...ew.values,recordId:e.recordId,header:{...ew.values.header,...e},items:a}),eR()}}}})}let eQ=[{key:"Locked",condition:eZ,onClick:"onUnpostConfirmation",onSuccess:eL,disabled:!eF},{key:"Unlocked",condition:!eZ,onClick:eV,disabled:!eF},{key:"Close",condition:!eF,onClick:eM,disabled:eF||!eP},{key:"Reopen",condition:eF,onClick:eE,disabled:!eF||eZ},{key:"GL",condition:!0,onClick:"onClickGL",valuesPath:{...ew.values.header,notes:ew.values.header.description},datasetId:c.i.WorkCenterConsumptions,disabled:!eP},{key:"Import",condition:!0,onClick:eH,disabled:!eP||ew.values.items.some(e=>e.itemId)||eF}];return(0,r.useEffect)(()=>{ew.setFieldValue("header.totalQty",parseFloat(ek).toFixed(2)),ew.setFieldValue("header.totalCostField",parseFloat(ej).toFixed(2))},[ek,ej]),(0,r.useEffect)(()=>{!async function(){let e=await eT();eh(null==e?void 0:e.list),ed&&e_(ed)}()},[]),(0,n.jsx)(d.Z,{form:ew,resourceId:c.i.WorkCenterConsumptions,functionId:C.J.WorkCenterConsumption,maxAccess:eD,actions:eQ,editMode:eP,previewReport:eP,disabledSubmit:eF,children:(0,n.jsxs)(v.R,{children:[(0,n.jsx)(w.g,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,xs:12,children:[(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(f.Z,{endpointId:h.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(C.J.WorkCenterConsumption),name:"header.dtId",label:ex.docType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:eP,valueField:"recordId",displayField:["reference","name"],values:ew.values.header,maxAccess:eD,onChange:(e,a)=>{ew.setFieldValue("header.dtId",(null==a?void 0:a.recordId)||null),eb(a)},error:(null===(M=ew.touched.header)||void 0===M?void 0:M.dtId)&&!!(null===(E=ew.errors.header)||void 0===E?void 0:E.dtId)})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Z,{name:"header.reference",label:ex.reference,value:null==ew?void 0:null===(J=ew.values)||void 0===J?void 0:null===(_=J.header)||void 0===_?void 0:_.reference,maxAccess:!eP&&eD,readOnly:eP,onChange:ew.handleChange,onClear:()=>ew.setFieldValue("header.reference",""),error:(null===(B=ew.touched.header)||void 0===B?void 0:B.reference)&&!!(null===(H=ew.errors.header)||void 0===H?void 0:H.reference)})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{name:"header.date",required:!0,readOnly:eF,label:ex.date,value:null==ew?void 0:null===(W=ew.values)||void 0===W?void 0:null===(Q=W.header)||void 0===Q?void 0:Q.date,maxAccess:eD,onChange:ew.setFieldValue,onClear:()=>ew.setFieldValue("header.date",null),error:(null===(U=ew.touched)||void 0===U?void 0:null===(G=U.header)||void 0===G?void 0:G.date)&&!!(null===(Y=ew.errors)||void 0===Y?void 0:null===($=Y.header)||void 0===$?void 0:$.date)})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(f.Z,{endpointId:h.r.Plant.qry,name:"header.plantId",readOnly:eF,label:ex.plant,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:ew.values.header,maxAccess:eD,onChange:(e,a)=>{ew.setFieldValue("header.plantId",(null==a?void 0:a.recordId)||null)},error:(null===(z=ew.touched.header)||void 0===z?void 0:z.plantId)&&!!(null===(K=ew.errors.header)||void 0===K?void 0:K.plantId)})})]})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(Z.U,{endpointId:q.u.WorkCenter.snapshot,valueField:"reference",displayField:"name",name:"header.workCenterId",secondFieldLabel:ex.name,label:ex.workCenter,valueShow:"WcRef",secondValueShow:"WcName",maxAccess:eD,formObject:ew.values.header,form:ew,displayFieldWidth:2,required:!0,readOnly:eF,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"},{key:"siteName",value:"Site Name"}],onSecondValueChange:(e,a)=>{ew.setFieldValue("header.WcName",a)},onChange:(e,a)=>{ew.setFieldValue("header.WcRef",(null==a?void 0:a.isInactive)?"":null==a?void 0:a.reference),ew.setFieldValue("header.WcName",(null==a?void 0:a.isInactive)?"":null==a?void 0:a.name),ew.setFieldValue("header.siteId",(null==a?void 0:a.isInactive)?null:null==a?void 0:a.siteId),ew.setFieldValue("header.siteRef",(null==a?void 0:a.isInactive)?"":null==a?void 0:a.siteRef),ew.setFieldValue("header.siteName",(null==a?void 0:a.isInactive)?"":null==a?void 0:a.siteName),ew.setFieldValue("header.workCenterId",(null==a?void 0:a.isInactive)?null:null==a?void 0:a.recordId),(null==a?void 0:a.isInactive)&&ep({message:ex.inactiveWorkCenter})},error:(null===(X=ew.touched.header)||void 0===X?void 0:X.workCenterId)&&!!(null===(ee=ew.errors.header)||void 0===ee?void 0:ee.workCenterId)})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(m.Z,{name:"header.siteRef",label:ex.siteRef,value:null===(ea=ew.values.header)||void 0===ea?void 0:ea.siteRef,readOnly:!0})}),(0,n.jsx)(l.ZP,{item:!0,xs:6,children:(0,n.jsx)(m.Z,{name:"header.reference",label:ex.siteName,value:null===(et=ew.values.header)||void 0===et?void 0:et.siteName,readOnly:!0,maxAccess:eD,error:(null===(en=ew.touched.header)||void 0===en?void 0:en.siteName)&&!!(null===(el=ew.errors.header)||void 0===el?void 0:el.siteName)})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(P.Z,{name:"header.description",label:ex.description,value:ew.values.header.description,rows:2.5,readOnly:eF,maxAccess:eD,onChange:e=>ew.setFieldValue("header.description",e.target.value),onClear:()=>ew.setFieldValue("header.description",""),error:(null===(er=ew.touched.header)||void 0===er?void 0:er.description)&&!!(null===(es=ew.errors.header)||void 0===es?void 0:es.description)})})]})})]})}),(0,n.jsx)(p.Q,{children:(0,n.jsx)(S._,{onChange:(e,a)=>{ew.setFieldValue("items",e),"delete"===a&&eI(!0)},onSelectionChange:(e,a,t)=>{"muRef"==t&&eO(null==e?void 0:e.itemId,null==e?void 0:e.msId)},value:ew.values.items,error:ew.errors.items,allowDelete:!eF,name:"items",columns:eB,maxAccess:eD})}),(0,n.jsx)(w.g,{children:(0,n.jsx)(l.ZP,{container:!0,spacing:2,xs:12,children:(0,n.jsx)(l.ZP,{item:!0,xs:4,children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"totalQty",maxAccess:eD,label:ex.totalQty,value:ek,decimalScale:2,readOnly:!0})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"totalCost",maxAccess:eD,label:ex.totalCost,value:ej,decimalScale:2,readOnly:!0})})]})})})})]})})}N.width=1200,N.height=700},27603:function(e,a,t){"use strict";t.d(a,{Z:function(){return P}});var n=t(52322),l=t(60218),r=t(2784),s=t(48601),d=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(80983),p=t(62362),y=t(31389),h=t(19473),f=t(8661),I=t(92407),x=t(27423),g=t(70104),C=t(21581),D=t(89330),b=t(39812),R=t(98345),S=t(7121),q=t(21326),w=t(50023);function P(e){var a;let{recordId:t,window:P}=e,{getRequest:Z,postRequest:F}=(0,r.useContext)(i.$),{platformLabels:j}=(0,r.useContext)(h.l),{labels:k,access:T}=(0,w.Z)({datasetId:c.i.JobInfos,editMode:!!t});(0,q.Z)({title:k.jobInfo,window:P});let{maxAccess:O}=(0,R.H)({functionId:S.J.JobInfo,access:T,enabled:!t}),N=(0,u.E)({endpointId:I.y.JobInfo.page}),{formik:A}=(0,v.c)({initialValues:{recordId:null,reference:"",employeeId:null,employeeName:"",employeeRef:"",date:new Date,departmentId:null,branchId:null,divisionId:null,positionId:null,reportToId:null,reportToName:"",reportToRef:"",notes:"",status:1,wip:1},validateOnChange:!0,validationSchema:s.Ry({employeeId:s.Rx().required(),date:s.hT().max(new Date,"Date cannot be in the future").required(),departmentId:s.Rx().required(),branchId:s.Rx().required(),positionId:s.Rx().required()}),onSubmit:async e=>{await F({extension:I.y.JobInfo.set,record:JSON.stringify({...e,date:(0,b.ku)(e.date)})}),o.ZP.success(e.recordId?j.Edited:j.Added),P.close(),N()}}),V=!!A.values.recordId,L=2==A.values.wip;async function M(e){if(e){let a=await Z({extension:I.y.JobInfo.get,parameters:"_recordId=".concat(e)});A.setValues({...a.record,date:(0,b.a1)(a.record.date)})}}(0,r.useEffect)(()=>{M(t)},[]);let E=[{key:"Close",condition:!L,onClick:async()=>{await F({extension:I.y.JobInfo.close,record:JSON.stringify({...A.values,date:(0,b.ku)(A.values.date)})}),o.ZP.success(j.Closed),M(t),N()},disabled:L||!V},{key:"Reopen",condition:L,onClick:async()=>{await F({extension:I.y.JobInfo.reopen,record:JSON.stringify({...A.values,date:(0,b.ku)(A.values.date)})}),o.ZP.success(j.Reopened),M(t),N()},disabled:!L},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!L}];return(0,n.jsx)(d.Z,{resourceId:c.i.JobInfos,functionId:S.J.JobInfo,form:A,maxAccess:O,editMode:V,actions:E,disabledSubmit:L,children:(0,n.jsx)(y.R,{children:(0,n.jsx)(p.Q,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(m.Z,{name:"reference",label:k.ref,value:A.values.reference,maxAccess:O,readOnly:V,maxLength:"30",onChange:A.handleChange,onClear:()=>A.setFieldValue("reference",""),error:A.touched.reference&&!!A.errors.reference})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.U,{endpointId:I.y.Employee.snapshot,parameters:{_branchId:0},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,displayFieldWidth:2,readOnly:L,label:k.employee,secondFieldLabel:k.employee,form:A,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:O,onChange:(e,a)=>{A.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),A.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(D.Z,{name:"date",label:k.date,value:null===(a=A.values)||void 0===a?void 0:a.date,readOnly:L,required:!0,max:new Date,onChange:A.setFieldValue,onClear:()=>A.setFieldValue("date",null),error:A.touched.date&&!!A.errors.date,maxAccess:O})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(f.Z,{endpointId:g.K.DepartmentFilters.qry,parameters:"_filter=&_size=1000&_startAt=0&_type=0&_activeStatus=0&_sortBy=recordId",name:"departmentId",label:k.department,values:A.values,columnsInDropDown:[{key:"departmentRef",value:"Reference"},{key:"name",value:"Name"}],required:!0,readOnly:L,displayField:["departmentRef","name"],maxAccess:O,onChange:(e,a)=>{A.setFieldValue("departmentId",(null==a?void 0:a.recordId)||null)},error:A.touched.departmentId&&!!A.errors.departmentId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(f.Z,{endpointId:g.K.BranchFilters.qry,name:"branchId",label:k.branch,columnsInDropDown:[{key:"branchRef",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["branchRef","name"],values:A.values,maxAccess:O,onChange:(e,a)=>{A.setFieldValue("branchId",(null==a?void 0:a.recordId)||null)},required:!0,readOnly:L,error:A.touched.branchId&&!!A.errors.branchId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(f.Z,{endpointId:g.K.DivisionFilters.qry,name:"divisionId",label:k.division,valueField:"recordId",displayField:"name",maxAccess:O,readOnly:L,values:A.values,onChange:(e,a)=>{A.setFieldValue("divisionId",(null==a?void 0:a.recordId)||null)},error:A.touched.divisionId&&!!A.errors.divisionId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(f.Z,{endpointId:g.K.CompanyPositions.qry,parameters:"_filter=&_size=1000&_startAt=0&_sortBy=recordId",name:"positionId",label:k.position,required:!0,valueField:"recordId",displayField:["positionRef","name"],columnsInDropDown:[{key:"positionRef",value:"Reference"},{key:"name",value:"Name"}],maxAccess:O,readOnly:L,values:A.values,onChange:(e,a)=>{A.setFieldValue("positionId",(null==a?void 0:a.recordId)||null)},error:A.touched.positionId&&!!A.errors.positionId})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(x.U,{endpointId:I.y.Employee.snapshot,parameters:{_branchId:0},secondFieldLabel:k.reportsTo,valueField:"reference",displayField:"fullName",name:"reportToId",displayFieldWidth:2,label:k.reportsTo,form:A,readOnly:L,valueShow:"reportToRef",secondValueShow:"reportToName",maxAccess:O,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],onChange:(e,a)=>{A.setFieldValue("reportToName",(null==a?void 0:a.fullName)||""),A.setFieldValue("reportToId",(null==a?void 0:a.recordId)||null)},errorCheck:"reportToId"})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"notes",label:k.notes,value:A.values.notes,rows:2,readOnly:L,maxAccess:O,onChange:A.handleChange,onClear:()=>A.setFieldValue("notes",""),error:A.touched.notes&&!!A.errors.notes})})]})})})})}P.width=600,P.height=520},30032:function(e,a,t){"use strict";t.d(a,{Z:function(){return j}});var n=t(52322),l=t(89330),r=t(39812),s=t(60218),d=t(2784),o=t(48601),i=t(82737),u=t(62202),c=t(65950),m=t(71987),v=t(26612),p=t(5088),y=t(21581),h=t(8661),f=t(38449),I=t(7121),x=t(62362),g=t(31389),C=t(80983),D=t(19473),b=t(98345),R=t(61802),S=t(58912),q=t(76399),w=t(33625),P=t(39704),Z=t(50023),F=t(21326);function j(e){var a,t,j,k,T,O,N,A,V,L,M,E;let{recordId:_,window:J}=e,{getRequest:B,postRequest:H}=(0,d.useContext)(c.$),{platformLabels:Q}=(0,d.useContext)(D.l),{stack:W}=(0,R.zY)(),{labels:G,access:U}=(0,Z.Z)({datasetId:v.i.MaterialReqPlannings,editMode:!!_}),{documentType:$,maxAccess:Y,changeDT:z}=(0,b.H)({functionId:I.J.MRP,access:U,enabled:!_,objectName:"header"});(0,F.Z)({title:G.materialRequestPlaning,window:J});let K=(0,m.E)({endpointId:S.I.MatPlanning.page}),{formik:X}=(0,C.c)({maxAccess:Y,documentType:{key:"header.dtId",value:null==$?void 0:$.dtId},initialValues:{recordId:_,header:{recordId:_,dtId:null,reference:"",date:new Date,notes:"",status:1,releaseStatus:null,wip:1},items:[]},validateOnChange:!0,validationSchema:o.Ry({header:o.Ry({date:o.hT().required()}),items:o.IX().of(o.Ry({qty:o.Rx().required()}))}),onSubmit:async e=>{let a=await H({extension:S.I.MatPlanning.set2,record:JSON.stringify({header:{...e.header,date:(0,r.ku)(e.header.date)},items:e.items})});u.ZP.success(e.recordId?Q.Edited:Q.Added),en(a.recordId),K()}}),ee=!!X.values.recordId,ea=4==X.values.header.status,et=2===X.values.header.wip;async function en(e){let{record:a}=await B({extension:S.I.MatPlanning.get,parameters:"_requestId=".concat(e)}),{list:t}=await B({extension:S.I.MatPlanningItem.qry,parameters:"_mrpId=".concat(e)});X.setValues({recordId:a.recordId,header:{...a,date:(0,r.a1)(null==a?void 0:a.date)},items:null==t?void 0:t.map((e,a)=>({...e,id:a+1,seqNo:a+1,date:(0,r.a1)(e.date)}))})}let el=[{key:"Reopen",condition:et,onClick:async function(){await H({extension:S.I.MatPlanning.reopen,record:JSON.stringify({...X.values.header,date:(0,r.ku)(X.values.header.date)})}),u.ZP.success(Q.Reopened),K(),en(X.values.recordId)},disabled:!et},{key:"Close",condition:!et,onClick:async function(){await H({extension:S.I.MatPlanning.close,record:JSON.stringify({...X.values.header,date:(0,r.ku)(X.values.header.date)})}),u.ZP.success(Q.Closed),K(),en(X.values.recordId)},disabled:et||!ee},{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!ee},{key:"WorkFlow",condition:!0,onClick:async function(){W({Component:P.Z,props:{functionId:I.J.MRP,recordId:X.values.recordId}})},disabled:!ee},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!et},{key:"generate",condition:!0,onClick:async()=>{await H({extension:S.I.PurchaseRequest.generate,record:JSON.stringify({...X.values.header,date:(0,r.ku)(X.values.header.date)})}),u.ZP.success(Q.Generated),K(),en(X.values.recordId)},disabled:!ee||!ea}];(0,d.useEffect)(()=>{_&&en(_)},[]);let er=[{component:"textfield",label:G.sku,name:"sku",width:100,props:{readOnly:!0}},{component:"textfield",label:G.name,name:"itemName",width:150,props:{readOnly:!0}},{component:"numberfield",label:G.onHand,name:"onhand",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.openPr,name:"openPR",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.openPo,name:"openPO",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.leadTime,name:"leadTime",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.safetyStock,name:"safetyStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.reorderPoint,name:"reorderPoint",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.min,name:"minStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.max,name:"maxStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.amcShortTerm,name:"amcShortTerm",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.amcLongTerm,name:"amcLongTerm",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.siteCoverageStock,name:"siteCoverageStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.totalCoverageStock,name:"totalStockCoverage",width:100,props:{readOnly:!0}},{component:"textfield",label:G.mu,name:"msRef",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.unitCost,name:"unitCost",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.totalCost,name:"totalCost",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.sugQty,name:"suggestedPRQty",width:100,props:{readOnly:!0}},{component:"numberfield",label:G.reqQty,name:"qty",width:100,props:{decimalScale:2}}];return(0,n.jsx)(i.Z,{resourceId:v.i.MaterialReqPlannings,functionId:I.J.MRP,form:X,maxAccess:Y,actions:el,editMode:ee,previewReport:ee,disabledSubmit:et,children:(0,n.jsxs)(g.R,{children:[(0,n.jsx)(w.g,{children:(0,n.jsxs)(s.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(s.ZP,{item:!0,xs:4,children:(0,n.jsxs)(s.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{endpointId:f.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(I.J.MRP),name:"header.dtId",label:G.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:ee,valueField:"recordId",displayField:["reference","name"],values:X.values.header,maxAccess:Y,onChange:(e,a)=>{X.setFieldValue("header.dtId",(null==a?void 0:a.recordId)||null),z(a)},error:(null===(a=X.touched.header)||void 0===a?void 0:a.dtId)&&!!(null===(t=X.errors.header)||void 0===t?void 0:t.dtId)})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(l.Z,{name:"header.date",label:G.date,value:null===(j=X.values)||void 0===j?void 0:j.header.date,readOnly:et,required:!0,onChange:X.setFieldValue,onClear:()=>X.setFieldValue("header.date",null),error:(null===(k=X.touched.header)||void 0===k?void 0:k.date)&&!!(null===(T=X.errors.header)||void 0===T?void 0:T.date),maxAccess:Y})}),(0,n.jsx)(s.ZP,{item:!0,xs:12,children:(0,n.jsx)(p.Z,{name:"header.reference",label:G.reference,value:null==X?void 0:null===(O=X.values)||void 0===O?void 0:O.header.reference,maxAccess:!ee&&Y,readOnly:ee,onChange:X.handleChange,onClear:()=>X.setFieldValue("header.reference",""),error:(null===(N=X.touched.header)||void 0===N?void 0:N.reference)&&!!(null===(A=X.errors.header)||void 0===A?void 0:A.reference)})})]})}),(0,n.jsx)(s.ZP,{item:!0,xs:4,children:(0,n.jsx)(y.Z,{name:"header.notes",label:G.notes,value:X.values.header.notes,rows:3,readOnly:et,maxAccess:Y,onChange:e=>X.setFieldValue("header.notes",e.target.value),onClear:()=>X.setFieldValue("header.notes",""),error:(null===(V=X.touched.header)||void 0===V?void 0:V.notes)&&!!(null===(L=X.errors.header)||void 0===L?void 0:L.notes)})})]})}),(0,n.jsx)(x.Q,{children:(0,n.jsx)(q._,{onChange:e=>{X.setFieldValue("items",e)},value:null==X?void 0:null===(M=X.values)||void 0===M?void 0:M.items,error:null==X?void 0:null===(E=X.errors)||void 0===E?void 0:E.items,columns:er,maxAccess:Y,name:"items",allowDelete:!et,allowAddNewLine:!1,disabled:et})})]})})}j.width=1300,j.height=600}},function(e){e.O(0,[92515,2494,43553,72683,28996,23352,13073,44129,17720,46553,38096,78451,77980,94828,58974,35934,60352,25991,69952,99090,32304,99471,58669,8324,69549,40300,41451,43933,49774,92888,40179],function(){return e(e.s=61663)}),_N_E=e.O()}]);