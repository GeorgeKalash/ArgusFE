(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61201],{75942:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gl-opening-balances",function(){return n(66284)}])},66284:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return j}});var r=n(52322),c=n(2784),t=n(62202),s=n(69387);n(27723);var l=n(65950),i=n(71987),d=n(26612),u=n(31389),o=n(33625),m=n(62362),x=n(61802),f=n(19473);n(30043);var g=n(66361),I=n(60218),h=n(48601),p=n(82737);n(5088);var y=n(80983),v=n(8661),C=n(38449),A=n(91406);n(2454);var b=n(27423);n(25870);var _=n(84100);function F(e){let{labels:a,maxAccess:n,record:s,recordId:o}=e,{getRequest:x,postRequest:F}=(0,c.useContext)(l.$),{platformLabels:S}=(0,c.useContext)(f.l),j=(0,i.E)({endpointId:g.x.OpeningBalances.page}),{formik:N}=(0,y.c)({initialValues:{recordId:o,fiscalYear:null,accountId:null,currencyId:null,sign:"",costCenterId:0,amount:null,baseAmount:null},maxAccess:n,validateOnChange:!0,validationSchema:h.Ry({fiscalYear:h.Rx().required(),accountId:h.Rx().required(),currencyId:h.Rx().required(),sign:h.Z_().required(),amount:h.Rx().required(),baseAmount:h.Rx().required()}),onSubmit:async e=>{let a=N.values.currencyId,n=N.values.fiscalYear,r=N.values.accountId,c=N.values.costCenterId,s=await F({extension:g.x.OpeningBalances.set,record:JSON.stringify(e)});a||n||r||c?t.ZP.success(S.Edited):(t.ZP.success(S.Added),N.setFieldValue("recordId",s.recordId)),N.setValues({...e,recordId:String(10*e.fiscalYear)+String(e.accountId)+String(e.currencyId)+String(e.costCenterId)}),j()}}),Y=!!N.values.recordId;return(0,c.useEffect)(()=>{!async function(){if(s&&s.currencyId&&s.fiscalYear&&s.accountId&&null!==s.costCenterId&&o){let e=await x({extension:g.x.OpeningBalances.get,parameters:"_fiscalYear=".concat(s.fiscalYear,"&_accountId=").concat(s.accountId,"&_currencyId=").concat(s.currencyId,"&_costCenterId=").concat(s.costCenterId)});N.setValues({...e.record,recordId:String(10*s.fiscalYear)+String(s.accountId)+String(s.currencyId)+String(s.costCenterId)})}}()},[]),(0,r.jsx)(p.Z,{resourceId:d.i.OpeningBalances,form:N,maxAccess:n,editMode:Y,children:(0,r.jsx)(u.R,{children:(0,r.jsx)(m.Q,{children:(0,r.jsxs)(I.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(I.ZP,{item:!0,xs:12,children:(0,r.jsx)(v.Z,{endpointId:C.r.FiscalYears.qry,readOnly:Y,name:"fiscalYear",label:a.fiscalYear,valueField:"fiscalYear",displayField:"fiscalYear",values:N.values,required:!0,maxAccess:n,onChange:(e,a)=>{N.setFieldValue("fiscalYear",(null==a?void 0:a.fiscalYear)||null)},error:N.touched.fiscalYear&&!!N.errors.fiscalYear})}),(0,r.jsx)(I.ZP,{item:!0,xs:12,children:(0,r.jsx)(b.U,{endpointId:g.x.Account.snapshot,name:"accountId",readOnly:Y,label:a.accountName,valueField:"accountRef",displayField:"name",valueShow:"accountRef",required:!0,secondValueShow:"accountName",form:N,onChange:(e,a)=>{N.setFieldValue("accountId",(null==a?void 0:a.recordId)||""),N.setFieldValue("accountRef",(null==a?void 0:a.accountRef)||""),N.setFieldValue("accountName",(null==a?void 0:a.name)||"")},error:N.touched.accountId&&!!N.errors.accountId,maxAccess:n})}),(0,r.jsx)(I.ZP,{item:!0,xs:12,children:(0,r.jsx)(v.Z,{endpointId:C.r.Currency.qry,name:"currencyId",label:a.currency,readOnly:Y,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:N.values,required:!0,maxAccess:n,onChange:(e,a)=>{N.setFieldValue("currencyId",(null==a?void 0:a.recordId)||null)},error:N.touched.currencyId&&!!N.errors.currencyId})}),(0,r.jsx)(I.ZP,{item:!0,xs:12,children:(0,r.jsx)(v.Z,{datasetId:_.v.Sign,name:"sign",label:a.sign,values:N.values,valueField:"key",displayField:"value",required:!0,maxAccess:n,onChange:(e,a)=>{N&&N.setFieldValue("sign",a?a.key:"")},error:N.touched.sign&&!!N.errors.sign})}),(0,r.jsx)(I.ZP,{item:!0,xs:12,children:(0,r.jsx)(v.Z,{name:"costCenterId",endpointId:g.x.CostCenter.qry,parameters:"_params=&_startAt=0&_pageSize=1000",label:a.costCenter,valueField:"recordId",displayField:"name",values:N.values,onChange:(e,a)=>{N.setFieldValue("costCenterId",(null==a?void 0:a.recordId)||0)},error:N.touched.costCenterId&&!!N.errors.costCenterId,maxAccess:n})}),(0,r.jsx)(I.ZP,{item:!0,xs:12,children:(0,r.jsx)(A.Z,{name:"amount",label:a.amount,value:N.values.amount,required:!0,maxAccess:n,onChange:e=>N.setFieldValue("amount",e.target.value),onClear:()=>N.setFieldValue("amount",""),error:N.touched.amount&&!!N.errors.amount,maxLength:10})}),(0,r.jsx)(I.ZP,{item:!0,xs:12,children:(0,r.jsx)(A.Z,{name:"baseAmount",required:!0,label:a.baseAmount,value:N.values.baseAmount,maxAccess:n,onChange:e=>N.setFieldValue("baseAmount",e.target.value),onClear:()=>N.setFieldValue("baseAmount",""),error:N.touched.baseAmount&&!!N.errors.baseAmount,maxLength:10,decimalScale:2})})]})})})})}var S=n(36908),j=()=>{let{getRequest:e,postRequest:a}=(0,c.useContext)(l.$),{platformLabels:n}=(0,c.useContext)(f.l),{stack:I}=(0,x.zY)();async function h(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0,_pageSize:r=50,params:c}=a;return{...await e({extension:g.x.OpeningBalances.page,parameters:"_startAt=".concat(n,"&_pageSize=").concat(r,"&filter=&_params=").concat(c||"")}),_startAt:n}}async function p(e){let{filters:a,pagination:n}=e;return h({_startAt:n._startAt||0,params:null==a?void 0:a.params})}let{query:{data:y},labels:v,paginationParameters:C,refetch:A,access:b,invalidate:_,filterBy:j}=(0,i.J)({queryFn:h,endpointId:g.x.OpeningBalances.page,datasetId:d.i.OpeningBalances,filter:{filterFn:p}}),N=[{field:"fiscalYear",headerName:v.fiscalYear,flex:1},{field:"accountRef",headerName:v.reference,flex:1},{field:"accountName",headerName:v.accountName,flex:1},{field:"currencyRef",headerName:v.currency,flex:1},{field:"amount",headerName:v.amount,flex:1,type:"number"},{field:"signName",headerName:v.sign,flex:1},{field:"baseAmount",headerName:v.baseAmount,flex:1,type:"number"}];function Y(e){I({Component:F,props:{labels:v,record:e,recordId:e?String(10*e.fiscalYear)+String(e.accountId)+String(e.currencyId)+String(e.costCenterId):null,maxAccess:b},width:600,height:500,title:v.OpeningBalances})}let Z=async e=>{await a({extension:g.x.OpeningBalances.del,record:JSON.stringify(e)}),_(),t.ZP.success(n.Deleted)};return(0,r.jsxs)(u.R,{children:[(0,r.jsx)(o.g,{children:(0,r.jsx)(S.Z,{onAdd:()=>{Y()},maxAccess:b,filterBy:j,reportName:"GLOBA",hasSearch:!1})}),(0,r.jsx)(m.Q,{children:(0,r.jsx)(s.Z,{columns:N,gridData:y,rowId:["recordId"],onEdit:e=>{Y(e)},onDelete:Z,isLoading:!1,deleteConfirmationType:"strict",pageSize:50,paginationType:"api",paginationParameters:C,refetch:A,maxAccess:b})})]})}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=75942)}),_N_E=e.O()}]);