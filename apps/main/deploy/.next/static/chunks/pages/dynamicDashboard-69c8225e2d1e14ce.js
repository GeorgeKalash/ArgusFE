(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57551,47441,84622,57981],{10264:function(e){var a;a=function(){"use strict";var e="minute",a=/[+-]\d\d(?::?\d\d)?/g,t=/([+-]|\d\d)/g;return function(l,n,r){var d=n.prototype;r.utc=function(e){var a={date:e,utc:!0,args:arguments};return new n(a)},d.utc=function(a){var t=r(this.toDate(),{locale:this.$L,utc:!0});return a?t.add(this.utcOffset(),e):t},d.local=function(){return r(this.toDate(),{locale:this.$L,utc:!1})};var s=d.parse;d.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var o=d.init;d.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else o.call(this)};var i=d.utcOffset;d.utcOffset=function(l,n){var r=this.$utils().u;if(r(l))return this.$u?0:r(this.$offset)?i.call(this):this.$offset;if("string"==typeof l&&null===(l=function(e){void 0===e&&(e="");var l=e.match(a);if(!l)return null;var n=(""+l[0]).match(t)||["-",0,0],r=n[0],d=60*+n[1]+ +n[2];return 0===d?0:"+"===r?d:-d}(l)))return this;var d=16>=Math.abs(l)?60*l:l;if(0===d)return this.utc(n);var s=this.clone();if(n)return s.$offset=d,s.$u=!1,s;var o=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(s=this.local().add(d+o,e)).$offset=d,s.$x.$localOffset=o,s};var u=d.format;d.format=function(e){var a=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return u.call(this,a)},d.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},d.isUTC=function(){return!!this.$u},d.toISOString=function(){return this.toDate().toISOString()},d.toString=function(){return this.toDate().toUTCString()};var c=d.toDate;d.toDate=function(e){return"s"===e&&this.$offset?r(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():c.call(this)};var m=d.diff;d.diff=function(e,a,t){if(e&&this.$u===e.$u)return m.call(this,e,a,t);var l=this.local(),n=r(e).local();return m.call(l,n,a,t)}}},e.exports=a()},24790:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dynamicDashboard",function(){return t(3109)}])},3109:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return l.Z}});var l=t(35138)},35138:function(e,a,t){"use strict";t.d(a,{Z:function(){return R}});var l=t(52322),n=t(2784),r=t(65950),d=t(38449),s=t(13781),o=t(1685),i=t(57590),u=t(26612),c=t(50023),m=t(54073),v=t.n(m);let p={NEW_CUSTOMERS_YTD:1,SALES_YTD:2,PROFIT_YTD:3,TODAYS_TOTAL_RETAIL_SALES:13,TODAYS_TOTAL_SALES_ORDERS:14,RETAIL_SALES_YTD:15,CREDIT_SALES_YTD:16,CREDIT_SALES_RETURNS_YTD:17,OPEN_SALES_ORDERS:18};var y=t(69387),h=t(23925),f=t(9522),x=t(29326),I=t(6035),g=t(84100),C=t(39812),D=t(38836),b=t(19505),S=t.n(b),R=()=>{var e,a,t,m,b,R,q,w,P,j,F,Z,T,N,k,O,A,V,L,_,M,E,J,B,H,Y,G,U,W,Q,$,z,K,X,ee,ea,et,el,en,er,ed,es,eo,ei,eu,ec,em,ev,ep,ey,eh,ef,ex,eI,eg,eC,eD,eb,eS,eR,eq,ew,eP,ej,eF,eZ,eT,eN,ek,eO,eA,eV,eL,e_,eM,eE,eJ,eB,eH,eY,eG,eU,eW,eQ,e$,ez,eK,eX,e0,e2,e1,e3,e8,e6,e9,e4,e7,e5,ae,aa,at,al,an,ar,ad,as,ao,ai,au,ac,am,av,ap,ay,ah,af,ax,aI,ag,aC,aD,ab,aS,aR,aq,aw,aP,aj,aF,aZ,aT,aN;let{getRequest:ak,LoadingOverlay:aO}=(0,n.useContext)(r.$),[aA,aV]=(0,n.useState)(null),[aL,a_]=(0,n.useState)(null),[aM,aE]=(0,n.useState)(!0),[aJ,aB]=(0,n.useState)(0),aH=(0,o.m)("userData"),aY=aH.userId,aG=aH.languageId,aU=n.useRef(ak);(0,n.useEffect)(()=>{aU.current=ak},[ak]);let aW=n.useRef(null);aW.current||(aW.current=v()(()=>{aE(!1)},500)),(0,n.useEffect)(()=>()=>{aW.current&&aW.current.cancel()},[]);let{labels:aQ,access:a$}=(0,c.Z)({datasetId:u.i.UserDashboard});if((0,n.useEffect)(()=>{let e=!1;return(async()=>{try{aE(!0);let a=await aU.current({extension:d.r.DynamicDashboard.qry,parameters:"_userId=".concat(aY)});if(e)return;a_(a.list);let[t,l,n,r]=await Promise.all([aU.current({extension:i.T.dashboard}),aU.current({extension:i.T.SalesPersonDashboard.spDB}),aU.current({extension:I.f.TimeVariation.qry2,parameters:"_dayId=".concat((0,C.Uf)(new Date))}),aU.current({extension:d.r.KeyValueStore,parameters:"_dataset=".concat(g.v.TIME_CODE,"&_language=").concat(aG)})]);if(e)return;let s=new Set((n.list||[]).map(e=>e.timeCode)),o=(r.list||[]).filter(e=>s.has(Number(e.key))).map(e=>({label:e.value,timeCode:Number(e.key),disabled:!1})),u=o.reduce((e,a)=>(e[a.timeCode]={list:(n.list||[]).filter(e=>e.timeCode===a.timeCode)},e),{});aV({dashboard:null==t?void 0:t.record,sp:null==l?void 0:l.record,hr:{timeVariationDetails:n.list||[],tabs:o,groupedData:u}}),aW.current&&aW.current()}catch(a){e||aE(!1)}})(),()=>{e=!0}},[aY,aG]),aM)return(0,l.jsx)(aO,{});let az=e=>!!Array.isArray(aL)&&aL.some(a=>a.appletId===e);return(0,l.jsx)("div",{className:S().frame,children:(0,l.jsxs)("div",{className:S().container,children:[az(u.i.TodayRetailOrders)&&(0,l.jsx)("div",{className:S().topRow,children:(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsxs)("div",{className:S().summaryCard,children:[(0,l.jsx)("h2",{className:S().title,children:aQ.retailSales}),(0,l.jsx)("strong",{className:S().strong,children:(null!==(ag=null==aA?void 0:null===(t=aA.dashboard)||void 0===t?void 0:null===(a=t.summaryFigures)||void 0===a?void 0:null===(e=a.find(e=>e.itemId===p.TODAYS_TOTAL_RETAIL_SALES))||void 0===e?void 0:e.amount)&&void 0!==ag?ag:0).toLocaleString()})]}),(0,l.jsx)(s.Tq,{labels:(null==aA?void 0:null===(b=aA.dashboard)||void 0===b?void 0:null===(m=b.todaysRetailSales)||void 0===m?void 0:m.map(e=>e.posRef))||[],data:(null==aA?void 0:null===(q=aA.dashboard)||void 0===q?void 0:null===(R=q.todaysRetailSales)||void 0===R?void 0:R.map(e=>e.sales))||[],label:aQ.retailSales})]})}),az(u.i.MyYearlySalesPerformance)&&(0,l.jsx)("div",{className:S().topRow,children:(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.myYearlySalesPerformance})}),(0,l.jsx)(s.tK,{labels:(null==aA?void 0:null===(P=aA.sp)||void 0===P?void 0:null===(w=P.myYearlySalesPerformanceList)||void 0===w?void 0:w.map(e=>e.year))||[],data1:(null==aA?void 0:null===(F=aA.sp)||void 0===F?void 0:null===(j=F.myYearlySalesPerformanceList)||void 0===j?void 0:j.map(e=>e.sales))||[],data2:(null==aA?void 0:null===(T=aA.sp)||void 0===T?void 0:null===(Z=T.myYearlySalesPerformanceList)||void 0===Z?void 0:Z.map(e=>e.target))||[],label1:aQ.sales,label2:aQ.target})]})}),az(u.i.MyMonthlySalesPerformance)&&(0,l.jsx)("div",{className:S().topRow,children:(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.myMonthlySalesPerformance})}),(0,l.jsx)(s.tK,{labels:(null==aA?void 0:null===(k=aA.sp)||void 0===k?void 0:null===(N=k.myMonthlySalesPerformanceList)||void 0===N?void 0:N.map(e=>e.monthName))||[],data1:(null==aA?void 0:null===(A=aA.sp)||void 0===A?void 0:null===(O=A.myMonthlySalesPerformanceList)||void 0===O?void 0:O.map(e=>e.sales))||[],data2:(null==aA?void 0:null===(L=aA.sp)||void 0===L?void 0:null===(V=L.myMonthlySalesPerformanceList)||void 0===V?void 0:V.map(e=>e.target))||[],label1:aQ.sales,label2:aQ.target})]})}),az(u.i.SalesTeamOrdersSummary)&&(0,l.jsx)("div",{className:S().topRow,children:(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.salesTeamOrdersSummary})}),(0,l.jsx)(s.tK,{labels:(null==aA?void 0:null===(M=aA.dashboard)||void 0===M?void 0:null===(_=M.salesTeamOrdersSummaries)||void 0===_?void 0:_.map(e=>e.spRef))||[],data1:(null==aA?void 0:null===(J=aA.dashboard)||void 0===J?void 0:null===(E=J.salesTeamOrdersSummaries)||void 0===E?void 0:E.map(e=>e.amount))||[],data2:(null==aA?void 0:null===(H=aA.dashboard)||void 0===H?void 0:null===(B=H.salesTeamOrdersSummaries)||void 0===B?void 0:B.map(e=>e.orderCount))||[],label1:aQ.amount,label2:aQ.orderCount,hasLegend:!0,rotation:-90})]})}),(0,l.jsxs)("div",{className:S().middleRow,children:[az(u.i.MyYearlyUnitsSoldList)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.myYearlyUnitsSoldList})}),(0,l.jsx)(s.zg,{labels:(null==aA?void 0:null===(G=aA.sp)||void 0===G?void 0:null===(Y=G.myYearlyUnitsSoldList)||void 0===Y?void 0:Y.map(e=>e.year))||[],data:(null==aA?void 0:null===(W=aA.sp)||void 0===W?void 0:null===(U=W.myYearlyUnitsSoldList)||void 0===U?void 0:U.map(e=>e.qty))||[],label:aQ.qty})]}),az(u.i.MyYearlyGrowthInUnitsSoldList)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.myYearlyGrowthInUnitsSoldList})}),(0,l.jsx)(s.zg,{labels:(null==aA?void 0:null===($=aA.sp)||void 0===$?void 0:null===(Q=$.myYearlyGrowthInUnitsSoldList)||void 0===Q?void 0:Q.map(e=>e.year))||[],data:(null==aA?void 0:null===(K=aA.sp)||void 0===K?void 0:null===(z=K.myYearlyGrowthInUnitsSoldList)||void 0===z?void 0:z.map(e=>e.qty))||[],label:aQ.qty})]}),az(u.i.MyYearlyClientsAcquiredList)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.myYearlyClientsAcquiredList})}),(0,l.jsx)(s.zg,{labels:(null==aA?void 0:null===(ee=aA.sp)||void 0===ee?void 0:null===(X=ee.myYearlyClientsAcquiredList)||void 0===X?void 0:X.map(e=>e.year))||[],data:(null==aA?void 0:null===(et=aA.sp)||void 0===et?void 0:null===(ea=et.myYearlyClientsAcquiredList)||void 0===ea?void 0:ea.map(e=>e.qty))||[],label:aQ.qty})]}),az(u.i.MyYearlyGrowthInClientsAcquiredList)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.myYearlyGrowthInClientsAc})}),(0,l.jsx)(s.zg,{labels:(null==aA?void 0:null===(en=aA.sp)||void 0===en?void 0:null===(el=en.myYearlyGrowthInClientsAcquiredList)||void 0===el?void 0:el.map(e=>e.year))||[],data:(null==aA?void 0:null===(ed=aA.sp)||void 0===ed?void 0:null===(er=ed.myYearlyGrowthInClientsAcquiredList)||void 0===er?void 0:er.map(e=>e.qty))||[],label:aQ.qty})]})]}),az(u.i.TodayPlantSales)&&(0,l.jsx)("div",{className:S().topRow,children:(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsxs)("div",{className:S().summaryCard,children:[(0,l.jsx)("h2",{className:S().title,children:aQ.todayPlantSales}),(0,l.jsx)("strong",{className:S().strong,children:((null==aA?void 0:null===(eo=aA.dashboard)||void 0===eo?void 0:null===(es=eo.todaysCreditSales)||void 0===es?void 0:es.map(e=>e.sales).reduce((e,a)=>e+a,0))||0).toLocaleString()})]}),(0,l.jsx)(s.Tq,{labels:(null==aA?void 0:null===(eu=aA.dashboard)||void 0===eu?void 0:null===(ei=eu.todaysCreditSales)||void 0===ei?void 0:ei.map(e=>e.plantRef))||[],data:(null==aA?void 0:null===(em=aA.dashboard)||void 0===em?void 0:null===(ec=em.todaysCreditSales)||void 0===ec?void 0:ec.map(e=>e.sales))||[],label:aQ.todayPlantSales,ratio:5})]})}),(0,l.jsxs)("div",{className:S().middleRow,children:[(az(u.i.NewCustomers)||az(u.i.GlobalSalesYTD))&&(0,l.jsxs)("div",{className:S().summaryGrid,children:[az(u.i.GlobalSalesYTD)&&(0,l.jsx)(l.Fragment,{children:[{title:aQ.todaysSale,rows:[{label:aQ.hoSalesOrders,value:null!==(aC=null==aA?void 0:null===(ey=aA.dashboard)||void 0===ey?void 0:null===(ep=ey.summaryFigures)||void 0===ep?void 0:null===(ev=ep.find(e=>e.itemId===p.TODAYS_TOTAL_SALES_ORDERS))||void 0===ev?void 0:ev.amount)&&void 0!==aC?aC:0},{label:aQ.retailSales,value:null!==(aD=null==aA?void 0:null===(ex=aA.dashboard)||void 0===ex?void 0:null===(ef=ex.summaryFigures)||void 0===ef?void 0:null===(eh=ef.find(e=>e.itemId===p.TODAYS_TOTAL_RETAIL_SALES))||void 0===eh?void 0:eh.amount)&&void 0!==aD?aD:0},{label:aQ.total,value:(null!==(ab=null==aA?void 0:null===(eC=aA.dashboard)||void 0===eC?void 0:null===(eg=eC.summaryFigures)||void 0===eg?void 0:null===(eI=eg.find(e=>e.itemId===p.TODAYS_TOTAL_SALES_ORDERS))||void 0===eI?void 0:eI.amount)&&void 0!==ab?ab:0)+(null!==(aS=null==aA?void 0:null===(eS=aA.dashboard)||void 0===eS?void 0:null===(eb=eS.summaryFigures)||void 0===eb?void 0:null===(eD=eb.find(e=>e.itemId===p.TODAYS_TOTAL_RETAIL_SALES))||void 0===eD?void 0:eD.amount)&&void 0!==aS?aS:0)}]},{title:aQ.globalSales,rows:[{label:aQ.hoSales,value:null!==(aR=null==aA?void 0:null===(ew=aA.dashboard)||void 0===ew?void 0:null===(eq=ew.summaryFigures)||void 0===eq?void 0:null===(eR=eq.find(e=>e.itemId===p.CREDIT_SALES_YTD))||void 0===eR?void 0:eR.amount)&&void 0!==aR?aR:0},{label:aQ.retailSales,value:null!==(aq=null==aA?void 0:null===(eF=aA.dashboard)||void 0===eF?void 0:null===(ej=eF.summaryFigures)||void 0===ej?void 0:null===(eP=ej.find(e=>e.itemId===p.RETAIL_SALES_YTD))||void 0===eP?void 0:eP.amount)&&void 0!==aq?aq:0},{label:aQ.total,value:(null!==(aw=null==aA?void 0:null===(eN=aA.dashboard)||void 0===eN?void 0:null===(eT=eN.summaryFigures)||void 0===eT?void 0:null===(eZ=eT.find(e=>e.itemId===p.CREDIT_SALES_YTD))||void 0===eZ?void 0:eZ.amount)&&void 0!==aw?aw:0)+(null!==(aP=null==aA?void 0:null===(eA=aA.dashboard)||void 0===eA?void 0:null===(eO=eA.summaryFigures)||void 0===eO?void 0:null===(ek=eO.find(e=>e.itemId===p.RETAIL_SALES_YTD))||void 0===ek?void 0:ek.amount)&&void 0!==aP?aP:0)}]},{title:aQ.miscData,rows:[{label:aQ.openSo,value:null!==(aj=null==aA?void 0:null===(e_=aA.dashboard)||void 0===e_?void 0:null===(eL=e_.summaryFigures)||void 0===eL?void 0:null===(eV=eL.find(e=>e.itemId===p.OPEN_SALES_ORDERS))||void 0===eV?void 0:eV.amount)&&void 0!==aj?aj:0},{label:aQ.returnSales,value:null!==(aF=null==aA?void 0:null===(eJ=aA.dashboard)||void 0===eJ?void 0:null===(eE=eJ.summaryFigures)||void 0===eE?void 0:null===(eM=eE.find(e=>e.itemId===p.CREDIT_SALES_RETURNS_YTD))||void 0===eM?void 0:eM.amount)&&void 0!==aF?aF:0}]},{title:aQ.generalRevenue,rows:[{label:aQ.revenues,value:null!==(aZ=null==aA?void 0:null===(eY=aA.dashboard)||void 0===eY?void 0:null===(eH=eY.summaryFigures)||void 0===eH?void 0:null===(eB=eH.find(e=>e.itemId===p.SALES_YTD))||void 0===eB?void 0:eB.amount)&&void 0!==aZ?aZ:0},{label:aQ.profit,value:null!==(aT=null==aA?void 0:null===(eW=aA.dashboard)||void 0===eW?void 0:null===(eU=eW.summaryFigures)||void 0===eU?void 0:null===(eG=eU.find(e=>e.itemId===p.PROFIT_YTD))||void 0===eG?void 0:eG.amount)&&void 0!==aT?aT:0}]}].map((e,a)=>(0,l.jsxs)("div",{className:S().summaryItem,children:[(0,l.jsx)("div",{className:S().redCenter,children:e.title}),(0,l.jsx)("div",{className:S().innerGrid,children:e.rows.map((e,a)=>(0,l.jsxs)(n.Fragment,{children:[(0,l.jsxs)("div",{className:S().label,children:[e.label,":"]}),(0,l.jsx)("div",{className:S().value,children:e.value.toLocaleString(void 0,{maximumFractionDigits:0})})]},a))})]},a))}),az(u.i.NewCustomers)&&(0,l.jsx)("div",{className:S().summaryItem,style:{gridColumn:"1 / 3"},children:(0,l.jsxs)("div",{className:S().redCenter,children:[aQ.newCostumers,":"," ",(null!==(aN=null==aA?void 0:null===(ez=aA.dashboard)||void 0===ez?void 0:null===(e$=ez.summaryFigures)||void 0===e$?void 0:null===(eQ=e$.find(e=>e.itemId===p.NEW_CUSTOMERS_YTD))||void 0===eQ?void 0:eQ.amount)&&void 0!==aN?aN:0).toLocaleString()]})})]}),az(u.i.WeeklySalesYTD)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsxs)("div",{className:S().summaryCard,children:[(0,l.jsxs)("h2",{className:S().title,children:[" ",aQ.avWeeklySales]}),(0,l.jsx)("strong",{className:S().strong,children:(((null==aA?void 0:null===(eX=aA.dashboard)||void 0===eX?void 0:null===(eK=eX.weeklySales)||void 0===eK?void 0:eK.map(e=>e.sales).reduce((e,a)=>e+a,0))||0)/((null==aA?void 0:null===(e2=aA.dashboard)||void 0===e2?void 0:null===(e0=e2.weeklySales)||void 0===e0?void 0:e0.length)||1)).toLocaleString()})]}),(0,l.jsx)(s.Tq,{labels:(null==aA?void 0:null===(e3=aA.dashboard)||void 0===e3?void 0:null===(e1=e3.weeklySales)||void 0===e1?void 0:e1.map(e=>e.weekName))||[],data:(null==aA?void 0:null===(e6=aA.dashboard)||void 0===e6?void 0:null===(e8=e6.weeklySales)||void 0===e8?void 0:e8.map(e=>e.sales))||[],label:aQ.weeklySales})]}),az(u.i.MonthlySalesYTD)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsxs)("div",{className:S().summaryCard,children:[(0,l.jsx)("h2",{className:S().title,children:aQ.avMonthlySales}),(0,l.jsx)("strong",{className:S().strong,children:(((null==aA?void 0:null===(e4=aA.dashboard)||void 0===e4?void 0:null===(e9=e4.monthlySales)||void 0===e9?void 0:e9.map(e=>e.sales).reduce((e,a)=>e+a,0))||0)/((null==aA?void 0:null===(e5=aA.dashboard)||void 0===e5?void 0:null===(e7=e5.monthlySales)||void 0===e7?void 0:e7.length)||1)).toLocaleString()})]}),(0,l.jsx)(s.Tq,{labels:(null==aA?void 0:null===(aa=aA.dashboard)||void 0===aa?void 0:null===(ae=aa.monthlySales)||void 0===ae?void 0:ae.map(e=>"".concat(e.year,"/").concat(e.month)))||[],data:(null==aA?void 0:null===(al=aA.dashboard)||void 0===al?void 0:null===(at=al.monthlySales)||void 0===at?void 0:at.map(e=>e.sales))||[],label:aQ.monthlySales})]}),az(u.i.AccumulatedRevenuesYTD)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.accRevenues})}),(0,l.jsx)(s.Tq,{labels:(null==aA?void 0:null===(ar=aA.dashboard)||void 0===ar?void 0:null===(an=ar.accumulatedMonthlySales)||void 0===an?void 0:an.map(e=>e.monthName))||[],data:(null==aA?void 0:null===(as=aA.dashboard)||void 0===as?void 0:null===(ad=as.accumulatedMonthlySales)||void 0===ad?void 0:ad.map(e=>e.sales))||[],label:aQ.accRevenues,color:"#ff6c02",hoverColor:"#fec106"})]}),az(u.i.Receivables)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.receivables})}),(0,l.jsx)(s.xe,{labels:Object.keys((null==aA?void 0:null===(ao=aA.dashboard)||void 0===ao?void 0:ao.receivables)||{}),data:Object.values((null==aA?void 0:null===(ai=aA.dashboard)||void 0===ai?void 0:ai.receivables)||{}).map(e=>"number"==typeof e?Math.ceil(e):0),label:aQ.receivables,color:"#6e87b6",hoverColor:"#818181"})]}),az(u.i.TopCustomers)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.topCostumers})}),(0,l.jsx)(s.xe,{labels:(null==aA?void 0:null===(ac=aA.dashboard)||void 0===ac?void 0:null===(au=ac.topCustomers)||void 0===au?void 0:au.map(e=>e.clientName))||[],data:(null==aA?void 0:null===(av=aA.dashboard)||void 0===av?void 0:null===(am=av.topCustomers)||void 0===am?void 0:am.map(e=>e.amount))||[],label:aQ.revenue,color:"#d5b552",hoverColor:"#818181"})]}),az(u.i.AverageRevenuePerItem)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.averageRevenuePerItem})}),(0,l.jsx)(s.wW,{labels:(null==aA?void 0:null===(ay=aA.dashboard)||void 0===ay?void 0:null===(ap=ay.avgUnitSales)||void 0===ap?void 0:ap.map(e=>e.itemName))||[],data:(null==aA?void 0:null===(af=aA.dashboard)||void 0===af?void 0:null===(ah=af.avgUnitSales)||void 0===ah?void 0:ah.map(e=>e.avgPrice))||[],label:aQ.averageRevenue})]}),az(u.i.TodaysTimeVariationsDetails)&&(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.todaysTimeVariationsDetails})}),(0,l.jsx)(f.Y,{tabs:(null==aA?void 0:null===(ax=aA.hr)||void 0===ax?void 0:ax.tabs)||[],activeTab:aJ,setActiveTab:aB}),((null==aA?void 0:null===(aI=aA.hr)||void 0===aI?void 0:aI.tabs)||[]).map((e,a)=>{var t,n;return(0,l.jsx)(x.Z,{index:a,value:aJ,children:(0,l.jsx)(h.Z,{sx:{display:"flex",height:"350px"},children:(0,l.jsx)(y.Z,{name:"TVtable",columns:[{field:"employeeName",headerName:aQ.employeeName,flex:3},{field:"branchName",headerName:aQ.branchName,flex:3},{field:"departmentName",headerName:aQ.departmentName,flex:3},{field:"duration",headerName:aQ.duration,flex:2,type:"number"}],gridData:(null==aA?void 0:null===(n=aA.hr)||void 0===n?void 0:null===(t=n.groupedData)||void 0===t?void 0:t[e.timeCode])||{list:[]},rowId:["recordId"],pagination:!1,maxAccess:a$})})},a)})]})]}),az(u.i.PendingAuthorizationRequests)&&(0,l.jsx)("div",{className:S().topRow,children:(0,l.jsxs)("div",{className:S().chartCard,children:[(0,l.jsx)("div",{className:S().summaryCard,children:(0,l.jsx)("h2",{className:S().title,children:aQ.authorization})}),(0,l.jsx)(h.Z,{sx:{display:"flex",height:"350px"},children:(0,l.jsx)(D.Z,{pageSize:10})})]})})]})})}},57393:function(e,a,t){"use strict";t.d(a,{s:function(){return n}});let l="CC.asmx/",n={CashCountTransaction:{snapshot:l+"snapshotTRX",qry:l+"qryTRX",get2:l+"get2TRX",set2:l+"set2TRX",post:l+"postTRX",close:l+"closeTRX",reopen:l+"reopenTRX",del:l+"delTRX"},Generate:{generate:l+"generateTFR"},CcCashNotes:{qry:l+"qryNOT",get:l+"getNOT",set:l+"setNOT",del:l+"delNOT",page:l+"pageNOT"}}},57590:function(e,a,t){"use strict";t.d(a,{T:function(){return n}});let l="DB.asmx/",n={dashboard:l+"dashboard",SalesPersonDashboard:{spDB:l+"spDB"}}},92407:function(e,a,t){"use strict";t.d(a,{y:function(){return n}});let l="EP.asmx/",n={Employee:{snapshot:l+"snapshotEM",get1:l+"getEM1",set:l+"setEM",del:l+"delEM"},CertificateFilters:{qry:l+"qryCL",get:l+"getCL",set:l+"setCL",del:l+"delCL",page:l+"pageCL"},HRDocTypeFilters:{qry:l+"qryDT"},SalaryChangeReason:{qry:l+"qrySC",get:l+"getSC",set:l+"setSC",del:l+"delSC",page:l+"pageSC"},EmploymentStatusFilters:{qry:l+"qryST",page:l+"pageST",set:l+"setST",get:l+"getST",del:l+"delST"},SponsorFilters:{qry:l+"qrySP",page:l+"pageSP",set:l+"setSP",get:l+"getSP",del:l+"delSP"},RelationshipTypes:{page:l+"pageRT",set:l+"setRT",get:l+"getRT",del:l+"delRT"},BonusTypes:{get:l+"getBT",set:l+"setBT",page:l+"pageBT",del:l+"delBT"},BgCheck:{page:l+"pageCT",set:l+"setCT",get:l+"getCT",del:l+"delCT"},NoticePeriods:{get:l+"getNP",set:l+"setNP",del:l+"delNP",qry:l+"qryNP",page:l+"pageNP"},CustomProperties:{get:l+"getUP",set:l+"setUP",del:l+"delUP",page:l+"pageUP",qry:l+"qryUP"},ResignationRequest:{get:l+"getRR",set:l+"setRR",del:l+"delRR",page:l+"pageRR",close:l+"closeRR",reopen:l+"reopenRR"},TerminationReasons:{qry:l+"qryTR",get:l+"getTR",set:l+"setTR",del:l+"delTR",page:l+"pageTR"},JobInfo:{snapshot:l+"snapshotJI",page:l+"pageJI",close:l+"closeJI",reopen:l+"reopenJI",get:l+"getJI",set:l+"setJI",del:l+"delJI",qry:l+"qryJI"},QuickView:{get:l+"getQV"},EmployeePenalty:{page:l+"pagePE",close:l+"closePE",reopen:l+"reopenPE",get:l+"getPE",set:l+"setPE",del:l+"delPE"},EmployeeDeduction:{qry:l+"qryED",page:l+"pageED",del:l+"delED",get:l+"getED",set:l+"setED",snapshot:l+"snapshotED"},FullName:{sync:l+"syncFullName"},EmployeeChart:{page:l+"pageES",qry:l+"qryES",qry2:l+"qryES2"},EmployeeSalary:{qry:l+"qrySA",get:l+"getSA",set:l+"setSA",del:l+"delSA"},SalaryDetails:{qry:l+"qrySD",get:l+"getSD",set2:l+"set2SD",del:l+"delSD"},TerminationEmployee:{get:l+"getTE"},EmployementHistory:{qry:l+"qryEH",del:l+"delEH",get:l+"getEH",set:l+"setEH"},Hiring:{get:l+"getRE",set:l+"setRE"},Skills:{qry:l+"qryCE",del:l+"delCE",get:l+"getCE",set:l+"setCE"},UserDefined:{qry:l+"qryUV",set2:l+"set2UV"},Leaves:{set:l+"setLS",del:l+"delLS",get:l+"getLS"}}},58912:function(e,a,t){"use strict";t.d(a,{I:function(){return n}});let l="IR.asmx/",n={ReplenishmentGroups:{qry:l+"qryGRP",page:l+"pageGRP",get:l+"getGRP",set:l+"setGRP",del:l+"delGRP"},IvReplenishements:{qry:l+"qryHDR",page:l+"pageHDR",get:l+"getHDR",set:l+"setHDR"},IvReplenishementsList:{qry:l+"qryTRX"},GenerateIvReplenishements:{generate:l+"generateTFR"},MaterialReplenishment:{page:l+"pageREQ",del:l+"delREQ",get:l+"getREQ",set2:l+"set2REQ",snapshot:l+"snapshotREQ",close:l+"closeREQ",reopen:l+"reopenREQ",cancel:l+"cancelREQ",print:l+"printREQ"},OrderItem:{qry:l+"qryREI",open:l+"openREI"},MatPlanning:{page:l+"pageMPL",del:l+"delMPL",get:l+"getMPL",set2:l+"set2MPL",reopen:l+"reopenMPL",close:l+"closeMPL",qry:l+"qryMPL",snapshot:l+"snapshotMPL"},MatPlanningItem:{qry:l+"qryMPI",append:l+"appendMPI"},PurchaseRequest:{generate:l+"generatePR"},PlantSettings:{get:l+"getPLT",set:l+"setPLT",del:l+"delPLT"},DocumentTypeDefault:{get:l+"getDTD",set:l+"setDTD",del:l+"delDTD",page:l+"pageDTD"},materialPlaning:{preview:l+"previewMRP"},Transfer:{generate2:l+"generate2TFR"},ConsumptionOfTools:{generate:l+"generateMFCON"}}},50496:function(e,a,t){"use strict";t.d(a,{U:function(){return n}});let l="LM.asmx/",n={IndemnityAccuralsFilters:{qry:l+"qryLT"},LeaveScheduleFilters:{qry:l+"qryLS",page:l+"pageLS",set:l+"setLS",get:l+"getLS",del:l+"delLS"},OpeningBalances:{page:l+"pageOBA",set:l+"setOBA",get:l+"getOBA",del:l+"delOBA",qry:l+"qryOBA"},BalanceAdjustment:{page:l+"pageBA",set:l+"setBA",get:l+"getBA",del:l+"delBA",snapshot:l+"snapshotBA"},EarnedLeave:{page:l+"pageEL",set2:l+"set2EL",get2:l+"get2EL",del:l+"delEL",preview:l+"previewEL",post:l+"postEL"},LeavePeriod:{qry:l+"qryLP",del:l+"delLP",get:l+"getLP",set:l+"setLP"},LeaveRequest:{page:l+"pageLR",qry:l+"qryLR",set:l+"setLR",get:l+"getLR",del:l+"delLR",snapshot:l+"snapshotLR",close:l+"closeLR",reopen:l+"reopenLR",set2:l+"set2LR",get2:l+"get2LR"},LeaveReturn:{page:l+"pageRE",set:l+"setRE",get:l+"getRE",del:l+"delRE",snapshot:l+"snapshotRE",close:l+"closeRE",reopen:l+"reopenRE"},PreviewDays:{preview:l+"previewLD"},Leaves:{qry:l+"qryELB"}}},73581:function(e,a,t){"use strict";t.d(a,{h:function(){return n}});let l="LT.asmx/",n={LoanType:{get:l+"getLT",set:l+"setLT",del:l+"delLT",qry:l+"qryLT",page:l+"pageLT"},Loans:{get:l+"getLR",set:l+"setLR",del:l+"delLR",page:l+"pageLR",close:l+"closeLR",reopen:l+"reopenLR"},LoanDeduction:{page:l+"pageLD",get:l+"getLD",set:l+"setLD",del:l+"delLD"}}},90587:function(e,a,t){"use strict";t.d(a,{u:function(){return n}});let l="MF.asmx/",n={DesignRawMaterial:{qry2:l+"qryDRM2",qry:l+"qryDRM",set2:l+"set2DRM"},JobOrdersItem:{qry:l+"qryJIT",set2:l+"set2JIT"},IssueOfMaterialsItems:{qry:l+"qryIMI",qry2:l+"qryIMI2"},LaborGroup:{snapshot:l+"snapshotLBG",page:l+"pageLBG",qry:l+"qryLBG",set:l+"setLBG",get:l+"getLBG",del:l+"delLBG"},ProductionLine:{page:l+"pageLIN",qry:l+"qryLIN",qry2:l+"qry2LIN",qry3:l+"qry3LIN",set:l+"setLIN",get:l+"getLIN",del:l+"delLIN"},CostGroup:{page:l+"pageCG",set:l+"setCG",get:l+"getCG",del:l+"delCG",qry:l+"qryCG"},WorkCenter:{page:l+"pageWCT",qry:l+"qryWCT",qry3:l+"qryWCT3",set:l+"setWCT",get:l+"getWCT",del:l+"delWCT",snapshot:l+"snapshotWCT"},Routing:{page:l+"pageRTN",qry:l+"qryRTN",set:l+"setRTN",get:l+"getRTN",del:l+"delRTN",snapshot2:l+"snapshot2RTN",snapshot:l+"snapshotRTN"},Operation:{snapshot:l+"snapshotOPR",qry:l+"qryOPR",page:l+"pageOPR",set:l+"setOPR",get:l+"getOPR",del:l+"delOPR"},Labor:{page:l+"pageLBR",qry:l+"qryLBR",qry2:l+"qry2LBR",set:l+"setLBR",get:l+"getLBR",del:l+"delLBR",snapshot:l+"snapshotLBR"},Machine:{page:l+"pageMAC",qry:l+"qryMAC",set:l+"setMAC",get:l+"getMAC",del:l+"delMAC",snapshot:l+"snapshotMAC"},MachineSpecification:{page:l+"pageMAS",qry:l+"qryMAS",set:l+"setMAS",get:l+"getMAS",del:l+"delMAS"},LeanProductionPlanning:{preview:l+"previewPQ",update:l+"updatePQ",snapshot:l+"snapshotPQ",del:l+"delPQ",cancel:l+"cancelPQ"},MaterialsAdjustment:{generate:l+"generateADJ"},ProductionClass:{page:l+"pageCLS",qry:l+"qryCLS",set:l+"setCLS",get:l+"getCLS",del:l+"delCLS",snapshot:l+"qryCLS"},ProductionStandard:{qry:l+"qrySTD",page:l+"pageSTD",set:l+"setSTD",get:l+"getSTD",del:l+"delSTD"},ProductionClassSemiFinished:{qry:l+"qryCSF",set:l+"setCSF",get:l+"getCSF",del:l+"delCSF",set2:l+"set2CSF"},RoutingSequence:{set2:l+"set2RTS",qry:l+"qryRTS"},Overhead:{qry:l+"qryOVH",set:l+"setOVH",get:l+"getOVH",del:l+"delOVH",page:l+"pageOVH",snapshot:l+"snapshotOVH"},Design:{qry:l+"qryDES",set:l+"setDES",get:l+"getDES",del:l+"delDES",snapshot:l+"snapshotDES",page:l+"pageDES"},MFJobOrder:{pack:l+"packJOB",qry:l+"qryJOB",qry2:l+"qryJOB2",set:l+"setJOB",get:l+"getJOB",get2:l+"get2JOB",del:l+"delJOB",snapshot:l+"snapshotJOB",snapshot2:l+"snapshotJOB2",snapshot3:l+"snapshotJOB3",cancel:l+"cancelJOB",post:l+"postJOB",start:l+"startJOB",stop:l+"stopJOB",wip:l+"wipJOB",sync:l+"syncJOB"},ProductionSheet:{page:l+"pagePST",qry:l+"qryPST",get:l+"getPST",set2:l+"set2PST",get2:l+"get2PST",del:l+"delPST",post:l+"postPST",unpost:l+"unpostPST",snapshot:l+"snapshotPST"},ProductionSheetItem:{qry:l+"qryPSI",set:l+"setPSI",get:l+"getPSI",del:l+"delPSI"},DocumentTypeDefault:{qry:l+"qryDTD",get:l+"getDTD",set:l+"setDTD",del:l+"delDTD",page:l+"pageDTD"},RawMaterialCategory:{qry:l+"qryRMC",get:l+"getRMC",set:l+"setRMC",del:l+"delRMC",page:l+"pageRMC"},WorksheetMaterials:{qry:l+"qryIMA",get:l+"getIMA",pack:l+"get2IMA",set:l+"setIMA",set2:l+"set2IMA",del:l+"delIMA",post:l+"postIMA"},ProductionSheetQueue:{qry:l+"qryPSQ"},Damage:{qry:l+"qryDMG",get:l+"getDMG",set:l+"setDMG",del:l+"delDMG",page:l+"pageDMG",snapshot:l+"snapshotDMG",post:l+"postDMG",get2:l+"get2DMG",set2:l+"set2DMG",preview:l+"previewDMG"},JobCategory:{qry:l+"qryJCA"},JobRouting:{qry:l+"qryJRO",get:l+"getJRO",set:l+"setJRO",set2:l+"set2JRO",del:l+"delJRO",sync:l+"syncJRO",close:l+"closeJRO",reopen:l+"reopenJRO"},Worksheet:{snapshot:l+"snapshotWST",get:l+"getWST",pack:l+"getPackWST",set:l+"setWST",del:l+"delWST",page:l+"pageWST",summary:l+"summaryWST",post:l+"postWST",qry2:l+"qryWST2",draft:l+"draftWST"},JobOverhead:{qry:l+"qryJOH",set2:l+"set2JOH",generate:l+"generateJOH"},JobMaterial:{qry:l+"qryJMA"},JobItemSize:{qry:l+"qryJSZ",set2:l+"set2JSZ"},MFSerial:{qry:l+"qrySRL",qry2:l+"qrySRL2",set2:l+"set2SRL",generate:l+"generateSRL"},SamplePack:{qry:l+"qrySPL",set2:l+"set2SPL"},DamageReturn:{get:l+"getDMR",set:l+"setDMR",del:l+"delDMR",page:l+"pageDMR",snapshot:l+"snapshotDMR",post:l+"postDMR"},ProductionOrder:{get2:l+"get2PO",set2:l+"set2PO",del:l+"delPO",page:l+"pagePO",snapshot:l+"snapshotPO",post:l+"postPO",gen:l+"genPO",close:l+"closePO"},BillOfMaterials:{get:l+"getBMA",qry2:l+"qry2BMA",set:l+"setBMA",del:l+"delBMA",page:l+"pageBMA",snapshot:l+"snapshotBMA"},Component:{get:l+"getBMI",qry:l+"qryBMI",del:l+"delBMI",set:l+"setBMI",set2:l+"set2BMI"},Assembly:{get:l+"getASM",set2:l+"set2ASM",del:l+"delASM",page:l+"pageASM",snapshot:l+"snapshotASM",post:l+"postASM",unpost:l+"unpostASM",generate:l+"genASM"},AssemblyItems:{qry:l+"qryASC"},AssemblyLot:{get:l+"getASL",set:l+"setASL"},AssemblyOverhead:{qry:l+"qryAOH",set2:l+"set2AOH"},MeasurementScheduleMap:{qry:l+"qryMSM",set:l+"setMSM",set2:l+"set2MSM",del:l+"delMSM"},JobCategory:{set:l+"setJCA",get:l+"getJCA",del:l+"delJCA",page:l+"pageJCA",qry:l+"qryJCA"},DesignGroup:{qry:l+"qryDEG",set:l+"setDEG",get:l+"getDEG",del:l+"delDEG",page:l+"pageDEG"},Components:{qry:l+"qryDEM",set2:l+"set2DEM"},DesignFamily:{qry:l+"qryDEF",set:l+"setDEF",get:l+"getDEF",del:l+"delDEF",page:l+"pageDEF"},ProductionShifts:{qry:l+"qrySHI",set:l+"setSHI",get:l+"getSHI",del:l+"delSHI",page:l+"pageSHI"},JobOrderWizard:{set2:l+"set2JOZ",get2:l+"get2JOZ",del:l+"delJOZ",page:l+"pageJOZ",snapshot:l+"snapshotJOZ",post:l+"postJOZ"},JobTransfer:{get2:l+"get2TFR",set2:l+"set2TFR",del:l+"delTFR",page:l+"pageTFR",snapshot:l+"snapshotTFR",post:l+"postTFR",close:l+"closeTFR",reopen:l+"reopenTFR",qry:l+"qryTFR"},JobWorkCenter:{qry:l+"qryJWC",close:l+"closeJWC",reopen:l+"reopenJWC",get:l+"getJWC",snapshot:l+"snapshotJWC",verify:l+"verifyJWC"},WorkCenterConsumption:{page:l+"pageCON",snapshot:l+"snapshotCON",del:l+"delCON",set2:l+"set2CON",get:l+"getCON",post:l+"postCON",unpost:l+"unpostCON",close:l+"closeCON",reopen:l+"reopenCON"},ConsumptionItemView:{qry:l+"qryCOI"},LineItemCapacity:{set2:l+"set2LIT",del:l+"delLIT",qry:l+"qryLIT",page:l+"pageLIT"},CostGroupOverhead:{set2:l+"set2CGV",qry:l+"qryCGV"},IssueOfMaterialDimension:{set:l+"setIMD",qry:l+"qryIMD"},JobOrder:{gen:l+"genORD"},RefreshPoItem:{refresh:l+"refreshPOI"},WorkCenterTransferMap:{qry:l+"qryWCTM",set2:l+"set2WCTM"},BatchWorksheet:{get2:l+"get2BWST",set2:l+"set2BWST",del:l+"delBWST",page:l+"pageBWST",snapshot:l+"snapshotBWST",post:l+"postBWST",gen:l+"genBWST",close:l+"closeBWST",reopen:l+"reopenBWST"},ProductionOrderFromSaleOrder:{gen:l+"generatePOFromSO"},BatchTransfer:{page:l+"pageBTFR",set2:l+"set2BTFR",del:l+"delBTFR",snapshot:l+"snapshotBTFR",get:l+"getBTFR",post:l+"postBTFR",unpost:l+"unpostBTFR"},BatchTransferJob:{qry:l+"qryBTFJ"},Disposal:{page:l+"pageDIS",snapshot:l+"snapshotDIS",get:l+"getDIS",set2:l+"set2DIS",del:l+"delDIS"},DisposalItem:{qry:l+"qryDII"},DisposalSerial:{qry:l+"qryDISRL"},MetalSetting:{page:l+"pageMTS",set:l+"setMTS",get:l+"getMTS",del:l+"delMTS"},DamageReason:{qry:l+"qryDRS",page:l+"pageDRS",set:l+"setDRS",get:l+"getDRS",del:l+"delDRS",snapshot:l+"snapshotDRS"},DamageCategory:{qry:l+"qryDCA",page:l+"pageDCA",set:l+"setDCA",get:l+"getDCA",del:l+"delDCA",snapshot:l+"snapshotDCA"}}},83562:function(e,a,t){"use strict";t.d(a,{m:function(){return n}});let l="PY.asmx/",n={Payroll:{qry:l+"qryHE",page:l+"pageHE",get:l+"getHE",set:l+"setHE",del:l+"delHE",close:l+"closeHE",reopen:l+"reopenHE",post:l+"postHE",unpost:l+"unpostHE",snapshot:l+"snapshotHE"},BankTransferFilters:{qry:l+"qrySB",page:l+"pageSB",get:l+"getSB",set:l+"setSB",del:l+"delSB"},Paycode:{qry:l+"qryPC",set:l+"setPC",del:l+"delPC",get:l+"getPC"},SecuritySchedule:{qry:l+"qrySS"},IndemnitySchedule:{page:l+"pageIS",qry:l+"qryIS",get:l+"getIS",set:l+"setIS",del:l+"delIS"},LedgerGroup:{qry:l+"qryGLG",get:l+"getGLG",set:l+"setGLG",del:l+"delGLG"},Arguments:{page:l+"pageAR"},SalaryBatch:{page:l+"pageBAT",get:l+"getBAT",set:l+"setBAT",del:l+"delBAT"},TimeCodes:{page:l+"pageTC",qry:l+"qryTC",get:l+"getTC",set:l+"setTC",del:l+"delTC"},FinalSettlement:{page:l+"pageFS",get:l+"getFS",set:l+"setFS",del:l+"delFS",snapshot:l+"snapshotFS"},IndemnityCompany:{qry:l+"qryID",set2:l+"set2ID"},IndemnityResignation:{qry:l+"qryIR",set2:l+"set2IR"},PenaltyType:{page:l+"pagePT",qry:l+"qryPT",get:l+"getPT",set:l+"setPT",del:l+"delPT"},PenaltyDetail:{qry:l+"qryPD",set2:l+"set2PD"},GeneratePayroll:{gen:l+"genEM",page:l+"pageEM"},PayrollDetails:{qry:l+"qryED",set2:l+"set2ED"},SocialSecurity:{qry:l+"qryES"},FiscalYear:{qry:l+"qryYE"},Period:{qry:l+"qryPE"}}},63518:function(e,a,t){"use strict";t.d(a,{z:function(){return n}});let l="PM.asmx/",n={Designer:{page:l+"pageDSR",get:l+"getDSR",set:l+"setDSR",del:l+"delDSR",snapshot:l+"snapshotDSR",qry:l+"qryDSR"},ThreeDDesign:{page:l+"page3DD",get:l+"get3DD",set:l+"set3DD",del:l+"del3DD",post:l+"post3DD",close:l+"close3DD",reopen:l+"reopen3DD",snapshot:l+"snapshot3DD"},Sketch:{page:l+"pageSKH",get:l+"getSKH",set:l+"setSKH",del:l+"delSKH",close:l+"closeSKH",reopen:l+"reopenSKH",snapshot:l+"snapshotSKH",snapshot2:l+"snapshot2SKH",snapshot3:l+"snapshot3SKH",post:l+"postSKH"},ModelMaker:{snapshot:l+"snapshotMDL",snapshot2:l+"snapshot2MDL",page:l+"pageMDL",get:l+"getMDL",set:l+"setMDL",del:l+"delMDL",post:l+"postMDL",close:l+"closeMDL",reopen:l+"reopenMDL"},ModellingMaterial:{qry:l+"qryMDLM",set2:l+"set2MDLM"},Printing:{page:l+"page3DP",get:l+"get3DP",set:l+"set3DP",del:l+"del3DP",start:l+"start3DP",snapshot:l+"snapshot3DP",snapshot2:l+"snapshot3DP2",post:l+"post3DP",qry:l+"qry3DP"},ThreeDDrawing:{snapshot:l+"snapshot3DD",snapshot2:l+"snapshot23DD",get:l+"get3DD",snapshot3DD2:l+"snapshot3DD2"},Rubber:{page:l+"pageRBR",get:l+"getRBR",set:l+"setRBR",del:l+"delRBR",snapshot:l+"snapshotRBR",post:l+"postRBR",start:l+"startRBR"},Modeling:{qry:l+"qryMDL"},Casting:{page:l+"pageCAS",get:l+"getCAS",set:l+"setCAS",del:l+"delCAS",snapshot:l+"snapshotCAS",post:l+"postCAS"},DocumentTypeDefault:{page:l+"pageDTD",get:l+"getDTD",set:l+"setDTD",del:l+"delDTD"},Samples:{page:l+"pageSPL",get2:l+"get2SPL",set:l+"setSPL",del:l+"delSPL",snapshot:l+"snapshotSPL",set2:l+"set2SPL",close:l+"closeSPL",reopen:l+"reopenSPL",post:l+"postSPL"}}},2454:function(e,a,t){"use strict";t.d(a,{y:function(){return n}});let l="PU.asmx/",n={VendorGroups:{qry:l+"qryGRP",page:l+"pageGRP",get:l+"getGRP",set:l+"setGRP",del:l+"delGRP"},PriceList:{qry:l+"qryPRI",del:l+"delPRI",get:l+"getPRI",set:l+"setPRI"},PUOrderStatus:{qry:l+"qryPOS",page:l+"pagePOS",get:l+"getPOS",set:l+"setPOS",del:l+"delPOS"},DeliveryMethods:{qry:l+"qryDM",page:l+"pageDM",get:l+"getDM",set:l+"setDM",del:l+"delDM"},PaymentTerms:{qry:l+"qryPT",page:l+"pagePT",get:l+"getPT",set:l+"setPT",del:l+"delPT"},Vendor:{snapshot:l+"snapshotVEN",qry:l+"qryVEN",page:l+"pageVEN",get:l+"getVEN",set:l+"setVEN",del:l+"delVEN"},Address:{qry:l+"qryAD",page:l+"pageAD",get:l+"getAD",set:l+"setAD",del:l+"delAD"},DocumentTypeDefault:{qry:l+"qryDTD",get:l+"getDTD",set:l+"setDTD",del:l+"delDTD",page:l+"pageDTD"},PurchaseInvoiceHeader:{qry:l+"qryIVC",get:l+"getIVC",get2:l+"get2IVC",level2_PU:l+"level2_PU",set:l+"setIVC",del:l+"delIVC",snapshot:l+"snapshotIVC",set2:l+"set2IVC",post:l+"postIVC",unpost:l+"unpostIVC",generate:l+"generateIVC",preview:l+"previewIVC",sync:l+"syncIVC",verify:l+"verifyIVC"},Invoice:{snapshot:l+"snapshotINV"},PurchaseReturnHeader:{set2:l+"set2IVR",post:l+"postIVR",unpost:l+"unpostIVR",del:l+"delIVR",qry:l+"qryIVR",snapshot:l+"snapshotIVR"},VendorPrice:{get:l+"getPRI2"},ItemCostHistory:{qry:l+"qryIPH"},ItemPromotion:{qry:l+"qryIVIM"},Serials:{qry:l+"qrySRL",import:l+"importSRL",last:l+"lastSRL",sync:l+"syncSRL"},Shipment:{get:l+"getSHP",set2:l+"set2SHP",del:l+"delSHP",page:l+"pageSHP",snapshot:l+"snapshotSHP",post:l+"postSHP",unpost:l+"unpostSHP",gen:l+"genSHP"},ShipmentItem:{qry:l+"qrySHI"},UnpostedOrderPack:{get:l+"openORD",snapshot:l+"snapshotORD"},PurchaseOrder:{page:l+"pageORD",snapshot:l+"snapshotORD",del:l+"delORD",set2:l+"set2ORD",get2:l+"get2ORD",close:l+"closeORD",reopen:l+"reopenORD",terminate:l+"terminateORD",transfer:l+"transfer1ORD"},PurchaseRequisition:{snapshot:l+"snapshotREQ",page:l+"pageREQ",get:l+"getREQ",set:l+"setREQ",del:l+"delREQ",cancel:l+"cancelREQ",reopen:l+"reopenREQ",close:l+"closeREQ"},RequisitionDetail:{qry:l+"qryREI",set:l+"setREI",get:l+"getREI",del:l+"delREI"},QuotationItem:{preview:l+"previewQTI",qry:l+"qryQTI"},OrderItem:{qry:l+"qryORI",set2:l+"set2ORI"},PUDraftReturn:{set2:l+"set2DRE",get:l+"getDRE",page:l+"pageDRE",snapshot:l+"snapshotDRE",del:l+"delDRE",post:l+"postDRE"},PUDraftReturnSerial:{get2:l+"get2DRS",qry:l+"qryDRS",del:l+"delDRS",append:l+"appendDRS",batch:l+"batchDRS"},FinancialGroup:{qry:l+"qryFII",set2:l+"set2FII"},PUInvoiceRetBalance:{balance:l+"balanceRET"},ItemLastPurchaseInfo:{last:l+"lastIVI"},PurchaseQuotation:{page:l+"pageQTN",set2:l+"set2QTN",get:l+"getQTN",del:l+"delQTN",snapshot:l+"snapshotQTN"},GenerateQTNPRPack:{gen:l+"genQTN"},GeneratePOPRPack:{gen:l+"genPO",gen2:l+"gen2PO"}}},76426:function(e,a,t){"use strict";t.d(a,{x:function(){return n}});let l="SC.asmx/",n={LabelTemplate:{qry:l+"qryLBT",set:l+"setLBT",get:l+"getLBT",del:l+"delLBT"},Item:{qry:l+"qryLBI",set:l+"setLBI",get:l+"getLBI",del:l+"delLBI"},Sites:{qry:l+"qrySIT",set:l+"setSIT",set2:l+"set2SIT",get:l+"getSIT",del:l+"delSIT",reopen:l+"reopenSIT",end:l+"endSIT"},Controller:{qry:l+"qryCRL"},StockCountControllerTab:{qry:l+"qryPHY",set2:l+"set2PHY",set:l+"setPHY",get:l+"getPHY",del:l+"delPHY"},StockCount:{page:l+"pageHDR",post:l+"postHDR",unpost:l+"unpostHDR",qry:l+"qryHDR",get:l+"getHDR",set:l+"setHDR",del:l+"delHDR",close:l+"closeHDR",reopen:l+"reopenHDR",snapshot:l+"snapshotHDR"},StockCountController:{page:l+"pageCRL",set:l+"setCRL",get:l+"getCRL",del:l+"delCRL"},DocumentTypeDefaults:{qry:l+"qryDTD",set:l+"setDTD",get:l+"getDTD",del:l+"delDTD"},StockCountItem:{qry:l+"qryITM",set:l+"setITM",get:l+"getITM",del:l+"delITM"},StockCountSerialSum:{qry:l+"qrySRS"},StockCountItemDetail:{qry:l+"qryITD",set:l+"setITD",get:l+"getITD",del:l+"delITD",set2:l+"set2ITD"},StockCountSerialDetail:{set2:l+"set2SRL",qry:l+"qrySRL",append:l+"appendSRL",del:l+"delSRL",batch:l+"batchSRL"}}},6035:function(e,a,t){"use strict";t.d(a,{f:function(){return n}});let l="TA.asmx/",n={AttendanceScheduleFilters:{qry:l+"qrySD"},ProcessedShiftPunches:{retry:l+"retryPSP"},OvertimeProfiles:{page:l+"pageOTP",set:l+"setOTP",get:l+"getOTP",del:l+"delOTP",qry:l+"qryOTP"},PendingPunches:{page:l+"pagePP",del:l+"delPP",qry:l+"qryPP"},BiometricDevices:{page:l+"pageBM",qry:l+"qryBM",del:l+"delBM",set:l+"setBM",get:l+"getBM"},DSLReasons:{page:l+"pageLR",set:l+"setLR",get:l+"getLR",del:l+"delLR"},TimeVariation:{reset:l+"resetTV",qry:l+"qryTV",qry2:l+"qryTV2",snapshot:l+"snapshotTV",page:l+"pageTV",get:l+"getTV",set:l+"setTV",del:l+"delTV",gen:l+"genTV",close:l+"closeTV",reopen:l+"reopenTV",cancel:l+"cancelTV",override:l+"overrideTV"},ShitLeave:{page:l+"pageLQ",set:l+"setLQ",get:l+"getLQ",del:l+"delLQ",close:l+"closeLQ",reopen:l+"reopenLQ"},FlatSchedule:{qry:l+"qryFS",qry2:l+"qryFS2",copyRange:l+"copyRangeFS",range:l+"rangeFS",del:l+"delRangeFS"},DSLReason:{qry:l+"qryLR"},Calendar:{qry:l+"qryCA"},DayTypes:{page:l+"pageDT",qry:l+"qryDT",set:l+"setDT",get:l+"getDT",del:l+"delDT"},AttendanceDay:{qry:l+"qryAD"},Schedule:{qry:l+"qrySC"},FlatPunch:{qry:l+"qryFP"}}},70104:function(e,a,t){"use strict";t.d(a,{K:function(){return n}});let l="CS.asmx/",n={DivisionFilters:{qry:l+"qryDI"},BranchFilters:{qry:l+"qryBR"},CompanyPositions:{qry:l+"qryPO"},DepartmentFilters:{qry:l+"qryDE"}}},93883:function(e,a,t){"use strict";var l=t(52322),n=t(2784),r=t(74143),d=t(44258),s=t(41633),o=t(45297),i=t(73980),u=t(11886),c=t(26698),m=t(32827),v=t(2494),p=t(81576),y=t(7087),h=t.n(y);a.Z=e=>{let{name:a,label:t,value:y,onChange:f,error:x,disabledRangeDate:I={},max:g=null,min:C=null,variant:D="outlined",size:b="small",views:S=["year","month","day","hours","minutes"],fullWidth:R=!0,required:q=!1,autoFocus:w=!1,disabled:P=!1,disabledDate:j=null,readOnly:F=!1,editMode:Z=!1,hasBorder:T=!0,hidden:N=!1,formatTime:k="hh:mm aa",defaultValue:O,...A}=e,V="".concat(window.localStorage.getItem("default")&&JSON.parse(window.localStorage.getItem("default")).dateFormat," ").concat(k),[L,_]=(0,n.useState)(!1),{_readOnly:M,_required:E,_hidden:J}=(0,p.W)(a,A.maxAccess,q,F,N),B=new Date(I.date);B.setDate(B.getDate()+I.day);let H=void 0===y?(()=>{let e;switch(O){case"today":e=new Date;break;case"yesterday":(e=new Date).setDate(e.getDate()-1);break;case"boy":e=new Date(new Date().getFullYear(),0,1);break;default:e=null}return e})():y;return J?(0,l.jsx)(l.Fragment,{}):(0,l.jsx)(s._,{dateAdapter:u.H,children:(0,l.jsx)(v.x,{variant:D,size:b,value:H,label:t,views:S,minDate:C||I.date,maxDate:g||B,fullWidth:R,autoFocus:w,format:V,onChange:e=>f(a,e),onClose:()=>_(!1),open:L,disabled:P,readOnly:M,clearable:!0,shouldDisableDate:j&&(e=>{let a=new Date(e),t=new Date;return(t.setDate(t.getDate()),a.setDate(a.getDate()),">="===j)?a>=t:"<"===j?a<t:">"===j&&a>t}),slotProps:{popper:{disablePortal:!0},textField:{required:E,size:b,fullWidth:R,error:x,inputProps:{tabIndex:M?-1:0},InputProps:{classes:{root:h().outlinedRoot,notchedOutline:T?h().outlinedFieldset:h().outlinedNoBorder,input:h().inputBase},endAdornment:!(M||P)&&(0,l.jsxs)(r.Z,{position:"end",className:h().inputAdornment,children:[H&&(0,l.jsx)(d.Z,{tabIndex:-1,edge:"start",onClick:()=>f(a,null),className:h().iconButton,children:(0,l.jsx)(o.Z,{className:h().icon})}),(0,l.jsx)(d.Z,{tabIndex:-1,onClick:()=>_(!0),className:h().iconButton,children:(0,l.jsx)(i.Z,{className:h().icon})})]})},InputLabelProps:{classes:{root:h().inputLabel,shrink:h().inputLabelShrink}}},actionBar:{actions:["accept","today"]}},slots:{actionBar:e=>(0,l.jsx)(c.Z,{...e,actions:["accept","today"]}),popper:e=>(0,l.jsx)(m.Z,{isDateTimePicker:!0,...e})}})})}},28298:function(e,a,t){"use strict";var l=t(52322),n=t(2784),r=t(74143),d=t(44258),s=t(41633),o=t(45297),i=t(94918),u=t(26698),c=t(51909),m=t(90740),v=t(32827),p=t(81576),y=t(7087),h=t.n(y);a.Z=e=>{let{name:a,label:t,value:y,onChange:f,error:x=!1,helperText:I="",disabledRangeTime:g={},variant:C="outlined",size:D="small",fullWidth:b=!0,required:S=!1,autoFocus:R=!1,disabled:q=!1,disabledTime:w=null,readOnly:P=!1,editMode:j=!1,hasBorder:F=!0,hidden:Z=!1,use24Hour:T=!1,min:N=null,max:k=null,...O}=e,[A,V]=(0,n.useState)(!1),[L,_]=(0,n.useState)(!1),{_readOnly:M,_required:E,_hidden:J}=(0,p.W)(a,O.maxAccess,S,P,Z);return J?(0,l.jsx)(l.Fragment,{}):(0,l.jsx)(s._,{dateAdapter:m.y,children:(0,l.jsx)(c.j,{variant:C,size:D,value:y,label:t,fullWidth:b,ampm:!T,minTime:N,maxTime:k,onFocus:()=>_(!0),onBlur:()=>_(!1),autoFocus:R,onChange:e=>f(a,e),onClose:()=>V(!1),open:A,disabled:q,readOnly:M,clearable:!0,slotProps:{textField:{required:E,size:D,fullWidth:b,error:!!x,helperText:"string"==typeof x?x:I,InputProps:{classes:{root:h().outlinedRoot,notchedOutline:F?h().outlinedFieldset:h().outlinedNoBorder,input:h().inputBase},endAdornment:!(M||q)&&(0,l.jsxs)(r.Z,{position:"end",className:h().inputAdornment,children:[y&&(0,l.jsx)(d.Z,{tabIndex:-1,className:h().iconButton,onClick:()=>f(a,null),children:(0,l.jsx)(o.Z,{className:h().icon})}),(0,l.jsx)(d.Z,{tabIndex:-1,className:h().iconButton,onClick:()=>V(!0),children:(0,l.jsx)(i.Z,{className:h().icon})})]})},InputLabelProps:{className:L||y?h().inputLabelShrink:h().inputLabel}},actionBar:{actions:["accept"]}},slots:{actionBar:e=>(0,l.jsx)(u.Z,{...e,actions:["accept"]}),popper:e=>(0,l.jsx)(v.Z,{...e,matchAnchorWidth:!1,isDateTimePicker:!0})},...O})})}},38836:function(e,a,t){"use strict";t.d(a,{Z:function(){return ey}});var l=t(52322),n=t(2784),r=t(23925),d=t(44258),s=t(9737),o=t(69387),i=t(27723),u=t(65950),c=t(68676),m=t(60218),v=t(78711),p=t(62202),y=t(71987),h=t(19473),f=t(23361),x=t(21326);let I=e=>{let{window:a,w:t,responseValue:r,onConfirm:d,fullScreen:s}=e,{platformLabels:o}=(0,n.useContext)(h.l);return(0,x.Z)({title:o.Confirmation,window:a}),(0,l.jsx)(f.Z,{DialogText:2===r?o.ApproveDoc:o.RejectDoc,okButtonAction:()=>{d(),a.close(),t.close()},fullScreen:s,cancelButtonAction:()=>{a.close()}})};I.width=450,I.height=170;var g=t(5088),C=t(21581),D=t(89330),b=t(39812);let S={DocumentsOnHold:{set:"CTDR.asmx/setTRX"}};var R=t(31389),q=t(62362),w=t(61802),P=t(7121),j=t(1883),F=t(54074);function Z(e){let{labels:a,maxAccess:t,functionId:r,seqNo:d,recordId:s,window:o}=e,[i,f]=(0,n.useState)(null),{platformLabels:x}=(0,n.useContext)(h.l),{getRequest:Z,postRequest:T}=(0,n.useContext)(u.$),N=(0,y.E)({endpointId:c.y.DocumentsOnHold.qry}),{stack:k}=(0,w.zY)(),O=(0,v.TA)({initialValues:{recordId:null,reference:"",indicatorId:null,functionId:null,seqNo:"",thirdParty:"",date:null,notes:"",responseDate:null,strategyName:""},validateOnChange:!0,onSubmit:async e=>{let a={...e,date:(0,b.ku)(e.date),response:i},t=(0,P.x)(r);t===j.Y.CurrencyTrading||t===j.Y.Remittance?await T({extension:S.DocumentsOnHold.set,record:JSON.stringify(a)}):await T({extension:c.y.DocumentsOnHold.set,record:JSON.stringify(a)}),p.ZP.success(r||d||e.recordId||null===i?x.Edited:x.Added),N()}});function A(e){f(e),k({Component:I,props:{fullScreen:!1,responseValue:e,w:o,onConfirm:()=>{console.log("submit"),O.submitForm()}}})}return(0,n.useEffect)(()=>{!async function(){var e;let a=await Z({extension:c.y.DocumentsOnHold.get,parameters:"_functionId=".concat(r,"&_seqNo=").concat(d,"&_recordId=").concat(s)});O.setValues({...a.record,date:(0,b.a1)(null==a?void 0:null===(e=a.record)||void 0===e?void 0:e.date)})}()},[]),(0,l.jsx)(F.Z,{actions:[{key:"Reject",condition:!0,onClick:()=>{A(-1)},disabled:!1},{key:"Approve",condition:!0,onClick:()=>{A(2)},disabled:!1}],isSaved:!1,maxAccess:t,children:(0,l.jsx)(R.R,{children:(0,l.jsx)(q.Q,{children:(0,l.jsxs)(m.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"reference",label:a.reference,value:O.values.reference,readOnly:!0,maxAccess:t,maxLength:"30"})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"thirdParty",label:a.thirdParty,value:O.values.thirdParty,readOnly:!0,maxAccess:t})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"date",label:a.date,onChange:O.setFieldValue,value:O.values.date,readOnly:!0,maxAccess:t})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"strategyName",label:a.strategy,value:O.values.strategyName,readOnly:!0,maxAccess:t})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"notes",label:a.notes,value:O.values.notes,maxLength:"100",rows:2,maxAccess:t,onChange:O.handleChange,onClear:()=>O.setFieldValue("notes",""),error:O.touched.notes&&!!O.errors.notes})})]})})})})}var T=t(26612),N=t(47441),k=t(58974),O=t(25991),A=t(38449),V=t(60352),L=t(53137),_=t(33625),M=t(93741),E=t(57981),J=t(74456),B=t(99090),H=t(69549),Y=t(8324),G=t(99471),U=t(44129),W=t(38096),Q=t(58669),$=t(40300),z=t(89764),K=t(69952),X=t(20899),ee=t(41451),ea=t(73470),et=t(51682),el=t(43933),en=t(21379),er=t(30032),ed=t(23427),es=t(1838),eo=t(86557),ei=t(58583),eu=t(27603),ec=t(32304),em=t(84622),ev=t(35934),ep=t(23476),ey=e=>{let{pageSize:a=50}=e,{getRequest:t}=(0,n.useContext)(u.$),{stack:m}=(0,w.zY)();async function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:l=0}=e;return{...await t({extension:c.y.DocumentsOnHold.qry,parameters:"_startAt=".concat(l,"&_reference=&_sortBy=reference desc&_pageSize=").concat(a)}),_startAt:l}}let{query:{data:p},labels:h,filterBy:f,clearFilter:x,refetch:I,paginationParameters:g,access:C}=(0,y.J)({queryFn:v,endpointId:c.y.DocumentsOnHold.qry,datasetId:T.i.DocumentsOnHold,filter:{endpointId:c.y.DocumentsOnHold.qry,filterFn:D}});async function D(e){let{options:l={},filters:n}=e,{_startAt:r=0}=l;return n.qry&&await t({extension:c.y.DocumentsOnHold.qry,parameters:"&_reference=".concat(n.qry,"&_sortBy=reference desc&_pageSize=").concat(a,"&_startAt=").concat(r)})}let b=async e=>{try{var a;let l=await t({extension:A.r.UserDefaults.get,parameters:"_userId=".concat(e&&e.userId,"&_key=plantId")});return null==l?void 0:null===(a=l.record)||void 0===a?void 0:a.value}catch(e){return""}},S=async e=>{let a;let l=e.recordId;switch(e.functionId){case P.J.CurrencyCreditOrderSale:case P.J.CurrencyCreditOrderPurchase:a=N.Z;break;case P.J.CreditInvoiceSales:case P.J.CreditInvoicePurchase:a=k.Z;break;case P.J.CashCountTransaction:a=M.Z;break;case P.J.CurrencyPurchase:case P.J.CurrencySale:a=O.Z;break;case P.J.KYC:await t({extension:L.L.CtClientIndividual.get,parameters:"_recordId=".concat(e.recordId)}).then(e=>{l=e.record.clientId}),a=V.Z;break;case P.J.ResignationRequest:a=ea.Z;break;case P.J.LeaveRequest:a=et.Z;break;case P.J.Samples:a=el.Z;break;case P.J.PayrollList:a=en.Z;break;case P.J.OutwardsOrder:a=G.Z;break;case P.J.CashTransfer:a=E.Z;break;case P.J.OutwardsModification:a=J.Z;break;case P.J.OutwardsReturn:a=B.Z;break;case P.J.InwardTransfer:a=H.Z;break;case P.J.InwardSettlement:a=Y.Z;break;case P.J.Sketch:a=U.Z;break;case P.J.SalesOrder:a=Q.Z;break;case P.J.ThreeDDesign:a=W.Z;break;case P.J.LoanRequest:a=z.Z;break;case P.J.PurchaseRequisition:a=$.Z;break;case P.J.PurchaseOrder:a=K.Z;break;case P.J.MaterialRequest:a=X.Z;break;case P.J.CostAllocation:a=ee.Z;break;case P.J.MRP:a=er.Z;break;case P.J.ReturnFromLeave:a=ed.Z;break;case P.J.Penalty:a=es.Z;break;case P.J.TimeVariation:a=eo.Z;break;case P.J.DuringShiftLeave:a=ei.Z;break;case P.J.JobInfo:a=eu.Z;break;case P.J.PaymentOrder:a=ec.Z;break;case P.J.WorkCenterConsumption:a=em.Z;break;case P.J.ProductionOrder:a=ev.Z;break;case P.J.StockCount:a=ep.Z}if(a){let e=window.sessionStorage.getItem("userData")?JSON.parse(window.sessionStorage.getItem("userData")):null,t=await b(e);m({Component:a,props:{recordId:l,plantId:t,userData:e}})}},j=async e=>{await S(e)},F=[{field:"reference",headerName:h.reference,flex:2},{field:"functionName",headerName:h.functionName,flex:2},{field:"thirdParty",headerName:h.thirdParty,flex:2},{field:"strategyName",headerName:h.strategy,flex:2},{field:"date",headerName:h.date,flex:2,type:"date"},{field:"approval",flex:1,cellRenderer:e=>(0,l.jsx)(r.Z,{sx:{display:"flex",width:"100%",justifyContent:"center"},children:(0,l.jsx)(d.Z,{size:"small",onClick:()=>ey(e.data),children:(0,l.jsx)(s.Z,{icon:"mdi:application-edit-outline",fontSize:18})})})}],ey=e=>{m({Component:Z,props:{labels:h,maxAccess:h,maxAccess:C,recordId:e.recordId,functionId:e.functionId,seqNo:e.seqNo}})};return(0,l.jsxs)(R.R,{children:[(0,l.jsx)(_.g,{children:(0,l.jsx)(i.Z,{maxAccess:C,onSearch:e=>{f("qry",e)},onSearchClear:()=>{x("qry")},labels:h,inputSearch:!0})}),(0,l.jsx)(q.Q,{children:(0,l.jsx)(o.Z,{columns:F,gridData:p,rowId:["functionId","seqNo","recordId"],onEdit:j,isLoading:!1,pageSize:a,refetch:I,paginationParameters:g,paginationType:"api",maxAccess:C})})]})}},93741:function(e,a,t){"use strict";t.d(a,{Z:function(){return _}});var l=t(52322),n=t(60218),r=t(2784),d=t(48601),s=t(82737),o=t(62202),i=t(65950),u=t(26612),c=t(5088),m=t(31389),v=t(80983),p=t(27423),y=t(2119),h=t(8661),f=t(38449),x=t(89330),I=t(76399),g=t(33625),C=t(62362),D=t(91406),b=t(57393),S=t(54074);function R(e){var a,t;let{labels:s,maxAccess:o,recordId:u,forceNoteCount:p,row:y,updateRow:h,readOnly:f,window:x}=e,{getRequest:R}=(0,r.useContext)(i.$),{formik:q}=(0,v.c)({maxAccess:o,initialValues:{total:0,currencyNotes:[{id:1,seqNo:"",cashCountId:0,note:"",qty:"",subTotal:""}]},validateOnChange:!0,validationSchema:d.Ry({currencyNotes:d.IX().of(d.Ry().shape({note:d.Z_().required()})).required("Operations array is required")}),onSubmit:async e=>{var a;let t=null===(a=e.currencyNotes.filter(e=>e.qty>0))||void 0===a?void 0:a.map(e=>{let{id:a,seqNo:t,cashCountId:l,qty:n,qty1:r,qty100:d,qty1000:s,...o}=e;return{seqNo:y.id,qty:n,qty1:r||0,qty100:d||0,qty1000:s||0,cashCountId:(null==y?void 0:y.cashCountId)<1?0:null==y?void 0:y.cashCountId,...o}}),l=e.currencyNotes.reduce((e,a)=>{let{subTotal:t}=a;return e+(Number(t)||0)},0);p?h({changes:{counted:l,currencyNotes:t,variation:l-(y.system||0),flag:y.system===l}}):h({changes:{currencyNotes:t}}),x.close()}});(0,r.useEffect)(()=>{(null==y?void 0:y.id)&&w()},[u]);let w=async()=>{var e;let a="_currencyId="+y.currencyId,{list:t}=await R({extension:b.s.CcCashNotes.qry,parameters:a}),l=null===(e=y.currencyNotes)||void 0===e?void 0:e.map((e,a)=>{let{id:t,qty:l,note:n,...r}=e;return{id:a+1,qty:l,note:n,subTotal:l*n,...r}}),n=(null==t?void 0:t.map((e,a)=>{let{...t}=e;return{id:a+1,...t}})).map(e=>{let a={id:e.id,note:e.note,seqNo:null,qty:"",subTotal:0},t=null==l?void 0:l.find(e=>a.note===e.note);return t&&(a.qty=t.qty,a.qty1=t.qty1||"",a.qty100=t.qty100||"",a.qty1000=t.qty1000||"",a.seqNo=t.seqNo,a.subTotal=t.subTotal),a});q.setFieldValue("currencyNotes",n)},P=null===(t=q.values)||void 0===t?void 0:null===(a=t.currencyNotes)||void 0===a?void 0:a.reduce((e,a)=>{let{subTotal:t}=a;return e+(Number(t)||0)},0);function j(e){let{update:a,newRow:t}=e,l=(null==t?void 0:t.note)||0,n=((null==t?void 0:t.qty1)||0)+100*((null==t?void 0:t.qty100)||0)+1e3*((null==t?void 0:t.qty1000)||0);a({qty:n,subTotal:n*l})}return(0,l.jsx)(S.Z,{onSave:q.handleSubmit,maxAccess:o,children:(0,l.jsxs)(m.R,{children:[(0,l.jsx)(g.g,{children:(0,l.jsx)(n.ZP,{container:!0,xs:6,children:(0,l.jsx)(c.Z,{name:"reference",label:s.currency,value:y.currencyRef,readOnly:!0})})}),(0,l.jsx)(C.Q,{children:(0,l.jsx)(I._,{onChange:e=>q.setFieldValue("currencyNotes",e),value:q.values.currencyNotes,error:q.errors.currencyNotes,columns:[{component:"numberfield",label:s.currencyNote,name:"note",props:{readOnly:!0}},{component:"numberfield",label:s.qty1,name:"qty1",props:{readOnly:f,decimalScale:0,maxLength:2,allowNegative:!1},async onChange(e){let{row:a}=e;j(a)}},{component:"numberfield",label:s.qty100,name:"qty100",props:{readOnly:f,decimalScale:0,maxLength:3,allowNegative:!1},async onChange(e){let{row:a}=e;j(a)}},{component:"numberfield",label:s.qty1000,name:"qty1000",props:{readOnly:f,decimalScale:0,allowNegative:!1},async onChange(e){let{row:a}=e;j(a)}},{component:"numberfield",label:s.qty,name:"qty",props:{readOnly:!0},async onChange(e){let{row:{update:a,newRow:t}}=e,l=(null==t?void 0:t.note)||0;a({subTotal:((null==t?void 0:t.qty)||0)*l})}},{component:"numberfield",label:s.subTotal,name:"subTotal",props:{readOnly:!0}}],allowDelete:!1,allowAddNewLine:!1})}),(0,l.jsx)(g.g,{children:(0,l.jsx)(n.ZP,{container:!0,spacing:2,sx:{mb:3,display:"flex",justifyContent:"right"},children:(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsx)(D.Z,{name:"total",label:s.total,value:P,readOnly:!0})})})})]})})}var q=t(61802),w=t(39812),P=t(7121),j=t(1685),F=t(71987),Z=t(39704),T=t(19473);function N(e){let{cashCountId:a,fromPlantId:t,labels:s,maxAccess:u}=e,{postRequest:c}=(0,r.useContext)(i.$),{platformLabels:x}=(0,r.useContext)(T.l),{formik:I}=(0,v.c)({maxAccess:u,initialValues:{cashCountId:a,fromPlantId:t,toPlantId:"",toAccountId:""},validateOnChange:!0,validationSchema:d.Ry({toPlantId:d.Z_().required(" "),toAccountId:d.Z_().required(" ")}),onSubmit:async e=>{console.log(e);let l={cashCountId:a,fromPlantId:t,toPlantId:e.toPlantId,toAccountId:e.toAccountId};try{await c({extension:b.s.Generate.generate,record:JSON.stringify(l)}),o.ZP.success(x.Generated)}catch(e){}}});return(0,l.jsx)(S.Z,{onSave:I.handleSubmit,maxAccess:u,children:(0,l.jsx)(m.R,{children:(0,l.jsx)(g.g,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(h.Z,{endpointId:f.r.Plant.qry,name:"toPlantId",label:s.toPlant,values:I.values,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,maxAccess:u,onChange:(e,a)=>{I&&I.setFieldValue("toPlantId",null==a?void 0:a.recordId),I.setFieldValue("toAccountId",null),I.setFieldValue("fromCARef",null),I.setFieldValue("fromCAName",null)},error:I.touched.toPlantId&&!!I.errors.toPlantId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.U,{endpointId:y.G.CashAccount.snapshot,parameters:{_type:0},filter:{plantId:I.values.toPlantId},firstFieldWidth:5,valueField:"accountNo",displayField:"name",name:"toAccountId",displayFieldWidth:2,required:!0,label:s.toCashAccount,form:I,valueShow:"fromCARef",secondValueShow:"fromCAName",onChange:(e,a)=>{I.setFieldValue("toAccountId",a?a.recordId:null),I.setFieldValue("fromCARef",a?a.accountNo:null),I.setFieldValue("fromCAName",a?a.name:null)},error:I.touched.toAccountId&&!!I.errors.toAccountId,maxAccess:u})})]})})})})}var k=t(98345),O=t(19689),A=t(50023),V=t(21326);let L=e=>{var a,t,D,S,L;let{recordId:_,window:M}=e,{postRequest:E,getRequest:J}=(0,r.useContext)(i.$),{platformLabels:B}=(0,r.useContext)(T.l),[H,Y]=(0,r.useState)(!!_),{stack:G}=(0,q.zY)(),[U,W]=(0,r.useState)(!1),[Q,$]=(0,r.useState)(!1),z=async()=>{let e=(0,j.m)("userData").userId,a="_userId=".concat(e,"&_functionId=").concat(P.J.CashCountTransaction),{record:t}=await J({extension:f.r.UserFunction.get,parameters:a});t&&et.setFieldValue("dtId",t.dtId);let{record:l}=await J({extension:f.r.UserDefaults.get,parameters:"_userId=".concat(e,"&_key=cashAccountId")}),n=null==l?void 0:l.value;if(n){let{record:e}=await J({extension:y.G.CbBankAccounts.get,parameters:"_recordId=".concat(n)});et.setFieldValue("cashAccountId",n),et.setFieldValue("cashAccountRef",e.reference),et.setFieldValue("cashAccountName",e.name)}let{record:r}=await J({extension:f.r.UserDefaults.get,parameters:"_userId=".concat(e,"&_key=plantId")});r&&et.setFieldValue("plantId",parseInt(r.value))},K=(0,F.E)({endpointId:b.s.CashCountTransaction.qry}),{labels:X,access:ee}=(0,A.Z)({datasetId:u.i.CashCountTransaction,editMode:!!_});(0,V.Z)({title:X.cashCount,window:M});let{maxAccess:ea}=(0,k.H)({functionId:P.J.CashCountTransaction,access:ee,hasDT:!1,enabled:!H}),{formik:et}=(0,v.c)({maxAccess:ea,initialValues:{recordId:null,plantId:null,reference:"",cashAccountId:"",cashAccountRef:"",cashAccountName:"",forceNoteCount:!1,wip:1,status:1,releaseStatus:"",date:new Date,startTime:"",endTime:"",items:[{id:1,cashCountId:"",seqNo:1,currencyId:"",currencyName:"",currencyRef:"",counted:"",system:"",variation:"",flag:"",currencyNotes:[]}]},validateOnChange:!0,validationSchema:d.Ry({cashAccountRef:d.Z_().required(),plantId:d.Z_().required(),items:d.IX().of(d.Ry().shape({currencyId:d.Z_().required(),counted:d.Z_().required()})).required()}),onSubmit:async e=>{let a={header:{recordId:e.recordId,dtId:e.dtId,plantId:e.plantId,shiftId:e.shiftId,currencyId:e.currencyId,cashAccountId:e.cashAccountId,forceNoteCount:e.forceNoteCount,reference:e.reference,date:(0,w.ku)(new Date),startTime:e.startTime,endTime:e.endTime,status:e.status,wip:e.wip,releaseStatus:e.releaseStatus},items:e.items.map((e,a)=>{let{id:t,flag:l,enabled:n,cashCountId:r,currencyNotes:d,...s}=e;return{seqNo:a+1,cashCountId:r||0,currencyNotes:d||[],...s}})},t=(await E({extension:b.s.CashCountTransaction.set2,record:JSON.stringify(a)})).recordId;e.recordId?o.ZP.success(B.Edited):(o.ZP.success(B.Added),el(t)),Y(!0),K()}});(0,r.useEffect)(()=>{H||z(),ed()},[]),(0,r.useEffect)(()=>{el(_)},[_]);let el=async e=>{if(e){let{record:{header:a,items:t}}=await J({extension:b.s.CashCountTransaction.get2,parameters:"_recordId=".concat(e)});W(2===a.wip),$(3===a.status),et.setValues({recordId:a.recordId,plantId:a.plantId,reference:a.reference,cashAccountId:a.cashAccountId,cashAccountRef:a.cashAccountRef,cashAccountName:a.cashAccountName,forceNoteCount:a.forceNoteCount,wip:a.wip,status:a.status,releaseStatus:a.releaseStatus,date:(0,w.a1)(a.date),startTime:a.startTime&&(0,w.s4)(a.startTime),endTime:a.endTime&&(0,w.s4)(a.endTime),items:t.map((e,a)=>{let{seqNo:t,variation:l,...n}=e;return{id:t,seqNo:t,variation:l,flag:0===l,...n}})})}};async function en(){let e=et.values,a={recordId:e.recordId,dtId:e.dtId,plantId:e.plantId,shiftId:e.shiftId,currencyId:e.currencyId,cashAccountId:e.cashAccountId,reference:e.reference,date:e.date,startTime:e.startTime,status:e.status,wip:e.wip,releaseStatus:e.releaseStatus},t=await E({extension:b.s.CashCountTransaction.reopen,record:JSON.stringify(a)}).then(()=>{t.recordId&&(o.ZP.success(B.Reopened),K(),el(null==e?void 0:e.recordId))})}let er=[{key:"Bulk",condition:!0,onClick:function(){G({Component:N,props:{labels:X,cashCountId:et.values.recordId,fromPlantId:et.values.plantId,maxAccess:ea},width:600,height:300,title:X.bulk})},disabled:!Q},{key:"WorkFlow",condition:!0,onClick:async()=>{G({Component:Z.Z,props:{functionId:P.J.CashCountTransaction,recordId:et.values.recordId}})},disabled:!H},{key:"Locked",condition:!0,onClick:()=>{E({extension:b.s.CashCountTransaction.post,record:JSON.stringify(et.values)}).then(e=>{(null==e?void 0:e.recordId)&&(o.ZP.success(B.Posted),K(),$(!0))})},disabled:!H||4!==et.values.status||Q},{key:"Close",condition:!U,onClick:()=>{E({extension:b.s.CashCountTransaction.close,record:JSON.stringify(et.values)}).then(e=>{(null==e?void 0:e.recordId)&&(o.ZP.success(B.Closed),K(),el(null==e?void 0:e.recordId))})},disabled:U||!H},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!U},{key:"Reopen",condition:U,onClick:en,disabled:!U||!H||3===et.values.releaseStatus},{key:"Account Balance",condition:!0,onClick:"onClickAC",disabled:!1}],ed=async()=>{var e;let{record:a}=await J({extension:null===(e=f.r.TimeZone)||void 0===e?void 0:e.get,parameters:""});a&&(H||et.setFieldValue("startTime",(0,w.s4)(null==a?void 0:a.utcDate,"utc")))},es=async e=>{var a,t;let l=null===(a=et.values)||void 0===a?void 0:a.cashAccountId;if(e&&l){let{record:a}=await J({extension:y.G.AccountBalance.get,parameters:"_currencyId="+e+"&_cashAccountId="+(null===(t=et.values)||void 0===t?void 0:t.cashAccountId)});if(a)return a.balance}};return(0,l.jsx)(s.Z,{actions:er,resourceId:u.i.CashCountTransaction,form:et,maxAccess:ea,editMode:H,functionId:P.J.CashCountTransaction,disabledSubmit:U,previewReport:H,children:(0,l.jsxs)(m.R,{children:[(0,l.jsx)(g.g,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(p.U,{endpointId:y.G.CashAccount.snapshot,parameters:{_type:2},name:"cashAccountRef",required:!0,label:X.cashAccount,readOnly:Q||U,valueField:"reference",displayField:"name",valueShow:"cashAccountRef",secondValueShow:"cashAccountName",form:et,onChange:(e,a)=>{et.setValues({...et.values,cashAccountId:(null==a?void 0:a.recordId)||"",cashAccountRef:(null==a?void 0:a.reference)||"",cashAccountName:(null==a?void 0:a.name)||""})},maxAccess:ea})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(x.Z,{name:"date",label:X.date,value:et.values.date,onChange:et.setFieldValue,readOnly:!0,maxAccess:ea})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(h.Z,{endpointId:f.r.Plant.qry,name:"plantId",label:X.plant,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"plant Ref"},{key:"name",value:"Name"}],values:et.values,required:!0,readOnly:Q||U,maxAccess:ea,onChange:(e,a)=>{let t=(null==a?void 0:a.recordId)||"";et.setFieldValue("plantId",t)},error:et.touched.plantId&&!!et.errors.plantId})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(c.Z,{name:"startTime",label:X.startTime,value:et.values.startTime,readOnly:!0,maxAccess:ea})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(c.Z,{name:"reference",label:X.reference,value:et.values.reference,readOnly:H,maxAccess:ea,onChange:e=>{et.handleChange(e)},onClear:()=>et.setFieldValue("reference",""),error:et.touched.reference&&!!et.errors.reference})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(c.Z,{name:"endTime",label:X.endTime,value:et.values.endTime,readOnly:!0,maxAccess:ea})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(O.Z,{name:"forceNoteCount",value:null===(a=et.values)||void 0===a?void 0:a.forceNoteCount,onChange:e=>et.setFieldValue("forceNoteCount",e.target.checked),label:X.forceNotesCount,maxAccess:ea,disabled:et.values.items&&((null===(D=et.values)||void 0===D?void 0:null===(t=D.items[0])||void 0===t?void 0:t.currencyId)||(null===(L=et.values)||void 0===L?void 0:null===(S=L.items[0])||void 0===S?void 0:S.currencyId))})})]})}),(0,l.jsx)(C.Q,{children:(0,l.jsx)(I._,{onChange:e=>et.setFieldValue("items",e),value:et.values.items,error:et.errors.items,name:"currency",maxAccess:ea,columns:[{component:"resourcecombobox",label:X.currency,name:"currencyId",props:{readOnly:Q||U,endpointId:f.r.Currency.qry,valueField:"recordId",displayField:"reference",mapping:[{from:"recordId",to:"currencyId"},{from:"reference",to:"currencyRef"},{from:"name",to:"currencyName"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:2},propsReducer(e){var a;let{row:t,props:l}=e;return{...l,readOnly:(null===(a=t.currencyNotes)||void 0===a?void 0:a.length)>0}},async onChange(e){let{row:{update:a,newRow:t}}=e;(null==t?void 0:t.currencyId)&&a({system:await es(null==t?void 0:t.currencyId)})}},{component:"numberfield",name:"counted",label:X.count,props:{readOnly:et.values.forceNoteCount||Q||U},async onChange(e){let{row:{update:a,newRow:t}}=e,l=t.counted||0,n=t.system||0;a({variation:l-n,flag:n===l})}},{component:"numberfield",label:X.system,name:"system",props:{readOnly:!0}},{component:"icon",label:X.flag,name:"flag"},{component:"button",name:"enabled",label:X.currencyNotes,props:{onCondition:e=>({disabled:!(null==e?void 0:e.currencyId)})},onClick:(e,a,t,l)=>{G({Component:R,props:{readOnly:Q||U,labels:X,maxAccess:ea,forceNoteCount:et.values.forceNoteCount,row:a,updateRow:l},width:700,title:null==X?void 0:X.currencyNotes})}}],allowDelete:!U||!Q&&!U})})]})})};L.width=1100,L.height=700;var _=L},57981:function(e,a,t){"use strict";var l=t(52322),n=t(2784),r=t(60218),d=t(48601),s=t(5088),o=t(82737),i=t(26612),u=t(8661),c=t(2119),m=t(65950),v=t(38449),p=t(71987),y=t(89330),h=t(62202),f=t(96026),x=t(7121),I=t(91088),g=t(76399),C=t(21581),D=t(30390),b=t(39812),S=t(31389),R=t(33625),q=t(62362),w=t(61802),P=t(80983),j=t(1251),F=t(26553),Z=t(30657),T=t(39704),N=t(98345),k=t(50023),O=t(21326);let A=e=>{var a,t,A,V;let{recordId:L,plantId:_,cashAccountId:M,dtId:E,refetch:J,window:B}=e,[H,Y]=(0,n.useState)(!!L),{getRequest:G,postRequest:U}=(0,n.useContext)(m.$),{stack:W}=(0,f.V)(),{stack:Q}=(0,w.zY)(),[$,z]=(0,n.useState)(!1),[K,X]=(0,n.useState)(!0),ee=(0,p.E)({endpointId:c.G.CashTransfer.page}),{labels:ea,access:et}=(0,k.Z)({datasetId:i.i.CashTransfer,editMode:!!L});(0,O.Z)({title:ea.cashTransfer,window:B});let[el,en]=(0,n.useState)({recordId:L||null,dtId:parseInt(E),reference:"",date:new Date,toPlantId:parseInt(_),fromPlantId:parseInt(_),fromCashAccountId:parseInt(M),toCashAccountId:"",baseAmount:"",notes:"",wip:"",status:"",statusName:"",releaseStatus:"",rsName:"",wipName:"",transfers:[{id:1,transferId:L||0,seqNo:"",currencyId:"",currencyName:"",currencyRef:"",amount:"",baseAmount:"",exRate:"",rateCalcMethod:"",balance:0}]}),{maxAccess:er}=(0,N.H)({functionId:x.J.CashTransfer,access:et,enabled:!L,hasDT:!1}),{formik:ed}=(0,P.c)({maxAccess:er,initialValues:el,validateOnChange:!0,validationSchema:d.Ry({fromCashAccountId:d.Z_().required(),fromPlantId:d.Z_().required(),date:d.Z_().required(),toPlantId:d.Z_().required(),toCashAccountId:d.Z_().nullable().test("",function(e){let{fromPlantId:a,toPlantId:t}=this.parent;return a!=t||!!e}),transfers:d.IX().of(d.Ry().shape({currencyName:d.Z_().required(),amount:d.Z_().nullable().required()})).required()}),onSubmit:async e=>{let a={...e};delete a.transfers,a.date=(0,b.ku)(a.date),a.status=""===a.status?1:a.status,a.wip=""===a.wip?1:a.wip,a.baseAmount=es;let t=ed.values.transfers.map((e,a)=>({...e,seqNo:a+1,transferId:ed.values.recordId||0}));if(1===t.length&&""===t[0].currencyId){W({message:"Grid not filled. Please fill the grid before saving."});return}let l=await U({extension:c.G.CashTransfer.set,record:JSON.stringify({header:a,items:t})});if(l.recordId){h.ZP.success("Record Updated Successfully"),ed.setFieldValue("recordId",l.recordId),Y(!0);let e=await G({extension:c.G.CashTransfer.get,parameters:"_recordId=".concat(l.recordId)});ed.setFieldValue("reference",e.record.reference),ee()}}}),es=ed.values.transfers.reduce((e,a)=>{var t;return e+(parseFloat(null===(t=a.baseAmount)||void 0===t?void 0:t.toString().replace(/,/g,""))||0)},0),eo=async()=>{let{transfers:e,...a}=ed.values,t={...a};if(t.date=(0,b.ku)(t.date),t.wip=""===t.wip?1:t.wip,t.status=""===t.status?1:t.status,t.baseAmount=es,(await U({extension:c.G.CashTransfer.close,record:JSON.stringify(t)})).recordId){var l;h.ZP.success("Record Closed Successfully"),ee(),z(!0);let e=await G({extension:c.G.CashTransfer.get,parameters:"_recordId=".concat(ed.values.recordId)});(null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.status)==4&&X(!1)}},ei=async()=>{let{transfers:e,...a}=ed.values,t={...a};t.date=(0,b.ku)(t.date),t.wip=""===t.wip?1:t.wip,t.status=""===t.status?1:t.status,t.baseAmount=es,(await U({extension:c.G.CashTransfer.reopen,record:JSON.stringify(t)})).recordId&&(h.ZP.success("Record Closed Successfully"),ee(),J&&(J(),B.close()),z(!1),X(!0))},eu=async(e,a)=>{let t=(await G({extension:c.G.CurrencyTransfer.qry,parameters:"_transferId=".concat(e)})).list.map(e=>{var a;return{...e,id:e.seqNo,amount:parseFloat(e.amount).toFixed(2),balance:null!==(a=parseFloat(null==e?void 0:e.balance).toFixed(2))&&void 0!==a?a:0}});ed.setValues({...a,transfers:t})},ec=async()=>{if(M){let e=await G({extension:c.G.CashAccount.get,parameters:"_recordId=".concat(M)});e.record&&(ed.setFieldValue("fromCARef",e.record.accountNo),ed.setFieldValue("fromCAName",e.record.name))}};(0,n.useEffect)(()=>{!async function(){if(L){let e=await G({extension:c.G.CashTransfer.get,parameters:"_recordId=".concat(L)});e.record.date=(0,b.a1)(e.record.date),z(2===e.record.wip),X(4!==e.record.status),await eu(L,e.record)}else ec()}()},[]);let em=[{key:"WorkFlow",condition:!0,onClick:async()=>{Q({Component:T.Z,props:{functionId:x.J.CashTransfer,recordId:ed.values.recordId}})},disabled:!H},{key:"Close",condition:!$,onClick:eo,disabled:$||!H},{key:"Reopen",condition:$,onClick:ei,disabled:!$||!H||3===ed.values.releaseStatus&&3===ed.values.status},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!$},{key:"Shipment",condition:!0,onClick:()=>{Q({Component:I.u,props:{recordId:ed.values.recordId,functionId:x.J.CashTransfer,editMode:$,totalBaseAmount:es}})},disabled:H&&ed.values.fromPlantId==ed.values.toPlantId||!H},{key:"Account Balance",condition:!0,onClick:"onClickAC",disabled:!1},{key:"Cash Transaction",condition:!0,onClick:"transactionClicked",disabled:!H}];return(0,l.jsx)(o.Z,{resourceId:i.i.CashTransfer,form:ed,editMode:H,maxAccess:er,functionId:x.J.CashTransfer,actions:em,disabledSubmit:$,children:(0,l.jsxs)(S.R,{children:[(0,l.jsx)(R.g,{children:(0,l.jsxs)(r.ZP,{container:!0,children:[(0,l.jsxs)(r.ZP,{container:!0,rowGap:2,xs:6,sx:{px:2},spacing:2,children:[(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(s.Z,{name:"reference",label:ea.reference,value:null==ed?void 0:null===(a=ed.values)||void 0===a?void 0:a.reference,maxAccess:er,maxLength:"15",readOnly:H,error:ed.touched.reference&&!!ed.errors.reference})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(u.Z,{endpointId:v.r.Plant.qry,name:"fromPlantId",label:ea.fromPlant,values:ed.values,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:!0,required:!0,maxAccess:er,onChange:(e,a)=>{ed&&ed.setFieldValue("fromPlantId",null==a?void 0:a.recordId)},error:ed.touched.fromPlantId&&!!ed.errors.fromPlantId})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(u.Z,{endpointId:c.G.CashAccount.qry,parameters:"_type=0",name:"fromCashAccountId",label:ea.fromCashAcc,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:ed.values,readOnly:!0,required:!0,maxAccess:er,onChange:(e,a)=>{ed.setFieldValue("fromCashAccountId",(null==a?void 0:a.recordId)||null)},error:ed.touched.fromCashAccountId&&!!ed.errors.fromCashAccountId})})]}),(0,l.jsxs)(r.ZP,{container:!0,rowGap:2,xs:6,sx:{px:2},spacing:2,children:[(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(y.Z,{name:"date",required:!0,readOnly:$,label:ea.date,value:null==ed?void 0:null===(t=ed.values)||void 0===t?void 0:t.date,onChange:ed.setFieldValue,editMode:H,maxAccess:er,onClear:()=>ed.setFieldValue("date",""),error:ed.touched.date&&!!ed.errors.date})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(u.Z,{endpointId:v.r.Plant.qry,name:"toPlantId",label:ea.toPlant,values:ed.values,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,readOnly:$,maxAccess:er,onChange:(e,a)=>{ed.setFieldValue("toPlantId",a?a.recordId:null),ed.setFieldValue("toCashAccountId",null),ed.setFieldValue("toCARef",null),ed.setFieldValue("toCAName",null)},error:ed.touched.toPlantId&&!!ed.errors.toPlantId})}),(0,l.jsx)(r.ZP,{item:!0,xs:12,children:(0,l.jsx)(u.Z,{endpointId:c.G.CashAccount.qry,parameters:"_type=0",name:"toCashAccountId",label:ea.toCashAcc,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:ed.values,required:ed.values.fromPlantId===ed.values.toPlantId,filter:e=>e.plantId===ed.values.toPlantId,readOnly:!ed.values.toPlantId||$,maxAccess:er,onChange:(e,a)=>{ed.setFieldValue("toCashAccountId",(null==a?void 0:a.recordId)||null)},error:ed.touched.toCashAccountId&&!!ed.errors.toCashAccountId})})]})]})}),(0,l.jsx)(q.Q,{children:(0,l.jsx)(g._,{onChange:e=>ed.setFieldValue("transfers",e),value:ed.values.transfers,error:ed.errors.transfers,allowDelete:!$,allowAddNewLine:!$,maxAccess:er,initialValues:null==ed?void 0:null===(V=ed.initialValues)||void 0===V?void 0:null===(A=V.transfers)||void 0===A?void 0:A[0],name:"currencies",columns:[{component:"resourcecombobox",label:ea.currency,name:"currencyName",props:{disabled:$,endpointId:v.r.Currency.qry,displayField:"reference",valueField:"recordId",mapping:[{from:"recordId",to:"currencyId"},{from:"name",to:"currencyName"},{from:"reference",to:"currencyRef"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}]},widthDropDown:200,displayFieldWidth:2,async onChange(e){let{row:{update:a,newRow:t}}=e;if((null==t?void 0:t.currencyId)&&t.currencyId){var l,n,r;let e=await (r=null==t?void 0:t.currencyId,G({extension:j.q.Currency.get,parameters:"_currencyId=".concat(r,"&_date=").concat((0,b.Uf)(ed.values.date),"&_rateDivision=").concat(F.B.FINANCIALS)}));a({exRate:null===(l=e.record)||void 0===l?void 0:l.exRate,rateCalcMethod:null===(n=e.record)||void 0===n?void 0:n.rateCalcMethod})}}},{component:"numberfield",label:ea.amount,name:"amount",props:{readOnly:$},async onChange(e){let{row:{update:a,newRow:t}}=e;(null==t?void 0:t.amount)&&(null==t?void 0:t.amount)&&a({baseAmount:(0,Z.fB)({amount:null==t?void 0:t.amount,exRate:null==t?void 0:t.exRate,baseAmount:null==t?void 0:t.baseAmount,rateCalcMethod:null==t?void 0:t.rateCalcMethod,dirtyField:Z.H9}).baseAmount})}},{component:"numberfield",label:ea.baseAmount,name:"baseAmount",props:{readOnly:!0}},{component:"numberfield",name:"balance",label:ea.balance,props:{readOnly:!0}}]})}),(0,l.jsx)(R.g,{children:(0,l.jsx)(D.Z,{container:!0,rowGap:1,xs:7,style:{marginTop:"10px"},children:(0,l.jsx)(C.Z,{name:"notes",label:ea.note,value:ed.values.notes,rows:3,readOnly:$,maxLength:"100",editMode:H,maxAccess:er,onChange:e=>ed.setFieldValue("notes",e.target.value),onClear:()=>ed.setFieldValue("notes","")})})})]})})};A.width=1100,A.height=650,a.Z=A},47441:function(e,a,t){"use strict";var l=t(52322),n=t(89330),r=t(39812),d=t(60218),s=t(95453),o=t(37691),i=t(6640),u=t(2784),c=t(96026),m=t(48601),v=t(82737),p=t(62202),y=t(65950),h=t(71987),f=t(26612),x=t(5088),I=t(21581),g=t(8661),C=t(38449),D=t(7121),b=t(53621),S=t(17627),R=t(24074),q=t(27423),w=t(61802),P=t(58974),j=t(50023),F=t(23361),Z=t(80983),T=t(30390),N=t(39704),k=t(76399),O=t(31389),A=t(33625),V=t(62362),L=t(19473),_=t(98345),M=t(96333),E=t(91088),J=t(21326),B=t(67920),H=t(91406),Y=t(1685);let G=e=>{var a,t,G,U,W,Q,$,z,K,X,ee,ea,et,el,en;let{recordId:er,window:ed}=e,{platformLabels:es,userDefaultsData:eo}=(0,u.useContext)(L.l),{getRequest:ei,postRequest:eu}=(0,u.useContext)(y.$),{stack:ec}=(0,c.V)(),[em,ev]=(0,u.useState)(D.J.CurrencyCreditOrderPurchase),[ep,ey]=(0,u.useState)(null),{stack:eh}=(0,w.zY)(),ef=(0,Y.m)("userData").userId,ex=parseInt(null==eo?void 0:null===(t=eo.list)||void 0===t?void 0:null===(a=t.find(e=>{let{key:a}=e;return"plantId"===a}))||void 0===a?void 0:a.value),{labels:eI,access:eg}=(0,j.Z)({datasetId:f.i.CreditOrder,editMode:!!er});(0,J.Z)({title:eI.creditOrder,window:ed});let{maxAccess:eC}=(0,_.H)({functionId:em,access:eg,enabled:!er,hasDT:!1}),eD=(0,h.E)({endpointId:S.s.CreditOrder.page}),{schema:eb,requiredFields:eS}=(0,B.m)({currencyRef:e=>null==e?void 0:e.currencyRef,currencyName:e=>null==e?void 0:e.currencyName,qty:e=>null==e?void 0:e.qty,exRate:e=>null==e?void 0:e.exRate,amount:e=>null==e?void 0:e.amount},!0,eC,"rows"),{formik:eR}=(0,Z.c)({maxAccess:eC,initialValues:{recordId:er,currencyId:null,currencyRef:"",date:new Date,functionId:D.J.CurrencyCreditOrderPurchase,deliveryDate:new Date,reference:"",dtId:null,plantId:parseInt(ex),corId:null,corRef:"",corName:"",wip:1,status:1,releaseStatus:"",notes:"",amount:0,baseAmount:0,exRate:1,rateCalcMethod:"",rateType:"",isTFRClicked:!1,rows:[{id:1,orderId:er||null,seqNo:"",currencyId:null,qty:"",rateCalcMethod:"",exRate:"",minRate:"",maxRate:"",defaultRate:"",amount:"",baseAmount:"",notes:"",goc:!1}]},validateOnChange:!0,validationSchema:m.Ry({date:m.Z_().required(),plantId:m.Z_().required(),corId:m.Z_().required(),rows:m.IX().of(eb)}),onSubmit:async e=>{var a;let t={...e,date:(0,r.ku)(e.date),deliveryDate:(0,r.ku)(e.deliveryDate),amount:eT,baseAmount:eN};delete t.rows;let l=null===(a=eR.values.rows.filter(e=>{var a;return null===(a=Object.values(eS))||void 0===a?void 0:a.every(a=>a(e))}))||void 0===a?void 0:a.map((e,a)=>({...e,seqNo:a+1,orderId:eR.values.recordId||0})),n=await eu({extension:S.s.CreditOrder.set,record:JSON.stringify({header:t,items:l})}),d=e.recordId?es.Edited:es.Added;p.ZP.success(d),await eY(null==n?void 0:n.recordId),eD()}}),eq=2==eR.values.wip,ew=3===eR.values.releaseStatus&&3!==eR.values.status,eP=!!eR.values.recordId,ej=async()=>{let e=await eu({extension:S.s.CreditOrder.close,record:JSON.stringify(eR.values)});p.ZP.success(es.Closed),eD(),eY(null==e?void 0:e.recordId)},eF=async()=>{let e=await eu({extension:S.s.CreditOrder.reopen,record:JSON.stringify(eR.values)});p.ZP.success(es.Closed),eD(),eY(null==e?void 0:e.recordId)},eZ=async()=>{let e=await eu({extension:S.s.CreditOrder.tfr,record:JSON.stringify(eR.values)});p.ZP.success(es.Generated),eD(),await eY(eR.values.recordId),ed.close(),eh({Component:P.Z,props:{recordId:null==e?void 0:e.recordId}})},eT=(null==eR?void 0:null===(U=eR.values)||void 0===U?void 0:null===(G=U.rows)||void 0===G?void 0:G.length)?eR.values.rows.reduce((e,a)=>{var t;return e+(parseFloat(null===(t=a.amount)||void 0===t?void 0:t.toString().replace(/,/g,""))||0)},0):0,eN=(null==eR?void 0:null===(Q=eR.values)||void 0===Q?void 0:null===(W=Q.rows)||void 0===W?void 0:W.length)?eR.values.rows.reduce((e,a)=>{var t;return e+(parseFloat(null===(t=a.baseAmount)||void 0===t?void 0:t.toString().replace(/,/g,""))||0)},0):0,ek=async(e,a,t)=>{var l,n,r,d;if(!e)return;let s=await ei({extension:b.d.Correspondent.get,parameters:"_recordId=".concat(e)});eR.setFieldValue("currencyId",(null==s?void 0:null===(l=s.record)||void 0===l?void 0:l.currencyId)||null),eR.setFieldValue("currencyRef",(null==s?void 0:null===(n=s.record)||void 0===n?void 0:n.currencyRef)||"");let o=await ei({extension:R.u.Defaults.get,parameters:"_key=ct_credit_eval_ratetype_id"});eA(t,null==s?void 0:null===(r=s.record)||void 0===r?void 0:r.currencyId,a,null==o?void 0:null===(d=o.record)||void 0===d?void 0:d.value)},eO=async e=>{var a;let t=await ei({extension:C.r.UserFunction.get,parameters:"_userId=".concat(ef,"&_functionId=").concat(e)});eR.setFieldValue("dtId",null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.dtId)};async function eA(e,a,t,l){var n,r,d,s,o;if(!e||!a||!l||!t){e||ec({message:eI.emptyPlant}),a||(eR.setFieldValue("corId",null),eR.setFieldValue("corRef",""),eR.setFieldValue("corName",""),ec({message:eI.emptyToCurrency})),l||ec({message:eI.emptyRate}),t||ec({message:eI.emptyFromCurrency});return}let i=await ei({extension:R.u.ExchangeMap.get,parameters:"_plantId=".concat(e,"&_currencyId=").concat(a,"&_raCurrencyId=").concat(t,"&_rateTypeId=").concat(l)});if(!(null==i?void 0:null===(n=i.record)||void 0===n?void 0:n.rate)){ec({message:eI.undefinedCorRate});return}eR.setFieldValue("currencyId",a),eR.setFieldValue("exRate",null==i?void 0:null===(r=i.record)||void 0===r?void 0:r.rate),eR.setFieldValue("rateCalcMethod",null==i?void 0:null===(d=i.record)||void 0===d?void 0:d.rateCalcMethod),eR.setFieldValue("minRate",null==i?void 0:null===(s=i.record)||void 0===s?void 0:s.minRate),eR.setFieldValue("maxRate",null==i?void 0:null===(o=i.record)||void 0===o?void 0:o.maxRate)}async function eV(e){for(let a in e)if(!e[a]){ec({message:"".concat(a," ").concat(eI.empty)});return}let a=await ei({extension:R.u.ExchangeMap.get,parameters:"_plantId=".concat(e.plantId,"&_currencyId=").concat(e.fromCurrency,"&_raCurrencyId=").concat(e.toCurrency,"&_rateTypeId=").concat(e.rateType)});return null==a?void 0:a.record}let eL=[{component:"resourcecombobox",label:eI.currency,name:"currencyRef",flex:2,props:{endpointId:C.r.Currency.qry,displayField:"reference",valueField:"recordId",mapping:[{from:"recordId",to:"currencyId"},{from:"reference",to:"currencyRef"},{from:"name",to:"currencyName"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:3},async onChange(e){var a,t,l;let{row:{update:n,oldRow:r,newRow:d}}=e;if(!(null==d?void 0:d.currencyId))return;let s=await eV({plantId:ex||eR.values.plantId,toCurrency:null==eR?void 0:null===(a=eR.values)||void 0===a?void 0:a.currencyId,fromCurrency:null==d?void 0:d.currencyId,rateType:null==eR?void 0:null===(t=eR.values)||void 0===t?void 0:t.rateType});if(!(null==s?void 0:s.rate)){n({exRate:0,defaultRate:0,amount:0,baseAmount:0}),ec({message:"".concat(eI.undefinedRate," ").concat(null==d?void 0:d.currencyRef,".")});return}let o=0,i=0;if(null==d?void 0:d.qty){let e=parseFloat(null==d?void 0:null===(l=d.qty)||void 0===l?void 0:l.toString().replace(/,/g,""))||0,a=1===s.rateCalcMethod?e*s.rate:2===s.rateCalcMethod?e/s.rate:0;o=parseFloat(a).toFixed(2),i=parseFloat(1===eR.values.rateCalcMethod?a*eR.values.exRate:2===eR.values.rateCalcMethod?a/eR.values.exRate:0).toFixed(2)}let u=await e_(null==d?void 0:d.currencyId);n({currencyId:s.currencyId,currencyName:s.currencyName,exRate:s.rate.toFixed(7),defaultRate:s.rate.toFixed(7),rateCalcMethod:s.rateCalcMethod,minRate:s.minRate,maxRate:s.maxRate,goc:(null==u?void 0:u.goc)||!1,amount:o,baseAmount:i})}},{component:"textfield",label:eI.name,name:"currencyName",props:{readOnly:!0},flex:3},{component:"numberfield",label:eI.quantity,name:"qty",flex:2,updateOn:"blur",async onChange(e){var a,t;let{row:{update:l,newRow:n}}=e,r=n.rateCalcMethod,d=1===r?parseFloat(null==n?void 0:null===(a=n.qty)||void 0===a?void 0:a.toString().replace(/,/g,""))*(null==n?void 0:n.exRate):2===r?parseFloat(null==n?void 0:null===(t=n.qty)||void 0===t?void 0:t.toString().replace(/,/g,""))/(null==n?void 0:n.exRate):0,s=1===eR.values.rateCalcMethod?parseFloat(d)*eR.values.exRate:2===r?parseFloat(d)/eR.values.exRate:0;l({amount:parseFloat(d).toFixed(2),baseAmount:parseFloat(s).toFixed(2),qty:parseFloat(null==n?void 0:n.qty).toFixed(2)})}},{component:"numberfield",label:eI.defaultRate,name:"defaultRate",props:{readOnly:!0},flex:2},{component:"numberfield",label:eI.exRate,name:"exRate",props:{decimalScale:7},flex:2,updateOn:"blur",async onChange(e){let{row:{update:a,newRow:t}}=e;if(!t.currencyId||!t.exRate){a({exRate:"",defaultRate:"",amount:0,baseAmount:0});return}let l=e=>parseFloat(null==e?void 0:e.toString().replace(/,/g,""))||0,n=l(t.exRate);if(n>0){let e=l(t.minRate),r=l(t.maxRate);if(n>=e&&n<=r){let e=l(t.qty),r=t.rateCalcMethod,d=1===r?e*n:2===r?e/n:0,s=1===eR.values.rateCalcMethod?d*eR.values.exRate:2===eR.values.rateCalcMethod?d/eR.values.exRate:0;a({exRate:n.toFixed(7),amount:d.toFixed(2),baseAmount:s.toFixed(2)})}else ec({message:"".concat(n," ").concat(eI.invalidRange," [").concat(e,"-").concat(r,"]")}),a({exRate:"",amount:0,baseAmount:0})}}},{component:"numberfield",label:"".concat(eI.total," ").concat(eR.values.currencyRef||""),name:"amount",props:{readOnly:!0},flex:2}];async function e_(e){if(!e)return;let a=await ei({extension:b.d.CorrespondentCurrency.get,parameters:"_corId=".concat(eR.values.corId,"&_currencyId=").concat(e)});return null==a?void 0:a.record}let eM=async e=>{var a;let t=await ei({extension:S.s.CreditOrderItem.qry,parameters:"_orderId=".concat(e)});return(null==t?void 0:null===(a=t.list)||void 0===a?void 0:a.length)>0?t.list.map((e,a)=>({...e,id:a+1,qty:parseFloat(null==e?void 0:e.qty).toFixed(2),amount:parseFloat(null==e?void 0:e.amount).toFixed(2),baseAmount:parseFloat(null==e?void 0:e.baseAmount).toFixed(2),exRate:parseFloat(null==e?void 0:e.exRate).toFixed(7),defaultRate:parseFloat(null==e?void 0:e.defaultRate).toFixed(7)})):eR.initialValues.rows};async function eE(e){if(e==D.J.CurrencyCreditOrderPurchase||e==D.J.CurrencyCreditOrderSale){var a;let t=await ei({extension:R.u.Defaults.get,parameters:e==D.J.CurrencyCreditOrderPurchase?"_key=ct_credit_purchase_ratetype_id":e==D.J.CurrencyCreditOrderSale?"_key=ct_credit_sales_ratetype_id":""});eR.setFieldValue("rateType",null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.value),eR.setFieldValue("functionId",e)}}async function eJ(){var e,a;let t=await ei({extension:C.r.Defaults.get,parameters:"_key=baseCurrencyId"});return await eB(null==t?void 0:null===(e=t.record)||void 0===e?void 0:e.value),null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.value}let eB=async e=>{ei({extension:C.r.Currency.get,parameters:"_recordId=".concat(e)}).then(e=>{var a;ey(null==e?void 0:null===(a=e.record)||void 0===a?void 0:a.reference)})};async function eH(e){return await await ei({extension:S.s.CreditOrder.get,parameters:"_recordId=".concat(e)})}async function eY(e){let a=await eH(e),t=await eM(e);eR.setValues(e=>{var l;return{...e,...a.record,date:(0,r.a1)(a.record.date),deliveryDate:(null==a?void 0:null===(l=a.record)||void 0===l?void 0:l.deliveryDate)?(0,r.a1)(a.record.deliveryDate):null,rows:t}}),await eE(a.record.functionId)}let eG=async()=>{eh({Component:N.Z,props:{functionId:eR.values.functionId,recordId:eR.values.recordId}})},eU=[{key:"Close",condition:!eq,onClick:ej,disabled:eq||!eP},{key:"Reopen",condition:eq,onClick:eF,disabled:!eq||!eP||3===eR.values.releaseStatus&&3===eR.values.status},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!eq},{key:"Invoice",condition:eZ,onClick:()=>{eh({Component:F.Z,props:{DialogText:eI.transferMessage,fullScreen:!1,okButtonAction:eZ},width:400,height:150,title:""})},disabled:!ew},{key:"WorkFlow",condition:!0,onClick:eG,disabled:!eP},{key:"Shipment",condition:!0,onClick:()=>{eh({Component:E.u,props:{recordId:eR.values.recordId,functionId:eR.values.functionId,editMode:1!=eR.values.status,totalBaseAmount:eN}})},disabled:!eP},{key:"Transportation",condition:!0,onClick:()=>{eh({Component:M.R,props:{recordId:eR.values.recordId,functionId:eR.values.functionId,editMode:1!=eR.values.status}})},disabled:!eP}];return(0,u.useEffect)(()=>{!async function(){er?(await eY(er),await eJ()):(await eE(D.J.CurrencyCreditOrderPurchase),await eO(D.J.CurrencyCreditOrderPurchase))}()},[]),(0,l.jsx)(v.Z,{resourceId:f.i.CreditOrder,form:eR,maxAccess:eC,editMode:eP,actions:eU,previewReport:eP,disabledSubmit:eq,children:(0,l.jsxs)(O.R,{children:[(0,l.jsx)(A.g,{children:(0,l.jsxs)(d.ZP,{container:!0,xs:12,spacing:2,children:[(0,l.jsx)(T.Z,{hideonempty:!0,item:!0,xs:4,children:(0,l.jsx)(n.Z,{name:"date",required:!0,readOnly:eq,label:eI.date,value:null==eR?void 0:null===($=eR.values)||void 0===$?void 0:$.date,onChange:eR.setFieldValue,maxAccess:eC,onClear:()=>eR.setFieldValue("date",null),error:eR.touched.date&&!!eR.errors.date})}),(0,l.jsx)(d.ZP,{item:!0,xs:4,children:(0,l.jsx)(g.Z,{endpointId:C.r.Plant.qry,name:"plantId",label:eI.plant,readOnly:!0,values:eR.values,valueField:"recordId",displayField:["reference","name"],required:!0,maxAccess:eC,onChange:(e,a)=>{eR.setFieldValue("plantId",(null==a?void 0:a.recordId)||null)},error:eR.touched.plantId&&!!eR.errors.plantId})}),(0,l.jsx)(d.ZP,{item:!0,xs:4,children:(0,l.jsx)(x.Z,{name:"reference",label:eI.reference,value:null==eR?void 0:null===(z=eR.values)||void 0===z?void 0:z.reference,maxAccess:eC,maxLength:"30",readOnly:eP,onChange:eR.handleChange,onClear:()=>eR.setFieldValue("reference",""),error:eR.touched.reference&&!!eR.errors.reference})}),(0,l.jsx)(d.ZP,{item:!0,xs:8,children:(0,l.jsx)(q.U,{endpointId:b.d.Correspondent.snapshot,valueField:"reference",displayField:"name",name:"corId",label:eI.correspondent,form:eR,required:!0,firstFieldWidth:4,displayFieldWidth:3,valueShow:"corRef",secondValueShow:"corName",readOnly:eq||(null==eR?void 0:null===(X=eR.values)||void 0===X?void 0:null===(K=X.rows)||void 0===K?void 0:K.some(e=>!!e.currencyId)),maxAccess:eC,onChange:async(e,a)=>{if(a){let e=await eJ();ek(null==a?void 0:a.recordId,e,eR.values.plantId)}eR.setFieldValue("corName",a?a.name:""),eR.setFieldValue("corRef",a?a.reference:""),eR.setFieldValue("corId",a?a.recordId:null)},errorCheck:"corId"})}),(0,l.jsx)(d.ZP,{item:!0,xs:4,children:(0,l.jsx)(n.Z,{name:"deliveryDate",readOnly:eq,label:eI.deliveryDate,value:null==eR?void 0:null===(ee=eR.values)||void 0===ee?void 0:ee.deliveryDate,onChange:eR.setFieldValue,maxAccess:eC,disabledRangeDate:{date:eR.values.date,day:30},onClear:()=>eR.setFieldValue("deliveryDate",null),error:eR.touched.deliveryDate&&!!eR.errors.deliveryDate})}),(0,l.jsx)(d.ZP,{item:!0,xs:6,children:(0,l.jsxs)(s.Z,{row:!0,value:eR.values.functionId,defaultValue:D.J.CurrencyCreditOrderPurchase,onChange:async e=>{await eE(e.target.value),await eO(e.target.value),ev(e.target.value),eR.setFieldValue("reference","")},children:[(0,l.jsx)(o.Z,{value:D.J.CurrencyCreditOrderPurchase,control:(0,l.jsx)(i.Z,{}),label:eI.purchase,disabled:null==eR?void 0:null===(et=eR.values)||void 0===et?void 0:null===(ea=et.rows)||void 0===ea?void 0:ea.some(e=>!!e.currencyId)}),(0,l.jsx)(o.Z,{value:D.J.CurrencyCreditOrderSale,control:(0,l.jsx)(i.Z,{}),label:eI.sale,disabled:null==eR?void 0:null===(en=eR.values)||void 0===en?void 0:null===(el=en.rows)||void 0===el?void 0:el.some(e=>!!e.currencyId)})]})})]})}),(0,l.jsx)(V.Q,{children:(0,l.jsx)(k._,{onChange:e=>eR.setFieldValue("rows",e),disabled:!eR.values.corId||eq,value:eR.values.rows,name:"rows",error:eR.errors.rows,columns:eL,allowAddNewLine:!eq,maxAccess:eC,allowDelete:!eq,bg:eR.values.functionId&&(eR.values.functionId!=D.J.CurrencyCreditOrderPurchase?"#C7F6C7":"rgb(245, 194, 193)")})}),(0,l.jsx)(A.g,{children:(0,l.jsxs)(d.ZP,{container:!0,spacing:2,xs:12,children:[(0,l.jsx)(T.Z,{item:!0,xs:8,children:(0,l.jsx)(I.Z,{name:"notes",label:eI.notes,value:eR.values.notes,rows:3,maxAccess:eC,readOnly:eq,onChange:e=>eR.setFieldValue("notes",e.target.value),onClear:()=>eR.setFieldValue("notes",""),error:eR.touched.notes&&!!eR.errors.notes})}),(0,l.jsx)(d.ZP,{item:!0,xs:4,children:(0,l.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(H.Z,{name:"totalCUR",label:"".concat(eI.total," ").concat(eR.values.currencyRef||""),value:eT,readOnly:!0,align:"right"})}),(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(H.Z,{name:"baseAmount",label:"".concat(eI.total," ").concat(ep||""),value:eN,readOnly:!0,align:"right"})})]})})]})})]})})};G.width=1e3,G.height=650,a.Z=G},23476:function(e,a,t){"use strict";t.d(a,{Z:function(){return J}});var l=t(52322),n=t(29326),r=t(9522),d=t(2784),s=t(60218),o=t(48601),i=t(82737),u=t(62202),c=t(65950),m=t(26612),v=t(80983),p=t(62362),y=t(31389),h=t(19473),f=t(71987),x=t(76426),I=t(8661),g=t(38449),C=t(21581),D=t(84100),b=t(27423),S=t(22341),R=t(89330),q=t(98345),w=t(7121),P=t(5088),j=t(39704),F=t(39812),Z=t(61802),T=t(19689);function N(e){var a,t,n,r;let{labels:N,maxAccess:k,setStore:O,store:A,plantId:V}=e,{recordId:L}=A,{getRequest:_,postRequest:M}=(0,d.useContext)(c.$),{platformLabels:E}=(0,d.useContext)(h.l),{stack:J}=(0,Z.zY)(),B=!!A.recordId,H=(0,f.E)({endpointId:x.x.StockCount.qry}),{documentType:Y,maxAccess:G,changeDT:U}=(0,q.H)({functionId:w.J.StockCount,access:k}),{formik:W}=(0,v.c)({documentType:{key:"dtId",value:null==Y?void 0:Y.dtId},initialValues:{recordId:L||null,reference:null,dtId:null,date:new Date,plantId:parseInt(V),notes:"",type:1,clientId:null,currencyId:null,genVar:1,wip:1,status:1,disableItemDuplicate:!1},maxAccess:G,validateOnChange:!0,validationSchema:o.Ry({genVar:o.Z_().required(),plantId:o.Rx().required(),clientId:o.Z_().nullable().test("",function(e){let{type:a}=this.parent;return 2!==a&&"2"!==a||!!e}),currencyId:o.Z_().nullable().test("",function(e){let{type:a}=this.parent;return 2!==a&&"2"!==a||!!e})}),onSubmit:async e=>{let a=await M({extension:x.x.StockCount.set,record:JSON.stringify(e)});if(e.recordId)u.ZP.success(E.Edited);else{O(e=>({...e,recordId:a.recordId})),u.ZP.success(E.Added),W.setFieldValue("recordId",a.recordId);let e=await $(a.recordId);W.setValues({...e.record,date:(0,F.a1)(e.record.date)})}H()}}),Q=async()=>{J({Component:j.Z,props:{functionId:w.J.StockCount,recordId:W.values.recordId}})};async function $(e){return await _({extension:x.x.StockCount.get,parameters:"_recordId=".concat(e)})}async function z(e){let a=await $(e);return a.record.date=(0,F.a1)(a.record.date),a}let K=2===W.values.wip,X=3===W.values.status,ee=async e=>{let a=await M({extension:x.x.StockCount.close,record:JSON.stringify({recordId:e})});u.ZP.success(E.Closed),H();let t=await z(a.recordId);W.setValues(t.record),O(e=>({...e,isClosed:2===t.record.wip}))},ea=[{key:"WorkFlow",condition:!0,onClick:Q,disabled:!B},{key:"Close",condition:!K,onClick:()=>ee(W.values.recordId),disabled:X||K||!B},{key:"Reopen",condition:K,onClick:async function(){let e=await M({extension:x.x.StockCount.reopen,record:JSON.stringify(W.values)});u.ZP.success(E.Reopened),H();let a=await z(e.recordId);W.setValues(a.record),O(e=>({...e,isClosed:2===a.record.wip}))},disabled:!K||X},{key:"Unlocked",condition:!X,onClick:async()=>{let e={...W.values};e.date=(0,F.ku)(e.date);let a=await M({extension:x.x.StockCount.post,record:JSON.stringify(e)});u.ZP.success(E.Posted),H();let t=await z(a.recordId);W.setValues(t.record),O(e=>({...e,isPosted:3===t.record.status}))},disabled:!B||!K},{key:"Locked",condition:X,onClick:"onUnpostConfirmation",onSuccess:async()=>{let e={...W.values};e.date=(0,F.ku)(e.date);let a=await M({extension:x.x.StockCount.unpost,record:JSON.stringify(e)});u.ZP.success(E.Unposted),H();let t=await z(a.recordId);W.setValues(t.record),O(e=>({...e,isPosted:3!==t.record.status}))},disabled:!B||!K}];return(0,d.useEffect)(()=>{!async function(){if(L){let e=await $(L);O(a=>({...a,isPosted:3===e.record.status,isClosed:2===e.record.wip})),W.setValues({...e.record,date:(0,F.a1)(e.record.date)})}}()},[]),(0,l.jsx)(i.Z,{resourceId:m.i.StockCounts,form:W,maxAccess:G,editMode:B,actions:ea,disabledSubmit:X||K,disableSubmitAndClear:X||K,children:(0,l.jsx)(y.R,{children:(0,l.jsx)(p.Q,{children:(0,l.jsxs)(s.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:g.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(w.J.StockCount),name:"dtId",readOnly:B||X||K,label:N.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:W.values,maxAccess:G,onChange:(e,a)=>{U(a),W&&W.setFieldValue("dtId",null==a?void 0:a.recordId)},error:W.touched.dtId&&!!W.errors.dtId})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(P.Z,{name:"reference",label:N.reference,value:null==W?void 0:null===(a=W.values)||void 0===a?void 0:a.reference,maxAccess:!B&&G,maxLength:"30",readOnly:B||X||K,onChange:W.handleChange,error:W.touched.reference&&!!W.errors.reference})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(R.Z,{name:"date",label:N.date,value:null===(t=W.values)||void 0===t?void 0:t.date,onChange:W.setFieldValue,onClear:()=>W.setFieldValue("date",""),readOnly:B||X||K,error:W.touched.date&&!!W.errors.date,maxAccess:G})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:g.r.Plant.qry,name:"plantId",label:N.plant,required:!0,valueField:"recordId",readOnly:B||X||K,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:W.values,onChange:(e,a)=>{W.setFieldValue("plantId",a?null==a?void 0:a.recordId:null)},error:W.touched.plantId&&!!W.errors.plantId})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"notes",type:"text",label:N.notes,value:null===(n=W.values)||void 0===n?void 0:n.notes,rows:3,readOnly:X||K,maxAccess:G,onChange:e=>W.setFieldValue("notes",e.target.value),onClear:()=>W.setFieldValue("notes",""),error:W.touched.notes&&!!W.errors.notes})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{datasetId:D.v.SC_TYPE,name:"type",label:N.type,values:W.values,valueField:"key",displayField:"value",readOnly:B||X||K,maxAccess:G,onChange:(e,a)=>{W&&W.setFieldValue("type",a?a.key:"")},error:W.touched.type&&!!W.errors.type})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.U,{endpointId:S.P.Client.snapshot,parameters:{_category:0},valueField:"reference",displayField:"name",name:"clientId",label:N.client,form:W,readOnly:B||X||K||"1"===W.values.type||1===W.values.type,required:"2"===W.values.type||2===W.values.type,displayFieldWidth:2,valueShow:"clientRef",secondValueShow:"clientName",maxAccess:G,columnsInDropDown:[{key:"reference",value:"Ref."},{key:"name",value:"Name"}],onChange:async(e,a)=>{W.setFieldValue("clientId",a?a.recordId:""),W.setFieldValue("clientName",a?a.name:""),W.setFieldValue("clientRef",a?a.reference:"")},errorCheck:"clientId"})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:g.r.Currency.qry,name:"currencyId",label:N.currency,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:W.values,readOnly:B||X||K||"1"===W.values.type||1===W.values.type,required:"2"===W.values.type||2===W.values.type,maxAccess:G,onChange:(e,a)=>{W.setFieldValue("currencyId",(null==a?void 0:a.recordId)||0)},error:W.touched.currencyId&&!!W.errors.currencyId})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{datasetId:D.v.GENERATE_VARIATIONS,name:"genVar",label:N.generateVariations,values:W.values,valueField:"key",displayField:"value",readOnly:B||X||K,maxAccess:G,onChange:(e,a)=>{W&&W.setFieldValue("genVar",a?a.key:"")},required:!0,error:W.touched.genVar&&!!W.errors.genVar})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(T.Z,{name:"disableItemDuplicate",value:null===(r=W.values)||void 0===r?void 0:r.disableItemDuplicate,onChange:e=>W.setFieldValue("disableItemDuplicate",e.target.checked),label:N.disableItemDuplicate,maxAccess:G})})]})})})})}var k=t(33625),O=t(76399),A=t(54074),V=e=>{let{store:a,maxAccess:t,labels:n,setRefreshController:r,refreshController:s}=e,{recordId:o,isPosted:i,isClosed:m}=a,{getRequest:f,postRequest:I}=(0,d.useContext)(c.$),{platformLabels:g}=(0,d.useContext)(h.l),{formik:C}=(0,v.c)({maxAccess:t,validateOnChange:!0,initialValues:{search:"",rows:[]},onSubmit:async()=>{let e=C.values.rows.map((e,a)=>({...e,id:a+1,status:e.status||1})).filter(e=>e.isChecked);await I({extension:x.x.Sites.set2,record:JSON.stringify({stockCountId:o,sites:e})}),await D(o),r(!s),u.ZP.success(g.Updated),C.setFieldValue("search","")}}),D=async e=>{if(e){let a=(await f({extension:x.x.Sites.qry,parameters:"_stockCountId=".concat(e)})).list.map((e,a)=>({...e,id:a+1}));C.setValues({rows:a})}},b=C.values.search?C.values.rows.filter(e=>e.siteRef&&e.siteRef.toString().includes(C.values.search.toLowerCase())||e.siteName&&e.siteName.toLowerCase().includes(C.values.search.toLowerCase())):C.values.rows,S=[{component:"checkbox",label:" ",name:"isChecked",flex:1,props:{disabled:i||m}},{component:"textfield",name:"siteRef",label:n.siteRef,flex:1,props:{readOnly:!0}},{component:"textfield",name:"siteName",label:n.name,flex:1,props:{readOnly:!0}},{component:"textfield",name:"statusName",label:n.statusName,flex:1,props:{readOnly:!0}},{component:"textfield",name:"notes",label:n.notes,flex:2,props:{readOnly:!1},propsReducer(e){let{row:a,props:t}=e;return{...t,readOnly:"Processed"===a.statusName||i||m}}}];return(0,d.useEffect)(()=>{!async function(){o&&await D(o)}()},[o]),(0,l.jsx)(A.Z,{onSave:C.handleSubmit,maxAccess:t,disabledSubmit:m,children:(0,l.jsx)(y.R,{children:(0,l.jsxs)(p.Q,{children:[(0,l.jsx)(k.g,{children:(0,l.jsx)(P.Z,{name:"search",value:C.values.search,label:n.search,readOnly:i||m,onClear:()=>{C.setFieldValue("search",""),D()},sx:{width:"30%"},onChange:e=>{let{value:a}=e.target;C.setFieldValue("search",a)}})}),(0,l.jsx)(p.Q,{children:(0,l.jsx)(O._,{onChange:e=>(function(e){let a=C.values.rows.map(a=>e.find(e=>e.id===a.id)||a);C.setFieldValue("rows",a)})(e),value:b,error:C.errors.rows,columns:S,allowAddNewLine:!1,allowDelete:!1})})]})})})},L=e=>{let{store:a,maxAccess:t,labels:n}=e,{recordId:r,isPosted:s,isClosed:i}=a,{getRequest:m,postRequest:f}=(0,d.useContext)(c.$),{platformLabels:g}=(0,d.useContext)(h.l),{formik:C}=(0,v.c)({maxAccess:t,validateOnChange:!0,initialValues:{stockCountId:"",siteId:null,rows:[]},validationSchema:o.Ry({siteId:o.Rx().required()}),onSubmit:async()=>{let e=C.values.rows.map((e,a)=>({...e,id:a+1,status:e.status||1,controllerId:e.recordId,siteId:C.values.siteId,stockCountId:r})).filter(e=>e.isChecked),a={stockCountId:r,siteId:C.values.siteId,items:e};if(await f({extension:x.x.StockCountControllerTab.set2,record:JSON.stringify(a)}),u.ZP.success(g.Updated),C.values.siteId){let e=await D(r,C.values.siteId);C.setValues({rows:e.list})}}}),D=async(e,a)=>{var t;let l=await m({extension:x.x.Controller.qry,parameters:"_siteId=".concat(a)}),n=await m({extension:x.x.StockCountControllerTab.qry,parameters:"_siteId=".concat(a,"&_stockCountId=").concat(e)});l.list.map((e,a)=>{let t=n.list.find(a=>a.controllerId===e.recordId);return t&&(e.isChecked=!0,e.statusName=t.statusName,e.status=t.status),{...e,id:a+1}}),l.list=null==l?void 0:null===(t=l.list)||void 0===t?void 0:t.map((e,a)=>({...e,id:a,isChecked:(null==e?void 0:e.isChecked)!==void 0&&(null==e?void 0:e.isChecked)})),C.setFieldValue("stockCountId",e),C.setValues({rows:l.list}),C.setFieldValue("siteId",a)},b=[{component:"checkbox",label:" ",name:"isChecked",flex:.2,props:{disabled:s||i}},{component:"textfield",name:"name",label:n.name,flex:1,props:{readOnly:!0}},{component:"textfield",name:"statusName",label:n.statusName,flex:1,props:{readOnly:!0}}];return(0,l.jsx)(A.Z,{onSave:C.handleSubmit,maxAccess:t,disabledSubmit:s||i,children:(0,l.jsx)(y.R,{children:(0,l.jsxs)(p.Q,{children:[(0,l.jsx)(k.g,{children:(0,l.jsx)(I.Z,{name:"siteId",endpointId:x.x.Sites.qry,parameters:r?"_stockCountId=".concat(r):"",label:n.sites,filter:e=>e.isChecked,valueField:"siteId",required:!0,displayField:"siteName",values:C.values,onChange:async(e,a)=>{(null==a?void 0:a.siteId)&&(C.setFieldValue("siteId",a?null==a?void 0:a.siteId:null),await D(r,null==a?void 0:a.siteId))},error:C.touched.siteId&&!!C.errors.siteId,maxAccess:t})}),(0,l.jsx)(O._,{onChange:e=>(function(e){let a=C.values.rows.map(a=>e.find(e=>e.id===a.id)||a);C.setFieldValue("rows",a)})(e),value:C.values.rows,error:C.errors.rows,columns:b,allowAddNewLine:!1,allowDelete:!1})]})})})},_=t(50023),M=t(21326);let E=e=>{let{recordId:a,plantId:t,window:s}=e,[o,i]=(0,d.useState)(0),[u,c]=(0,d.useState)({recordId:a||null,isPosted:!1,isClosed:!1}),{labels:v,access:p}=(0,_.Z)({datasetId:m.i.StockCounts,editMode:!!a});(0,M.Z)({title:v.cycleCounts,window:s});let[y,h]=(0,d.useState)(!1),f=!!u.recordId,x=[{label:v.cycleCounts},{label:v.sites,disabled:!f},{label:v.controller,disabled:!f}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.Y,{tabs:x,activeTab:o,setActiveTab:i,maxAccess:p}),(0,l.jsx)(n.Z,{index:0,value:o,maxAccess:p,children:(0,l.jsx)(N,{labels:v,setStore:c,store:u,maxAccess:p,plantId:t})}),(0,l.jsx)(n.Z,{index:1,value:o,maxAccess:p,children:(0,l.jsx)(V,{labels:v,maxAccess:p,store:u,setRefreshController:h,refreshController:y})}),(0,l.jsx)(n.Z,{index:2,value:o,maxAccess:p,children:(0,l.jsx)(L,{labels:v,maxAccess:p,store:u},y)})]})};E.width=650,E.height=750;var J=E},1838:function(e,a,t){"use strict";t.d(a,{Z:function(){return j}});var l=t(52322),n=t(60218),r=t(2784),d=t(48601),s=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(8661),v=t(5088),p=t(80983),y=t(31389),h=t(62362),f=t(19473),x=t(39812),I=t(89330),g=t(91406),C=t(21581),D=t(27423),b=t(92407),S=t(98345),R=t(7121),q=t(83562),w=t(21326),P=t(50023);function j(e){var a;let{recordId:t,window:j}=e,{getRequest:F,postRequest:Z}=(0,r.useContext)(i.$),{platformLabels:T}=(0,r.useContext)(f.l),{labels:N,access:k}=(0,P.Z)({datasetId:c.i.EmployeePenalties,editMode:!!t});(0,w.Z)({title:N.empPenalty,window:j});let{maxAccess:O}=(0,S.H)({functionId:R.J.Penalty,access:k,enabled:!t}),{formik:A}=(0,p.c)({initialValues:{recordId:t||null,reference:"",penaltyId:null,employeeId:null,employeeRef:"",employeeName:"",date:new Date,amount:null,notes:"",status:1,wip:1},maxAccess:O,validateOnChange:!0,validationSchema:d.Ry({date:d.hT().required().test(function(e){return e<=new Date}),penaltyId:d.Rx().required(),amount:d.Rx().required(),employeeId:d.Rx().required()}),onSubmit:async e=>{let{employeeName:a,employeeRef:t,date:l,...n}=e,r=await Z({extension:b.y.EmployeePenalty.set,record:JSON.stringify({...n,date:(0,x.ku)(l)})});o.ZP.success(n.recordId?T.Edited:T.Added),M(r.recordId),V()}}),V=(0,u.E)({endpointId:b.y.EmployeePenalty.page}),L=!!A.values.recordId,_=2===A.values.wip;async function M(e){if(e){let{record:a}=await F({extension:b.y.EmployeePenalty.get,parameters:"_recordId=".concat(e)});A.setValues({...a,date:(0,x.a1)(a.date)})}}(0,r.useEffect)(()=>{M(t)},[]);let{employeeName:E,employeeRef:J,date:B,...H}=A.values,Y=[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!L},{key:"Close",condition:!_,onClick:async()=>{await Z({extension:b.y.EmployeePenalty.close,record:JSON.stringify({...H,date:(0,x.ku)(B)})}),o.ZP.success(T.Closed),M(A.values.recordId),V()},disabled:_||!L},{key:"Reopen",condition:_,onClick:async()=>{await Z({extension:b.y.EmployeePenalty.reopen,record:JSON.stringify({...H,date:(0,x.ku)(B)})}),o.ZP.success(T.Reopened),M(A.values.recordId),V()},disabled:!_},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!_}];return(0,l.jsx)(s.Z,{resourceId:c.i.EmployeePenalties,functionId:R.J.Penalty,form:A,actions:Y,maxAccess:O,editMode:L,children:(0,l.jsx)(y.R,{children:(0,l.jsx)(h.Q,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(v.Z,{name:"reference",label:N.ref,value:A.values.reference,maxAccess:O,readOnly:L,maxLength:"10",onChange:A.handleChange,onClear:()=>A.setFieldValue("reference",""),error:A.touched.reference&&!!A.errors.reference})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{name:"date",required:!0,label:N.date,value:null===(a=A.values)||void 0===a?void 0:a.date,onChange:A.setFieldValue,onClear:()=>A.setFieldValue("date",null),error:A.touched.date&&!!A.errors.date,maxAccess:O,readOnly:_,max:new Date})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(m.Z,{endpointId:q.m.PenaltyType.qry,name:"penaltyId",label:N.penalty,required:!0,valueField:"recordId",readOnly:_,displayField:"name",values:A.values,maxAccess:O,onChange:(e,a)=>{A.setFieldValue("penaltyId",(null==a?void 0:a.recordId)||null)},error:A.touched.penaltyId&&!!A.errors.penaltyId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.U,{endpointId:b.y.Employee.snapshot,parameters:{_branchId:0},filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,readOnly:_,label:N.employee,secondFieldLabel:N.empName,form:A,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:O,onChange:async(e,a)=>{A.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),A.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),A.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"amount",label:N.amount,value:A.values.amount,maxAccess:O,readOnly:_,required:!0,onChange:A.handleChange,onClear:()=>A.setFieldValue("amount",null),error:A.touched.amount&&!!A.errors.amount})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"notes",label:N.notes,value:A.values.notes,rows:3,readOnly:_,maxAccess:O,onChange:e=>A.setFieldValue("notes",e.target.value),onClear:()=>A.setFieldValue("notes",""),error:A.touched.notes&&!!A.errors.notes})})]})})})})}j.width=600,j.height=470},51682:function(e,a,t){"use strict";t.d(a,{Z:function(){return j}});var l=t(52322),n=t(60218),r=t(2784),d=t(48601),s=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(80983),p=t(19473),y=t(31389),h=t(62362),f=t(50496),x=t(27423),I=t(92407),g=t(89330),C=t(91406),D=t(21581),b=t(39812),S=t(7121),R=t(98345),q=t(8661),w=t(50023),P=t(21326);function j(e){var a,t,j;let{recordId:F,window:Z}=e,{getRequest:T,postRequest:N}=(0,r.useContext)(i.$),{platformLabels:k}=(0,r.useContext)(p.l),{labels:O,access:A}=(0,w.Z)({datasetId:c.i.LeaveRequest,editMode:!!F});(0,P.Z)({title:O.title,window:Z});let V=(0,u.E)({endpointId:f.U.LeaveRequest.page}),{maxAccess:L}=(0,R.H)({functionId:S.J.LeaveRequest,access:A,enabled:!F}),{formik:_}=(0,v.c)({initialValues:{recordId:null,name:"",startDate:null,endDate:null,date:new Date,employeeId:null,justification:"",destination:"",ltId:null,status:1,reference:"",hours:null,multiDayLeave:1,wip:1},maxAccess:L,validateOnChange:!0,validationSchema:d.Ry({hours:d.Rx().required(),startDate:d.hT().required(),date:d.hT().required(),destination:d.Z_().required(),employeeId:d.Rx().required(),ltId:d.Rx().required(),justification:d.Z_().required()}),onSubmit:async e=>{let a=await N({extension:f.U.LeaveRequest.set,record:JSON.stringify({...e,date:(0,b.ku)(e.date),startDate:(0,b.ku)(e.startDate),endDate:(0,b.ku)(e.endDate)})});o.ZP.success(e.recordId?k.Edited:k.Added),J(a.recordId),V()}}),M=!!_.values.recordId,E=(null==_?void 0:null===(a=_.values)||void 0===a?void 0:a.wip)===2;async function J(e){if(e){let{record:a}=await T({extension:f.U.LeaveRequest.get,parameters:"_recordId=".concat(e)});_.setValues({...a,date:(0,b.a1)(a.date),startDate:(0,b.a1)(a.startDate),endDate:(0,b.a1)(a.endDate)})}}(0,r.useEffect)(()=>{J(F)},[]);let B=[{key:"Close",condition:!E,onClick:async()=>{await N({extension:f.U.LeaveRequest.close,record:JSON.stringify({..._.values,date:(0,b.ku)(_.values.date),startDate:(0,b.ku)(_.values.startDate),endDate:(0,b.ku)(_.values.endDate)})}),o.ZP.success(k.Closed),J(_.values.recordId),V()},disabled:E||!M},{key:"Reopen",condition:E,onClick:async()=>{await N({extension:f.U.LeaveRequest.reopen,record:JSON.stringify({..._.values,date:(0,b.ku)(_.values.date),startDate:(0,b.ku)(_.values.startDate),endDate:(0,b.ku)(_.values.endDate)})}),o.ZP.success(k.Reopened),J(_.values.recordId),V()},disabled:!E||!M||3===_.values.releaseStatus},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!E}];return(0,l.jsx)(s.Z,{resourceId:c.i.LeaveRequest,functionId:S.J.LeaveRequest,previewReport:M,form:_,maxAccess:L,editMode:M,actions:B,children:(0,l.jsx)(y.R,{children:(0,l.jsx)(h.Q,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(m.Z,{name:"reference",label:O.ref,value:_.values.reference,maxAccess:L,maxLength:"30",readOnly:E,onChange:_.handleChange,onClear:()=>_.setFieldValue("reference",""),error:_.touched.reference&&!!_.errors.reference})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(x.U,{endpointId:I.y.Employee.snapshot,parameters:{_branchId:0},filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,label:O.employee,secondFieldLabel:O.employeeName,form:_,readOnly:E,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:L,onChange:async(e,a)=>{_.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),_.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),_.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"date",label:O.date,value:null===(t=_.values)||void 0===t?void 0:t.date,required:!0,readOnly:E,onChange:(e,a)=>{_.setFieldValue("date",a||null)},onClear:()=>_.setFieldValue("date",null),error:_.touched.date&&!!_.errors.date,maxAccess:L})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"startDate",label:O.startDate,value:null===(j=_.values)||void 0===j?void 0:j.startDate,required:!0,readOnly:E,onChange:(e,a)=>{_.setFieldValue("startDate",a||null),_.setFieldValue("endDate",a||null)},onClear:()=>{_.setFieldValue("startDate",null),_.setFieldValue("endDate",null)},error:_.touched.startDate&&!!_.errors.startDate,maxAccess:L})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"hours",label:O.hours,value:_.values.hours,maxAccess:L,readOnly:E,required:!0,onChange:e=>_.setFieldValue("hours",e.target.value),onClear:()=>_.setFieldValue("hours",null),error:_.touched.hours&&!!_.errors.hours,decimalScale:2})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"justification",label:O.justification,value:_.values.justification,rows:3,required:!0,readOnly:E,maxAccess:L,onChange:_.handleChange,onClear:()=>_.setFieldValue("justification",""),error:_.touched.justification&&!!_.errors.justification})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(m.Z,{name:"destination",label:O.destination,value:_.values.destination,onChange:_.handleChange,required:!0,readOnly:E,maxLength:100,maxAccess:L,onClear:()=>_.setFieldValue("destination",""),error:_.touched.destination&&!!_.errors.destination})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(q.Z,{endpointId:f.U.IndemnityAccuralsFilters.qry,name:"ltId",label:O.leaveType,valueField:"recordId",values:_.values,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,readOnly:M,maxAccess:L,onChange:(e,a)=>{_.setFieldValue("ltId",null==a?void 0:a.recordId)},error:_.touched.ltId&&!!_.errors.ltId})})]})})})})}j.width=800,j.height=500},23427:function(e,a,t){"use strict";t.d(a,{Z:function(){return j}});var l=t(52322),n=t(60218),r=t(2784),d=t(48601),s=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(80983),p=t(19473),y=t(31389),h=t(62362),f=t(50496),x=t(27423),I=t(92407),g=t(89330),C=t(21581),D=t(39812),b=t(7121),S=t(98345),R=t(8661),q=t(84100),w=t(50023),P=t(21326);function j(e){var a,t,j,F;let{recordId:Z,window:T}=e,{getRequest:N,postRequest:k}=(0,r.useContext)(i.$),{platformLabels:O}=(0,r.useContext)(p.l),A=(0,u.E)({endpointId:f.U.LeaveReturn.page}),{labels:V,access:L}=(0,w.Z)({datasetId:c.i.LeaveReturn,editMode:!!Z});(0,P.Z)({title:V.title,window:T});let{maxAccess:_}=(0,S.H)({functionId:b.J.ReturnFromLeave,access:L,enabled:!Z}),{formik:M}=(0,v.c)({initialValues:{recordId:null,date:null,employeeId:null,employeeRef:"",employeeName:"",justification:"",leaveId:null,status:1,reference:"",returnType:null,wip:1,minDate:null,maxDate:null},maxAccess:_,validateOnChange:!0,validationSchema:d.Ry({date:d.hT().typeError().required().test(function(e){let{minDate:a,maxDate:t}=this.parent;return!e||!(a&&e<=new Date(a)||t&&e>=new Date(t))}),leaveId:d.Rx().required(),returnType:d.Rx().required(),justification:d.Z_().required()}),onSubmit:async e=>{let{minDate:a,maxDate:t,employeeName:l,date:n,...r}=e,d=await k({extension:f.U.LeaveReturn.set,record:JSON.stringify({...r,date:(0,D.ku)(n)})});o.ZP.success(e.recordId?O.Edited:O.Added),B(d.recordId),A()}}),E=!!M.values.recordId,J=(null==M?void 0:null===(a=M.values)||void 0===a?void 0:a.wip)===2;async function B(e){if(e){let{record:a}=await N({extension:f.U.LeaveReturn.get,parameters:"_recordId=".concat(e)}),t=await $(a.returnType,a.leaveId);M.setValues({...a,date:(0,D.a1)(a.date),minDate:t.minDate,maxDate:t.maxDate})}}(0,r.useEffect)(()=>{B(Z)},[]);let{minDate:H,maxDate:Y,employeeName:G,date:U,...W}=M.values,Q=[{key:"Close",condition:!J,onClick:async()=>{await k({extension:f.U.LeaveReturn.close,record:JSON.stringify({...W,date:(0,D.ku)(U)})}),o.ZP.success(O.Closed),B(W.recordId),A()},disabled:J||!E},{key:"Reopen",condition:J,onClick:async()=>{await k({extension:f.U.LeaveReturn.reopen,record:JSON.stringify({...W,date:(0,D.ku)(U)})}),o.ZP.success(O.Reopened),B(W.recordId),A()},disabled:!J},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!J}];async function $(e,a){let t={date:null,minDate:null,maxDate:null};if(!a||!e)return;let{record:l}=await N({extension:f.U.LeaveRequest.get,parameters:"_recordId=".concat(a)});switch(e){case"1":t.date=(0,D.a1)(l.startDate);break;case"2":t.minDate=(0,D.a1)(l.startDate),t.endDate=(0,D.a1)(l.endDate),t.date=new Date;break;case"3":let n=new Date((0,D.a1)(l.endDate));n.setDate(n.getDate()+1),t.date=n;break;case"4":t.date=new Date,t.minDate=l.startDate}return t}return(0,l.jsx)(s.Z,{resourceId:c.i.LeaveReturn,functionId:b.J.ReturnFromLeave,previewReport:E,form:M,maxAccess:_,editMode:E,actions:Q,disabledSubmit:J,children:(0,l.jsx)(y.R,{children:(0,l.jsx)(h.Q,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(m.Z,{name:"reference",label:V.reference,value:M.values.reference,maxAccess:_,maxLength:"30",readOnly:J,onChange:M.handleChange,onClear:()=>M.setFieldValue("reference",""),error:M.touched.reference&&!!M.errors.reference})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(x.U,{endpointId:I.y.Employee.snapshot,parameters:{_branchId:0},filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeId",label:V.employee,secondFieldLabel:V.employeeName,form:M,readOnly:J,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:_,onChange:async(e,a)=>{M.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),M.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),M.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(R.Z,{endpointId:M.values.employeeId&&f.U.LeaveRequest.qry,parameters:"_filter=&_multiDayLeave=2&_params=1|".concat(M.values.employeeId,"&_sortBy=recordId&_startAt=0&_size=100"),filter:e=>4==e.status,displayField:["reference",{name:"startDate",type:"date"},{name:"endDate",type:"date"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"startDate",value:"Start Date",type:"date"},{key:"endDate",value:"End date",type:"date"}],name:"leaveId",label:V.leave,valueField:"recordId",required:!0,values:M.values,onChange:(e,a)=>{M.setFieldValue("leaveId",(null==a?void 0:a.recordId)||null)},readOnly:J,maxAccess:_,error:(null==M?void 0:null===(t=M.touched)||void 0===t?void 0:t.leaveId)&&!!(null==M?void 0:null===(j=M.errors)||void 0===j?void 0:j.leaveId)})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(R.Z,{datasetId:q.v.LEAVE_RETURN_TYPE,name:"returnType",label:V.returnType,valueField:"key",displayField:"value",values:M.values,required:!0,readOnly:J,maxAccess:_,onChange:async(e,a)=>{let t=await $(null==a?void 0:a.key,M.values.leaveId);M.setValues({...M.values,maxDate:(null==t?void 0:t.maxDate)||null,minDate:(null==t?void 0:t.minDate)||null,date:(null==t?void 0:t.date)||null,returnType:(null==a?void 0:a.key)||null})},error:M.touched.returnType&&!!M.errors.returnType})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"date",label:V.date,value:null===(F=M.values)||void 0===F?void 0:F.date,required:!0,readOnly:J||"1"==M.values.returnType||"3"==M.values.returnType,onChange:(e,a)=>{M.setFieldValue("date",a||null)},min:M.values.minDate,max:M.values.maxDate,onClear:()=>M.setFieldValue("date",null),error:M.touched.date&&!!M.errors.date,maxAccess:_})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"justification",label:V.justification,value:M.values.justification,rows:3,required:!0,readOnly:J,maxAccess:_,onChange:M.handleChange,onClear:()=>M.setFieldValue("justification",""),error:M.touched.justification&&!!M.errors.justification})})]})})})})}j.width=800,j.height=500},89764:function(e,a,t){"use strict";t.d(a,{Z:function(){return J}});var l=t(52322),n=t(29326),r=t(9522),d=t(2784),s=t(60218),o=t(48601),i=t(82737),u=t(62202),c=t(65950),m=t(71987),v=t(26612),p=t(5088),y=t(80983),h=t(19473),f=t(31389),x=t(33625),I=t(8661),g=t(84100),C=t(73581),D=t(91406),b=t(27423),S=t(92407),R=t(70104),q=t(38449),w=t(89330),P=t(21581),j=t(39812),F=t(7121);function Z(e){var a,t,n,r,Z,T,N,k,O,A;let{labels:V,maxAccess:L,store:_,setStore:M,window:E}=e,{getRequest:J,postRequest:B}=(0,d.useContext)(c.$),{platformLabels:H,defaultsData:Y}=(0,d.useContext)(h.l),{recordId:G}=_,U=(0,m.E)({endpointId:C.h.Loans.page}),W=null==Y?void 0:null===(t=Y.list)||void 0===t?void 0:null===(a=t.find(e=>{let{key:a}=e;return"currencyId"===a}))||void 0===a?void 0:a.value,Q=null==Y?void 0:null===(r=Y.list)||void 0===r?void 0:null===(n=r.find(e=>{let{key:a}=e;return"ldMethod"===a}))||void 0===n?void 0:n.value,$=null==Y?void 0:null===(T=Y.list)||void 0===T?void 0:null===(Z=T.find(e=>{let{key:a}=e;return"ldValue"===a}))||void 0===Z?void 0:Z.value,{formik:z}=(0,y.c)({initialValues:{recordId:null,status:1,releaseStatus:null,wip:1,reference:"",date:new Date,employeeId:null,branchId:null,departmentName:"",positionName:"",ltId:null,ltName:"",loanBalance:null,currencyId:parseInt(W),amount:null,purpose:"",effectiveDate:new Date,ldMethod:parseInt(Q),ldmName:"",ldValue:parseInt($),disableEditing:!1},maxAccess:L,validationSchema:o.Ry({reference:o.Z_().required(),employeeId:o.Rx().required(),date:o.hT().required(),ltId:o.Rx().required(),currencyId:o.Rx().required(),amount:o.Rx().min(1).required(),purpose:o.Z_().required(),ldValue:o.Rx().min(1).required(),effectiveDate:o.hT().required(),ldMethod:o.Rx().required()}),onSubmit:async e=>{let a={...e,date:(0,j.ku)(e.date),effectiveDate:(0,j.ku)(e.effectiveDate)};await B({extension:C.h.Loans.set,record:JSON.stringify(a)}),u.ZP.success(e.recordId?H.Edited:H.Added),U(),E.close()}}),K=!!(null==z?void 0:null===(N=z.values)||void 0===N?void 0:N.recordId),X=2==z.values.wip;(0,d.useEffect)(()=>{G&&ee(G)},[]);let ee=async e=>{let a=await J({extension:C.h.Loans.get,parameters:"_recordId=".concat(e)});if(null==a?void 0:a.record){let{record:e}=a;z.setValues({...e,date:(0,j.a1)(e.date),effectiveDate:(0,j.a1)(e.effectiveDate)}),M(t=>{var l;return{...t,isClosed:2===e.wip,loanAmount:null!==(l=e.amount)&&void 0!==l?l:0,effectiveDate:(0,j.a1)(a.record.effectiveDate)}}),await ea(e.employeeId)}return a},ea=async e=>{if(!e){et();return}let{record:a}=await J({extension:S.y.QuickView.get,parameters:"_recordId=".concat(e,"&_asOfDate=").concat((0,j.uQ)(new Date))});z.setValues(t=>{var l;return{...t,employeeId:e,employeeRef:(null==a?void 0:a.reference)||"",employeeName:(null==a?void 0:a.fullName)||"",positionName:(null==a?void 0:a.positionName)||"",departmentName:(null==a?void 0:a.departmentName)||"",loanBalance:null!==(l=null==a?void 0:a.loanBalance)&&void 0!==l?l:0,branchId:(null==a?void 0:a.branchId)||null}})},et=()=>{z.setValues(e=>({...e,employeeId:null,employeeRef:"",employeeName:"",positionName:"",departmentName:"",loanBalance:0,branchId:null}))},el=async e=>{let a=await ee(e);(null==a?void 0:a.record)&&(z.setValues(e=>({...e,...a.record,date:(0,j.a1)(a.record.date),effectiveDate:(0,j.a1)(a.record.effectiveDate)})),M(e=>({...e,isClosed:2===a.record.wip,effectiveDate:(0,j.a1)(a.record.effectiveDate)})))},en=[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!K},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!X||!K},{key:"Close",condition:!X,onClick:async()=>{let e=await B({extension:C.h.Loans.close,record:JSON.stringify(z.values)});u.ZP.success(H.Closed),U(),el(e.recordId)},disabled:X||!K},{key:"Reopen",condition:X,onClick:async()=>{let e=await B({extension:C.h.Loans.reopen,record:JSON.stringify(z.values)});u.ZP.success(H.Reopened),U(),el(e.recordId)},disabled:!X||!K}];return(0,l.jsx)(i.Z,{resourceId:v.i.Loans,form:z,maxAccess:L,editMode:K,actions:en,disabledSubmit:X,functionId:F.J.LoanRequest,children:(0,l.jsx)(f.R,{children:(0,l.jsx)(x.g,{children:(0,l.jsxs)(s.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.Z,{name:"reference",label:V.reference,value:z.values.reference,required:!0,readOnly:K,maxAccess:L,maxLength:"20",onChange:z.handleChange,onClear:()=>z.setFieldValue("reference",""),error:z.touched.reference&&!!z.errors.reference})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(w.Z,{name:"date",required:!0,max:z.values.effectiveDate,readOnly:X,label:V.date,value:null==z?void 0:null===(k=z.values)||void 0===k?void 0:k.date,onChange:z.setFieldValue,maxAccess:L,onClear:()=>z.setFieldValue("date",null),error:z.touched.date&&!!z.errors.date})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.U,{endpointId:S.y.Employee.snapshot,parameters:{_branchId:0},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,readOnly:X,displayFieldWidth:2,label:V.employeeName,form:z,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:L,onChange:(e,a)=>{ea((null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:R.K.BranchFilters.qry,name:"branchId",label:V.branch,readOnly:!0,valueField:"recordId",displayField:["reference","name"],values:z.values,maxAccess:L,onChange:(e,a)=>z.setFieldValue("branchId",(null==a?void 0:a.recordId)||null),error:z.touched.branchId&&!!z.errors.branchId})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.Z,{name:"departmentName",label:V.department,value:z.values.departmentName,readOnly:!0,maxAccess:L,error:z.touched.departmentName&&!!z.errors.departmentName})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.Z,{name:"positionName",label:V.position,value:z.values.positionName,readOnly:!0,maxAccess:L,error:z.touched.positionName&&!!z.errors.positionName})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:C.h.LoanType.qry,name:"ltId",label:V.ltype,required:!0,readOnly:X,valueField:"recordId",displayField:"name",values:z.values,onChange:(e,a)=>{z.setFieldValue("disableEditing",(null==a?void 0:a.disableEditing)||!1),z.setFieldValue("ldMethod",(null==a?void 0:a.ldMethod)||null),z.setFieldValue("ldValue",(null==a?void 0:a.ldValue)||0),z.setFieldValue("ltId",(null==a?void 0:a.recordId)||null)},error:z.touched.ltId&&!!z.errors.ltId})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"loanBalance",label:V.loanBalance,value:null==z?void 0:null===(O=z.values)||void 0===O?void 0:O.loanBalance,maxAccess:L,readOnly:!0})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:q.r.Currency.qry,filter:e=>1===e.currencyType,name:"currencyId",label:V.currency,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:z.values,required:!0,readOnly:X,maxAccess:L,onChange:async(e,a)=>{z.setFieldValue("currencyName",(null==a?void 0:a.name)||""),z.setFieldValue("currencyRef",(null==a?void 0:a.reference)||""),z.setFieldValue("currencyId",(null==a?void 0:a.recordId)||null)},error:z.touched.currencyId&&!!z.errors.currencyId})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"amount",label:V.amount,value:z.values.amount,required:!0,readOnly:X,maxAccess:L,onChange:e=>z.setFieldValue("amount",e.target.value),onClear:async()=>{z.setFieldValue("amount",null)},error:z.touched.amount&&!!z.errors.amount,maxLength:10})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(P.Z,{name:"purpose",label:V.purpose,required:!0,rows:2,readOnly:X,value:z.values.purpose,maxAccess:L,onChange:e=>z.setFieldValue("purpose",e.target.value),onClear:()=>z.setFieldValue("purpose",""),error:z.touched.purpose&&!!z.errors.purpose})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(w.Z,{name:"effectiveDate",label:V.effectiveDate,value:null==z?void 0:null===(A=z.values)||void 0===A?void 0:A.effectiveDate,required:!0,min:z.values.date,readOnly:X,onChange:z.setFieldValue,maxAccess:L,onClear:()=>z.setFieldValue("effectiveDate",null),error:z.touched.effectiveDate&&!!z.errors.effectiveDate})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{datasetId:g.v.LOAN_DEDUCTION_METHOD,name:"ldMethod",label:V.ldMethod,required:!0,readOnly:X||z.values.disableEditing,valueField:"key",displayField:"value",values:z.values,maxAccess:L,onChange:(e,a)=>z.setFieldValue("ldMethod",(null==a?void 0:a.key)||null),onClear:async()=>{z.setFieldValue("ldMethod",null),z.setFieldValue("ldValue",null)},error:z.touched.ldMethod&&!!z.errors.ldMethod})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"ldValue",label:V.ldValue,value:z.values.ldValue,required:!0,readOnly:X||z.values.disableEditing,maxAccess:L,onChange:e=>z.setFieldValue("ldValue",e.target.value),onClear:()=>z.setFieldValue("ldValue",null),error:z.touched.ldValue&&!!z.errors.ldValue,maxLength:10})})]})})})})}var T=t(69387),N=t(62362),k=t(27723),O=t(61802),A=t(19689);function V(e){var a,t;let{labels:n,recordId:r,store:p,maxAccess:x,loanAmount:b,window:S}=e,{getRequest:R,postRequest:q}=(0,d.useContext)(c.$),{platformLabels:F}=(0,d.useContext)(h.l),Z=(0,m.E)({endpointId:C.h.LoanDeduction.page}),{formik:T}=(0,y.c)({maxAccess:x,initialValues:{loanId:p.recordId,recordId:null,payrollDeduction:!1,amount:null,date:new Date,type:null,notes:""},validationSchema:o.Ry({amount:o.Rx().required().max(b),date:o.hT().required(),type:o.Z_().required()}),onSubmit:e=>{let a={...e,date:(0,j.ku)(e.date),payrollDeduction:1===e.type};q({extension:C.h.LoanDeduction.set,record:JSON.stringify(a)}).then(a=>{u.ZP.success(e.recordId?F.Edited:F.Added),T.setFieldValue("recordId",a.recordId),Z(),S.close()})}}),k=!!T.values.recordId;return(0,d.useEffect)(()=>{!async function(){if(r){var e;let a=await R({extension:C.h.LoanDeduction.get,parameters:"_recordId=".concat(r)});T.setValues({...null==a?void 0:a.record,date:(0,j.a1)(null==a?void 0:null===(e=a.record)||void 0===e?void 0:e.date)})}}()},[]),(0,l.jsx)(i.Z,{resourceId:v.i.Loans,form:T,maxAccess:x,disabledSubmit:!p.isClosed||T.values.payrollDeduction,editMode:k,isInfo:!1,isCleared:!1,children:(0,l.jsx)(f.R,{children:(0,l.jsx)(N.Q,{children:(0,l.jsxs)(s.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(s.ZP,{item:!0,xs:6,children:(0,l.jsx)(A.Z,{name:"payrollDeduction",value:null===(a=T.values)||void 0===a?void 0:a.payrollDeduction,readOnly:!0,label:n.payrollDeduction,maxAccess:x})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"amount",label:n.deductionAmount,value:T.values.amount,required:!0,readOnly:!p.isClosed||T.values.payrollDeduction,maxAccess:x,onChange:async e=>{var a;T.setFieldValue("amount",(null==e?void 0:null===(a=e.target)||void 0===a?void 0:a.value)||null)},onClear:async()=>{T.setFieldValue("amount",null)},error:T.touched.amount&&!!T.errors.amount,maxLength:10})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(w.Z,{name:"date",label:n.date,required:!0,min:p.effectiveDate,readOnly:!p.isClosed||T.values.payrollDeduction,value:null==T?void 0:null===(t=T.values)||void 0===t?void 0:t.date,onChange:T.setFieldValue,maxAccess:x,onClear:()=>T.setFieldValue("date",null),error:T.touched.date&&!!T.errors.date})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{datasetId:g.v.LOAN_TYPE,name:"type",label:n.type,required:!0,readOnly:!p.isClosed||T.values.payrollDeduction,valueField:"key",displayField:"value",values:T.values,maxAccess:x,onChange:(e,a)=>{T.setFieldValue("type",(null==a?void 0:a.key)||null)},error:T.touched.type&&!!T.errors.type})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,children:(0,l.jsx)(P.Z,{name:"notes",label:n.notes,readOnly:!p.isClosed||T.values.payrollDeduction,value:T.values.notes,maxLength:"100",maxAccess:x,onChange:e=>T.setFieldValue("notes",e.target.value),onClear:()=>T.setFieldValue("notes",""),error:T.touched.notes&&!!T.errors.notes})})]})})})})}var L=e=>{var a;let{store:t,labels:n}=e,{recordId:r}=t,{getRequest:o,postRequest:i}=(0,d.useContext)(c.$),{platformLabels:p}=(0,d.useContext)(h.l),{stack:y}=(0,O.zY)(),I=[{field:"payrollDeduction",headerName:n.payrollDeduction,type:"checkbox",flex:1},{field:"amount",headerName:n.amount,flex:1,type:"number"},{field:"date",headerName:n.date,flex:1,type:"date"},{field:"typeName",headerName:n.type,flex:1},{field:"notes",headerName:n.notes,flex:1}];async function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:t=50}=e;return{...await o({extension:C.h.LoanDeduction.page,parameters:"_loanId=".concat(r,"&_pageSize=").concat(t,"&_startAt=").concat(a)}),_startAt:a}}let{query:{data:b},access:S,invalidate:R,paginationParameters:q,refetch:w}=(0,m.J)({queryFn:g,endpointId:C.h.LoanDeduction.page,datasetId:v.i.Loans,enabled:!!r}),P=parseFloat((null==b?void 0:null===(a=b.list)||void 0===a?void 0:a.reduce((e,a)=>e+(a.amount||0),0))||0).toFixed(2),j=parseFloat((t.loanAmount||0)-P).toFixed(2);function F(e){y({Component:V,props:{labels:n,store:t,maxAccess:S,loanAmount:t.loanAmount,recordId:e},width:600,height:500,title:n.Deduction})}let Z=async e=>{await i({extension:C.h.LoanDeduction.del,record:JSON.stringify(e)}),R(),u.ZP.success(p.Deleted)};return(0,l.jsxs)(f.R,{children:[(0,l.jsx)(x.g,{children:(0,l.jsx)(k.Z,{disableAdd:!t.isClosed,onAdd:()=>F(),maxAccess:S})}),(0,l.jsx)(N.Q,{children:(0,l.jsx)(T.Z,{name:"deductionTable",columns:I,gridData:b,rowId:"recordId",onEdit:e=>F(e.recordId),onDelete:t.isClosed&&Z,actionCondition:(e,a)=>"delete"!==a||!1===e.payrollDeduction,pageSize:50,paginationType:"api",paginationParameters:q,refetch:w,maxAccess:S})}),(0,l.jsx)(x.g,{children:(0,l.jsxs)(s.ZP,{container:!0,sx:{p:2},spacing:2,children:[(0,l.jsx)(s.ZP,{item:!0,xs:4,children:(0,l.jsx)(D.Z,{name:"loanAmount",label:n.loanAmount,value:parseFloat(t.loanAmount).toFixed(2),readOnly:!0})}),(0,l.jsx)(s.ZP,{item:!0,xs:4,children:(0,l.jsx)(D.Z,{name:"deductedAmount",label:n.deductedAmount,value:P,readOnly:!0})}),(0,l.jsx)(s.ZP,{item:!0,xs:4,children:(0,l.jsx)(D.Z,{name:"remainingBalance",label:n.remainingBalance,value:j,readOnly:!0})})]})})]})},_=t(21326),M=t(50023);let E=e=>{let{recordId:a,window:t}=e,[s,o]=(0,d.useState)(0),[i,u]=(0,d.useState)({recordId:a,isClosed:!1,loanAmount:0,effectiveDate:null}),{labels:c,access:m}=(0,M.Z)({datasetId:v.i.Loans,editMode:!!a});(0,_.Z)({title:c.Loans,window:t});let p=[{label:c.LoanInfo},{label:c.Deduction,disabled:!i.recordId}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.Y,{tabs:p,activeTab:s,setActiveTab:o}),(0,l.jsx)(n.Z,{index:0,value:s,children:(0,l.jsx)(Z,{labels:c,setStore:u,store:i,maxAccess:m,window:t})}),(0,l.jsx)(n.Z,{index:1,value:s,children:(0,l.jsx)(L,{labels:c,store:i})})]})};E.width=800,E.height=600;var J=E},20899:function(e,a,t){"use strict";t.d(a,{Z:function(){return V}});var l=t(52322),n=t(60218),r=t(2784),d=t(48601),s=t(82737),o=t(62202),i=t(76399),u=t(65950),c=t(71987),m=t(26612),v=t(5088),p=t(80983),y=t(19473),h=t(31389),f=t(62362),x=t(89330),I=t(8661),g=t(38449),C=t(7121),D=t(21581),b=t(98345),S=t(39812),R=t(39704),q=t(61802),w=t(65215),P=t(96026),j=t(70104),F=t(58912),Z=t(92407),T=t(33625),N=t(27423),k=t(90587),O=t(21326),A=t(50023);function V(e){var a,t,V,L,_,M,E,J;let{recordId:B,window:H}=e,{getRequest:Y,postRequest:G}=(0,r.useContext)(u.$),{platformLabels:U,defaultsData:W}=(0,r.useContext)(y.l),{stack:Q}=(0,q.zY)(),{stack:$}=(0,P.V)(),[z,K]=(0,r.useState)([]),X=(0,r.useRef)([]),{labels:ee,access:ea}=(0,A.Z)({datasetId:m.i.MaterialReplenishment,editMode:!!B});(0,O.Z)({title:ee.MaterialRequest,window:H});let{documentType:et,maxAccess:el,changeDT:en}=(0,b.H)({functionId:C.J.MaterialRequest,access:ea,enabled:!B}),er=(0,c.E)({endpointId:F.I.MaterialReplenishment.page});async function ed(){if(!ev&&(null==et||!et.dtId)){var e;let a=null==W?void 0:null===(e=W.list)||void 0===e?void 0:e.find(e=>{let{key:a}=e;return"de_siteId"===a});(null==a?void 0:a.value)&&ei.setFieldValue("fromSiteId",parseInt(null==a?void 0:a.value))}}let es=null===(a=JSON.parse(window.sessionStorage.getItem("userData")))||void 0===a?void 0:a.userId,eo=async()=>{var e,a;let t=await Y({extension:g.r.Users.get,parameters:"_recordId=".concat(es)});if(null==t?void 0:null===(e=t.record)||void 0===e?void 0:e.employeeId){let e=await Y({extension:Z.y.Employee.get1,parameters:"_recordId=".concat(null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.employeeId)});ei.setFieldValue("departmentId",e.record.departmentId)}},{formik:ei}=(0,p.c)({documentType:{key:"dtId",value:null==et?void 0:et.dtId},initialValues:{recordId:null,functionId:C.J.MaterialRequest,reference:"",dtId:null,siteId:null,siteName:"",date:new Date,fromSiteId:"",departmentId:null,departmentName:"",statusName:"",rsName:"",wipName:"",notes:"",workCenterId:null,wcName:"",wcRef:"",status:1,wip:1,items:[{id:1,requestId:B||0,seqNo:1,sku:"",itemName:null,itemId:null,qty:null,notes:"",onHandSite:0,onHandGlobal:null,deliveredQty:null,deliveryStatus:"",muId:null,muQty:"",muRef:"",muName:"",msId:null}]},maxAccess:el,validateOnChange:!0,validationSchema:d.Ry({date:d.hT().required(),fromSiteId:d.Z_().required(),items:d.IX().of(d.Ry().shape({sku:d.Z_().required(),qty:d.Z_().required().min(1)})).required()}),onSubmit:async e=>{let a={...e,date:(0,S.ku)(null==e?void 0:e.date)||null};delete a.items;let t=null==e?void 0:e.items.map((a,t)=>({...a,seqNo:t+1,requestId:e.recordId||0}));if(e.fromSiteId===e.siteId){$({message:ee.errorMessage});return}let l=await G({extension:F.I.MaterialReplenishment.set2,record:JSON.stringify({header:a,items:t})});if(e.recordId)o.ZP.success(U.Edited);else{o.ZP.success(U.Added),ei.setFieldValue("recordId",l.recordId);let e=await ex(l.recordId),a=await eb(l.recordId);ei.setValues({...e.record,items:a}),er()}}});async function eu(e){var a,t;if(!e)return;let l=null===(t=ei.values.items)||void 0===t?void 0:null===(a=t.find(a=>parseInt(a.itemId)===e))||void 0===a?void 0:a.msId,n=(null==z?void 0:z.filter(e=>e.msId===l))||[];X.current=n}let ec=2===ei.values.wip,em=-1==ei.values.status,ev=!!ei.values.recordId,ep=async()=>await Y({extension:w.$.MeasurementUnit.qry,parameters:"_msId=0"});async function ey(e){let a=await Y({extension:w.$.Item.get,parameters:"_recordId=".concat(e)});return null==a?void 0:a.record}async function eh(e){let a=await Y({extension:w.$.Availability.qry,parameters:"_siteId=".concat(ei.values.fromSiteId||0,"&_itemId=").concat(e,"&_startAt=0&_pageSize=1000")}),t=(null==a?void 0:a.count)>0,l=t&&0!==a.list[0].siteId;return t&&l?(ei.setFieldValue("onHandSite",a.list[0].onhand),a.list[0].onhand):(ei.setFieldValue("onHandSite",0),null)}let ef=[{component:"resourcelookup",label:ee.sku,name:"sku",props:{endpointId:w.$.Item.snapshot,valueField:"sku",displayField:"sku",mandatory:!0,readOnly:ec||em,displayFieldWidth:3,mapping:[{from:"recordId",to:"itemId"},{from:"msId",to:"msId"},{from:"onHandGlobal",to:"onHandGlobal"},{from:"deliveredQty",to:"deliveredQty"},{from:"sku",to:"sku"},{from:"name",to:"itemName"},{from:"isInactive",to:"isInactive"}],columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"},{key:"flName",value:"flName"}]},async onChange(e){let{row:{update:a,newRow:t}}=e;if(!(null==t?void 0:t.itemId)){a({details:!1});return}if(t.isInactive){a({...ei.initialValues.items[0],id:t.id}),$({message:ee.inactiveItem});return}if(null==t?void 0:t.itemId){var l,n,r;let e=await ey(t.itemId);eu(null==t?void 0:t.itemId);let d=null==z?void 0:z.filter(a=>a.msId===(null==e?void 0:e.msId)),s=null!==(r=await eh(null==t?void 0:t.itemId))&&void 0!==r?r:0;a({msId:null==e?void 0:e.msId,onHandSite:s,muRef:null==d?void 0:null===(l=d[0])||void 0===l?void 0:l.reference,muId:null==d?void 0:null===(n=d[0])||void 0===n?void 0:n.recordId})}}},{component:"textfield",label:ee.itemName,name:"itemName",props:{readOnly:!0}},{component:"resourcecombobox",label:ee.muId,name:"muRef",props:{store:null==X?void 0:X.current,displayField:"reference",valueField:"recordId",readOnly:ec||em,mapping:[{from:"reference",to:"muRef"},{from:"recordId",to:"muId"}]},async onChange(e){var a;let{row:{update:t,newRow:l}}=e,n=null==X?void 0:X.current.filter(e=>e.recordId===(null==l?void 0:l.muId));t({qtyInBase:(null==l?void 0:l.qty)*(null==n?void 0:n.muQty),muQty:null==l?void 0:l.muQty})},propsReducer(e){let{row:a,props:t}=e;return{...t,store:null==X?void 0:X.current}}},{component:"numberfield",label:ee.qty,name:"qty",props:{readOnly:ec||em,mandatory:!0},async onChange(e){let{row:{update:a,newRow:t}}=e;if(t){var l;a({qtyInBase:(null==t?void 0:t.qty)*(null==t?void 0:t.muQty)})}}},{component:"numberfield",label:ee.onHandSite,name:"onHandSite",props:{readOnly:!0}},{component:"textfield",label:ee.notes,name:"notes",props:{readOnly:ec||em}}];async function ex(e){var a;let t=await Y({extension:F.I.MaterialReplenishment.get,parameters:"_requestId=".concat(e,"&_params=")});return t.record.date=(0,S.a1)(null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.date),t}let eI=async e=>{await G({extension:F.I.MaterialReplenishment.close,record:JSON.stringify({recordId:e})}),o.ZP.success(U.Closed),er();let a=await ex(e),t=await eb(e);ei.setValues({...a.record,items:t})},eg=async e=>{var a;let t={...ei.values,date:(0,S.ku)(null===(a=ei.values)||void 0===a?void 0:a.date)||null};delete t.items,await G({extension:F.I.MaterialReplenishment.reopen,record:JSON.stringify(t)}),o.ZP.success(U.Reopened),er();let l=await ex(e),n=await eb(e);ei.setValues({...l.record,items:n})},eC=async e=>{var a;let t={...ei.values,date:(0,S.ku)(null===(a=ei.values)||void 0===a?void 0:a.date)||null};delete t.items,await G({extension:F.I.MaterialReplenishment.cancel,record:JSON.stringify(t)}),o.ZP.success(U.Cancelled),er();let l=await ex(e),n=await eb(e);ei.setValues({...l.record,items:n})},eD=[{key:"Approval",condition:!0,onClick:"onApproval",disabled:!ec},{key:"Close",condition:!ec,onClick:()=>eI(ei.values.recordId),disabled:!ev||em},{key:"Reopen",condition:ec,onClick:()=>eg(ei.values.recordId),disabled:!ev||em},{key:"WorkFlow",condition:!0,onClick:async()=>{Q({Component:R.Z,props:{functionId:C.J.MaterialRequest,recordId:ei.values.recordId}})},disabled:!ev},{key:"Cancel",condition:!0,onClick:()=>eC(ei.values.recordId),disabled:!ev||em||ec}];async function eb(e){var a,t;let l=await Y({extension:F.I.OrderItem.qry,parameters:"_requestId=".concat(e,"&_functionId=").concat(C.J.MaterialRequest,"&_params=&_startAt=0")});return(null==l?void 0:null===(a=l.list)||void 0===a?void 0:a.length)?await Promise.all(null==l?void 0:null===(t=l.list)||void 0===t?void 0:t.map(async e=>({...e,id:e.seqNo,onHandSite:e.onhandSite}))):[]}return(0,r.useEffect)(()=>{!async function(){let e=await ep();K(null==e?void 0:e.list),ed(),await eo()}()},[]),(0,r.useEffect)(()=>{!async function(){if(B&&z){let e=await ex(B),a=await eb(B);ei.setValues({...e.record,items:a})}}()},[B,z]),(0,l.jsx)(s.Z,{resourceId:m.i.MaterialReplenishment,form:ei,maxAccess:el,editMode:ev,previewReport:ev,actions:eD,functionId:C.J.MaterialRequest,disabledSubmit:ec||em,children:(0,l.jsxs)(h.R,{children:[(0,l.jsx)(T.g,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:g.r.DocumentType.qry,parameters:"_dgId=".concat(C.J.MaterialRequest,"&_startAt=0&_pageSize=50"),filter:ev?void 0:e=>1===e.activeStatus,name:"dtId",label:ee.documentType,readOnly:ec||em,valueField:"recordId",displayField:"name",values:null==ei?void 0:ei.values,onChange:async(e,a)=>{ei.setFieldValue("dtId",(null==a?void 0:a.recordId)||null),en(a)},error:ei.touched.dtId&&!!ei.errors.dtId,maxAccess:el})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(v.Z,{name:"reference",label:ee.reference,value:null==ei?void 0:null===(t=ei.values)||void 0===t?void 0:t.reference,readOnly:ev,maxAccess:!ev&&el,onChange:ei.handleChange,onClear:()=>ei.setFieldValue("reference",""),error:ei.touched.reference&&!!ei.errors.reference})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(x.Z,{name:"date",label:ee.date,value:null==ei?void 0:null===(V=ei.values)||void 0===V?void 0:V.date,required:!0,onChange:ei.setFieldValue,onClear:()=>ei.setFieldValue("date",null),readOnly:ec||em,error:ei.touched.date&&!!ei.errors.date,maxAccess:el})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:j.K.DepartmentFilters.qry,parameters:"_filter=&_size=1000&_startAt=0&_type=0&_activeStatus=0&_sortBy=recordId",name:"departmentId",readOnly:ec||em,label:ee.department,values:ei.values,displayField:"name",maxAccess:el,onChange:(e,a)=>{ei.setFieldValue("departmentId",(null==a?void 0:a.recordId)||null)},error:ei.touched.departmentId&&!!ei.errors.departmentId})})]})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(N.U,{endpointId:k.u.WorkCenter.snapshot,name:"workCenterId",label:ee.workCenter,valueField:"reference",displayField:"name",valueShow:"wcRef",secondValueShow:"wcName",displayFieldWidth:2,form:ei,onChange:(e,a)=>{ei.setFieldValue("workCenterId",(null==a?void 0:a.recordId)||null),ei.setFieldValue("wcRef",(null==a?void 0:a.reference)||""),ei.setFieldValue("wcName",(null==a?void 0:a.name)||"")},error:ei.touched.workCenterId&&!!ei.errors.workCenterId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:w.$.Site.qry,name:"siteId",readOnly:ec||em,refresh:ev,label:ee.site,values:ei.values,displayField:"name",maxAccess:el,onChange:(e,a)=>{ei.setFieldValue("siteId",(null==a?void 0:a.recordId)||null)},error:ei.touched.siteId&&!!ei.errors.siteId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:w.$.Site.qry,name:"fromSiteId",readOnly:ec||em||(null==ei?void 0:null===(_=ei.values)||void 0===_?void 0:null===(L=_.items)||void 0===L?void 0:L.some(e=>e.sku)),label:ee.fromSite,values:ei.values,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:1,required:!0,maxAccess:el,onChange:(e,a)=>{ei.setFieldValue("fromSiteId",(null==a?void 0:a.recordId)||null)},error:ei.touched.fromSiteId&&!!ei.errors.fromSiteId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"notes",label:ee.notes,value:null==ei?void 0:null===(M=ei.values)||void 0===M?void 0:M.notes,readOnly:ec||em,maxLength:"200",maxAccess:el,onChange:ei.handleChange,onClear:()=>ei.setFieldValue("notes",""),error:ei.touched.notes&&!!ei.errors.notes})})]})})]})}),(0,l.jsx)(f.Q,{children:(0,l.jsx)(i._,{onChange:e=>{let a=null==e?void 0:e.map(e=>({...e,details:!1,qtyInBase:0}));null==ei||ei.setFieldValue("items",a)},onSelectionChange:(e,a,t)=>{"muRef"==t&&eu(null==e?void 0:e.itemId)},name:"items",maxAccess:el,value:null==ei?void 0:null===(E=ei.values)||void 0===E?void 0:E.items,error:null==ei?void 0:null===(J=ei.errors)||void 0===J?void 0:J.items,columns:ef,allowDelete:!ec&&!em})})]})})}V.width=1e3,V.height=680},74456:function(e,a,t){"use strict";var l=t(52322),n=t(60218),r=t(48601),d=t(2784),s=t(5088),o=t(82737),i=t(89330),u=t(88469),c=t(65950),m=t(26612),v=t(80983),p=t(31389),y=t(62362),h=t(91406),f=t(27423),x=t(39812),I=t(75991),g=t(46553),C=t(17720),D=t(62202),b=t(7121),S=t(98345),R=t(84141),q=t(61802),w=t(19473),P=t(71987),j=t(33625),F=t(8661),Z=t(84100),T=t(50023),N=t(21326);let k=e=>{var a,t,k,O,A,V,L,_,M,E,J,B;let{recordId:H,window:Y}=e,{getRequest:G,postRequest:U}=(0,d.useContext)(c.$),{stack:W}=(0,q.zY)(),{platformLabels:Q}=(0,d.useContext)(w.l),[$,z]=(0,d.useState)(!1),[K,X]=(0,d.useState)(!1),[ee,ea]=(0,d.useState)(!1),{labels:et,access:el}=(0,T.Z)({datasetId:m.i.OutwardsModification,editMode:!!H});(0,N.Z)({title:et.outwardsModification,window:Y});let{maxAccess:en}=(0,S.H)({functionId:b.J.OutwardsModification,access:el,hasDT:!1}),er=(0,P.E)({endpointId:u.N.OutwardsModification.page}),{formik:ed}=(0,v.c)({maxAccess:en,initialValues:{recordId:null,reference:"",date:new Date,outwardsDate:null,owoId:"",owRef:"",ttNo:"",productName:"",clientId:"",currencyId:"",clientRef:"",clientName:"",cellPhone:"",dispersalType:"",countryId:"",headerBenId:"",headerBenName:"",headerBenSeqNo:"",newBeneficiaryId:"",newBeneficiarySeqNo:"",corId:"",oldBeneficiaryId:"",oldBeneficiarySeqNo:"",oldBeneficiarySeqName:"",wip:"",releaseStatus:"",status:"",otpVerified:!1,owtId:"",owtRef:"",plantId:"",seqNo:"",modificationType:"",beneficiaryData:{}},validateOnChange:!0,validationSchema:r.Ry({owRef:r.Z_().required(),date:r.Z_().required(),modificationType:r.Z_().required()}),onSubmit:async()=>{X(!0)}}),es=!!ed.values.recordId,eo=2===ed.values.wip,ei=4===ed.values.status,eu=ed.values.dispersalType;async function ec(e){return await G({extension:u.N.OutwardsModification.get,parameters:"_recordId=".concat(e)})}let em=async e=>{let a=await U({extension:u.N.OutwardsModification.close,record:JSON.stringify({recordId:e})});H&&D.ZP.success(Q.Closed),er(),await eI(a.recordId)};function ev(e){ed.setValues({...ed.values,beneficiaryData:e})}function ep(e){for(let[a,t]of Object.entries(e))ed.setFieldValue(a,null!=t?t:"")}async function ey(e){var a,t,l,n;ep(e);let{headerView:r,ttNo:d}=(await G({extension:u.N.OutwardsOrder.get2,parameters:"_recordId=".concat(null==e?void 0:e.owoId)})).record;ep({outwardsDate:(0,x.a1)(r.date),amount:r.amount,productName:r.productName,clientId:r.clientId,currencyId:r.currencyId,clientRef:r.clientRef,clientName:r.clientName,cellPhone:r.cellPhone,ttNo:d,dispersalType:r.dispersalType,countryId:r.countryId,corId:r.corId,modificationType:null==e?void 0:e.modificationType}),ef({headerBenId:null!==(a=e.newBeneficiaryId)&&void 0!==a?a:"",headerBenName:null!==(t=e.newBeneficiaryName)&&void 0!==t?t:"",headerBenSeqNo:null!==(l=e.newBeneficiarySeqNo)&&void 0!==l?l:"",dispersalType:null!==(n=r.dispersalType)&&void 0!==n?n:""})}function eh(){ed.resetForm(),z(!0)}async function ef(e){ed.setFieldValue("newBeneficiaryId",e.headerBenId),ed.setFieldValue("newBeneficiarySeqNo",e.headerBenSeqNo),ed.setFieldValue("dispersalType",e.dispersalType)}let ex=[{key:"Close",condition:!eo,onClick:()=>em(ed.values.recordId),disabled:eo||!es},{key:"Reopen",condition:eo,onClick:async()=>{let e=await U({extension:u.N.OutwardsModification.reopen,record:JSON.stringify({recordId:ed.values.recordId})});D.ZP.success(Q.Reopened),er(),await eI(e.recordId)},disabled:!eo},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!eo},{key:"Locked",condition:!0,onClick:async()=>{let e=await U({extension:u.N.OutwardsModification.post,record:JSON.stringify({recordId:ed.values.recordId})});D.ZP.success(Q.Posted),er(),await eI(e.recordId)},disabled:!ei}];async function eI(e){let a=await ec(e);a.record.date=(0,x.a1)(a.record.date),await ey(a.record)}async function eg(e){if(e)return await G({extension:u.N.OutwardsOrder.get,parameters:"_recordId=".concat(e)})}return(0,d.useEffect)(()=>{!async function(){if(ee){var e;X(!1),ea(!1);let a={owoId:ed.values.owoId,modificationType:ed.values.modificationType,owtId:ed.values.owtId,beneficiaryCashPack:1===eu?ed.values.beneficiaryData:null,beneficiaryBankPack:2===eu?ed.values.beneficiaryData:null},t=await U({extension:u.N.OutwardsModification.set2,record:JSON.stringify(a)}),l=es?Q.Edited:Q.Added;D.ZP.success(l),await eI(t.recordId),er(),H||(e=t.recordId,W({Component:R.Z,props:{values:ed.values,recordId:e,functionId:b.J.OutwardsModification,onSuccess:()=>{em(e)}}}))}}()},[ee]),(0,d.useEffect)(()=>{!async function(){H&&await eI(H)}()},[]),(0,l.jsx)(o.Z,{resourceId:m.i.OutwardsModification,form:ed,maxAccess:en,editMode:es,disabledSubmit:es,onClose:em,isClosed:eo,actions:ex,functionId:b.J.OutwardsModification,previewReport:es,children:(0,l.jsx)(p.R,{children:(0,l.jsx)(y.Q,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.g,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsx)(s.Z,{name:"reference",label:et.reference,value:ed.values.reference,maxAccess:en,readOnly:!0})}),(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsx)(i.Z,{name:"date",required:!0,readOnly:es,label:et.date,value:ed.values.date,editMode:es,maxAccess:en,onChange:ed.setFieldValue,onClear:()=>ed.setFieldValue("date",""),error:ed.touched.date&&!!ed.errors.date})}),(0,l.jsx)(n.ZP,{item:!0,xs:2,children:(0,l.jsx)(f.U,{endpointId:u.N.OutwardsOrder.snapshot,valueField:"reference",displayField:"reference",name:"owRef",secondDisplayField:!1,required:!0,readOnly:es||ed.values.owtRef,label:et.outwardOrder,form:ed,onChange:(e,a)=>{(null==a?void 0:a.recordId)?ey({owoId:null==a?void 0:a.recordId,owRef:null==a?void 0:a.reference,oldBeneficiaryId:null==a?void 0:a.beneficiaryId,oldBeneficiarySeqNo:null==a?void 0:a.beneficiarySeqNo,oldBeneficiaryName:null==a?void 0:a.beneficiaryName,newBeneficiaryId:null==a?void 0:a.beneficiaryId,newBeneficiarySeqNo:null==a?void 0:a.beneficiarySeqNo,newBeneficiaryName:null==a?void 0:a.beneficiaryName,dispersalType:null==a?void 0:a.dispersalType}):eh()},error:ed.touched.owRef&&!!ed.errors.owRef,maxAccess:en})}),(0,l.jsx)(n.ZP,{item:!0,xs:2,children:(0,l.jsx)(f.U,{endpointId:u.N.OutwardsTransfer.snapshot,valueField:"reference",displayField:"reference",name:"owtRef",secondDisplayField:!1,readOnly:es||ed.values.owRef,label:et.outwardTransfer,form:ed,onChange:async(e,a)=>{var t,l,n,r,d,s,o,i;(null==a?void 0:a.recordId)||eh();let u=await eg(null==a?void 0:a.owoId);await ey({owoId:null==a?void 0:a.owoId,owRef:null==u?void 0:null===(t=u.record)||void 0===t?void 0:t.reference,owtId:null==a?void 0:a.recordId,owtRef:null==a?void 0:a.reference,oldBeneficiaryId:null==u?void 0:null===(l=u.record)||void 0===l?void 0:l.beneficiaryId,oldBeneficiarySeqNo:null==u?void 0:null===(n=u.record)||void 0===n?void 0:n.beneficiarySeqNo,oldBeneficiaryName:null==u?void 0:null===(r=u.record)||void 0===r?void 0:r.beneficiaryName,newBeneficiaryId:null==u?void 0:null===(d=u.record)||void 0===d?void 0:d.beneficiaryId,newBeneficiarySeqNo:null==u?void 0:null===(s=u.record)||void 0===s?void 0:s.beneficiarySeqNo,newBeneficiaryName:null==u?void 0:null===(o=u.record)||void 0===o?void 0:o.beneficiaryName,dispersalType:null==u?void 0:null===(i=u.record)||void 0===i?void 0:i.dispersalType})},error:ed.touched.owtRef&&!!ed.errors.owtRef,maxAccess:en})}),(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsx)(s.Z,{name:"ttNo",label:et.ttNo,value:ed.values.ttNo,readOnly:!0,error:ed.touched.ttNo&&!!ed.errors.ttNo,maxAccess:en})}),(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsx)(i.Z,{name:"outwardsDate",label:et.outwardsDate,value:ed.values.outwardsDate,editMode:es,maxAccess:en,readOnly:!0,error:ed.touched.outwardsDate&&!!ed.errors.outwardsDate})}),(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsx)(s.Z,{name:"productName",label:et.product,value:ed.values.productName,readOnly:!0,error:ed.touched.ttNo&&!!ed.errors.productName,maxAccess:en})}),(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsx)(h.Z,{name:"amount",label:et.amount,value:ed.values.amount,maxAccess:en,readOnly:!0,error:ed.touched.amount&&!!ed.errors.amount})}),(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsx)(F.Z,{datasetId:Z.v.OW_MODIFICATION_TYPE,name:"modificationType",label:et.modificationType,values:ed.values,valueField:"key",displayField:"value",required:!0,readOnly:es,maxAccess:en,onChange:(e,a)=>{ed.setFieldValue("modificationType",null==a?void 0:a.key),(null==a?void 0:a.key)==3&&(z(!0),ed.setFieldValue("newBeneficiaryId",""),ed.setFieldValue("newBeneficiarySeqNo",""),ed.setFieldValue("headerBenName",""))},error:ed.touched.modificationType&&!!ed.errors.modificationType})}),(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsx)(f.U,{endpointId:u.N.Beneficiary.snapshot2,parameters:{_clientId:ed.values.clientId,_dispersalType:ed.values.dispersalType,_currencyId:ed.values.currencyId},valueField:"name",displayField:"name",name:"headerBenName",label:et.beneficiary,form:ed,readOnly:!ed.values.clientId||!ed.values.dispersalType||es||ei||2!=ed.values.modificationType,maxAccess:en,editMode:es,secondDisplayField:!1,onChange:async(e,a)=>{(null==a?void 0:a.beneficiaryId)?ef({headerBenId:null==a?void 0:a.beneficiaryId,headerBenName:null==a?void 0:a.name,headerBenSeqNo:null==a?void 0:a.seqNo,dispersalType:null==a?void 0:a.dispersalType}):(ed.setFieldValue("headerBenId",""),ed.setFieldValue("headerBenName",""),ed.setFieldValue("headerBenSeqNo",""))},errorCheck:"headerBenId"})})]})})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(y.Q,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsxs)(I.Z,{title:et.benOld,form:!0,children:[2===eu&&(0,l.jsx)(C.Z,{client:{clientId:ed.values.clientId,clientName:ed.values.clientName,clientRef:ed.values.clientRef},beneficiary:{beneficiaryId:ed.values.oldBeneficiaryId,beneficiarySeqNo:ed.values.oldBeneficiarySeqNo},dispersalType:ed.values.dispersalType,countryId:ed.values.countryId,corId:ed.values.corId,recordId:(null===(a=ed.values)||void 0===a?void 0:a.clientId)&&(null===(t=ed.values)||void 0===t?void 0:t.oldBeneficiaryId)&&(null===(k=ed.values)||void 0===k?void 0:k.oldBeneficiarySeqNo)?(100*ed.values.clientId).toString()+(10*ed.values.oldBeneficiaryId).toString()+ed.values.oldBeneficiarySeqNo:null,viewBtns:!1}),1===eu&&(0,l.jsx)(g.Z,{client:{clientId:ed.values.clientId,clientName:ed.values.clientName,clientRef:ed.values.clientRef},beneficiary:{beneficiaryId:ed.values.oldBeneficiaryId,beneficiarySeqNo:ed.values.oldBeneficiarySeqNo},dispersalType:ed.values.dispersalType,countryId:ed.values.countryId,corId:ed.values.corId,recordId:(null===(O=ed.values)||void 0===O?void 0:O.clientId)&&(null===(A=ed.values)||void 0===A?void 0:A.oldBeneficiaryId)&&(null===(V=ed.values)||void 0===V?void 0:V.oldBeneficiarySeqNo)?(100*ed.values.clientId).toString()+(10*ed.values.oldBeneficiaryId).toString()+ed.values.oldBeneficiarySeqNo:null,viewBtns:!1})]})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsxs)(I.Z,{title:et.benNew,form:!0,children:[2===eu&&(0,l.jsx)(C.Z,{viewBtns:!1,resetForm:$,setResetForm:z,onChange:ev,submitted:K,setSubmitted:X,setValidSubmit:ea,forceEdit:es,client:{clientId:ed.values.clientId,clientName:ed.values.clientName,clientRef:ed.values.clientRef},beneficiary:{beneficiaryId:ed.values.newBeneficiaryId,beneficiarySeqNo:ed.values.newBeneficiarySeqNo},dispersalType:ed.values.dispersalType,corId:ed.values.corId,recordId:(null===(L=ed.values)||void 0===L?void 0:L.clientId)&&(null===(_=ed.values)||void 0===_?void 0:_.newBeneficiaryId)&&(null===(M=ed.values)||void 0===M?void 0:M.newBeneficiarySeqNo)?(100*ed.values.clientId).toString()+(10*ed.values.newBeneficiaryId).toString()+ed.values.newBeneficiarySeqNo:null,submitMainForm:!1}),1===eu&&(0,l.jsx)(g.Z,{viewBtns:!1,forceEdit:es,resetForm:$,setResetForm:z,onChange:ev,submitted:K,setSubmitted:X,setValidSubmit:ea,client:{clientId:ed.values.clientId,clientName:ed.values.clientName,clientRef:ed.values.clientRef},beneficiary:{beneficiaryId:ed.values.newBeneficiaryId,beneficiarySeqNo:ed.values.newBeneficiarySeqNo},dispersalType:ed.values.dispersalType,countryId:ed.values.countryId,corId:ed.values.corId,recordId:(null===(E=ed.values)||void 0===E?void 0:E.clientId)&&(null===(J=ed.values)||void 0===J?void 0:J.newBeneficiaryId)&&(null===(B=ed.values)||void 0===B?void 0:B.newBeneficiarySeqNo)?(100*ed.values.clientId).toString()+(10*ed.values.newBeneficiaryId).toString()+ed.values.newBeneficiarySeqNo:null,submitMainForm:!1})]})})]})})})]})})})})};k.width=1200,k.height=650,a.Z=k},21379:function(e,a,t){"use strict";t.d(a,{Z:function(){return j}});var l=t(52322),n=t(60218),r=t(2784),d=t(48601),s=t(62202),o=t(39812),i=t(65950),u=t(19473),c=t(71987),m=t(83562),v=t(7121),p=t(98345),y=t(80983),h=t(26612),f=t(82737),x=t(31389),I=t(62362),g=t(8661),C=t(38449),D=t(5088),b=t(89330),S=t(84100),R=t(91406),q=t(21581),w=t(50023),P=t(21326);function j(e){var a,t,j,F,Z,T,N,k,O,A,V;let{recordId:L,window:_}=e,{getRequest:M,postRequest:E}=(0,r.useContext)(i.$),{platformLabels:J,defaultsData:B}=(0,r.useContext)(u.l),H=parseInt(null==B?void 0:null===(t=B.list)||void 0===t?void 0:null===(a=t.find(e=>{let{key:a}=e;return"pytvStartDate"===a}))||void 0===a?void 0:a.value)||null,Y=parseInt(null==B?void 0:null===(F=B.list)||void 0===F?void 0:null===(j=F.find(e=>{let{key:a}=e;return"pytvEndDate"===a}))||void 0===j?void 0:j.value)||null,G=(0,c.E)({endpointId:m.m.Payroll.page}),{labels:U,access:W}=(0,w.Z)({datasetId:h.i.PayrollHeader,editMode:!!L});(0,P.Z)({title:U.payrollList,window:_});let{documentType:Q,maxAccess:$,changeDT:z}=(0,p.H)({functionId:v.J.PayrollList,access:W,enabled:!L}),{formik:K}=(0,y.c)({maxAccess:$,documentType:{key:"dtId",value:null==Q?void 0:Q.dtId,reference:null==Q?void 0:Q.reference},initialValues:{recordId:null,dtId:null,reference:"",fiscalYear:null,salaryType:5,date:new Date,payDate:null,startDate:null,endDate:null,taStartDate:null,taEndDate:null,calendarDays:null,periodId:null,notes:"",status:1},validationSchema:d.Ry({periodId:d.Rx().required(),date:d.hT().required(),payDate:d.hT().required(),startDate:d.hT().required(),endDate:d.hT().required(),fiscalYear:d.Rx().required()}),onSubmit:async e=>{await E({extension:m.m.Payroll.set,record:JSON.stringify(e)}),s.ZP.success(e.recordId?J.Edited:J.Added),G(),_.close()}}),X=!!K.values.recordId,ee=2==K.values.wip,ea=3===K.values.status,et=async e=>{if(e){let a=await M({extension:m.m.Payroll.get,parameters:"_recordId=".concat(e)});K.setValues({...a.record,date:(0,o.a1)(a.record.date),payDate:(0,o.a1)(a.record.payDate),startDate:(0,o.a1)(a.record.startDate),endDate:(0,o.a1)(a.record.endDate),taStartDate:(0,o.a1)(a.record.taStartDate),taEndDate:(0,o.a1)(a.record.taEndDate)})}};(0,r.useEffect)(()=>{et(L)},[]);let el=async()=>{let e=await E({extension:m.m.Payroll.close,record:JSON.stringify({...K.values,date:(0,o.ku)(K.values.date),payDate:(0,o.ku)(K.values.payDate),startDate:(0,o.ku)(K.values.startDate),endDate:(0,o.ku)(K.values.endDate),taStartDate:(0,o.ku)(K.values.taStartDate),taEndDate:(0,o.ku)(K.values.taEndDate)})});s.ZP.success(J.Closed),et(null==e?void 0:e.recordId),G()},en=async()=>{await E({extension:m.m.Payroll.post,record:JSON.stringify({...K.values,date:(0,o.ku)(K.values.date),payDate:(0,o.ku)(K.values.payDate),startDate:(0,o.ku)(K.values.startDate),endDate:(0,o.ku)(K.values.endDate),taStartDate:(0,o.ku)(K.values.taStartDate),taEndDate:(0,o.ku)(K.values.taEndDate)})}),s.ZP.success(J.Posted),et(L),G()},er=async()=>{let e=await E({extension:m.m.Payroll.unpost,record:JSON.stringify({...K.values,date:(0,o.ku)(K.values.date),payDate:(0,o.ku)(K.values.payDate),startDate:(0,o.ku)(K.values.startDate),endDate:(0,o.ku)(K.values.endDate),taStartDate:(0,o.ku)(K.values.taStartDate),taEndDate:(0,o.ku)(K.values.taEndDate)})});s.ZP.success(J.Unposted),et(null==e?void 0:e.recordId),G()},ed=async()=>{let e=await E({extension:m.m.Payroll.reopen,record:JSON.stringify({...K.values,date:(0,o.ku)(K.values.date),payDate:(0,o.ku)(K.values.payDate),startDate:(0,o.ku)(K.values.startDate),endDate:(0,o.ku)(K.values.endDate),taStartDate:(0,o.ku)(K.values.taStartDate),taEndDate:(0,o.ku)(K.values.taEndDate)})});s.ZP.success(J.Reopened),et(null==e?void 0:e.recordId),G()},es=[{key:"GL",condition:!0,onClick:"onClickGL",datasetId:h.i.GLPayrollList,disabled:!X},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!ee},{key:"Close",condition:!ee,onClick:el,disabled:ee||!X},{key:"Reopen",condition:ee,onClick:ed,disabled:!ee||ea},{key:"Unlocked",condition:!ea,onClick:en,disabled:!X||!ee},{key:"Locked",condition:ea,onClick:"onUnpostConfirmation",onSuccess:er,disabled:!X||!ee}],eo=(e,a,t,l)=>{if(!e||!a)return{};let n=new Date(e),r=new Date(a),d=new Date(r.getFullYear(),r.getMonth(),l),s=n.getMonth(),o=n.getFullYear();return t>n.getDate()&&(s-=1)<0&&(s=11,o-=1),{taStartDate:new Date(o,s,t),taEndDate:d}};return(0,l.jsx)(f.Z,{resourceId:h.i.PayrollHeader,form:K,maxAccess:$,editMode:X,actions:es,functionId:v.J.PayrollList,disabledSubmit:ee,children:(0,l.jsx)(x.R,{children:(0,l.jsx)(I.Q,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{endpointId:C.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(v.J.PayrollList),name:"dtId",label:U.docType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:X,valueField:"recordId",displayField:["reference","name"],values:K.values,maxAccess:$,onChange:async(e,a)=>{await z(a),K.setFieldValue("dtId",(null==a?void 0:a.recordId)||null)},error:K.touched.dtId&&!!K.errors.dtId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"reference",label:U.reference,value:null==K?void 0:null===(Z=K.values)||void 0===Z?void 0:Z.reference,maxAccess:!X&&$,readOnly:X,onChange:K.handleChange,onClear:()=>K.setFieldValue("reference",""),error:K.touched.reference&&!!K.errors.reference})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"date",required:!0,label:U.date,value:null==K?void 0:null===(T=K.values)||void 0===T?void 0:T.date,maxAccess:$,readOnly:ee,onChange:K.setFieldValue,onClear:()=>K.setFieldValue("date",null),error:K.touched.date&&!!K.errors.date})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{endpointId:m.m.FiscalYear.qry,name:"fiscalYear",label:U.fiscalYear,valueField:"fiscalYear",displayField:"fiscalYear",values:K.values,readOnly:ee,required:!0,maxAccess:$,onChange:(e,a)=>{K.setFieldValue("fiscalYear",(null==a?void 0:a.fiscalYear)||null)},error:K.touched.fiscalYear&&!!K.errors.fiscalYear})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{datasetId:S.v.SALARY_TYPE,name:"salaryType",label:U.salaryType,valueField:"key",displayField:"value",values:K.values,maxAccess:$,readOnly:!0,onChange:(e,a)=>K.setFieldValue("salaryType",(null==a?void 0:a.key)||null),error:K.touched.salaryType&&!!K.errors.salaryType})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{endpointId:m.m.Period.qry,parameters:K.values.fiscalYear&&K.values.salaryType&&"_year=".concat(K.values.fiscalYear,"&_salaryType=").concat(K.values.salaryType,"&_status=0"),name:"periodId",label:U.period,valueField:"periodId",required:!0,displayField:"periodName",values:K.values,readOnly:ee,maxAccess:$,onChange:(e,a)=>K.setFieldValue("periodId",(null==a?void 0:a.periodId)||null),error:K.touched.periodId&&!!K.errors.periodId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"payDate",required:!0,label:U.payDate,value:null==K?void 0:null===(N=K.values)||void 0===N?void 0:N.payDate,maxAccess:$,readOnly:ee,onChange:(e,a)=>{if(a&&5===K.values.salaryType){let e=new Date(a),t=new Date(e.getFullYear(),e.getMonth(),1),l=new Date(e.getFullYear(),e.getMonth()+1,0),n=l.getTime()-t.getTime();if(K.setFieldValue("calendarDays",n/864e5+1),K.setFieldValue("startDate",t),K.setFieldValue("endDate",l),K.setFieldTouched("startDate",!1,!1),K.setFieldTouched("endDate",!1,!1),H&&Y){let{taStartDate:e,taEndDate:a}=eo(t,l,H,Y);K.setFieldValue("taStartDate",e),K.setFieldValue("taEndDate",a)}}K.setFieldValue("payDate",a)},onClear:()=>{K.setFieldValue("payDate",null),K.setFieldValue("calendarDays",""),K.setFieldValue("startDate",null),K.setFieldValue("endDate",null),K.setFieldValue("taStartDate",null),K.setFieldValue("taEndDate",null)},error:K.touched.payDate&&!!K.errors.payDate})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"startDate",label:U.startDate,value:null==K?void 0:null===(k=K.values)||void 0===k?void 0:k.startDate,maxAccess:$,readOnly:!0,required:!0,onChange:K.setFieldValue,onClear:()=>K.setFieldValue("startDate",null),error:K.touched.startDate&&!!K.errors.startDate})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"endDate",label:U.endDate,value:null==K?void 0:null===(O=K.values)||void 0===O?void 0:O.endDate,onChange:K.setFieldValue,maxAccess:$,readOnly:!0,required:!0,onClear:()=>K.setFieldValue("endDate",null),error:K.touched.endDate&&!!K.errors.endDate})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"taStartDate",label:U.taStartDate,value:null==K?void 0:null===(A=K.values)||void 0===A?void 0:A.taStartDate,onChange:K.setFieldValue,maxAccess:$,readOnly:!0,onClear:()=>K.setFieldValue("taStartDate",null),error:K.touched.taStartDate&&!!K.errors.taStartDate})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"taEndDate",label:U.taEndDate,value:null==K?void 0:null===(V=K.values)||void 0===V?void 0:V.taEndDate,onChange:K.setFieldValue,maxAccess:$,readOnly:!0,onClear:()=>K.setFieldValue("taEndDate",null),error:K.touched.taEndDate&&!!K.errors.taEndDate})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(R.Z,{name:"calendarDays",label:U.calendarDays,value:K.values.calendarDays,onChange:K.handleChange,onClear:()=>K.setFieldValue("calendarDays",""),readOnly:!0,maxAccess:$,error:K.touched.calendarDays&&!!K.errors.calendarDays})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(q.Z,{name:"notes",label:U.notes,value:K.values.notes,maxAccess:$,readOnly:ee,rows:3,maxLength:"128",onChange:e=>K.setFieldValue("notes",e.target.value),onClear:()=>K.setFieldValue("notes",""),error:K.touched.notes&&!!K.errors.notes})})]})})})})}j.width=850,j.height=700},73470:function(e,a,t){"use strict";t.d(a,{Z:function(){return F}});var l=t(52322),n=t(89330),r=t(39812),d=t(60218),s=t(2784),o=t(48601),i=t(82737),u=t(62202),c=t(65950),m=t(71987),v=t(26612),p=t(5088),y=t(21581),h=t(8661),f=t(7121),x=t(27423),I=t(62362),g=t(31389),C=t(91406),D=t(80983),b=t(19473),S=t(92407),R=t(75991),q=t(68676),w=t(96026),P=t(21326),j=t(50023);function F(e){var a,t,F,Z,T,N,k,O,A;let{recordId:V,window:L}=e,{getRequest:_,postRequest:M}=(0,s.useContext)(c.$),{platformLabels:E}=(0,s.useContext)(b.l),{stack:J}=(0,w.V)(),{labels:B,access:H}=(0,j.Z)({datasetId:v.i.ResignationRequest,editMode:!!V});(0,P.Z)({title:B.ResignationReq,window:L});let Y=(0,m.E)({endpointId:S.y.ResignationRequest.page}),{formik:G}=(0,D.c)({maxAccess:H,initialValues:{recordId:V||null,reference:"",date:new Date,effectiveDate:null,employeeId:null,department:null,position:null,branch:null,hireDate:null,serviceDuration:null,netSalary:null,explanation:"",status:1,wip:1,reasonId:null,releaseStatus:null},validateOnChange:!0,validationSchema:o.Ry({employeeId:o.Rx().required(),effectiveDate:o.hT().required(),date:o.hT().required(),reasonId:o.Rx().required()}),onSubmit:async e=>{let{hireDate:a,department:t,position:l,branch:n,serviceDuration:d,netSalary:s,...o}=e;M({extension:S.y.ResignationRequest.set,record:JSON.stringify({...o,date:(0,r.OZ)(new Date(e.date)),effectiveDate:(0,r.OZ)(new Date(e.effectiveDate))})}).then(async e=>{u.ZP.success(V?E.Edited:E.Added),G.setFieldValue("recordId",e.recordId),await U(e.recordId),Y()})}});function U(e){_({extension:S.y.ResignationRequest.get,parameters:"_recordId=".concat(e)}).then(e=>{!function(e){_({extension:S.y.QuickView.get,parameters:"_recordId=".concat(null==e?void 0:e.employeeId,"&_asOfDate=").concat((0,r.Uf)((0,r.a1)(null==e?void 0:e.date)))}).then(a=>{var t,l,n,d,s,o;G.setValues({...G.values,...e,effectiveDate:(0,r.a1)(null==e?void 0:e.effectiveDate),date:(0,r.a1)(null==e?void 0:e.date),hireDate:(0,r.a1)(null==a?void 0:null===(t=a.record)||void 0===t?void 0:t.hireDate),department:null==a?void 0:null===(l=a.record)||void 0===l?void 0:l.departmentName,position:null==a?void 0:null===(n=a.record)||void 0===n?void 0:n.positionName,branch:null==a?void 0:null===(d=a.record)||void 0===d?void 0:d.branchName,serviceDuration:null==a?void 0:null===(s=a.record)||void 0===s?void 0:s.serviceDuration,netSalary:null==a?void 0:null===(o=a.record)||void 0===o?void 0:o.salary})})}(e.record)})}async function W(e){if(e){var a;await _({extension:S.y.QuickView.get,parameters:"_recordId=".concat(e,"&_asOfDate=").concat((0,r.Uf)(null==G?void 0:null===(a=G.values)||void 0===a?void 0:a.date))}).then(e=>{var a,t,l,n,d,s;G.setFieldValue("hireDate",(0,r.a1)(null==e?void 0:null===(a=e.record)||void 0===a?void 0:a.hireDate)||null),G.setFieldValue("department",(null==e?void 0:null===(t=e.record)||void 0===t?void 0:t.departmentName)||null),G.setFieldValue("position",(null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.positionName)||null),G.setFieldValue("branch",(null==e?void 0:null===(n=e.record)||void 0===n?void 0:n.branchName)||null),G.setFieldValue("serviceDuration",(null==e?void 0:null===(d=e.record)||void 0===d?void 0:d.serviceDuration)||null),G.setFieldValue("netSalary",(null==e?void 0:null===(s=e.record)||void 0===s?void 0:s.salary)||0)})}else G.setFieldValue("hireDate",null),G.setFieldValue("department",null),G.setFieldValue("position",null),G.setFieldValue("branch",null),G.setFieldValue("serviceDuration",null),G.setFieldValue("netSalary",null)}let Q=!!G.values.recordId,$=2===G.values.wip;async function z(){var e,a;let{hireDate:t,department:l,position:n,branch:d,serviceDuration:s,netSalary:o,...i}=null==G?void 0:G.values;await M({extension:S.y.ResignationRequest.reopen,record:JSON.stringify({...i,date:(0,r.OZ)(new Date(null==G?void 0:null===(e=G.values)||void 0===e?void 0:e.date)),effectiveDate:(0,r.OZ)(new Date(null==G?void 0:null===(a=G.values)||void 0===a?void 0:a.effectiveDate))})}).then(()=>{var e;u.ZP.success(E.Reopened),Y(),U(null==G?void 0:null===(e=G.values)||void 0===e?void 0:e.recordId)})}let K=[{key:"Close",condition:!$,onClick:async function(){var e,a;let{hireDate:t,department:l,position:n,branch:d,serviceDuration:s,netSalary:o,...i}=null==G?void 0:G.values;await M({extension:S.y.ResignationRequest.close,record:JSON.stringify({...i,date:(0,r.OZ)(new Date(null==G?void 0:null===(e=G.values)||void 0===e?void 0:e.date)),effectiveDate:(0,r.OZ)(new Date(null==G?void 0:null===(a=G.values)||void 0===a?void 0:a.effectiveDate))})}).then(()=>{var e;u.ZP.success(E.Closed),Y(),U(null==G?void 0:null===(e=G.values)||void 0===e?void 0:e.recordId)})},disabled:$||!Q},{key:"Reopen",condition:$,onClick:async function(){var e,a;(null==G?void 0:null===(e=G.values)||void 0===e?void 0:e.releaseStatus)?await _({extension:q.y.ReleaseIndicator.get,parameters:"_recordId=".concat(null==G?void 0:null===(a=G.value)||void 0===a?void 0:a.releaseStatus)}).then(e=>{var a;(null==e?void 0:null===(a=e.record)||void 0===a?void 0:a.isReleased)?J({message:B.documentReleasedError}):z()}):z()},disabled:!$||!Q},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!$}];return(0,s.useEffect)(()=>{V&&U(V)},[]),(0,l.jsx)(i.Z,{resourceId:v.i.ResignationRequest,functionId:f.J.ResignationRequest,form:G,maxAccess:H,actions:K,editMode:Q,isClosed:$,disabledSubmit:$,children:(0,l.jsx)(g.R,{children:(0,l.jsx)(I.Q,{children:(0,l.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(d.ZP,{item:!0,xs:6,children:(0,l.jsx)(p.Z,{name:"reference",label:B.reference,value:null==G?void 0:null===(a=G.values)||void 0===a?void 0:a.reference,maxAccess:H,readOnly:!Q||$,onChange:G.handleChange,onClear:()=>G.setFieldValue("reference",""),error:G.touched.reference&&!!G.errors.reference})}),(0,l.jsx)(d.ZP,{item:!0,xs:6,children:(0,l.jsx)(n.Z,{name:"effectiveDate",required:!0,label:B.effectiveDate,value:null==G?void 0:null===(t=G.values)||void 0===t?void 0:t.effectiveDate,onChange:G.setFieldValue,readOnly:$,maxAccess:H,onClear:()=>G.setFieldValue("effectiveDate",null),error:G.touched.effectiveDate&&!!G.errors.effectiveDate})}),(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(x.U,{endpointId:S.y.Employee.snapshot,parameters:{_branchId:0},required:!0,form:G,filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeRef",readOnly:$,label:B.employee,secondFieldLabel:B.name,secondDisplayField:!0,secondValue:G.values.employeeName,onChange:(e,a)=>{G.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null),G.setFieldValue("employeeRef",(null==a?void 0:a.reference)||null),G.setFieldValue("employeeName",(null==a?void 0:a.fullName)||null),W(null==a?void 0:a.recordId)},error:G.touched.employeeId&&!!G.errors.employeeId})}),(0,l.jsx)(d.ZP,{item:!0,xs:6,children:(0,l.jsx)(n.Z,{name:"date",required:!0,readOnly:$,label:B.date,value:null==G?void 0:null===(F=G.values)||void 0===F?void 0:F.date,onChange:G.setFieldValue,maxAccess:H,onClear:()=>G.setFieldValue("date",null),error:G.touched.date&&!!G.errors.date})}),(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsxs)(R.Z,{title:B.jobInfo,children:[(0,l.jsx)(d.ZP,{item:!0,xs:6,children:(0,l.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.Z,{name:"department",label:B.department,value:null==G?void 0:null===(Z=G.values)||void 0===Z?void 0:Z.department,maxAccess:H,readOnly:!0})}),(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.Z,{name:"position",label:B.position,value:null==G?void 0:null===(T=G.values)||void 0===T?void 0:T.position,maxAccess:H,readOnly:!0})}),(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.Z,{name:"branch",label:B.branch,value:null==G?void 0:null===(N=G.values)||void 0===N?void 0:N.branch,maxAccess:H,readOnly:!0})}),(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(n.Z,{name:"hireDate",label:B.hireDate,value:null==G?void 0:null===(k=G.values)||void 0===k?void 0:k.hireDate,readOnly:!0,maxAccess:H})})]})}),(0,l.jsx)(d.ZP,{item:!0,xs:6,children:(0,l.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.Z,{name:"serviceDuration",label:B.YIS,value:null==G?void 0:null===(O=G.values)||void 0===O?void 0:O.serviceDuration,maxAccess:H,readOnly:!0})}),(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"netSalary",label:B.netSalary,value:null==G?void 0:null===(A=G.values)||void 0===A?void 0:A.netSalary,maxAccess:H,readOnly:!0})})]})})]})}),(0,l.jsx)(d.ZP,{item:!0,xs:6,children:(0,l.jsx)(h.Z,{endpointId:S.y.TerminationReasons.qry,name:"reasonId",label:B.reason,valueField:"recordId",required:!0,displayField:"name",readOnly:$,values:G.values,onChange:(e,a)=>{G.setFieldValue("reasonId",(null==a?void 0:a.recordId)||null)},error:G.touched.reasonId&&!!G.errors.reasonId,maxAccess:H})}),(0,l.jsx)(d.ZP,{item:!0,xs:7,children:(0,l.jsx)(y.Z,{name:"explanation",label:B.explanation,value:G.values.explanation,rows:3,readOnly:$,maxAccess:H,onChange:e=>G.setFieldValue("explanation",e.target.value),onClear:()=>G.setFieldValue("explanation",""),error:G.touched.explanation&&!!G.errors.explanation})})]})})})})}F.width=850,F.height=630},58583:function(e,a,t){"use strict";t.d(a,{Z:function(){return F}});var l=t(52322),n=t(60218),r=t(2784),d=t(48601),s=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(31389),p=t(80983),y=t(8661),h=t(89330),f=t(39812),x=t(7121),I=t(98345),g=t(19473),C=t(21581),D=t(27423),b=t(92407),S=t(6035),R=t(28298),q=t(28879),w=t.n(q),P=t(21326),j=t(50023);function F(e){var a,t,q,F,Z;let{recordId:T,window:N}=e,{platformLabels:k}=(0,r.useContext)(g.l),{getRequest:O,postRequest:A}=(0,r.useContext)(i.$),{labels:V,access:L}=(0,j.Z)({datasetId:c.i.ShiftLeave,editMode:!!T});(0,P.Z)({title:V.duringShiftLeave,window:N});let{maxAccess:_}=(0,I.H)({functionId:x.J.DuringShiftLeave,access:L,enabled:!T}),M=(0,u.E)({endpointId:S.f.ShitLeave.page}),{formik:E}=(0,p.c)({initialValues:{recordId:null,employeeId:null,employeeRef:"",employeeName:"",reference:"",date:new Date,leaveDate:null,reasonId:null,fromTime:null,toTime:null,realDuration:null,destination:null,notes:"",status:1,wip:1,departmentRef:"",departmentName:"",reportToRef:"",reportToName:"",departmentHeadName:"",departmentHeadRef:"",position:"",schedule:""},maxAccess:_,validateOnChange:!0,validationSchema:d.Ry({employeeId:d.Rx().required(),reasonId:d.Rx().required(),duration:d.Z_().required(),destination:d.Z_().required(),leaveDate:d.hT().required(),fromTime:d.Z_().required(),toTime:d.Z_().required()}),onSubmit:async e=>{let{date:a,leaveDate:t,fromTime:l,toTime:n,returnTime:r,statusName:d,rsName:s,wipName:i,employeeRef:u,employeeName:c,departmentRef:m,departmentName:v,reportToRef:p,reportToName:y,departmentHeadName:h,departmentHeadRef:x,position:I,schedule:g,...C}=e,D=await A({extension:S.f.ShitLeave.set,record:JSON.stringify({...C,date:(0,f.ku)(a),leaveDate:(0,f.ku)(t),fromTime:w()(l).format("HH:mm"),toTime:w()(n).format("HH:mm"),returnTime:w()(r).format("HH:mm")})});o.ZP.success(e.recordId?k.Edited:k.Added),ec(D.recordId),M()}}),J=!!(null===(a=E.values)||void 0===a?void 0:a.recordId),B=(null==E?void 0:null===(t=E.values)||void 0===t?void 0:t.wip)===2,{date:H,leaveDate:Y,fromTime:G,toTime:U,returnTime:W,statusName:Q,rsName:$,wipName:z,employeeRef:K,employeeName:X,departmentRef:ee,departmentName:ea,reportToRef:et,reportToName:el,departmentHeadName:en,departmentHeadRef:er,position:ed,schedule:es,...eo}=E.values,ei=async()=>{await A({extension:S.f.ShitLeave.close,record:JSON.stringify({...eo,date:(0,f.ku)(H),leaveDate:(0,f.ku)(Y),fromTime:w()(G).format("HH:mm"),toTime:w()(U).format("HH:mm"),returnTime:w()(W).format("HH:mm")})}),o.ZP.success(k.Closed),ec(E.values.recordId),M()},eu=async()=>{await A({extension:S.f.ShitLeave.reopen,record:JSON.stringify({...eo,date:(0,f.ku)(H),leaveDate:(0,f.ku)(Y),fromTime:w()(G).format("HH:mm"),toTime:w()(U).format("HH:mm"),returnTime:w()(W).format("HH:mm")})}),o.ZP.success(k.Reopened),ec(E.values.recordId),M()};async function ec(e){var a;let{record:t}=await O({extension:S.f.ShitLeave.get,parameters:"_recordId=".concat(e)});return E.setValues({...t,date:(0,f.a1)(t.date),leaveDate:(0,f.a1)(t.leaveDate),fromTime:w()(t.fromTime,"HH:mm"),toTime:w()(t.toTime,"HH:mm"),returnTime:(null==t?void 0:null===(a=t.returnTime)||void 0===a?void 0:a.trim())?w()(null==t?void 0:t.returnTime,"HH:mm"):null}),ey(t.employeeId),t}(0,r.useEffect)(()=>{T&&ec(T)},[]);let em=[{key:"Close",condition:!B,onClick:ei,disabled:B||!J},{key:"Reopen",condition:B,onClick:eu,disabled:!B},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!B}],ev=e=>{let a=new Date(e),t=a.getFullYear(),l=String(a.getMonth()+1).padStart(2,"0"),n=String(a.getDate()).padStart(2,"0");return"".concat(t).concat(l).concat(n)};(0,r.useEffect)(()=>{!async function(){if(E.values.leaveDate&&E.values.employeeId){let{list:e}=await O({extension:S.f.FlatSchedule.qry,parameters:"_params=1|"+E.values.employeeId+"^2|"+ev(E.values.leaveDate)+"^3|"+ev(E.values.leaveDate)}),a=null==e?void 0:e.map(e=>{let a=w()((0,f.a1)(e.dtFrom)).format("HH:mm"),t=w()((0,f.a1)(e.dtTo)).format("HH:mm");return"[".concat(a,"..").concat(t,"]")}).join(" ");E.setFieldValue("schedule",a)}}()},[E.values.employeeId,E.values.leaveDate]),(0,r.useEffect)(()=>{let e=ep(w()(E.values.fromTime).format("HH:mm"),w()(E.values.toTime).format("HH:mm"));E.setFieldValue("duration",e||0)},[E.values.fromTime,E.values.toTime]),(0,r.useEffect)(()=>{if(E.values.returnTime){let e=ep(w()(E.values.fromTime).format("HH:mm"),w()(E.values.returnTime).format("HH:mm"));E.setFieldValue("realDuration",e||0)}else E.setFieldValue("realDuration",null)},[E.values.fromTime,E.values.returnTime]);let ep=(e,a)=>{if(!e||!a||"Invalid Date"===a||"Invalid Date"===e)return;let[t,l]=e.split(":").map(Number),[n,r]=a.split(":").map(Number),d=new Date(0,0,0,t,l),s=(new Date(0,0,0,n,r)-d)/6e4;return s<0&&(s+=1440),Number((s/60).toFixed(2))};async function ey(e){if(e){let{record:a}=await O({extension:b.y.QuickView.get,parameters:"_recordId=".concat(e,"&_asOfDate=").concat((0,f.Uf)(E.values.date))});E.setFieldValue("departmentRef",null==a?void 0:a.departmentRef),E.setFieldValue("departmentName",null==a?void 0:a.departmentName),E.setFieldValue("departmentHeadRef",null==a?void 0:a.departmentHeadRef),E.setFieldValue("departmentHeadName",null==a?void 0:a.departmentHeadName),E.setFieldValue("reportToRef",null==a?void 0:a.reportToRef),E.setFieldValue("reportToName",null==a?void 0:a.reportToName),E.setFieldValue("position","".concat((null==a?void 0:a.positionName)||"").concat((null==a?void 0:a.positionRef)?" ".concat(a.positionRef):""))}}return(0,l.jsx)(s.Z,{form:E,resourceId:c.i.ShiftLeave,functionId:x.J.DuringShiftLeave,maxAccess:_,editMode:J,previewReport:J,actions:em,disabledSubmit:B,children:(0,l.jsx)(v.R,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:8,children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(m.Z,{name:"reference",label:V.ref,value:E.values.reference,maxAccess:_,maxLength:"30",readOnly:J,onChange:E.handleChange,onClear:()=>E.setFieldValue("reference",""),error:E.touched.reference&&!!E.errors.reference})}),(0,l.jsx)(n.ZP,{item:!0,xs:6}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(h.Z,{name:"date",label:V.date,value:E.values.date,onChange:E.setFieldValue,maxAccess:L,readOnly:!0,onClear:()=>E.setFieldValue("date",""),error:E.touched.date&&!!E.errors.date})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.U,{endpointId:b.y.Employee.snapshot,parameters:{_branchId:0},filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,readOnly:B,label:V.employee,secondFieldLabel:V.employee,form:E,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:_,onChange:async(e,a)=>{await ey(null==a?void 0:a.recordId),E.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),E.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),E.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.U,{name:"department",readOnly:!0,label:V.department,secondFieldLabel:V.department,form:E,valueShow:"departmentRef",secondValueShow:"departmentName",maxAccess:_})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.U,{name:"reportTo",readOnly:!0,label:V.reportTo,secondFieldLabel:V.reportTo,form:E,valueShow:"reportToRef",secondValueShow:"reportToName",maxAccess:_})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.U,{name:"depManager",readOnly:!0,label:V.depManager,secondFieldLabel:V.depManager,form:E,valueShow:"departmentHeadRef",secondValueShow:"departmentHeadName",maxAccess:_})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(m.Z,{name:"position",label:V.empPosition,value:E.values.position,readOnly:!0,maxAccess:_})}),(0,l.jsx)(n.ZP,{item:!0,xs:6}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(m.Z,{name:"schedule",label:V.schedule,value:E.values.schedule,readOnly:!0,maxAccess:_})})]})}),(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(h.Z,{name:"leaveDate",label:V.dateOfLeave,value:null===(q=E.values)||void 0===q?void 0:q.leaveDate,required:!0,readOnly:B,onBlur:(e,a)=>{E.setFieldValue("leaveDate",a||null)},onAccept:e=>{E.setFieldValue("leaveDate",e||null)},onClear:()=>E.setFieldValue("leaveDate",null),error:E.touched.leaveDate&&!!E.errors.leaveDate,maxAccess:_})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(R.Z,{label:V.from,name:"fromTime",required:!0,use24Hour:!0,readOnly:B,value:E.values.fromTime,onChange:E.setFieldValue,onClear:()=>E.setFieldValue("fromTime",""),maxAccess:_,error:E.touched.fromTime&&!!E.errors.fromTime})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(R.Z,{label:V.to,name:"toTime",readOnly:B,use24Hour:!0,required:!0,value:E.values.toTime,onChange:E.setFieldValue,onClear:()=>E.setFieldValue("toTime",""),maxAccess:_,error:E.touched.toTime&&!!E.errors.toTime})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(m.Z,{name:"duration",label:V.leaveDuration,value:E.values.duration,readOnly:!0,required:!0,maxAccess:_,error:E.touched.duration&&!!E.errors.duration})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(y.Z,{endpointId:S.f.DSLReason.qry,name:"reasonId",label:V.dsltype,valueField:"recordId",displayField:"name",required:!0,values:E.values,onChange:(e,a)=>{E.setFieldValue("reasonId",(null==a?void 0:a.recordId)||null)},readOnly:B,maxAccess:_,error:(null==E?void 0:null===(F=E.touched)||void 0===F?void 0:F.reasonId)&&!!(null==E?void 0:null===(Z=E.errors)||void 0===Z?void 0:Z.reasonId)})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(R.Z,{label:V.returnTime,name:"returnTime",use24Hour:!0,readOnly:B,value:E.values.returnTime,onChange:E.setFieldValue,onClear:()=>E.setFieldValue("returnTime",""),maxAccess:_,error:E.touched.returnTime&&!!E.errors.returnTime})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(m.Z,{name:"realDuration",label:V.duration,value:E.values.realDuration,readOnly:!0,maxAccess:_})})]})}),(0,l.jsx)(n.ZP,{item:!0,xs:8,children:(0,l.jsx)(m.Z,{name:"destination",label:V.destination,value:E.values.destination,onChange:E.handleChange,required:!0,maxLength:100,readOnly:B,maxAccess:_,onClear:()=>E.setFieldValue("destination",""),error:E.touched.destination&&!!E.errors.destination})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"notes",label:V.notes,value:E.values.notes,rows:2,readOnly:B,maxAccess:_,onChange:E.handleChange,onClear:()=>E.setFieldValue("notes",""),error:E.touched.notes&&!!E.errors.notes})})]})})})}F.width=1e3,F.height=500},86557:function(e,a,t){"use strict";t.d(a,{Z:function(){return k}});var l=t(52322),n=t(60218),r=t(5088),d=t(8661),s=t(82737),o=t(26612),i=t(65950),u=t(2784),c=t(48601),m=t(62202),v=t(71987),p=t(80983),y=t(19473),h=t(21581),f=t(6035),x=t(50023),I=t(21326),g=t(62362),C=t(31389),D=t(27423),b=t(92407),S=t(89330),R=t(84100),q=t(91406),w=t(39812),P=t(28879),j=t.n(P),F=t(10264),Z=t.n(F),T=t(3191),N=t(7121);function k(e){var a,t,P,F,k,O;let{recordId:A,window:V}=e,{getRequest:L,postRequest:_}=(0,u.useContext)(i.$),{platformLabels:M}=(0,u.useContext)(y.l),E=(0,u.useRef)([]);j().extend(Z());let{labels:J,access:B}=(0,x.Z)({datasetId:o.i.TimeVariation,editMode:!!A});(0,I.Z)({title:null==J?void 0:J.timeVariation,window:V});let H=(0,v.E)({endpointId:f.f.TimeVariation.page}),{formik:Y}=(0,p.c)({maxAccess:B,initialValues:{recordId:A,reference:"",date:new Date,employeeId:null,dataSource:2,timeCode:20,clockDuration:X(0),duration:0,damageLevel:null,justification:"",releaseStatus:null,wip:1,status:1},validationSchema:c.Ry({employeeId:c.Rx().required(),date:c.hT().required(),timeCode:c.Rx().required(),damageLevel:c.Rx().required()}),onSubmit:async e=>{await _({extension:f.f.TimeVariation.gen,record:JSON.stringify({...e,clockDuration:0,date:(0,w.ku)(e.date)})}),m.ZP.success(e.recordId?M.Edited:M.Added),H(),V.close()}}),G=!!Y.values.recordId,U=2==Y.values.wip,W=-1==Y.values.status,Q=[{key:"Approval",condition:!0,onClick:"onApproval",disabled:!U},{key:"Close",condition:!U,onClick:"onCloseConfirmation",action:$,disabled:W||U||!G},{key:"Reopen",condition:U,onClick:"onOpenConfirmation",action:z,disabled:W||!U||!G},{key:"Cancel",condition:!0,onClick:K,disabled:!G||U||W}];async function $(){var e;let a=await _({extension:f.f.TimeVariation.close,record:JSON.stringify({...Y.values,date:(0,w.ku)(null===(e=Y.values)||void 0===e?void 0:e.date),clockDuration:0})});m.ZP.success(M.Closed),H(),er(a.recordId)}async function z(){var e;let a=await _({extension:f.f.TimeVariation.reopen,record:JSON.stringify({...Y.values,date:(0,w.ku)(null===(e=Y.values)||void 0===e?void 0:e.date),clockDuration:0})});m.ZP.success(M.Reopened),H(),er(a.recordId)}async function K(){var e;let a=await _({extension:f.f.TimeVariation.cancel,record:JSON.stringify({...Y.values,date:(0,w.ku)(null===(e=Y.values)||void 0===e?void 0:e.date),clockDuration:0})});m.ZP.success(M.Cancelled),H(),er(a.recordId)}function X(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0==e)return"00:00";let a=Math.abs(e),t=String(Math.floor(a/60)).padStart(2,"0"),l=String(a%60).padStart(2,"0");return(e<0?"-":"")+"".concat(t,":").concat(l)}async function ee(e,a){let{list:t}=await L({extension:f.f.FlatSchedule.qry,parameters:"_params=1|"+e+"^2|"+j()(a).format("YYYYMMDD")+"^3|"+j()(a).format("YYYYMMDD")}),l=null==t?void 0:t.map(e=>{let a=j().utc((0,w.a1)(e.dtFrom)).format("hh:mm A"),t=j().utc((0,w.a1)(e.dtTo)).format("hh:mm A");return{...e,dtRange:"".concat(a," - ").concat(t)}});return E.current=l||[],l||[]}async function ea(e,a,t){if(!e){el();return}let l=await ee(e,a);if(!(null==l?void 0:l.length)){el();return}let{recordId:n,duration:r}=l[0];20!=t&&(Y.setFieldValue("shiftId",n),Y.setFieldValue("duration",r),Y.setFieldValue("clockDuration",X(r)))}async function et(e){var a;if(!e){Y.setFieldValue("terminationDate",null);return}let t=await L({extension:b.y.QuickView.get,parameters:"_recordId=".concat(e,"&_asOfDate=").concat((0,w.uQ)(new Date))});Y.setFieldValue("terminationDate",(null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.terminationDate)||null)}function el(){Y.setFieldValue("shiftId",null),Y.setFieldValue("duration",0),Y.setFieldValue("clockDuration",X(0))}async function en(e){if(e)return await L({extension:f.f.TimeVariation.get,parameters:"_recordId=".concat(e)})}async function er(e){var a,t;let l=await en(e);Y.setValues({...l.record,date:(0,w.a1)(null==l?void 0:null===(a=l.record)||void 0===a?void 0:a.date),clockDuration:X(null==l?void 0:null===(t=l.record)||void 0===t?void 0:t.duration)})}return(0,u.useEffect)(()=>{!async function(){if(A){var e,a,t,l;let n=await en(A);await ee(null==n?void 0:null===(e=n.record)||void 0===e?void 0:e.employeeId,(0,w.a1)(null==n?void 0:null===(a=n.record)||void 0===a?void 0:a.date)),Y.setValues({...n.record,date:(0,w.a1)(null==n?void 0:null===(t=n.record)||void 0===t?void 0:t.date),clockDuration:X(null==n?void 0:null===(l=n.record)||void 0===l?void 0:l.duration)})}}()},[]),(0,l.jsx)(s.Z,{form:Y,resourceId:o.i.TimeVariation,maxAccess:B,editMode:G,actions:Q,isCleared:!1,functionId:N.J.TimeVariation,disabledSubmit:W||U,children:(0,l.jsx)(C.R,{children:(0,l.jsx)(g.Q,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(r.Z,{name:"reference",label:null==J?void 0:J.reference,value:null===(a=Y.values)||void 0===a?void 0:a.reference,readOnly:!0,maxAccess:B,onChange:Y.handleChange,onClear:()=>Y.setFieldValue("reference",""),error:Y.touched.reference&&!!Y.errors.reference})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.U,{endpointId:b.y.Employee.snapshot,parameters:{_branchId:0},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,readOnly:W||U,label:J.employee,form:Y,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:B,onChange:async(e,a)=>{await ea(null==a?void 0:a.recordId,Y.values.date,Y.values.timeCode),await et(null==a?void 0:a.recordId),Y.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),Y.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),Y.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(S.Z,{name:"date",required:!0,label:J.date,value:null===(t=Y.values)||void 0===t?void 0:t.date,onChange:async(e,a)=>{var t,l;await ea(null===(t=Y.values)||void 0===t?void 0:t.employeeId,a,null===(l=Y.values)||void 0===l?void 0:l.timeCode),Y.setFieldValue("date",a)},onClear:()=>{el(),Y.setFieldValue("date",null)},error:Y.touched.date&&!!Y.errors.date,maxAccess:B,readOnly:W||U})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(d.Z,{datasetId:R.v.TIME_CODE,name:"timeCode",readOnly:W||G,label:J.timeCode,valueField:"key",displayField:"value",required:!0,values:Y.values,maxAccess:B,onChange:async(e,a)=>{var t,l;a&&(null==a?void 0:a.key)!=20||el(),await ea(null===(t=Y.values)||void 0===t?void 0:t.employeeId,null===(l=Y.values)||void 0===l?void 0:l.date,null==a?void 0:a.key),Y.setFieldValue("timeCode",(null==a?void 0:a.key)||null)},error:Y.touched.timeCode&&!!Y.errors.timeCode})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(T.Z,{name:"shiftId",label:J.shift,valueField:"recordId",displayField:"dtRange",store:null==E?void 0:E.current,value:Y.values.shiftId,readOnly:W||U||(null===(P=Y.values)||void 0===P?void 0:P.timeCode)==20,onChange:(e,a)=>Y.setFieldValue("shiftId",(null==a?void 0:a.recordId)||null),error:Y.touched.shiftId&&!!Y.errors.shiftId,maxAccess:B})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(r.Z,{name:"clockDuration",label:null==J?void 0:J.clockDuration,value:null===(F=Y.values)||void 0===F?void 0:F.clockDuration,readOnly:!0,onChange:Y.handleChange,onClear:()=>Y.setFieldValue("clockDuration",X(0)),error:Y.touched.clockDuration&&!!Y.errors.clockDuration,maxAccess:B})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(q.Z,{name:"duration",label:J.duration,value:Y.values.duration,maxAccess:B,readOnly:W||U||(null===(k=Y.values)||void 0===k?void 0:k.timeCode)==20||(null===(O=Y.values)||void 0===O?void 0:O.timeCode)==21,min:20==Y.values.timeCode||21==Y.values.timeCode?0:1,onChange:Y.handleChange,onClear:()=>Y.setFieldValue("duration",null),error:Y.touched.duration&&!!Y.errors.duration})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(d.Z,{name:"damageLevel",label:J.damage,datasetId:R.v.DAMAGE_LEVEL,values:Y.values,valueField:"key",displayField:"value",required:!0,readOnly:W||U,maxAccess:B,onChange:(e,a)=>Y.setFieldValue("damageLevel",(null==a?void 0:a.key)||null),error:Y.touched.damageLevel&&!!Y.errors.damageLevel})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(h.Z,{name:"justification",label:J.justification,value:Y.values.justification,rows:2,readOnly:W||U,maxAccess:B,onChange:Y.handleChange,onClear:()=>Y.setFieldValue("justification",""),error:Y.touched.justification&&!!Y.errors.justification})})]})})})})}k.width=550,k.height=550},84622:function(e,a,t){"use strict";t.d(a,{Z:function(){return O}});var l=t(52322),n=t(60218),r=t(2784),d=t(48601),s=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(31389),p=t(62362),y=t(80983),h=t(38449),f=t(8661),x=t(89330),I=t(39812),g=t(91406),C=t(7121),D=t(98345),b=t(19473),S=t(65215),R=t(76399),q=t(90587),w=t(33625),P=t(21581),j=t(27423),F=t(96026),Z=t(61802),T=t(9657),N=t(21326),k=t(50023);function O(e){var a,t,O,A,V,L,_,M,E,J,B,H,Y,G,U,W,Q,$,z,K,X,ee,ea,et,el,en,er,ed;let{recordId:es,window:eo}=e,{stack:ei}=(0,Z.zY)(),{platformLabels:eu}=(0,r.useContext)(b.l),{getRequest:ec,postRequest:em}=(0,r.useContext)(i.$),ev=(0,r.useRef)([]),{stack:ep}=(0,F.V)(),[ey,eh]=(0,r.useState)([]),[ef,ex]=(0,r.useState)(!1),{labels:eI,access:eg}=(0,k.Z)({datasetId:c.i.WorkCenterConsumptions,editMode:!!es});(0,N.Z)({title:eI.workCenterConsumption,window:eo});let{documentType:eC,maxAccess:eD,changeDT:eb}=(0,D.H)({functionId:C.J.WorkCenterConsumption,access:eg,enabled:!es,objectName:"header"}),eS=(0,u.E)({endpointId:q.u.WorkCenterConsumption.page});function eR(e){return("qty"===e?d.Rx().nullable().max(999999999.999," "):d.nK()).test(function(e){let{sku:a,qty:t,itemName:l}=this.parent;return!a&&!t&&!l||!!e})}let eq=d.Ry({itemName:eR("itemName"),sku:eR("sku"),qty:eR("qty")}),{formik:ew}=(0,y.c)({documentType:{key:"header.dtId",value:null==eC?void 0:eC.dtId,reference:null==eC?void 0:eC.reference},initialValues:{recordId:es,header:{recordId:null,reference:"",dtId:null,date:new Date,plantId:null,siteId:null,workCenterId:null,WcRef:"",WcName:"",weight:0,totalQty:0,description:"",status:1,wip:1},items:[{id:1,seqNo:1,itemId:null,consumptionId:es,qty:0,unitCost:0,muId:null,msId:null,itemName:"",totalCost:0,baseQty:null}]},maxAccess:eD,validateOnChange:!0,validationSchema:d.Ry({header:d.Ry({date:d.hT().required(),workCenterId:d.Rx().required()}),items:d.IX().of(eq)}),onSubmit:async e=>{var a;let{items:t,header:l}=e,n=null==t?void 0:null===(a=t.filter(e=>e.sku))||void 0===a?void 0:a.map((a,t)=>({...a,seqNo:t+1,consumptionId:e.recordId||0})),r=await em({extension:q.u.WorkCenterConsumption.set2,record:JSON.stringify({header:l,items:n})}),d=e.recordId?eu.Edited:eu.Added;o.ZP.success(d),eE(r.recordId),eS()}}),eP=!!(null===(a=ew.values)||void 0===a?void 0:a.recordId),ej=(null==ew?void 0:null===(O=ew.values)||void 0===O?void 0:null===(t=O.header)||void 0===t?void 0:t.status)===3,eF=(null==ew?void 0:null===(V=ew.values)||void 0===V?void 0:null===(A=V.header)||void 0===A?void 0:A.wip)===2,eZ=ew.values.items.reduce((e,a)=>e+(Number(null==a?void 0:a.totalCost)||0),0),eT=ef?ew.values.items.reduce((e,a)=>e+(Number(null==a?void 0:a.qty)||0),0):(null===(L=ew.values)||void 0===L?void 0:L.header.totalQty)||0,eN=async()=>await ec({extension:S.$.MeasurementUnit.qry,parameters:"_msId=0"});async function ek(e,a){if(!e)return;let t=(null==ey?void 0:ey.filter(e=>e.msId==a))||[];ev.current=t}let eO=async e=>{if(!e)return;let a=await ec({extension:q.u.WorkCenterConsumption.get,parameters:"_recordId=".concat(e)});return{...null==a?void 0:a.record,date:(0,I.a1)(null==a?void 0:a.record.date)}},eA=async e=>{var a;if(!e)return;let t=await ec({extension:q.u.ConsumptionItemView.qry,parameters:"_consumptionId=".concat(e)});return(null==t?void 0:null===(a=t.list)||void 0===a?void 0:a.length)>0?t.list.map((e,a)=>({...e,id:a+1,seqNo:a+1})):ew.values.items},eV=async()=>{await em({extension:q.u.WorkCenterConsumption.post,record:JSON.stringify(ew.values.header)}),o.ZP.success(eu.Posted),eS(),eo.close()},eL=async()=>{await em({extension:q.u.WorkCenterConsumption.unpost,record:JSON.stringify(ew.values.header)}),eE(ew.values.recordId),o.ZP.success(eu.Unposted),eS()},e_=async()=>{await em({extension:q.u.WorkCenterConsumption.close,record:JSON.stringify(ew.values.header)}),o.ZP.success(eu.Closed),eE(ew.values.recordId),eS()},eM=async()=>{await em({extension:q.u.WorkCenterConsumption.reopen,record:JSON.stringify(ew.values.header)}),o.ZP.success(eu.Reopened),eE(ew.values.recordId),eS()};async function eE(e){let a=await eO(e),t=await eA(e);ew.setValues({...ew.values,recordId:a.recordId,header:{...ew.values.header,...a},items:t})}let eJ=async e=>{var a;let t=await ec({extension:S.$.CurrentCost.get,parameters:"_itemId=".concat(e)});return null==t?void 0:null===(a=t.record)||void 0===a?void 0:a.currentCost},eB=[{component:"resourcelookup",label:eI.sku,name:"sku",props:{endpointId:S.$.Item.snapshot,valueField:"sku",displayField:"sku",mandatory:!0,readOnly:eF,displayFieldWidth:3,mapping:[{from:"recordId",to:"itemId"},{from:"msId",to:"msId"},{from:"sku",to:"sku"},{from:"name",to:"itemName"}],columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"}]},async onChange(e){let{row:{update:a,newRow:t}}=e;if(!(null==t?void 0:t.itemId)){ev.current=[],a({muRef:null,muId:null,baseQty:0,muQty:0,qty:0,totalCost:0});return}if(t.isInactive){a({...ew.initialValues.items[0],id:t.id}),ep({message:eI.inactiveItem});return}if(null==t?void 0:t.itemId){var l,n,r,d,s,o,i,u;ek(null==t?void 0:t.itemId,t.msId),a({unitCost:((null==t?void 0:t.itemId)?await eJ(null==t?void 0:t.itemId):0)||0,muRef:(null==ev?void 0:null===(n=ev.current)||void 0===n?void 0:null===(l=n[0])||void 0===l?void 0:l.reference)||null,muId:(null==ev?void 0:null===(d=ev.current)||void 0===d?void 0:null===(r=d[0])||void 0===r?void 0:r.recordId)||null,muQty:(null==ev?void 0:null===(o=ev.current)||void 0===o?void 0:null===(s=o[0])||void 0===s?void 0:s.qty)||0,baseQty:(null==ev?void 0:null===(u=ev.current)||void 0===u?void 0:null===(i=u[0])||void 0===i?void 0:i.qty)||(null==t?void 0:t.qty),qty:(null==t?void 0:t.qty)||0})}}},{component:"textfield",label:eI.itemName,name:"itemName",flex:2,props:{readOnly:!0}},{component:"resourcecombobox",label:eI.MU,name:"muRef",props:{store:null==ev?void 0:ev.current,displayField:"reference",valueField:"recordId",readOnly:eF,mapping:[{from:"reference",to:"muRef"},{from:"name",to:"muName"},{from:"qty",to:"muQty"},{from:"recordId",to:"muId"}]},async onChange(e){let{row:{update:a,newRow:t}}=e;ex(!0),t&&a(t.muId?{baseQty:(null==t?void 0:t.qty)?(null==t?void 0:t.qty)*(null==t?void 0:t.muQty):null==t?void 0:t.muQty}:{baseQty:0})},propsReducer(e){let{row:a,props:t}=e;return{...t,store:null==ev?void 0:ev.current}}},{component:"numberfield",name:"qty",label:eI.qty,async onChange(e){let{row:{update:a,newRow:t}}=e;ex(!0),a({totalCost:parseFloat((null==t?void 0:t.unitCost)*(null==t?void 0:t.qty)).toFixed(2),baseQty:(null==t?void 0:t.muQty)?(null==t?void 0:t.muQty)*(null==t?void 0:t.qty):null==t?void 0:t.qty})},props:{decimalScale:2,readOnly:eF}},{component:"numberfield",name:"unitCost",label:eI.unitCost,props:{decimalScale:2,readOnly:!0}},{component:"numberfield",name:"totalCost",label:eI.totalCost,props:{decimalScale:2,readOnly:!0}}];async function eH(){ei({Component:T.Z,props:{resourceId:c.i.WCConsumptionImport,access:eD,onSuccess:async e=>{var a;if(null==ew?void 0:null===(a=ew.values)||void 0===a?void 0:a.recordId){let e=await eO(null==ew?void 0:ew.values.recordId),a=await eA(null==ew?void 0:ew.values.recordId);ew.setValues({...ew.values,recordId:e.recordId,header:{...ew.values.header,...e},items:a}),eS()}}}})}let eY=[{key:"Locked",condition:ej,onClick:"onUnpostConfirmation",onSuccess:eL,disabled:!eF},{key:"Unlocked",condition:!ej,onClick:eV,disabled:!eF},{key:"Close",condition:!eF,onClick:e_,disabled:eF||!eP},{key:"Reopen",condition:eF,onClick:eM,disabled:!eF||ej},{key:"GL",condition:!0,onClick:"onClickGL",valuesPath:{...ew.values.header,notes:ew.values.header.description},datasetId:c.i.WorkCenterConsumptions,disabled:!eP},{key:"Import",condition:!0,onClick:eH,disabled:!eP||ew.values.items.some(e=>e.itemId)||eF}];return(0,r.useEffect)(()=>{ew.setFieldValue("header.totalQty",parseFloat(eT).toFixed(2)),ew.setFieldValue("header.totalCostField",parseFloat(eZ).toFixed(2))},[eT,eZ]),(0,r.useEffect)(()=>{!async function(){let e=await eN();eh(null==e?void 0:e.list),es&&eE(es)}()},[]),(0,l.jsx)(s.Z,{form:ew,resourceId:c.i.WorkCenterConsumptions,functionId:C.J.WorkCenterConsumption,maxAccess:eD,actions:eY,editMode:eP,previewReport:eP,disabledSubmit:eF,children:(0,l.jsxs)(v.R,{children:[(0,l.jsx)(w.g,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,xs:12,children:[(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(f.Z,{endpointId:h.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(C.J.WorkCenterConsumption),name:"header.dtId",label:eI.docType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:eP,valueField:"recordId",displayField:["reference","name"],values:ew.values.header,maxAccess:eD,onChange:(e,a)=>{ew.setFieldValue("header.dtId",(null==a?void 0:a.recordId)||null),eb(a)},error:(null===(_=ew.touched.header)||void 0===_?void 0:_.dtId)&&!!(null===(M=ew.errors.header)||void 0===M?void 0:M.dtId)})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(m.Z,{name:"header.reference",label:eI.reference,value:null==ew?void 0:null===(J=ew.values)||void 0===J?void 0:null===(E=J.header)||void 0===E?void 0:E.reference,maxAccess:!eP&&eD,readOnly:eP,onChange:ew.handleChange,onClear:()=>ew.setFieldValue("header.reference",""),error:(null===(B=ew.touched.header)||void 0===B?void 0:B.reference)&&!!(null===(H=ew.errors.header)||void 0===H?void 0:H.reference)})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(x.Z,{name:"header.date",required:!0,readOnly:eF,label:eI.date,value:null==ew?void 0:null===(G=ew.values)||void 0===G?void 0:null===(Y=G.header)||void 0===Y?void 0:Y.date,maxAccess:eD,onChange:ew.setFieldValue,onClear:()=>ew.setFieldValue("header.date",null),error:(null===(W=ew.touched)||void 0===W?void 0:null===(U=W.header)||void 0===U?void 0:U.date)&&!!(null===($=ew.errors)||void 0===$?void 0:null===(Q=$.header)||void 0===Q?void 0:Q.date)})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(f.Z,{endpointId:h.r.Plant.qry,name:"header.plantId",readOnly:eF,label:eI.plant,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:ew.values.header,maxAccess:eD,onChange:(e,a)=>{ew.setFieldValue("header.plantId",(null==a?void 0:a.recordId)||null)},error:(null===(z=ew.touched.header)||void 0===z?void 0:z.plantId)&&!!(null===(K=ew.errors.header)||void 0===K?void 0:K.plantId)})})]})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.U,{endpointId:q.u.WorkCenter.snapshot,valueField:"reference",displayField:"name",name:"header.workCenterId",secondFieldLabel:eI.name,label:eI.workCenter,valueShow:"WcRef",secondValueShow:"WcName",maxAccess:eD,formObject:ew.values.header,form:ew,displayFieldWidth:2,required:!0,readOnly:eF,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"},{key:"siteName",value:"Site Name"}],onSecondValueChange:(e,a)=>{ew.setFieldValue("header.WcName",a)},onChange:(e,a)=>{ew.setFieldValue("header.WcRef",(null==a?void 0:a.isInactive)?"":null==a?void 0:a.reference),ew.setFieldValue("header.WcName",(null==a?void 0:a.isInactive)?"":null==a?void 0:a.name),ew.setFieldValue("header.siteId",(null==a?void 0:a.isInactive)?null:null==a?void 0:a.siteId),ew.setFieldValue("header.siteRef",(null==a?void 0:a.isInactive)?"":null==a?void 0:a.siteRef),ew.setFieldValue("header.siteName",(null==a?void 0:a.isInactive)?"":null==a?void 0:a.siteName),ew.setFieldValue("header.workCenterId",(null==a?void 0:a.isInactive)?null:null==a?void 0:a.recordId),(null==a?void 0:a.isInactive)&&ep({message:eI.inactiveWorkCenter})},error:(null===(X=ew.touched.header)||void 0===X?void 0:X.workCenterId)&&!!(null===(ee=ew.errors.header)||void 0===ee?void 0:ee.workCenterId)})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(m.Z,{name:"header.siteRef",label:eI.siteRef,value:null===(ea=ew.values.header)||void 0===ea?void 0:ea.siteRef,readOnly:!0})}),(0,l.jsx)(n.ZP,{item:!0,xs:6,children:(0,l.jsx)(m.Z,{name:"header.reference",label:eI.siteName,value:null===(et=ew.values.header)||void 0===et?void 0:et.siteName,readOnly:!0,maxAccess:eD,error:(null===(el=ew.touched.header)||void 0===el?void 0:el.siteName)&&!!(null===(en=ew.errors.header)||void 0===en?void 0:en.siteName)})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(P.Z,{name:"header.description",label:eI.description,value:ew.values.header.description,rows:2.5,readOnly:eF,maxAccess:eD,onChange:e=>ew.setFieldValue("header.description",e.target.value),onClear:()=>ew.setFieldValue("header.description",""),error:(null===(er=ew.touched.header)||void 0===er?void 0:er.description)&&!!(null===(ed=ew.errors.header)||void 0===ed?void 0:ed.description)})})]})})]})}),(0,l.jsx)(p.Q,{children:(0,l.jsx)(R._,{onChange:(e,a)=>{ew.setFieldValue("items",e),"delete"===a&&ex(!0)},onSelectionChange:(e,a,t)=>{"muRef"==t&&ek(null==e?void 0:e.itemId,null==e?void 0:e.msId)},value:ew.values.items,error:ew.errors.items,allowDelete:!eF,name:"items",columns:eB,maxAccess:eD})}),(0,l.jsx)(w.g,{children:(0,l.jsx)(n.ZP,{container:!0,spacing:2,xs:12,children:(0,l.jsx)(n.ZP,{item:!0,xs:4,children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"totalQty",maxAccess:eD,label:eI.totalQty,value:eT,decimalScale:2,readOnly:!0})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(g.Z,{name:"totalCost",maxAccess:eD,label:eI.totalCost,value:eZ,decimalScale:2,readOnly:!0})})]})})})})]})})}O.width=1200,O.height=700},27603:function(e,a,t){"use strict";t.d(a,{Z:function(){return P}});var l=t(52322),n=t(60218),r=t(2784),d=t(48601),s=t(82737),o=t(62202),i=t(65950),u=t(71987),c=t(26612),m=t(5088),v=t(80983),p=t(62362),y=t(31389),h=t(19473),f=t(8661),x=t(92407),I=t(27423),g=t(70104),C=t(21581),D=t(89330),b=t(39812),S=t(98345),R=t(7121),q=t(21326),w=t(50023);function P(e){var a;let{recordId:t,window:P}=e,{getRequest:j,postRequest:F}=(0,r.useContext)(i.$),{platformLabels:Z}=(0,r.useContext)(h.l),{labels:T,access:N}=(0,w.Z)({datasetId:c.i.JobInfos,editMode:!!t});(0,q.Z)({title:T.jobInfo,window:P});let{maxAccess:k}=(0,S.H)({functionId:R.J.JobInfo,access:N,enabled:!t}),O=(0,u.E)({endpointId:x.y.JobInfo.page}),{formik:A}=(0,v.c)({initialValues:{recordId:null,reference:"",employeeId:null,employeeName:"",employeeRef:"",date:new Date,departmentId:null,branchId:null,divisionId:null,positionId:null,reportToId:null,reportToName:"",reportToRef:"",notes:"",status:1,wip:1},validateOnChange:!0,validationSchema:d.Ry({employeeId:d.Rx().required(),date:d.hT().max(new Date,"Date cannot be in the future").required(),departmentId:d.Rx().required(),branchId:d.Rx().required(),positionId:d.Rx().required()}),onSubmit:async e=>{await F({extension:x.y.JobInfo.set,record:JSON.stringify({...e,date:(0,b.ku)(e.date)})}),o.ZP.success(e.recordId?Z.Edited:Z.Added),P.close(),O()}}),V=!!A.values.recordId,L=2==A.values.wip;async function _(e){if(e){let a=await j({extension:x.y.JobInfo.get,parameters:"_recordId=".concat(e)});A.setValues({...a.record,date:(0,b.a1)(a.record.date)})}}(0,r.useEffect)(()=>{_(t)},[]);let M=[{key:"Close",condition:!L,onClick:async()=>{await F({extension:x.y.JobInfo.close,record:JSON.stringify({...A.values,date:(0,b.ku)(A.values.date)})}),o.ZP.success(Z.Closed),_(t),O()},disabled:L||!V},{key:"Reopen",condition:L,onClick:async()=>{await F({extension:x.y.JobInfo.reopen,record:JSON.stringify({...A.values,date:(0,b.ku)(A.values.date)})}),o.ZP.success(Z.Reopened),_(t),O()},disabled:!L},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!L}];return(0,l.jsx)(s.Z,{resourceId:c.i.JobInfos,functionId:R.J.JobInfo,form:A,maxAccess:k,editMode:V,actions:M,disabledSubmit:L,children:(0,l.jsx)(y.R,{children:(0,l.jsx)(p.Q,{children:(0,l.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(m.Z,{name:"reference",label:T.ref,value:A.values.reference,maxAccess:k,readOnly:V,maxLength:"30",onChange:A.handleChange,onClear:()=>A.setFieldValue("reference",""),error:A.touched.reference&&!!A.errors.reference})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.U,{endpointId:x.y.Employee.snapshot,parameters:{_branchId:0},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,displayFieldWidth:2,readOnly:L,label:T.employee,secondFieldLabel:T.employee,form:A,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:k,onChange:(e,a)=>{A.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),A.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(D.Z,{name:"date",label:T.date,value:null===(a=A.values)||void 0===a?void 0:a.date,readOnly:L,required:!0,max:new Date,onChange:A.setFieldValue,onClear:()=>A.setFieldValue("date",null),error:A.touched.date&&!!A.errors.date,maxAccess:k})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(f.Z,{endpointId:g.K.DepartmentFilters.qry,parameters:"_filter=&_size=1000&_startAt=0&_type=0&_activeStatus=0&_sortBy=recordId",name:"departmentId",label:T.department,values:A.values,columnsInDropDown:[{key:"departmentRef",value:"Reference"},{key:"name",value:"Name"}],required:!0,readOnly:L,displayField:["departmentRef","name"],maxAccess:k,onChange:(e,a)=>{A.setFieldValue("departmentId",(null==a?void 0:a.recordId)||null)},error:A.touched.departmentId&&!!A.errors.departmentId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(f.Z,{endpointId:g.K.BranchFilters.qry,name:"branchId",label:T.branch,columnsInDropDown:[{key:"branchRef",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["branchRef","name"],values:A.values,maxAccess:k,onChange:(e,a)=>{A.setFieldValue("branchId",(null==a?void 0:a.recordId)||null)},required:!0,readOnly:L,error:A.touched.branchId&&!!A.errors.branchId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(f.Z,{endpointId:g.K.DivisionFilters.qry,name:"divisionId",label:T.division,valueField:"recordId",displayField:"name",maxAccess:k,readOnly:L,values:A.values,onChange:(e,a)=>{A.setFieldValue("divisionId",(null==a?void 0:a.recordId)||null)},error:A.touched.divisionId&&!!A.errors.divisionId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(f.Z,{endpointId:g.K.CompanyPositions.qry,parameters:"_filter=&_size=1000&_startAt=0&_sortBy=recordId",name:"positionId",label:T.position,required:!0,valueField:"recordId",displayField:["positionRef","name"],columnsInDropDown:[{key:"positionRef",value:"Reference"},{key:"name",value:"Name"}],maxAccess:k,readOnly:L,values:A.values,onChange:(e,a)=>{A.setFieldValue("positionId",(null==a?void 0:a.recordId)||null)},error:A.touched.positionId&&!!A.errors.positionId})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.U,{endpointId:x.y.Employee.snapshot,parameters:{_branchId:0},secondFieldLabel:T.reportsTo,valueField:"reference",displayField:"fullName",name:"reportToId",displayFieldWidth:2,label:T.reportsTo,form:A,readOnly:L,valueShow:"reportToRef",secondValueShow:"reportToName",maxAccess:k,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],onChange:(e,a)=>{A.setFieldValue("reportToName",(null==a?void 0:a.fullName)||""),A.setFieldValue("reportToId",(null==a?void 0:a.recordId)||null)},errorCheck:"reportToId"})}),(0,l.jsx)(n.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"notes",label:T.notes,value:A.values.notes,rows:2,readOnly:L,maxAccess:k,onChange:A.handleChange,onClear:()=>A.setFieldValue("notes",""),error:A.touched.notes&&!!A.errors.notes})})]})})})})}P.width=600,P.height=520},30032:function(e,a,t){"use strict";t.d(a,{Z:function(){return Z}});var l=t(52322),n=t(89330),r=t(39812),d=t(60218),s=t(2784),o=t(48601),i=t(82737),u=t(62202),c=t(65950),m=t(71987),v=t(26612),p=t(5088),y=t(21581),h=t(8661),f=t(38449),x=t(7121),I=t(62362),g=t(31389),C=t(80983),D=t(19473),b=t(98345),S=t(61802),R=t(58912),q=t(76399),w=t(33625),P=t(39704),j=t(50023),F=t(21326);function Z(e){var a,t,Z,T,N,k,O,A,V,L,_,M;let{recordId:E,window:J}=e,{getRequest:B,postRequest:H}=(0,s.useContext)(c.$),{platformLabels:Y}=(0,s.useContext)(D.l),{stack:G}=(0,S.zY)(),{labels:U,access:W}=(0,j.Z)({datasetId:v.i.MaterialReqPlannings,editMode:!!E}),{documentType:Q,maxAccess:$,changeDT:z}=(0,b.H)({functionId:x.J.MRP,access:W,enabled:!E,objectName:"header"});(0,F.Z)({title:U.materialRequestPlaning,window:J});let K=(0,m.E)({endpointId:R.I.MatPlanning.page}),{formik:X}=(0,C.c)({maxAccess:$,documentType:{key:"header.dtId",value:null==Q?void 0:Q.dtId},initialValues:{recordId:E,header:{recordId:E,dtId:null,reference:"",date:new Date,notes:"",status:1,releaseStatus:null,wip:1},items:[]},validateOnChange:!0,validationSchema:o.Ry({header:o.Ry({date:o.hT().required()}),items:o.IX().of(o.Ry({qty:o.Rx().required()}))}),onSubmit:async e=>{let a=await H({extension:R.I.MatPlanning.set2,record:JSON.stringify({header:{...e.header,date:(0,r.ku)(e.header.date)},items:e.items})});u.ZP.success(e.recordId?Y.Edited:Y.Added),el(a.recordId),K()}}),ee=!!X.values.recordId,ea=4==X.values.header.status,et=2===X.values.header.wip;async function el(e){let{record:a}=await B({extension:R.I.MatPlanning.get,parameters:"_requestId=".concat(e)}),{list:t}=await B({extension:R.I.MatPlanningItem.qry,parameters:"_mrpId=".concat(e)});X.setValues({recordId:a.recordId,header:{...a,date:(0,r.a1)(null==a?void 0:a.date)},items:null==t?void 0:t.map((e,a)=>({...e,id:a+1,seqNo:a+1,date:(0,r.a1)(e.date)}))})}let en=[{key:"Reopen",condition:et,onClick:async function(){await H({extension:R.I.MatPlanning.reopen,record:JSON.stringify({...X.values.header,date:(0,r.ku)(X.values.header.date)})}),u.ZP.success(Y.Reopened),K(),el(X.values.recordId)},disabled:!et},{key:"Close",condition:!et,onClick:async function(){await H({extension:R.I.MatPlanning.close,record:JSON.stringify({...X.values.header,date:(0,r.ku)(X.values.header.date)})}),u.ZP.success(Y.Closed),K(),el(X.values.recordId)},disabled:et||!ee},{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!ee},{key:"WorkFlow",condition:!0,onClick:async function(){G({Component:P.Z,props:{functionId:x.J.MRP,recordId:X.values.recordId}})},disabled:!ee},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!et},{key:"generate",condition:!0,onClick:async()=>{await H({extension:R.I.PurchaseRequest.generate,record:JSON.stringify({...X.values.header,date:(0,r.ku)(X.values.header.date)})}),u.ZP.success(Y.Generated),K(),el(X.values.recordId)},disabled:!ee||!ea}];(0,s.useEffect)(()=>{E&&el(E)},[]);let er=[{component:"textfield",label:U.sku,name:"sku",width:100,props:{readOnly:!0}},{component:"textfield",label:U.name,name:"itemName",width:150,props:{readOnly:!0}},{component:"numberfield",label:U.onHand,name:"onhand",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.openPr,name:"openPR",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.openPo,name:"openPO",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.leadTime,name:"leadTime",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.safetyStock,name:"safetyStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.reorderPoint,name:"reorderPoint",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.min,name:"minStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.max,name:"maxStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.amcShortTerm,name:"amcShortTerm",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.amcLongTerm,name:"amcLongTerm",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.siteCoverageStock,name:"siteCoverageStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.totalCoverageStock,name:"totalStockCoverage",width:100,props:{readOnly:!0}},{component:"textfield",label:U.mu,name:"msRef",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.unitCost,name:"unitCost",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.totalCost,name:"totalCost",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.sugQty,name:"suggestedPRQty",width:100,props:{readOnly:!0}},{component:"numberfield",label:U.reqQty,name:"qty",width:100,props:{decimalScale:2}}];return(0,l.jsx)(i.Z,{resourceId:v.i.MaterialReqPlannings,functionId:x.J.MRP,form:X,maxAccess:$,actions:en,editMode:ee,previewReport:ee,disabledSubmit:et,children:(0,l.jsxs)(g.R,{children:[(0,l.jsx)(w.g,{children:(0,l.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(d.ZP,{item:!0,xs:4,children:(0,l.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(h.Z,{endpointId:f.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(x.J.MRP),name:"header.dtId",label:U.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:ee,valueField:"recordId",displayField:["reference","name"],values:X.values.header,maxAccess:$,onChange:(e,a)=>{X.setFieldValue("header.dtId",(null==a?void 0:a.recordId)||null),z(a)},error:(null===(a=X.touched.header)||void 0===a?void 0:a.dtId)&&!!(null===(t=X.errors.header)||void 0===t?void 0:t.dtId)})}),(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(n.Z,{name:"header.date",label:U.date,value:null===(Z=X.values)||void 0===Z?void 0:Z.header.date,readOnly:et,required:!0,onChange:X.setFieldValue,onClear:()=>X.setFieldValue("header.date",null),error:(null===(T=X.touched.header)||void 0===T?void 0:T.date)&&!!(null===(N=X.errors.header)||void 0===N?void 0:N.date),maxAccess:$})}),(0,l.jsx)(d.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.Z,{name:"header.reference",label:U.reference,value:null==X?void 0:null===(k=X.values)||void 0===k?void 0:k.header.reference,maxAccess:!ee&&$,readOnly:ee,onChange:X.handleChange,onClear:()=>X.setFieldValue("header.reference",""),error:(null===(O=X.touched.header)||void 0===O?void 0:O.reference)&&!!(null===(A=X.errors.header)||void 0===A?void 0:A.reference)})})]})}),(0,l.jsx)(d.ZP,{item:!0,xs:4,children:(0,l.jsx)(y.Z,{name:"header.notes",label:U.notes,value:X.values.header.notes,rows:3,readOnly:et,maxAccess:$,onChange:e=>X.setFieldValue("header.notes",e.target.value),onClear:()=>X.setFieldValue("header.notes",""),error:(null===(V=X.touched.header)||void 0===V?void 0:V.notes)&&!!(null===(L=X.errors.header)||void 0===L?void 0:L.notes)})})]})}),(0,l.jsx)(I.Q,{children:(0,l.jsx)(q._,{onChange:e=>{X.setFieldValue("items",e)},value:null==X?void 0:null===(_=X.values)||void 0===_?void 0:_.items,error:null==X?void 0:null===(M=X.errors)||void 0===M?void 0:M.items,columns:er,maxAccess:$,name:"items",allowDelete:!et,allowAddNewLine:!1,disabled:et})})]})})}Z.width=1300,Z.height=600},19505:function(e){e.exports={frame:"DynamicDashboard_frame__LiDOD",container:"DynamicDashboard_container__alGWv",topRow:"DynamicDashboard_topRow__QYtYS",title:"DynamicDashboard_title__QPkf7",summaryCard:"DynamicDashboard_summaryCard__wkUPv",summaryGrid:"DynamicDashboard_summaryGrid__KEkjf",summaryItem:"DynamicDashboard_summaryItem__yOvgM",middleRow:"DynamicDashboard_middleRow__S8stN",innerGrid:"DynamicDashboard_innerGrid___0c_6",chartCard:"DynamicDashboard_chartCard__IBIVJ",redCenter:"DynamicDashboard_redCenter__ebbJh",label:"DynamicDashboard_label__f6Txq",value:"DynamicDashboard_value__gxMix",strong:"DynamicDashboard_strong__pyBUJ"}}},function(e){e.O(0,[96767,92515,2494,43553,72683,86558,28996,23352,13073,44129,17720,46553,38096,78451,77980,94828,58974,13781,35934,60352,25991,69952,99090,32304,99471,58669,8324,69549,40300,41451,43933,49774,92888,40179],function(){return e(e.s=24790)}),_N_E=e.O()}]);