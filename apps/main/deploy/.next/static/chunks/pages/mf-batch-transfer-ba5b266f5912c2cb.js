(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90858],{99313:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mf-batch-transfer",function(){return r(60965)}])},60965:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return B}});var a=r(52322),n=r(2784),s=r(62202),o=r(69387),l=r(65950),d=r(71987),i=r(61802),c=r(26612),u=r(31389),p=r(33625),g=r(62362),y=r(19473),v=r(98345),h=r(7121),m=r(90587),f=r(27723),I=r(60218),q=r(48601),S=r(82737),C=r(5088),T=r(80983),O=r(38449),b=r(8661),D=r(89330),x=r(39812),M=r(76399),R=r(67920),J=r(21581),A=r(91406),P=r(96026);function W(e){var t,r,o,i,f,W,B,j,F,N,w,k,L,_,G,Z,E,V,H,Q,z,$,X,K,U,Y,ee,et,er,ea,en,es,eo,el,ed,ei,ec;let{labels:eu,maxAccess:ep,recordId:eg}=e,{platformLabels:ey,userDefaultsData:ev}=(0,n.useContext)(y.l),{getRequest:eh,postRequest:em}=(0,n.useContext)(l.$),{stack:ef}=(0,P.V)(),eI=parseInt(null==ev?void 0:null===(r=ev.list)||void 0===r?void 0:null===(t=r.find(e=>"workCenterId"===e.key))||void 0===t?void 0:t.value)||null,{documentType:eq,maxAccess:eS,changeDT:eC}=(0,v.H)({functionId:h.J.BatchTransfer,access:ep,enabled:!eg,objectName:"header"}),eT=(0,d.E)({endpointId:m.u.BatchTransfer.page}),{schema:eO,requiredFields:eb}=(0,R.m)({jobId:e=>null==e?void 0:e.jobId,pcs:e=>(null==e?void 0:e.jobId)>0&&(null==e?void 0:e.pcs)<=(null==e?void 0:e.jobPcs),qty:e=>(null==e?void 0:e.jobId)>0&&(null==e?void 0:e.qty)<=(null==e?void 0:e.jobQty),sku:e=>null==e?void 0:e.sku,itemName:e=>null==e?void 0:e.itemName},!0,eS,"items"),{formik:eD}=(0,T.c)({documentType:{key:"header.dtId",value:null==eq?void 0:eq.dtId,reference:null==eq?void 0:eq.reference},conditionSchema:["items"],initialValues:{recordId:null,header:{dtId:null,reference:"",date:new Date,fromWCId:eI,toWCId:null,notes:"",status:1,wip:1},items:[{id:1,jobId:null,btId:eg||0,pcs:0,qty:0,transferRef:null,sku:"",itemName:"",itemGroupId:null}]},maxAccess:eS,validationSchema:q.Ry({header:q.Ry({date:q.Z_().required(),fromWCId:q.Rx().required(),toWCId:q.Rx().required()}),items:q.IX().of(eO)}),onSubmit:async e=>{let{items:t,header:r}=e;if(r.fromWCId===r.toWCId){ef({message:eu.errorMessage});return}let a=await em({extension:m.u.BatchTransfer.set2,record:JSON.stringify({batchTransfer:r,batchTransferJobs:t.filter(e=>{var t;return null===(t=Object.values(eb))||void 0===t?void 0:t.every(t=>t(e))})})});s.ZP.success(e.recordId?ey.Edited:ey.Added),eJ(a.recordId),eT()}}),ex=!!(null===(o=eD.values)||void 0===o?void 0:o.recordId),eM=(null==eD?void 0:null===(f=eD.values)||void 0===f?void 0:null===(i=f.header)||void 0===i?void 0:i.status)===3,eR=async()=>{await em({extension:m.u.BatchTransfer.post,record:JSON.stringify(eD.values.header)}),s.ZP.success(ey.Posted),eT(),eJ(eD.values.recordId)};async function eJ(e){var t;if(!e)return;let r=await eh({extension:m.u.BatchTransfer.get,parameters:"_recordId=".concat(e)}),a={...null==r?void 0:r.record,date:(0,x.a1)(null==r?void 0:r.record.date)},n=await eh({extension:m.u.BatchTransferJob.qry,parameters:"_btId=".concat(e)});eD.setValues({...eD.values,recordId:a.recordId,header:{...eD.values.header,...a},items:(null==n?void 0:null===(t=n.list)||void 0===t?void 0:t.length)>0?n.list.map((e,t)=>({...e,id:t+1})):eD.values.items})}let eA=[{component:"resourcelookup",label:eu.jobOrder,name:"jobId",flex:1,props:{endpointId:m.u.JobWorkCenter.snapshot,parameters:{_workCenterId:null===(B=eD.values)||void 0===B?void 0:null===(W=B.header)||void 0===W?void 0:W.fromWCId},displayField:"jobRef",valueField:"jobRef",mapping:[{from:"jobId",to:"jobId"},{from:"jobRef",to:"jobRef"}],displayFieldWidth:4,readOnly:!(null===(F=eD.values)||void 0===F?void 0:null===(j=F.header)||void 0===j?void 0:j.fromWCId)},async onChange(e){var t,r,a,n,s,o,l,d,i,c,u,p;let{row:{update:g,newRow:y}}=e;if(!(null==y?void 0:y.jobId))return;let v=await eh({extension:m.u.MFJobOrder.get,parameters:"_recordId=".concat(null==y?void 0:y.jobId)}),h=await eh({extension:m.u.JobWorkCenter.verify,parameters:"_jobOrderId=".concat(null==y?void 0:y.jobId,"&_toWcId=").concat(null===(r=eD.values)||void 0===r?void 0:null===(t=r.header)||void 0===t?void 0:t.toWCId)}),f=await eh({extension:m.u.JobWorkCenter.get,parameters:"_jobId=".concat(null==y?void 0:y.jobId,"&_workCenterId=").concat(null===(n=eD.values)||void 0===n?void 0:null===(a=n.header)||void 0===a?void 0:a.fromWCId)});g({jobId:(null==y?void 0:y.jobId)||null,jobRef:(null==y?void 0:y.jobRef)||"",itemName:(null===(s=v.record)||void 0===s?void 0:s.itemName)||"",itemId:(null===(o=h.record)||void 0===o?void 0:o.itemId)||null,sku:(null===(l=h.record)||void 0===l?void 0:l.sku)||"",itemGroupName:(null===(d=h.record)||void 0===d?void 0:d.itemGroupName)||"",pcs:(null===(i=f.record)||void 0===i?void 0:i.pcs)||0,qty:(null===(c=f.record)||void 0===c?void 0:c.qty)||0,jobPcs:(null===(u=f.record)||void 0===u?void 0:u.pcs)||0,jobQty:(null===(p=f.record)||void 0===p?void 0:p.qty)||0})}},{component:"textfield",label:eu.sku,name:"sku",props:{readOnly:!0}},{component:"textfield",label:eu.itemName,name:"itemName",flex:2,props:{readOnly:!0}},{component:"textfield",label:eu.itemGroup,name:"itemGroupName",flex:2,props:{readOnly:!0}},{component:"numberfield",name:"qty",label:eu.qty,flex:1},{component:"numberfield",name:"pcs",label:eu.pcs,flex:1},{component:"numberfield",name:"jobQty",label:eu.jobQty,flex:1,props:{readOnly:!0}},{component:"numberfield",name:"jobPcs",label:eu.jobPcs,flex:1,props:{readOnly:!0}},{component:"textfield",label:eu.transferRef,name:"transferRef",flex:1,props:{readOnly:!0}}],eP=[{key:"Locked",condition:eM,disabled:!0},{key:"Unlocked",condition:!eM,onClick:eR,disabled:!ex||eM}];(0,n.useEffect)(()=>{eg&&eJ(eg)},[eg]);let eW=null!==(ei=null===(w=eD.values)||void 0===w?void 0:null===(N=w.items)||void 0===N?void 0:N.reduce((e,t)=>e+(parseFloat(t.qty)||0),0))&&void 0!==ei?ei:0,eB=null!==(ec=null===(L=eD.values)||void 0===L?void 0:null===(k=L.items)||void 0===k?void 0:k.reduce((e,t)=>e+(parseFloat(t.pcs)||0),0))&&void 0!==ec?ec:0;return(0,a.jsx)(S.Z,{form:eD,resourceId:c.i.BatchTransfer,maxAccess:eS,editMode:ex,previewReport:ex,actions:eP,disabledSubmit:eM,children:(0,a.jsxs)(u.R,{children:[(0,a.jsx)(p.g,{children:(0,a.jsxs)(I.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(I.ZP,{item:!0,xs:6,children:(0,a.jsxs)(I.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(I.ZP,{item:!0,xs:12,children:(0,a.jsx)(b.Z,{endpointId:O.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(h.J.BatchTransfer),name:"header.dtId",label:eu.docType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:ex,valueField:"recordId",displayField:["reference","name"],values:eD.values.header,maxAccess:eS,onChange:(e,t)=>{eD.setFieldValue("header.dtId",(null==t?void 0:t.recordId)||null),eC(t)},error:(null===(_=eD.touched.header)||void 0===_?void 0:_.dtId)&&!!(null===(G=eD.errors.header)||void 0===G?void 0:G.dtId)})}),(0,a.jsx)(I.ZP,{item:!0,xs:12,children:(0,a.jsx)(C.Z,{name:"header.reference",label:eu.reference,value:null==eD?void 0:null===(E=eD.values)||void 0===E?void 0:null===(Z=E.header)||void 0===Z?void 0:Z.reference,maxAccess:!ex&&eS,readOnly:ex,onChange:eD.handleChange,onClear:()=>eD.setFieldValue("header.reference",""),error:(null===(V=eD.touched.header)||void 0===V?void 0:V.reference)&&!!(null===(H=eD.errors.header)||void 0===H?void 0:H.reference)})}),(0,a.jsx)(I.ZP,{item:!0,xs:12,children:(0,a.jsx)(b.Z,{endpointId:m.u.WorkCenter.qry,name:"header.fromWCId",label:eu.fromWC,required:!0,valueField:"recordId",readOnly:eM,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:eD.values.header,onChange:(e,t)=>{eD.setFieldValue("header.fromWCId",(null==t?void 0:t.recordId)||null)},error:(null===(Q=eD.touched.header)||void 0===Q?void 0:Q.fromWCId)&&(null===(z=eD.errors.header)||void 0===z?void 0:z.fromWCId),maxAccess:eS,displayFieldWidth:1.5})}),(0,a.jsx)(I.ZP,{item:!0,xs:12,children:(0,a.jsx)(b.Z,{endpointId:m.u.WorkCenter.qry,name:"header.toWCId",label:eu.toWC,required:!0,valueField:"recordId",readOnly:eM,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:eD.values.header,onChange:(e,t)=>{eD.setFieldValue("header.toWCId",(null==t?void 0:t.recordId)||null)},error:(null===($=eD.touched.header)||void 0===$?void 0:$.toWCId)&&(null===(X=eD.errors.header)||void 0===X?void 0:X.toWCId),maxAccess:eS,displayFieldWidth:1.5})})]})}),(0,a.jsx)(I.ZP,{item:!0,xs:6,children:(0,a.jsxs)(I.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(I.ZP,{item:!0,xs:12,children:(0,a.jsx)(D.Z,{name:"header.date",required:!0,readOnly:eM,label:eu.date,value:null==eD?void 0:null===(U=eD.values)||void 0===U?void 0:null===(K=U.header)||void 0===K?void 0:K.date,maxAccess:eS,onChange:eD.setFieldValue,onClear:()=>eD.setFieldValue("header.date",null),error:(null===(ee=eD.touched)||void 0===ee?void 0:null===(Y=ee.header)||void 0===Y?void 0:Y.date)&&!!(null===(er=eD.errors)||void 0===er?void 0:null===(et=er.header)||void 0===et?void 0:et.date)})}),(0,a.jsx)(I.ZP,{item:!0,xs:12,children:(0,a.jsx)(J.Z,{name:"header.notes",label:eu.notes,value:eD.values.header.notes,maxLength:"100",rows:2,maxAccess:eS,readOnly:eM,onChange:eD.handleChange,onClear:()=>eD.setFieldValue("header.notes",""),error:(null===(en=eD.touched)||void 0===en?void 0:null===(ea=en.header)||void 0===ea?void 0:ea.notes)&&!!(null===(eo=eD.errors)||void 0===eo?void 0:null===(es=eo.header)||void 0===es?void 0:es.notes)})})]})})]})}),(0,a.jsx)(g.Q,{children:(0,a.jsx)(M._,{onChange:e=>eD.setFieldValue("items",e),value:eD.values.items,error:eD.errors.items,allowDelete:!eM,disabled:eM||(null===(el=eD.values.header)||void 0===el?void 0:el.toWCId)===null||(null===(ed=eD.values.header)||void 0===ed?void 0:ed.fromWCId)===null,name:"items",columns:eA,maxAccess:eS})}),(0,a.jsx)(p.g,{children:(0,a.jsxs)(I.ZP,{container:!0,spacing:2,direction:"row",wrap:"nowrap",sx:{justifyContent:"flex-end"},children:[(0,a.jsx)(I.ZP,{item:!0,xs:3,children:(0,a.jsx)(A.Z,{name:"totalQty",label:eu.totalQty,value:eW,readOnly:!0})}),(0,a.jsx)(I.ZP,{item:!0,xs:3,children:(0,a.jsx)(A.Z,{name:"totalPcs",label:eu.totalPcs,value:eB,readOnly:!0})})]})})]})})}var B=()=>{let{getRequest:e,postRequest:t}=(0,n.useContext)(l.$),{platformLabels:r}=(0,n.useContext)(y.l),{stack:I}=(0,i.zY)();async function q(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:a=50,params:n}=t;return{...await e({extension:m.u.BatchTransfer.page,parameters:"_filter=&_size=30&_startAt=".concat(r,"&_sortBy=recordId desc&_pageSize=").concat(a,"&_params=").concat(n||"")}),_startAt:r}}async function S(t){let{qry:r}=t;return await e({extension:m.u.BatchTransfer.snapshot,parameters:"_filter=".concat(r)})}let{query:{data:C},labels:T,search:O,clear:b,paginationParameters:D,refetch:x,access:M,invalidate:R}=(0,d.J)({queryFn:q,endpointId:m.u.BatchTransfer.page,datasetId:c.i.BatchTransfer,search:{searchFn:S}}),{proxyAction:J}=(0,v.G)({functionId:h.J.BatchTransfer,action:B}),A=async()=>{await J()},P=[{field:"reference",headerName:T.reference,flex:1},{field:"date",headerName:T.date,flex:1,type:"date"},{field:"fromWCName",headerName:T.fromWC,flex:1},{field:"toWCName",headerName:T.toWC,flex:1},{field:"notes",headerName:T.notes,flex:1},{field:"releaseStatus",headerName:T.releaseStatus,flex:1},{field:"statusName",headerName:T.status,flex:1}];function B(e){I({Component:W,props:{labels:T,recordId:e,maxAccess:M},width:1e3,height:750,title:T.batchTransfer})}let j=async e=>{await t({extension:m.u.BatchTransfer.del,record:JSON.stringify(e)}),R(),s.ZP.success(r.Deleted)};return(0,a.jsxs)(u.R,{children:[(0,a.jsx)(p.g,{children:(0,a.jsx)(f.Z,{onAdd:A,maxAccess:M,onSearch:O,onSearchClear:b,labels:T,inputSearch:!0})}),(0,a.jsx)(g.Q,{children:(0,a.jsx)(o.Z,{name:"table",columns:P,gridData:C,rowId:["recordId"],onEdit:e=>{B(null==e?void 0:e.recordId)},onDelete:j,pageSize:50,paginationType:"api",paginationParameters:D,refetch:x,maxAccess:M})})]})}},90587:function(e,t,r){"use strict";r.d(t,{u:function(){return n}});let a="MF.asmx/",n={DesignRawMaterial:{qry2:a+"qryDRM2",qry:a+"qryDRM",set2:a+"set2DRM"},JobOrdersItem:{qry:a+"qryJIT",set2:a+"set2JIT"},IssueOfMaterialsItems:{qry:a+"qryIMI",qry2:a+"qryIMI2"},LaborGroup:{snapshot:a+"snapshotLBG",page:a+"pageLBG",qry:a+"qryLBG",set:a+"setLBG",get:a+"getLBG",del:a+"delLBG"},ProductionLine:{page:a+"pageLIN",qry:a+"qryLIN",qry2:a+"qry2LIN",qry3:a+"qry3LIN",set:a+"setLIN",get:a+"getLIN",del:a+"delLIN"},CostGroup:{page:a+"pageCG",set:a+"setCG",get:a+"getCG",del:a+"delCG",qry:a+"qryCG"},WorkCenter:{page:a+"pageWCT",qry:a+"qryWCT",qry3:a+"qryWCT3",set:a+"setWCT",get:a+"getWCT",del:a+"delWCT",snapshot:a+"snapshotWCT"},Routing:{page:a+"pageRTN",qry:a+"qryRTN",set:a+"setRTN",get:a+"getRTN",del:a+"delRTN",snapshot2:a+"snapshot2RTN",snapshot:a+"snapshotRTN"},Operation:{snapshot:a+"snapshotOPR",qry:a+"qryOPR",page:a+"pageOPR",set:a+"setOPR",get:a+"getOPR",del:a+"delOPR"},Labor:{page:a+"pageLBR",qry:a+"qryLBR",qry2:a+"qry2LBR",set:a+"setLBR",get:a+"getLBR",del:a+"delLBR",snapshot:a+"snapshotLBR"},Machine:{page:a+"pageMAC",qry:a+"qryMAC",set:a+"setMAC",get:a+"getMAC",del:a+"delMAC",snapshot:a+"snapshotMAC"},MachineSpecification:{page:a+"pageMAS",qry:a+"qryMAS",set:a+"setMAS",get:a+"getMAS",del:a+"delMAS"},LeanProductionPlanning:{preview:a+"previewPQ",update:a+"updatePQ",snapshot:a+"snapshotPQ",del:a+"delPQ",cancel:a+"cancelPQ"},MaterialsAdjustment:{generate:a+"generateADJ"},ProductionClass:{page:a+"pageCLS",qry:a+"qryCLS",set:a+"setCLS",get:a+"getCLS",del:a+"delCLS",snapshot:a+"qryCLS"},ProductionStandard:{qry:a+"qrySTD",page:a+"pageSTD",set:a+"setSTD",get:a+"getSTD",del:a+"delSTD"},ProductionClassSemiFinished:{qry:a+"qryCSF",set:a+"setCSF",get:a+"getCSF",del:a+"delCSF",set2:a+"set2CSF"},RoutingSequence:{set2:a+"set2RTS",qry:a+"qryRTS"},Overhead:{qry:a+"qryOVH",set:a+"setOVH",get:a+"getOVH",del:a+"delOVH",page:a+"pageOVH",snapshot:a+"snapshotOVH"},Design:{qry:a+"qryDES",set:a+"setDES",get:a+"getDES",del:a+"delDES",snapshot:a+"snapshotDES",page:a+"pageDES"},MFJobOrder:{pack:a+"packJOB",qry:a+"qryJOB",qry2:a+"qryJOB2",set:a+"setJOB",get:a+"getJOB",get2:a+"get2JOB",del:a+"delJOB",snapshot:a+"snapshotJOB",snapshot2:a+"snapshotJOB2",snapshot3:a+"snapshotJOB3",cancel:a+"cancelJOB",post:a+"postJOB",start:a+"startJOB",stop:a+"stopJOB",wip:a+"wipJOB",sync:a+"syncJOB"},ProductionSheet:{page:a+"pagePST",qry:a+"qryPST",get:a+"getPST",set2:a+"set2PST",get2:a+"get2PST",del:a+"delPST",post:a+"postPST",unpost:a+"unpostPST",snapshot:a+"snapshotPST"},ProductionSheetItem:{qry:a+"qryPSI",set:a+"setPSI",get:a+"getPSI",del:a+"delPSI"},DocumentTypeDefault:{qry:a+"qryDTD",get:a+"getDTD",set:a+"setDTD",del:a+"delDTD",page:a+"pageDTD"},RawMaterialCategory:{qry:a+"qryRMC",get:a+"getRMC",set:a+"setRMC",del:a+"delRMC",page:a+"pageRMC"},WorksheetMaterials:{qry:a+"qryIMA",get:a+"getIMA",pack:a+"get2IMA",set:a+"setIMA",set2:a+"set2IMA",del:a+"delIMA",post:a+"postIMA"},ProductionSheetQueue:{qry:a+"qryPSQ"},Damage:{qry:a+"qryDMG",get:a+"getDMG",set:a+"setDMG",del:a+"delDMG",page:a+"pageDMG",snapshot:a+"snapshotDMG",post:a+"postDMG",get2:a+"get2DMG",set2:a+"set2DMG",preview:a+"previewDMG"},JobCategory:{qry:a+"qryJCA"},JobRouting:{qry:a+"qryJRO",get:a+"getJRO",set:a+"setJRO",set2:a+"set2JRO",del:a+"delJRO",sync:a+"syncJRO",close:a+"closeJRO",reopen:a+"reopenJRO"},Worksheet:{snapshot:a+"snapshotWST",get:a+"getWST",pack:a+"getPackWST",set:a+"setWST",del:a+"delWST",page:a+"pageWST",summary:a+"summaryWST",post:a+"postWST",qry2:a+"qryWST2",draft:a+"draftWST"},JobOverhead:{qry:a+"qryJOH",set2:a+"set2JOH",generate:a+"generateJOH"},JobMaterial:{qry:a+"qryJMA"},JobItemSize:{qry:a+"qryJSZ",set2:a+"set2JSZ"},MFSerial:{qry:a+"qrySRL",qry2:a+"qrySRL2",set2:a+"set2SRL",generate:a+"generateSRL"},SamplePack:{qry:a+"qrySPL",set2:a+"set2SPL"},DamageReturn:{get:a+"getDMR",set:a+"setDMR",del:a+"delDMR",page:a+"pageDMR",snapshot:a+"snapshotDMR",post:a+"postDMR"},ProductionOrder:{get2:a+"get2PO",set2:a+"set2PO",del:a+"delPO",page:a+"pagePO",snapshot:a+"snapshotPO",post:a+"postPO",gen:a+"genPO",close:a+"closePO"},BillOfMaterials:{get:a+"getBMA",qry2:a+"qry2BMA",set:a+"setBMA",del:a+"delBMA",page:a+"pageBMA",snapshot:a+"snapshotBMA"},Component:{get:a+"getBMI",qry:a+"qryBMI",del:a+"delBMI",set:a+"setBMI",set2:a+"set2BMI"},Assembly:{get:a+"getASM",set2:a+"set2ASM",del:a+"delASM",page:a+"pageASM",snapshot:a+"snapshotASM",post:a+"postASM",unpost:a+"unpostASM",generate:a+"genASM"},AssemblyItems:{qry:a+"qryASC"},AssemblyLot:{get:a+"getASL",set:a+"setASL"},AssemblyOverhead:{qry:a+"qryAOH",set2:a+"set2AOH"},MeasurementScheduleMap:{qry:a+"qryMSM",set:a+"setMSM",set2:a+"set2MSM",del:a+"delMSM"},JobCategory:{set:a+"setJCA",get:a+"getJCA",del:a+"delJCA",page:a+"pageJCA",qry:a+"qryJCA"},DesignGroup:{qry:a+"qryDEG",set:a+"setDEG",get:a+"getDEG",del:a+"delDEG",page:a+"pageDEG"},Components:{qry:a+"qryDEM",set2:a+"set2DEM"},DesignFamily:{qry:a+"qryDEF",set:a+"setDEF",get:a+"getDEF",del:a+"delDEF",page:a+"pageDEF"},ProductionShifts:{qry:a+"qrySHI",set:a+"setSHI",get:a+"getSHI",del:a+"delSHI",page:a+"pageSHI"},JobOrderWizard:{set2:a+"set2JOZ",get2:a+"get2JOZ",del:a+"delJOZ",page:a+"pageJOZ",snapshot:a+"snapshotJOZ",post:a+"postJOZ"},JobTransfer:{get2:a+"get2TFR",set2:a+"set2TFR",del:a+"delTFR",page:a+"pageTFR",snapshot:a+"snapshotTFR",post:a+"postTFR",close:a+"closeTFR",reopen:a+"reopenTFR",qry:a+"qryTFR"},JobWorkCenter:{qry:a+"qryJWC",close:a+"closeJWC",reopen:a+"reopenJWC",get:a+"getJWC",snapshot:a+"snapshotJWC",verify:a+"verifyJWC"},WorkCenterConsumption:{page:a+"pageCON",snapshot:a+"snapshotCON",del:a+"delCON",set2:a+"set2CON",get:a+"getCON",post:a+"postCON",unpost:a+"unpostCON",close:a+"closeCON",reopen:a+"reopenCON"},ConsumptionItemView:{qry:a+"qryCOI"},LineItemCapacity:{set2:a+"set2LIT",del:a+"delLIT",qry:a+"qryLIT",page:a+"pageLIT"},CostGroupOverhead:{set2:a+"set2CGV",qry:a+"qryCGV"},IssueOfMaterialDimension:{set:a+"setIMD",qry:a+"qryIMD"},JobOrder:{gen:a+"genORD"},RefreshPoItem:{refresh:a+"refreshPOI"},WorkCenterTransferMap:{qry:a+"qryWCTM",set2:a+"set2WCTM"},BatchWorksheet:{get2:a+"get2BWST",set2:a+"set2BWST",del:a+"delBWST",page:a+"pageBWST",snapshot:a+"snapshotBWST",post:a+"postBWST",gen:a+"genBWST",close:a+"closeBWST",reopen:a+"reopenBWST"},ProductionOrderFromSaleOrder:{gen:a+"generatePOFromSO"},BatchTransfer:{page:a+"pageBTFR",set2:a+"set2BTFR",del:a+"delBTFR",snapshot:a+"snapshotBTFR",get:a+"getBTFR",post:a+"postBTFR",unpost:a+"unpostBTFR"},BatchTransferJob:{qry:a+"qryBTFJ"},Disposal:{page:a+"pageDIS",snapshot:a+"snapshotDIS",get:a+"getDIS",set2:a+"set2DIS",del:a+"delDIS"},DisposalItem:{qry:a+"qryDII"},DisposalSerial:{qry:a+"qryDISRL"},MetalSetting:{page:a+"pageMTS",set:a+"setMTS",get:a+"getMTS",del:a+"delMTS"},DamageReason:{qry:a+"qryDRS",page:a+"pageDRS",set:a+"setDRS",get:a+"getDRS",del:a+"delDRS",snapshot:a+"snapshotDRS"},DamageCategory:{qry:a+"qryDCA",page:a+"pageDCA",set:a+"setDCA",get:a+"getDCA",del:a+"delDCA",snapshot:a+"snapshotDCA"}}},67920:function(e,t,r){"use strict";r.d(t,{m:function(){return n}});var a=r(48601);function n(e,t,r){var n;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",o={...e};return null==r||null===(n=r.record)||void 0===n||n.controls.forEach(e=>{let{controlId:t,accessLevel:r}=e,[a,n]=null==t?void 0:t.split(".");a!==s||2!==r||n in o||(o[n]=e=>(null==e?void 0:e[n])!=null),(1===r||4===r)&&n in o&&delete o[n]}),{schema:a.Ry().shape({...Object.keys(o).reduce((e,r)=>(e[r]=a.nK().nullable().test(function(e){var a;let n=this.parent,[,s]=this.path.match(/^(\w+)\[(\d+)\]/)||[],l=(null===(a=this.options.context)||void 0===a?void 0:a[s])||[];if(t||!t&&l.length>1){if(null!==n[r]&&void 0!==n[r]&&0!==n[r]&&""!==o[r]&&!o[r](n))return!1;if(!Object.entries(o).some(e=>{let[,t]=e;return!!t(n)}))return!0}return!!o[r](n)&&void 0!==e}),e),{})}),requiredFields:o}}},1685:function(e,t,r){"use strict";r.d(t,{m:function(){return a}});let a=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,r){"use strict";r.d(t,{H:function(){return v},G:function(){return y}});var a=r(45300),n=r(2784),s=r(96026),o=r(38449);r(26612);var l=r(65947),d=r(1685);let i=async(e,t,r)=>{try{let a=await e({extension:t,parameters:r});return t.includes("qry")?a:a.record}catch(e){return null}},c=(e,t,r,a)=>{let n=(e=JSON.parse(JSON.stringify(e))).record.controls,s=n.find(e=>"reference"===e.controlId);return s?s.accessLevel=(null==t?void 0:t.mandatory)?l.$7:l.rr:(null==t?void 0:t.mandatory)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?l.$7:l.rr}):(null==t?void 0:t.readOnly)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?l.rr:l.$7}):n=e.record.controls.filter(e=>"reference"!=e.controlId),r&&n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","dtId"),accessLevel:l.$7}),{...e,record:{...e.record,controls:n}}},u=async(e,t,r)=>{let a,n;switch(r){case"dtId":let s=(0,d.m)("userData"),l=null==s?void 0:s.userId;n="_userId=".concat(l,"&_functionId=").concat(t),a=o.r.UserFunction.get;break;case"glbSysNumberRange":n="_recordId=".concat(t),a=o.r.SystemFunction.get;break;case"DocumentType":n="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),a=o.r.DocumentType.qry;break;case"DcTypNumberRange":n="_recordId=".concat(t),a=o.r.DocumentType.get;break;case"isExternal":n="_recordId=".concat(t),a=o.r.NumberRange.get;break;default:return null}return await i(e,a,n)},p=async function(e){let t,r,a,n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,d=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=arguments.length>5?arguments[5]:void 0,p=void 0===l&&s&&await u(e,s,"dtId"),g=null==p?void 0:p.dtId,y="",v=!0;if(p&&void 0===l||"nraId"===l){if(g){let r=await u(e,g,"DcTypNumberRange");t=null==r?void 0:r.nraId,v=!((null==r?void 0:r.activeStatus)<0),t||(y="Assign the document type to a number range")}if((!g||!v)&&d&&s){var h;let t=await u(e,s,"DocumentType");n=(null==t?void 0:null===(h=t.list)||void 0===h?void 0:h.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===l||void 0===l)&&s){if((!g||g)&&!t||t&&!v){let r=await u(e,s,"glbSysNumberRange");(t=null==r?void 0:r.nraId)&&n&&(n=!1),v=!0}y=t||n?"":"Assign the system Function to a number range"}l>0&&!t&&(t=l),t&&v?(r={readOnly:null==(a=await u(e,t,"isExternal"))||!a.external,mandatory:null!=a&&!!a.external},o&&(o=await c(o,r,n,i))):!t&&o&&(o=await c(o,r,n,i));let m=i?"".concat(i,".reference"):"reference";return{dtId:g,resetReference:null==r?void 0:r.readOnly,dcTypeRequired:n,reference:{fieldName:m,isEmpty:(null==a?void 0:a.external)!==void 0&&(null==a||!a.external)},errorMessage:y,maxAccess:o,selectNraId:l}};var g=r(65950);function y(e){let{functionId:t,action:r,hasDT:a}=e,{getRequest:o}=(0,n.useContext)(g.$),{stack:l}=(0,s.V)();return{proxyAction:async()=>{let e=await p(o,t,"",void 0,a);(null==e?void 0:e.errorMessage)?l({message:null==e?void 0:e.errorMessage}):await r()}}}function v(e){var t;let{functionId:r,access:o,hasDT:l,enabled:d=!0,objectName:i=""}=e,{getRequest:c}=(0,n.useContext)(g.$),{stack:u}=(0,s.V)(),[y,v]=(0,n.useState)(),h=async e=>{let t=await p(c,r,o,e,l,i);if(!t.errorMessage)return t;u({message:null==t?void 0:t.errorMessage})},m=(0,a.a)({retry:!1,staleTime:0,enabled:d,queryKey:[r,y,!!o,d],queryFn:y||"nraId"===y?()=>h(y):()=>h()});return{documentType:m.data,maxAccess:(null==m?void 0:null===(t=m.data)||void 0===t?void 0:t.maxAccess)||o,changeDT(e){v((null==e?void 0:e.nraId)||"nraId")}}}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=99313)}),_N_E=e.O()}]);