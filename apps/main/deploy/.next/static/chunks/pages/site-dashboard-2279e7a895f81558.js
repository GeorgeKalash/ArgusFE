(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[31643],{38237:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/site-dashboard",function(){return t(47360)}])},47360:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return N}});var s=t(52322),i=t(29326),n=t(9522),l=t(2784),r=t(62362),d=t(31389),c=t(69387),o=e=>{let{data:a,pagination:t,refetch:i,access:n,labels:l}=e,o=[{field:"sku",headerName:l.sku,flex:1},{field:"itemName",headerName:l.itemName,flex:1},{field:"onHand",headerName:l.qty,flex:1,type:"number"}];return(0,s.jsx)(d.R,{children:(0,s.jsx)(r.Q,{children:(0,s.jsx)(c.Z,{name:"availabilities",columns:o,gridData:a,rowId:["recordId"],isLoading:!1,pageSize:50,paginationType:"api",paginationParameters:t,refetch:i,maxAccess:n})})})},u=e=>{let{data:a,pagination:t,refetch:i,access:n,labels:l}=e,o=[{field:"reference",headerName:l.reference,flex:1},{field:"functionName",headerName:l.function,flex:1},{field:"date",headerName:l.date,flex:1,type:"date"},{field:"description",headerName:l.description,flex:1},{field:"sku",headerName:l.sku,flex:1},{field:"itemName",headerName:l.itemName,flex:1},{field:"qty",headerName:l.qty,flex:1}];return(0,s.jsx)(d.R,{children:(0,s.jsx)(r.Q,{children:(0,s.jsx)(c.Z,{name:"activities",columns:o,gridData:a,rowId:["recordId"],isLoading:!1,pageSize:50,paginationType:"api",paginationParameters:t,refetch:i,maxAccess:n})})})},m=t(71987),b=t(26612),_=t(65215),f=t(60218),v=t(33625),h=t(27723),p=t(19473),x=t(8661),I=t(65950),g=t(80983),y=t(69627),N=()=>{let[e,a]=(0,l.useState)(0),{getRequest:t}=(0,l.useContext)(I.$),{platformLabels:c}=(0,l.useContext)(p.l),{labels:N,access:T}=(0,m.J)({datasetId:b.i.SiteDashboard});async function j(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:s=50}=e;return D.values.siteId?{...await t({extension:_.$.Availability.qry,parameters:"_startAt=".concat(a,"&_pageSize=").concat(s,"&_siteId=").concat(D.values.siteId,"&_itemId=",0,"&_functionId=0&_filter=&_size=30")}),_startAt:a}:{count:0,list:[],statusId:1,message:""}}async function C(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:s=50}=e;return D.values.siteId?{...await t({extension:_.$.Transaction.qry3,parameters:"_filter=&_size=30&_startAt=".concat(a,"&_siteId=").concat(D.values.siteId,"&_functionId=0&_itemId=0&_pageSize=").concat(s,"&_sortBy=itemId")}),_startAt:a}:{count:0,list:[],statusId:1,message:""}}let{query:{data:A},paginationParameters:Z,refetch:P,access:S}=(0,m.J)({queryFn:j,endpointId:_.$.Availability.qry,datasetId:b.i.SiteDashboard}),{query:{data:q},paginationParameters:w,refetch:k,access:R}=(0,m.J)({queryFn:C,endpointId:_.$.Transaction.qry3,datasetId:b.i.SiteDashboard}),z=[{label:null==N?void 0:N.availability},{label:null==N?void 0:N.activities}],{formik:D}=(0,g.c)({initialValues:{siteId:null},validateOnChange:!0,onSubmit:()=>{w({_startAt:0,_pageSize:50}),Z({_startAt:0,_pageSize:50}),P(),k()}});return(0,s.jsxs)(d.R,{children:[(0,s.jsx)(v.g,{children:(0,s.jsx)(h.Z,{maxAccess:T,inputSearch:!1,leftSection:(0,s.jsxs)(f.ZP,{item:!0,sx:{display:"flex"},xs:4,children:[(0,s.jsx)(x.Z,{endpointId:_.$.Site.qry,name:"siteId",label:N.site,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:D.values,maxAccess:T,onChange:(e,a)=>{D.setFieldValue("siteId",(null==a?void 0:a.recordId)||null)}}),(0,s.jsx)(y.Z,{image:"preview.png",tooltipText:c.Preview,onClick:()=>D.handleSubmit(),style:{marginLeft:2,padding:0}})]})})}),(0,s.jsxs)(r.Q,{children:[(0,s.jsx)(n.Y,{tabs:z,activeTab:e,setActiveTab:a,maxAccess:T}),(0,s.jsx)(i.Z,{index:0,value:e,maxAccess:T,children:(0,s.jsx)(o,{labels:N,maxAccess:T,data:A,pagination:Z,refetch:P,access:S})}),(0,s.jsx)(i.Z,{index:1,value:e,maxAccess:T,children:(0,s.jsx)(u,{maxAccess:T,labels:N,data:q,pagination:w,refetch:k,access:R})})]})]})}},29326:function(e,a,t){"use strict";var s=t(52322);t(2784);var i=t(23925),n=t(13980),l=t.n(n),r=t(95291),d=t.n(r),c=t(65947);let o=e=>{var a,t,n;let{children:l,value:r,index:o,maxAccess:u,...m}=e,b="".concat(e.name||"tab",".").concat(o),{accessLevel:_}=null!==(n=(null!==(t=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==t?t:[]).find(e=>e.controlId===b))&&void 0!==n?n:{accessLevel:0};if(_===c.A1)return null;let f=r===o;return(0,s.jsx)(i.Z,{role:"tabpanel",hidden:!f,id:"simple-tabpanel-".concat(o),"aria-labelledby":"simple-tab-".concat(o),className:"".concat(d().tabPanel," ").concat(f?d().active:d().hidden),...m,children:l})};o.propTypes={children:l().node,index:l().number.isRequired,value:l().number.isRequired},a.Z=o},9522:function(e,a,t){"use strict";t.d(a,{Y:function(){return m}});var s=t(52322),i=t(23925),n=t(54582),l=t(68696),r=t(44258),d=t(2784),c=t(99266),o=t(52614),u=t.n(o);let m=e=>{var a,t,o,m,b;let{tabs:_,activeTab:f,setActiveTab:v,maxAccess:h,name:p="tab"}=e,x=(null==h?void 0:null===(t=h.record)||void 0===t?void 0:null===(a=t.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(p,".")))}).map(e=>e.controlId.split(".")[1]))||[],I=null==_?void 0:null===(o=_.map((e,a)=>({...e,id:a})))||void 0===o?void 0:o.filter((e,a)=>!x.includes(String(a))),g=null===(m=I[f])||void 0===m?void 0:m.id,y=null===(b=I[f])||void 0===b?void 0:b.disabled;return(0,d.useEffect)(()=>{g>=0&&!y&&f!=g&&v(g)},[]),(0,s.jsx)(i.Z,{className:u().tabsContainer,children:(0,s.jsx)(i.Z,{className:u().tabsWrapper,children:(0,s.jsx)(n.Z,{value:f,onChange:(e,a)=>v(a),variant:"scrollable",scrollButtons:I.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==I?void 0:I.map(e=>(0,s.jsx)(l.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,s.jsxs)(i.Z,{display:"flex",alignItems:"center",children:[(0,s.jsx)("span",{children:e.label}),e.id===f&&(null==e?void 0:e.onRefetch)&&(0,s.jsx)(r.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,s.jsx)(c.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=38237)}),_N_E=e.O()}]);