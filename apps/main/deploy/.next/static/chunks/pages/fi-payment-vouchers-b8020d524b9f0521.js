(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5386],{92137:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fi-payment-vouchers",function(){return t(48366)}])},48366:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return I}});var n=t(52322),l=t(2784),r=t(62202),o=t(69387),d=t(65950),i=t(71987),c=t(26612),u=t(31389),s=t(33625),m=t(62362),v=t(61802),f=t(19473),h=t(46671),y=t(25870),x=t(36908),p=t(7121),g=t(98345),I=()=>{let{getRequest:e,postRequest:a}=(0,l.useContext)(d.$),{platformLabels:t}=(0,l.useContext)(f.l),{stack:I}=(0,v.zY)();async function b(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:n=50,params:l}=a,r=await e({extension:y.H.PaymentVouchers.page3,parameters:"_startAt=".concat(t,"&_pageSize=").concat(n,"&_params=").concat(l||"","&filter=")});if(r&&(null==r?void 0:r.list)){var o;r.list=null==r?void 0:null===(o=r.list)||void 0===o?void 0:o.map(e=>({...e,isVerified:(null==e?void 0:e.isVerified)!==null&&(null==e?void 0:e.isVerified)}))}return{...r,_startAt:t}}async function N(a){let{filters:t,pagination:n}=a;return(null==t?void 0:t.qry)?await e({extension:y.H.PaymentVouchers.snapshot,parameters:"_filter=".concat(t.qry)}):b({_startAt:n._startAt||0,params:null==t?void 0:t.params})}let{query:{data:C},labels:F,filterBy:w,paginationParameters:A,refetch:_,access:V,invalidate:j}=(0,i.J)({queryFn:b,endpointId:y.H.PaymentVouchers.page3,datasetId:c.i.PaymentVouchers,filter:{filterFn:N}}),R=[{field:"plantName",headerName:F.plant,flex:1},{field:"reference",headerName:F.reference,flex:1},{field:"date",headerName:F.date,flex:1,type:"date"},{field:"accountRef",headerName:F.account,flex:1},{field:"accountName",headerName:F.accountName,flex:1},{field:"currencyRef",headerName:F.currency,flex:1},{field:"paymentMethodName",headerName:F.paymentMethod,flex:1},{field:"amount",headerName:F.amount,flex:1,type:"number"},{field:"cashAccountName",headerName:F.cashAccount,flex:1},{field:"notes",headerName:F.notes,flex:1},{field:"isVerified",headerName:F.isVerified,type:"checkbox"},{field:"statusName",headerName:F.status,flex:1}],k=async()=>{await T()};async function M(e){I({Component:h.Z,props:{recordId:e}})}let{proxyAction:T}=(0,g.G)({functionId:p.J.PaymentVoucher,action:M}),Z=async e=>{await a({extension:y.H.PaymentVouchers.del,record:JSON.stringify(e)}),j(),r.ZP.success(t.Deleted)};return(0,n.jsxs)(u.R,{children:[(0,n.jsx)(s.g,{children:(0,n.jsx)(x.Z,{labels:F,onAdd:k,maxAccess:V,reportName:"FIPV",filterBy:w})}),(0,n.jsx)(m.Q,{children:(0,n.jsx)(o.Z,{name:"table",columns:R,gridData:C,rowId:["recordId"],onEdit:e=>{M(null==e?void 0:e.recordId)},onDelete:Z,isLoading:!1,deleteConfirmationType:"strict",pageSize:50,paginationType:"api",paginationParameters:A,refetch:_,maxAccess:V})})]})}},1685:function(e,a,t){"use strict";t.d(a,{m:function(){return n}});let n=e=>{let a=window.sessionStorage.getItem(e);return a?JSON.parse(a):null}},98345:function(e,a,t){"use strict";t.d(a,{H:function(){return h},G:function(){return f}});var n=t(45300),l=t(2784),r=t(96026),o=t(38449);t(26612);var d=t(65947),i=t(1685);let c=async(e,a,t)=>{try{let n=await e({extension:a,parameters:t});return a.includes("qry")?n:n.record}catch(e){return null}},u=(e,a,t,n)=>{let l=(e=JSON.parse(JSON.stringify(e))).record.controls,r=l.find(e=>"reference"===e.controlId);return r?r.accessLevel=(null==a?void 0:a.mandatory)?d.$7:d.rr:(null==a?void 0:a.mandatory)?l.push({sgId:0,resourceId:"",controlId:"".concat(n?n+".":"","reference"),accessLevel:(null==a?void 0:a.mandatory)?d.$7:d.rr}):(null==a?void 0:a.readOnly)?l.push({sgId:0,resourceId:"",controlId:"".concat(n?n+".":"","reference"),accessLevel:(null==a?void 0:a.readOnly)?d.rr:d.$7}):l=e.record.controls.filter(e=>"reference"!=e.controlId),t&&l.push({sgId:0,resourceId:"",controlId:"".concat(n?n+".":"","dtId"),accessLevel:d.$7}),{...e,record:{...e.record,controls:l}}},s=async(e,a,t)=>{let n,l;switch(t){case"dtId":let r=(0,i.m)("userData"),d=null==r?void 0:r.userId;l="_userId=".concat(d,"&_functionId=").concat(a),n=o.r.UserFunction.get;break;case"glbSysNumberRange":l="_recordId=".concat(a),n=o.r.SystemFunction.get;break;case"DocumentType":l="_dgId=".concat(a,"&_startAt=",0,"&_pageSize=",50),n=o.r.DocumentType.qry;break;case"DcTypNumberRange":l="_recordId=".concat(a),n=o.r.DocumentType.get;break;case"isExternal":l="_recordId=".concat(a),n=o.r.NumberRange.get;break;default:return null}return await c(e,n,l)},m=async function(e){let a,t,n,l,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4],c=arguments.length>5?arguments[5]:void 0,m=void 0===d&&r&&await s(e,r,"dtId"),v=null==m?void 0:m.dtId,f="",h=!0;if(m&&void 0===d||"nraId"===d){if(v){let t=await s(e,v,"DcTypNumberRange");a=null==t?void 0:t.nraId,h=!((null==t?void 0:t.activeStatus)<0),a||(f="Assign the document type to a number range")}if((!v||!h)&&i&&r){var y;let a=await s(e,r,"DocumentType");l=(null==a?void 0:null===(y=a.list)||void 0===y?void 0:y.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===d||void 0===d)&&r){if((!v||v)&&!a||a&&!h){let t=await s(e,r,"glbSysNumberRange");(a=null==t?void 0:t.nraId)&&l&&(l=!1),h=!0}f=a||l?"":"Assign the system Function to a number range"}d>0&&!a&&(a=d),a&&h?(t={readOnly:null==(n=await s(e,a,"isExternal"))||!n.external,mandatory:null!=n&&!!n.external},o&&(o=await u(o,t,l,c))):!a&&o&&(o=await u(o,t,l,c));let x=c?"".concat(c,".reference"):"reference";return{dtId:v,resetReference:null==t?void 0:t.readOnly,dcTypeRequired:l,reference:{fieldName:x,isEmpty:(null==n?void 0:n.external)!==void 0&&(null==n||!n.external)},errorMessage:f,maxAccess:o,selectNraId:d}};var v=t(65950);function f(e){let{functionId:a,action:t,hasDT:n}=e,{getRequest:o}=(0,l.useContext)(v.$),{stack:d}=(0,r.V)();return{proxyAction:async()=>{let e=await m(o,a,"",void 0,n);(null==e?void 0:e.errorMessage)?d({message:null==e?void 0:e.errorMessage}):await t()}}}function h(e){var a;let{functionId:t,access:o,hasDT:d,enabled:i=!0,objectName:c=""}=e,{getRequest:u}=(0,l.useContext)(v.$),{stack:s}=(0,r.V)(),[f,h]=(0,l.useState)(),y=async e=>{let a=await m(u,t,o,e,d,c);if(!a.errorMessage)return a;s({message:null==a?void 0:a.errorMessage})},x=(0,n.a)({retry:!1,staleTime:0,enabled:i,queryKey:[t,f,!!o,i],queryFn:f||"nraId"===f?()=>y(f):()=>y()});return{documentType:x.data,maxAccess:(null==x?void 0:null===(a=x.data)||void 0===a?void 0:a.maxAccess)||o,changeDT(e){h((null==e?void 0:e.nraId)||"nraId")}}}},77595:function(e,a,t){"use strict";t.d(a,{Z:function(){return b}});var n=t(52322),l=t(60218),r=t(2784),o=t(26612),d=t(5088),i=t(80983),c=t(31389),u=t(62362),s=t(91406),m=t(30657),v=t(65950),f=t(1251),h=t(39812),y=t(26553),x=t(71987),p=t(21326),g=t(19473),I=t(54074);function b(e){var a,t,b,N,C,F,w,A,_;let{data:V,onOk:j,DatasetIdAccess:R,window:k}=e,{getRequest:M}=(0,r.useContext)(v.$),{platformLabels:T}=(0,r.useContext)(g.l);(0,p.Z)({title:T.MultiCurrencyRate,window:k});let{labels:Z,access:O}=(0,x.J)({endpointId:f.q.Currency.get,DatasetIdAccess:R,datasetId:o.i.MultiCurrencyRate}),{formik:S}=(0,i.c)({initialValues:{currencyId:null==V?void 0:V.currencyId,currencyName:null==V?void 0:V.currencyName,exchangeId:null==V?void 0:V.exchangeId,exchangeName:null==V?void 0:V.exchangeName,rateCalcMethod:null==V?void 0:V.rateCalcMethod,rateCalcMethodName:null==V?void 0:V.rateCalcMethodName,rateTypeId:null==V?void 0:V.rateTypeId,exRate:(null==V?void 0:V.exRate)||null,amount:(null==V?void 0:V.amount)||0,baseAmount:null==V?void 0:V.baseAmount,rateTypeName:null==V?void 0:V.rateTypeName},maxAccess:O,validateOnChange:!0});async function P(){if((null==V?void 0:V.currencyId)&&(null==V?void 0:V.date)){var e,a,t,n,l;let r=await M({extension:f.q.Currency.get,parameters:"_currencyId=".concat(null==V?void 0:V.currencyId,"&_date=").concat((0,h.Uf)(null==V?void 0:V.date),"&_rateDivision=").concat(y.B.FINANCIALS)});S.setFieldValue("rateCalcMethod",null===(e=r.record)||void 0===e?void 0:e.rateCalcMethod),S.setFieldValue("rateCalcMethodName",null===(a=r.record)||void 0===a?void 0:a.rateCalcMethodName),S.setFieldValue("exchangeId",null===(t=r.record)||void 0===t?void 0:t.exchangeId),S.setFieldValue("exchangeName",null===(n=r.record)||void 0===n?void 0:n.exchangeName),S.setFieldValue("rateTypeName",null===(l=r.record)||void 0===l?void 0:l.rateTypeName)}}(0,r.useEffect)(()=>{!async function(){await P()}()},[]);let E=()=>{j&&(j({...S.values,exRate:S.values.exRate,baseAmount:S.values.baseAmount,amount:S.values.amount}),k.close())},L=[{key:"Ok",condition:!0,onClick:E,disabled:!1}];return(0,n.jsx)(I.Z,{onSave:E,actions:L,maxAccess:O,editMode:!1,isSaved:!1,children:(0,n.jsx)(c.R,{children:(0,n.jsx)(u.Q,{children:(0,n.jsxs)(l.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(d.Z,{name:"currencyName",value:null==S?void 0:null===(a=S.values)||void 0===a?void 0:a.currencyName,label:Z.currency,readOnly:!0})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(d.Z,{name:"rateTypeName",value:null==S?void 0:null===(t=S.values)||void 0===t?void 0:t.rateTypeName,label:Z.rateType,readOnly:!0})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(d.Z,{name:"exchangeName",value:null==S?void 0:null===(b=S.values)||void 0===b?void 0:b.exchangeName,label:Z.exchangeTable,readOnly:!0})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(d.Z,{name:"rateCalcMethodName",value:null==S?void 0:null===(N=S.values)||void 0===N?void 0:N.rateCalcMethodName,label:Z.rateCalcMethod,readOnly:!0})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(s.Z,{name:"exRate",value:null==S?void 0:null===(C=S.values)||void 0===C?void 0:C.exRate,label:Z.rate,readOnly:(null==S?void 0:null===(F=S.values)||void 0===F?void 0:F.amount)==0,maxAccess:O,onClear:()=>{S.setFieldValue("baseAmount",""),S.setFieldValue("exRate","")},decimalScale:7,onChange:e=>{var a,t;let n=e.target.value;if(!n){S.setFieldValue("exRate",""),S.setFieldValue("baseAmount","");return}S.setFieldValue("exRate",n);let l=(0,m.fB)({amount:(null==V?void 0:V.amount)||0,exRate:n,baseAmount:parseFloat((null==S?void 0:null===(a=S.values)||void 0===a?void 0:a.baseAmount)||0).toFixed(2),rateCalcMethod:null==S?void 0:null===(t=S.values)||void 0===t?void 0:t.rateCalcMethod,dirtyField:m.ss});S.setValues({...S.values,...l,baseAmount:parseFloat(l.baseAmount).toFixed(2)})}})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(s.Z,{name:"amount",value:null==S?void 0:null===(w=S.values)||void 0===w?void 0:w.amount,label:Z.amount,readOnly:!0})}),(0,n.jsx)(l.ZP,{item:!0,xs:12,children:(0,n.jsx)(s.Z,{name:"baseAmount",value:null==S?void 0:null===(A=S.values)||void 0===A?void 0:A.baseAmount,label:Z.baseAmount,readOnly:(null==S?void 0:null===(_=S.values)||void 0===_?void 0:_.amount)==0,onClear:()=>{S.setFieldValue("baseAmount",""),S.setFieldValue("exRate","")},maxAccess:O,onChange:e=>{var a,t;let n=e.target.value;if(!n){S.setFieldValue("baseAmount",""),S.setFieldValue("exRate","");return}S.setFieldValue("baseAmount",n);let l=(0,m.fB)({amount:(null==V?void 0:V.amount)||0,exRate:null==S?void 0:null===(a=S.values)||void 0===a?void 0:a.exRate,baseAmount:parseFloat(n||0).toFixed(2),rateCalcMethod:null==S?void 0:null===(t=S.values)||void 0===t?void 0:t.rateCalcMethod,dirtyField:m.i5});S.setValues({...S.values,...l})}})})]})})})})}b.width=500,b.height=500},39704:function(e,a,t){"use strict";var n=t(52322),l=t(2784),r=t(22341),o=t(65950),d=t(85325),i=t(21326),c=t(19473),u=t(35656),s=t(24868),m=t.n(s);let v=e=>{let{functionId:a,recordId:t,window:s}=e,{getRequest:v}=(0,l.useContext)(o.$),{languageId:f}=(0,l.useContext)(d.V),{platformLabels:h}=(0,l.useContext)(c.l),y=t+"-"+a;(0,i.Z)({title:h.WorkFlow,window:s});let{width:x}=(0,u.d)(),p=x<=1024,g=x>1024&&x<=1280,I=p?10:g?12:14,b=p?75:g?85:95,N=p?15:g?20:25,C=async()=>{var e="_functionId=".concat(a,"&_recordId=").concat(t);let n=await v({extension:r.P.WorkFlow.graph,parameters:e});return null==n?void 0:n.record},F=e=>{let a=[],t=[],n="",l="";return e.objects.forEach(e=>{a.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(a=>{e.objects.forEach(e=>{let t=e.functionName.split(" ").join("\r\n");a.parentId===e.recordId&&a.parentFunctionId===e.functionId&&(n=e.reference+"\r\n"+e.date+"\r\n"+t,a.parentId),a.childId===e.recordId&&a.childFunctionId===e.functionId&&(l=e.reference+"\r\n"+e.date+"\r\n"+t,a.childId)}),""===n||""===l||t.push({from:n,to:l,value:1,labelText:""}),n="",l=""}),t};return(0,l.useEffect)(()=>{!async function(){var e=await C();if(e){let a=(e,a)=>{let t=document.createElement("script");t.type="text/javascript",t.src=e,t.async=!0,t.onload=a,document.head.appendChild(t)};a("https://cdn.amcharts.com/lib/4/core.js",()=>{a("https://cdn.amcharts.com/lib/4/charts.js",()=>{a("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let a=am4core.create(y,am4charts.SankeyDiagram),t=F(e);a.data=t,a.dataFields.fromName="from",a.dataFields.toName="to",a.dataFields.value="value",a.paddingRight=2===f?0:40,a.paddingLeft=2===f?40:0,a.tooltip.label.fontSize=I;let n=a.nodes.template;n.draggable=!1,n.inert=!0,n.clickable=!1,n.width=b,n.height=N,n.nameLabel.label.fontSize=I,n.nameLabel.locationX=2===f?.85:0,n.nameLabel.height=void 0,n.nameLabel.label.fontWeight="bold";let l=a.links.template;l.middleLine.strokeOpacity=.3,l.middleLine.stroke=am4core.color("#555"),l.middleLine.strokeWidth=5,l.middleLine.hoverable=!1,l.fillOpacity=0,l.hoverable=!0,l.hoverOnFocus=!0,l.fill=am4core.color("#A8C686"),l.isHover=!0,a.appear(1e3,100)})})})})}}()},[]),(0,n.jsx)("div",{id:y,className:m().root})};v.width=950,a.Z=v},24868:function(e){e.exports={root:"WorkFlow_root__EINm1"}}},function(e){e.O(0,[92515,2494,36908,46671,49774,92888,40179],function(){return e(e.s=92137)}),_N_E=e.O()}]);