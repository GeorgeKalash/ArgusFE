(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26912],{636:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/job-transfer-checkout",function(){return n(97817)}])},97817:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return O}});var l=n(52322),t=n(2784),a=n(62202),o=n(69387),d=n(65950),s=n(71987),i=n(26612),u=n(31389),c=n(33625),v=n(62362),f=n(61802),m=n(19473),y=n(90587),x=n(60218),I=n(48601),g=n(82737),p=n(2801),h=n(80983),b=n(5088),j=n(8661),N=n(27423),C=n(38449),w=n(91406),k=n(89330),q=n(21581),_=n(98345),Z=n(39812),S=n(7121),R=n(96026);function F(e){var r,n,f,F,P,O,A,V,J,D,T,W,M,Q,E,$,z,U,L,B,H,X,G,Y,K,ee,er,en,el,et,ea,eo,ed,es,ei,eu,ec,ev,ef,em,ey,ex,eI,eg,ep;let{labels:eh,recordId:eb,access:ej,window:eN}=e,{platformLabels:eC}=(0,t.useContext)(m.l),{getRequest:ew,postRequest:ek}=(0,t.useContext)(d.$),{stack:eq}=(0,R.V)(),{documentType:e_,maxAccess:eZ,changeDT:eS}=(0,_.H)({functionId:S.J.JTCheckOut,access:ej,enabled:!eb,objectName:"transfer"}),eR=(0,s.E)({endpointId:y.u.JobTransfer.page}),{formik:eF}=(0,h.c)({documentType:{key:"transfer.dtId",value:null==e_?void 0:e_.dtId},initialValues:{recordId:eb,transfer:{dtId:null,recordId:null,reference:"",status:1,date:new Date,jobId:null,itemId:null,fromWCId:null,toWCId:null,designId:null,jobQty:0,qty:0,pcs:0,fromSeqNo:null,toSeqNo:null,wip:1,routingSeq:null,jobDescription:"",sku:"",designRef:"",itemNmae:"",designName:""},categorySummary:[]},maxAccess:eZ,validationSchema:I.Ry({transfer:I.Ry({date:I.Z_().required(),jobId:I.Rx().required(),fromWCId:I.Z_().required(),toWCId:I.Rx().required(),qty:I.Rx().test("max-qty","Quantity exceeds maximum allowed",function(e){let{maxQty:r}=this.parent;return void 0===r||parseFloat(e)<=r}),pcs:I.Rx().test("max-pcs","Pieces exceed maximum allowed",function(e){let{maxPcs:r}=this.parent;return void 0===r||parseFloat(e)<=r})})}),onSubmit:async e=>{var r,n;let l=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return Number(e.toFixed(r))},t=null!=eO,o=(null==e?void 0:null===(r=e.transfer)||void 0===r?void 0:r.jobQty)!==null&&(null==e?void 0:null===(n=e.transfer)||void 0===n?void 0:n.jobQty)!==void 0;if(t&&o&&Math.abs(l(Number(eO))-l(Number(e.transfer.jobQty)))>.01){eq({message:eh.QtyNotMatching});return}let d={transfer:{...e.transfer,date:(0,Z.ku)(e.transfer.date)},categorySummary:e.categorySummary};await ek({extension:y.u.JobTransfer.set2,record:JSON.stringify(d)}).then(async r=>{eP(null==r?void 0:r.recordId),a.ZP.success((null==e?void 0:e.recordId)?eC.Edited:eC.Added),eR()})}}),eP=async e=>{e&&await ew({extension:y.u.JobTransfer.get2,parameters:"_recordId=".concat(e)}).then(async e=>{var r,n,l,t,a,o,d,s,i,u;eF.setValues({...eF.values,recordId:(null==e?void 0:null===(n=e.record)||void 0===n?void 0:null===(r=n.transfer)||void 0===r?void 0:r.recordId)||null,transfer:{...null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.transfer,date:(0,Z.a1)(null==e?void 0:null===(a=e.record)||void 0===a?void 0:null===(t=a.transfer)||void 0===t?void 0:t.date),maxQty:null==e?void 0:null===(o=e.record)||void 0===o?void 0:o.transfer.qty,maxPcs:null==e?void 0:null===(d=e.record)||void 0===d?void 0:d.transfer.pcs,workCenterId:null==e?void 0:null===(i=e.record)||void 0===i?void 0:null===(s=i.transfer)||void 0===s?void 0:s.fromWCId},categorySummary:(null==e?void 0:null===(u=e.record)||void 0===u?void 0:u.categorySummary)||[]})})};(0,t.useEffect)(()=>{eP(eb)},[]);let eO=(null==eF?void 0:null===(r=eF.values)||void 0===r?void 0:r.categorySummary)!=[]?null==eF?void 0:null===(f=eF.values)||void 0===f?void 0:null===(n=f.categorySummary)||void 0===n?void 0:n.reduce((e,r)=>e+(null==r?void 0:r.qty),0):0,eA=!!(null==eF?void 0:null===(P=eF.values)||void 0===P?void 0:null===(F=P.transfer)||void 0===F?void 0:F.recordId),eV=3===eF.values.transfer.status,eJ=2===eF.values.transfer.wip;async function eD(e){let{jobId:r,routingSeq:n,routingId:l}=e;if(r){if(n&&l){var t,a;let l=await ew({extension:y.u.JobRouting.qry,parameters:"_jobId=".concat(r,"&_workCenterId=0&_status=0")}),o=null==l?void 0:null===(t=l.list)||void 0===t?void 0:t.find(e=>e.seqNo===n);if(o){let r=null==l?void 0:null===(a=l.list)||void 0===a?void 0:a.find(e=>e.seqNo===Number(n)+1);e={...e,fromSeqNo:o.seqNo,fromWCId:o.workCenterId,workCenterId:o.workCenterId,fromSVName:o.supervisorName,jobQty:o.qty,qty:o.qty,pcs:o.pcs,toWCId:null==r?void 0:r.workCenterId,toSVName:null==r?void 0:r.supervisorName,toSeqNo:null==r?void 0:r.seqNo},eF.setValues({...eF.values,transfer:e})}else eW(e)}else eW(e);await eT(r)}else eW(e),eF.setFieldValue("categorySummary",[])}async function eT(e){let r=await ew({extension:y.u.IssueOfMaterialsItems.qry2,parameters:"_jobId=".concat(e)});eF.setFieldValue("categorySummary",r.list||[])}async function eW(e){e={...e,fromSeqNo:null,fromWCId:null,fromSVName:"",qty:0,pcs:0,toWCId:null,toSVName:""},eF.setValues({...null==eF?void 0:eF.values,transfer:e})}let eM=[{key:"Unlocked",condition:!eV,onClick:async()=>{var e,r;await ek({extension:y.u.JobTransfer.post,record:JSON.stringify({...eF.values.transfer,date:(0,Z.ku)(null==eF?void 0:null===(r=eF.values)||void 0===r?void 0:null===(e=r.transfer)||void 0===e?void 0:e.date)||null})}).then(async()=>{var e,r;await eP(null==eF?void 0:null===(r=eF.values)||void 0===r?void 0:null===(e=r.transfer)||void 0===e?void 0:e.recordId),eR(),a.ZP.success(eC.Posted),eN.close()})},disabled:!eA||!eJ},{key:"Locked",condition:eV,disabled:!0},{key:"Close",condition:!eJ,onClick:async function(){await ek({extension:y.u.JobTransfer.close,record:JSON.stringify({...eF.values.transfer,date:(0,Z.ku)(eF.values.transfer.date)})}).then(async()=>{var e,r;await eP(null==eF?void 0:null===(r=eF.values)||void 0===r?void 0:null===(e=r.transfer)||void 0===e?void 0:e.recordId),a.ZP.success(eC.Closed),eR()})},disabled:eJ||!eA},{key:"Reopen",condition:eJ,onClick:async function(){await ek({extension:y.u.JobTransfer.reopen,record:JSON.stringify({...eF.values.transfer,date:(0,Z.ku)(eF.values.transfer.date)})}).then(async()=>{var e;await eP(null==eF?void 0:null===(e=eF.values)||void 0===e?void 0:e.recordId),a.ZP.success(eC.Reopened),eR()})},disabled:!eJ||eV||!eA}];return(0,l.jsx)(g.Z,{resourceId:i.i.JTCheckOut,functionId:S.J.JTCheckOut,form:eF,maxAccess:eZ,editMode:eA,actions:eM,previewReport:eA,disabledSubmit:eJ,children:(0,l.jsxs)(u.R,{children:[(0,l.jsx)(c.g,{children:(0,l.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(x.ZP,{item:!0,xs:8,children:(0,l.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(x.ZP,{item:!0,xs:6,children:(0,l.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:C.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(S.J.JTCheckOut),name:"transfer.dtId",label:eh.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:eF.values.transfer,maxAccess:!0,onChange:async(e,r)=>{eF.setFieldValue("transfer.dtId",(null==r?void 0:r.recordId)||null),eS(r)},readOnly:eA,required:!0,error:(null===(O=eF.touched.transfer)||void 0===O?void 0:O.dtId)&&!!(null===(A=eF.errors.transfer)||void 0===A?void 0:A.dtId)})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(N.U,{endpointId:y.u.MFJobOrder.snapshot3,parameters:{_status:4},valueField:"reference",displayField:"reference",secondDisplayField:!1,name:"transfer.jobId",label:eh.jobOrder,formObject:eF.values.transfer,form:eF,required:!0,readOnly:eA,valueShow:"jobRef",maxAccess:ej,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"itemName",value:"Item Name"},{key:"description",value:"Description"}],onChange:(e,r)=>{eF.setFieldValue("transfer.jobRef",(null==r?void 0:r.reference)||""),eF.setFieldValue("transfer.jobId",(null==r?void 0:r.recordId)||null),eD({...eF.values.transfer,jobId:(null==r?void 0:r.recordId)||null,jobRef:(null==r?void 0:r.reference)||"",itemId:(null==r?void 0:r.itemId)||"",sku:(null==r?void 0:r.sku)||"",itemName:(null==r?void 0:r.itemName)||"",designRef:(null==r?void 0:r.designRef)||"",designId:(null==r?void 0:r.designId)||"",designName:(null==r?void 0:r.designName)||"",jobDescription:(null==r?void 0:r.description)||"",routingSeq:(null==r?void 0:r.routingSeqNo)||null,routingId:(null==r?void 0:r.routingId)||null,workCenterId:null==r?void 0:r.workCenterId})},errorCheck:"transfer.jobId"})})]})}),(0,l.jsx)(x.ZP,{item:!0,xs:6,children:(0,l.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(k.Z,{name:"transfer.date",required:!0,readOnly:eJ||eV,label:eh.date,value:null===(V=eF.values.transfer)||void 0===V?void 0:V.date,onChange:eF.setFieldValue,maxAccess:!0,onClear:()=>eF.setFieldValue("date",null),error:(null===(J=eF.touched.transfer)||void 0===J?void 0:J.date)&&!!(null===(D=eF.errors.transfer)||void 0===D?void 0:D.date)})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"transfer.reference",label:eh.reference,value:eF.values.transfer.reference,readOnly:eA,maxLength:"15",maxAccess:!eA&&eZ,onChange:eF.handleChange,onClear:()=>eF.setFieldValue("transfer.reference",""),error:(null===(T=eF.touched.transfer)||void 0===T?void 0:T.reference)&&!!(null===(W=eF.errors.transfer)||void 0===W?void 0:W.reference)})})]})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(q.Z,{name:"transfer.jobDescription",label:eh.jobDesc,value:eF.values.transfer.jobDescription,rows:2,readOnly:!0,maxAccess:!0,onChange:e=>eF.setFieldValue("transfer.jobDescription",e.target.value),onClear:()=>eF.setFieldValue("transfer.jobDescription",""),error:(null===(M=eF.touched.transfer)||void 0===M?void 0:M.jobDescription)&&!!(null===(Q=eF.errors.transfer)||void 0===Q?void 0:Q.jobDescription)})}),(0,l.jsx)(x.ZP,{item:!0,xs:6,children:(0,l.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"transfer.sku",label:eh.itemRef,value:eF.values.transfer.sku,readOnly:!0,maxAccess:!0})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"transfer.designRef",label:eh.designRef,value:eF.values.transfer.designRef,readOnly:!0,maxAccess:!0})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:(null==eF?void 0:null===(E=eF.values)||void 0===E?void 0:E.transfer.jobId)?(null==eF?void 0:null===(z=eF.values)||void 0===z?void 0:null===($=z.transfer)||void 0===$?void 0:$.routingId)?y.u.JobRouting.qry:y.u.JobWorkCenter.qry:null,parameters:eF.values.transfer.jobId?"_jobId=".concat(eF.values.transfer.jobId).concat(eF.values.transfer.routingId?"&_workCenterId=0&_status=0":""):"",name:"transfer.fromWCId",label:eh.workCenter,readOnly:!!(null==eF?void 0:null===(L=eF.values)||void 0===L?void 0:null===(U=L.transfer)||void 0===U?void 0:U.routingId)||!eF.values.transfer.jobId||eJ||eV,valueField:"workCenterId",displayField:["workCenterRef","workCenterName"],values:eF.values.transfer,columnsInDropDown:[{key:"workCenterRef",value:"Reference"},{key:"workCenterName",value:"Name"}],onChange:async(e,r)=>{eF.setFieldValue("transfer.qty",(null==r?void 0:r.qty)||0),eF.setFieldValue("transfer.jobQty",(null==r?void 0:r.qty)||0),eF.setFieldValue("transfer.maxQty",(null==r?void 0:r.qty)||0),eF.setFieldValue("transfer.pcs",(null==r?void 0:r.pcs)||0),eF.setFieldValue("transfer.maxPcs",(null==r?void 0:r.pcs)||0),eF.setFieldValue("transfer.fromSeqNo",(null==r?void 0:r.seqNo)||null),eF.setFieldValue("transfer.workCenterId",(null==r?void 0:r.workCenterId)||null),eF.setFieldValue("transfer.fromWCId",(null==r?void 0:r.workCenterId)||null)},required:!0,maxAccess:!0,error:(null===(B=eF.touched.transfer)||void 0===B?void 0:B.fromWCId)&&(null===(H=eF.errors.transfer)||void 0===H?void 0:H.fromWCId)})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(w.Z,{name:"transfer.qty",readOnly:eJ||eV||!!(null==eF?void 0:null===(G=eF.values)||void 0===G?void 0:null===(X=G.transfer)||void 0===X?void 0:X.routingId)||!eF.values.transfer.jobId,label:eh.qty,value:null==eF?void 0:null===(Y=eF.values)||void 0===Y?void 0:Y.transfer.qty,maxAccess:!0,decimalScale:2,onChange:eF.handleChange,onClear:()=>eF.setFieldValue("transfer.qty",null),error:(null===(K=eF.touched.transfer)||void 0===K?void 0:K.qty)&&!!(null===(ee=eF.errors.transfer)||void 0===ee?void 0:ee.qty)})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(j.Z,{endpointId:(null==eF?void 0:null===(er=eF.values)||void 0===er?void 0:er.transfer.jobId)?(null==eF?void 0:null===(el=eF.values)||void 0===el?void 0:null===(en=el.transfer)||void 0===en?void 0:en.routingId)?y.u.JobRouting.qry:(null===(et=eF.values.transfer)||void 0===et?void 0:et.workCenterId)?y.u.WorkCenter.qry3:null:null,parameters:eF.values.transfer.jobId?"_jobId=".concat(eF.values.transfer.jobId).concat(eF.values.transfer.routingId?"&_workCenterId=0&_status=0":eF.values.transfer.workCenterId?"&_fromWorkCenterId=".concat(eF.values.transfer.workCenterId):""):"",name:"transfer.toWCId",filter:(null==eF?void 0:null===(eo=eF.values)||void 0===eo?void 0:null===(ea=eo.transfer)||void 0===ea?void 0:ea.routingSeq)?e=>{var r,n;return e.seqNo===Number(null==eF?void 0:null===(n=eF.values)||void 0===n?void 0:null===(r=n.transfer)||void 0===r?void 0:r.routingSeq)+1}:void 0,label:eh.toWorkCenter,readOnly:!!(null==eF?void 0:null===(es=eF.values)||void 0===es?void 0:null===(ed=es.transfer)||void 0===ed?void 0:ed.routingId)||!eF.values.transfer.jobId||eJ||eV,valueField:eF.values.transfer.jobId&&(null===(ei=eF.values.transfer)||void 0===ei?void 0:ei.routingId)?"workCenterId":"recordId",columnsInDropDown:eF.values.transfer.jobId&&(null===(eu=eF.values.transfer)||void 0===eu?void 0:eu.routingId)?[{key:"workCenterRef",value:"Reference"},{key:"workCenterName",value:"Name"}]:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayField:eF.values.transfer.jobId&&(null===(ec=eF.values.transfer)||void 0===ec?void 0:ec.routingId)?["workCenterRef","workCenterName"]:["reference","name"],onChange:async(e,r)=>{eF.setFieldValue("transfer.toWCId",(null==r?void 0:r.recordId)||null)},values:eF.values.transfer,required:!0,maxAccess:!0,error:(null===(ev=eF.touched.transfer)||void 0===ev?void 0:ev.toWCId)&&(null===(ef=eF.errors.transfer)||void 0===ef?void 0:ef.toWCId)})})]})}),(0,l.jsx)(x.ZP,{item:!0,xs:6,children:(0,l.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"transfer.itemName",label:eh.itemName,value:eF.values.transfer.itemName,readOnly:!0,maxAccess:!0})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"transfer.designName",label:eh.designName,value:eF.values.transfer.designName,readOnly:!0,maxAccess:!0})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"transfer.fromSVName",label:eh.superVisor,value:eF.values.transfer.fromSVName,readOnly:!0,maxAccess:!0})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(w.Z,{name:"transfer.pcs",readOnly:!!(null==eF?void 0:null===(ey=eF.values)||void 0===ey?void 0:null===(em=ey.transfer)||void 0===em?void 0:em.routingId)||!eF.values.transfer.jobId||eJ||eV,label:eh.pieces,value:null==eF?void 0:null===(eI=eF.values)||void 0===eI?void 0:null===(ex=eI.transfer)||void 0===ex?void 0:ex.pcs,maxAccess:!0,onChange:eF.handleChange,onClear:()=>eF.setFieldValue("transfer.pcs",null),error:(null===(eg=eF.touched.transfer)||void 0===eg?void 0:eg.pcs)&&!!(null===(ep=eF.errors.transfer)||void 0===ep?void 0:ep.pcs)})}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"transfer.toSVName",label:eh.superVisor,value:eF.values.transfer.toSVName,readOnly:!0,maxAccess:!0})})]})})]})}),(0,l.jsx)(x.ZP,{item:!0,xs:4,children:(0,l.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(p.Z,{resourceId:i.i.MFJobOrders,seqNo:0,recordId:eF.values.transfer.jobId,customWidth:330,customHeight:240,isAbsolutePath:!0,disabled:!0})}),(0,l.jsx)(x.ZP,{item:!0,xs:12}),(0,l.jsx)(x.ZP,{item:!0,xs:12}),(0,l.jsx)(x.ZP,{item:!0,xs:12}),(0,l.jsx)(x.ZP,{item:!0,xs:12}),(0,l.jsx)(x.ZP,{item:!0,xs:12,children:(0,l.jsx)(w.Z,{name:"transfer.totalQty",value:eO,readOnly:!0,label:eh.totalQty,maxAccess:!0})})]})})]})}),(0,l.jsx)(v.Q,{children:(0,l.jsx)(o.Z,{name:"itemTable",gridData:{list:eF.values.categorySummary},maxAccess:eZ,columns:[{field:"categoryRef",headerName:eh.itemCategory,flex:1},{field:"categoryName",headerName:eh.title,flex:1},{field:"qty",headerName:eh.qty,type:{field:"number",decimal:2},flex:1},{field:"pcs",headerName:eh.pcs,type:"number",flex:1}],rowId:["itemId"],pagination:!1})})]})})}var P=n(36908),O=()=>{let{getRequest:e,postRequest:r}=(0,t.useContext)(d.$),{platformLabels:n}=(0,t.useContext)(m.l),{stack:x}=(0,f.zY)();async function I(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0,_pageSize:l=50,params:t=[]}=r;return{...await e({extension:y.u.JobTransfer.page,parameters:"_startAt=".concat(n,"&_pageSize=").concat(l,"&_params=").concat(t||"")}),_startAt:n}}let{query:{data:g},filterBy:p,refetch:h,labels:b,access:j,paginationParameters:N,invalidate:C}=(0,s.J)({queryFn:I,endpointId:y.u.JobTransfer.page,datasetId:i.i.JTCheckOut,filter:{filterFn:w}});async function w(r){let{filters:n,pagination:l={}}=r,{_startAt:t=0,_size:a=50}=l;return n.qry?{...await e({extension:y.u.JobTransfer.snapshot,parameters:"_filter=".concat(n.qry,"&_startAt=").concat(t,"&_size=").concat(a)}),_startAt:t}:I({_startAt:l._startAt||0,params:null==n?void 0:n.params})}let k=[{field:"dtName",headerName:b.docType,flex:1},{field:"reference",headerName:b.reference,flex:1},{field:"date",headerName:b.date,flex:1,type:"date"},{field:"jobRef",headerName:b.jobOrder,flex:1},{field:"designRef",headerName:b.designRef,flex:1},{field:"fromWCName",headerName:b.fromWorkCenter,flex:1},{field:"toWCName",headerName:b.toWorkCenter,flex:1},{field:"pcs",headerName:b.pieces,flex:1,type:"number"},{field:"qty",headerName:b.qty,flex:1,type:{field:"number",decimal:2}},{field:"statusName",headerName:b.status,flex:1}],{proxyAction:q}=(0,_.G)({functionId:S.J.JTCheckOut,action:Z});function Z(e){x({Component:F,props:{labels:b,recordId:null==e?void 0:e.recordId,access:j},width:1200,height:700,title:b.jobTransfer})}let R=async e=>{await r({extension:y.u.JobTransfer.del,record:JSON.stringify(e)}),C(),a.ZP.success(n.Deleted)};return(0,l.jsxs)(u.R,{children:[(0,l.jsx)(c.g,{children:(0,l.jsx)(P.Z,{onAdd:()=>{q()},maxAccess:j,filterBy:p,reportName:"MFTFR"})}),(0,l.jsx)(v.Q,{children:(0,l.jsx)(o.Z,{name:"table",columns:k,gridData:g,rowId:["recordId"],onEdit:e=>{Z(e)},onDelete:R,pageSize:50,paginationType:"api",paginationParameters:N,deleteConfirmationType:"strict",refetch:h,maxAccess:j})})]})}},1685:function(e,r,n){"use strict";n.d(r,{m:function(){return l}});let l=e=>{let r=window.sessionStorage.getItem(e);return r?JSON.parse(r):null}},98345:function(e,r,n){"use strict";n.d(r,{H:function(){return y},G:function(){return m}});var l=n(45300),t=n(2784),a=n(96026),o=n(38449);n(26612);var d=n(65947),s=n(1685);let i=async(e,r,n)=>{try{let l=await e({extension:r,parameters:n});return r.includes("qry")?l:l.record}catch(e){return null}},u=(e,r,n,l)=>{let t=(e=JSON.parse(JSON.stringify(e))).record.controls,a=t.find(e=>"reference"===e.controlId);return a?a.accessLevel=(null==r?void 0:r.mandatory)?d.$7:d.rr:(null==r?void 0:r.mandatory)?t.push({sgId:0,resourceId:"",controlId:"".concat(l?l+".":"","reference"),accessLevel:(null==r?void 0:r.mandatory)?d.$7:d.rr}):(null==r?void 0:r.readOnly)?t.push({sgId:0,resourceId:"",controlId:"".concat(l?l+".":"","reference"),accessLevel:(null==r?void 0:r.readOnly)?d.rr:d.$7}):t=e.record.controls.filter(e=>"reference"!=e.controlId),n&&t.push({sgId:0,resourceId:"",controlId:"".concat(l?l+".":"","dtId"),accessLevel:d.$7}),{...e,record:{...e.record,controls:t}}},c=async(e,r,n)=>{let l,t;switch(n){case"dtId":let a=(0,s.m)("userData"),d=null==a?void 0:a.userId;t="_userId=".concat(d,"&_functionId=").concat(r),l=o.r.UserFunction.get;break;case"glbSysNumberRange":t="_recordId=".concat(r),l=o.r.SystemFunction.get;break;case"DocumentType":t="_dgId=".concat(r,"&_startAt=",0,"&_pageSize=",50),l=o.r.DocumentType.qry;break;case"DcTypNumberRange":t="_recordId=".concat(r),l=o.r.DocumentType.get;break;case"isExternal":t="_recordId=".concat(r),l=o.r.NumberRange.get;break;default:return null}return await i(e,l,t)},v=async function(e){let r,n,l,t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,s=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=arguments.length>5?arguments[5]:void 0,v=void 0===d&&a&&await c(e,a,"dtId"),f=null==v?void 0:v.dtId,m="",y=!0;if(v&&void 0===d||"nraId"===d){if(f){let n=await c(e,f,"DcTypNumberRange");r=null==n?void 0:n.nraId,y=!((null==n?void 0:n.activeStatus)<0),r||(m="Assign the document type to a number range")}if((!f||!y)&&s&&a){var x;let r=await c(e,a,"DocumentType");t=(null==r?void 0:null===(x=r.list)||void 0===x?void 0:x.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===d||void 0===d)&&a){if((!f||f)&&!r||r&&!y){let n=await c(e,a,"glbSysNumberRange");(r=null==n?void 0:n.nraId)&&t&&(t=!1),y=!0}m=r||t?"":"Assign the system Function to a number range"}d>0&&!r&&(r=d),r&&y?(n={readOnly:null==(l=await c(e,r,"isExternal"))||!l.external,mandatory:null!=l&&!!l.external},o&&(o=await u(o,n,t,i))):!r&&o&&(o=await u(o,n,t,i));let I=i?"".concat(i,".reference"):"reference";return{dtId:f,resetReference:null==n?void 0:n.readOnly,dcTypeRequired:t,reference:{fieldName:I,isEmpty:(null==l?void 0:l.external)!==void 0&&(null==l||!l.external)},errorMessage:m,maxAccess:o,selectNraId:d}};var f=n(65950);function m(e){let{functionId:r,action:n,hasDT:l}=e,{getRequest:o}=(0,t.useContext)(f.$),{stack:d}=(0,a.V)();return{proxyAction:async()=>{let e=await v(o,r,"",void 0,l);(null==e?void 0:e.errorMessage)?d({message:null==e?void 0:e.errorMessage}):await n()}}}function y(e){var r;let{functionId:n,access:o,hasDT:d,enabled:s=!0,objectName:i=""}=e,{getRequest:u}=(0,t.useContext)(f.$),{stack:c}=(0,a.V)(),[m,y]=(0,t.useState)(),x=async e=>{let r=await v(u,n,o,e,d,i);if(!r.errorMessage)return r;c({message:null==r?void 0:r.errorMessage})},I=(0,l.a)({retry:!1,staleTime:0,enabled:s,queryKey:[n,m,!!o,s],queryFn:m||"nraId"===m?()=>x(m):()=>x()});return{documentType:I.data,maxAccess:(null==I?void 0:null===(r=I.data)||void 0===r?void 0:r.maxAccess)||o,changeDT(e){y((null==e?void 0:e.nraId)||"nraId")}}}},2801:function(e,r,n){"use strict";var l=n(52322),t=n(23925),a=n(2784),o=n(80983),d=n(65950),s=n(38449),i=n(19473),u=n(35656),c=n(10498),v=n.n(c),f=n(69627);let m=(0,a.forwardRef)((e,r)=>{let{resourceId:c,error:m,seqNo:y,recordId:x,width:I=140,height:g=140,customWidth:p,customHeight:h,disabled:b=!1,isAbsolutePath:j=!1,parentImage:N}=e,C=(0,a.useRef)(null),w=(0,a.useRef)(null),k=(0,a.useRef)({}),{getRequest:q,postRequest:_}=(0,a.useContext)(d.$),{platformLabels:Z}=(0,a.useContext)(i.l),[S,R]=(0,a.useState)(""),F=null==N?void 0:N.recordId,P=null==N?void 0:N.resourceId,{formik:O}=(0,o.c)({initialValues:{}}),{width:A}=(0,u.d)(),V=A>=1680?1:A>=1600?.9:A<=1024?.7:.7+(A-1024)/576*.22000000000000008;(0,a.useImperativeHandle)(r,()=>({submit:J}));let J=()=>{var e,n,l,t,a,o,d,i,u,v,f,m;if(b)return;let y=(null==r?void 0:null===(e=r.current)||void 0===e?void 0:e.value)||x;if(j){if((null===(o=O.values)||void 0===o?void 0:null===(a=o.file)||void 0===a?void 0:a.name)||O.values.url){let e={...O.values,fileName:(null===(u=O.values.file)||void 0===u?void 0:u.name)||O.values.url,resourceId:c,recordId:y};return _({extension:s.r.Attachment.set2,record:JSON.stringify(e),file:null===(v=O.values)||void 0===v?void 0:v.file}).then(()=>T(y))}return S||null===(d=k.current)||void 0===d||!d.fileName||(null===(i=O.values)||void 0===i?void 0:i.fileName)?void 0:_({extension:s.r.Attachment.del,record:JSON.stringify(k.current)}).then(()=>T(y))}if(null===(n=O.values)||void 0===n?void 0:n.file){let e={...O.values,recordId:y};return _({extension:s.r.Attachment.set,record:JSON.stringify(e),file:null===(f=O.values)||void 0===f?void 0:f.file}).then(()=>T(y))}if(!S&&(null===(l=k.current)||void 0===l?void 0:l.url)&&!(null===(t=O.values)||void 0===t?void 0:t.url))return _({extension:s.r.Attachment.del,record:JSON.stringify(k.current),file:null===(m=k.current)||void 0===m?void 0:m.url}).then(()=>T(y))},D=()=>{R(""),O.setValues({})},T=async e=>{let r=e||x;if(!c)return;if(j&&r){let e=await q({extension:s.r.Attachment.get2,parameters:"_resourceId=".concat(c,"&_seqNo=").concat(y,"&_recordId=").concat(r)}),n=(null==e?void 0:e.record)||{};O.setValues({...n,resourceId:c}),k.current={...n,resourceId:c},R((null==n?void 0:n.fileName)?"".concat(n.fileName,"?t=").concat(Date.now()):"");return}let n=P||c,l=F||r;if(!l)return;let t=await q({extension:s.r.Attachment.get,parameters:"_resourceId=".concat(n,"&_seqNo=").concat(y,"&_recordId=").concat(l)}),a=(null==t?void 0:t.record)||{};O.setValues({...a,resourceId:n}),k.current={...a,resourceId:n},R((null==a?void 0:a.url)?"".concat(a.url,"?t=").concat(Date.now()):"")};return(0,a.useEffect)(()=>{F||x?T():D()},[F,x]),(0,l.jsxs)(t.Z,{className:v().container,children:[(0,l.jsx)(t.Z,{className:v().previewBox,style:{width:"100%",maxWidth:(p||I)*V,height:(h||g)*V},onClick:()=>{b||C.current.click()},children:(0,l.jsx)("img",{src:S||n(68802).default.src,alt:"",className:v().previewImage,style:{border:m?"2px solid #F44336":"none"},onError:e=>{e.currentTarget.src=n(68802).default.src}})}),(0,l.jsxs)(t.Z,{className:v().bottomSection,children:[(0,l.jsx)("input",{hidden:!0,type:"file",accept:"image/png, image/jpeg, image/jpg",ref:C,onChange:e=>{var r,n;let l=null==e?void 0:null===(n=e.target)||void 0===n?void 0:null===(r=n.files)||void 0===r?void 0:r[0];if(!l)return;if(Math.round(l.size/1024)>500){alert(Z.MaxFileSize);return}let t=new Date(l.lastModifiedDate),a="".concat(t.getDate(),"/").concat(t.getMonth()+1,"/").concat(t.getFullYear());O.setValues({resourceId:c,recordId:x,seqNo:0,fileName:l.name,folderId:null,folderName:null,date:a,url:null,file:l});let o=new FileReader;w.current=o,o.onloadend=e=>R(e.target.result),o.readAsDataURL(l)},disabled:b}),(0,l.jsx)(f.Z,{onClick:D,image:"clear.png",tooltipText:Z.Clear,color:"#F44336",border:"none",disabled:b})]})]})});r.Z=m},10498:function(e){e.exports={container:"ImageUpload_container__I2BWx",previewBox:"ImageUpload_previewBox__JogCN",previewImage:"ImageUpload_previewImage___eqQX",bottomSection:"ImageUpload_bottomSection__jpph8"}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=636)}),_N_E=e.O()}]);