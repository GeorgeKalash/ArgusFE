(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30764],{89977:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/security-groups",function(){return a(82734)}])},82734:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return Q}});var l=a(52322),t=a(2784),r=a(62202),n=a(69387),i=a(27723),o=a(65950),d=a(95982),c=a(29326),u=a(60218),m=a(5088),h=a(21581),x=a(80983),p=a(48601),v=a(71987),f=a(82737),I=a(26612),y=a(31389),b=a(62362),g=a(19473),C=e=>{let{labels:s,maxAccess:a,storeRecordId:n,setRecordId:i}=e,{getRequest:c,postRequest:C}=(0,t.useContext)(o.$),{platformLabels:_}=(0,t.useContext)(g.l),{formik:j}=(0,x.c)({initialValues:{recordId:n||null,name:"",description:""},validateOnChange:!0,validationSchema:p.Ry({name:p.Z_().required()}),onSubmit:async e=>{let s=await C({extension:d.y.SecurityGroup.set,record:JSON.stringify(e)});e.recordId?r.ZP.success(_.Updated):(r.ZP.success(_.Added),j.setValues({...e,recordId:s.recordId}),i(null==s?void 0:s.recordId)),Z()}}),Z=(0,v.E)({endpointId:d.y.SecurityGroup.qry});return(0,t.useEffect)(()=>{!async function(){if(n){let e=await c({extension:d.y.SecurityGroup.get,parameters:"_recordId=".concat(n)});j.setValues(e.record)}}()},[n]),(0,l.jsx)(f.Z,{resourceId:I.i.SecurityGroup,form:j,height:300,maxAccess:a,editMode:!!n,children:(0,l.jsx)(y.R,{children:(0,l.jsx)(b.Q,{children:(0,l.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(u.ZP,{item:!0,xs:12,children:(0,l.jsx)(m.Z,{name:"name",label:s.name,value:j.values.name,required:!0,maxLength:"30",maxAccess:a,onChange:j.handleChange,onClear:()=>j.setFieldValue("name",""),error:j.touched.name&&!!j.errors.name})}),(0,l.jsx)(u.ZP,{item:!0,xs:12,children:(0,l.jsx)(h.Z,{name:"description",label:s.description,value:j.values.description,rows:3,maxLength:"150",maxAccess:a,onChange:j.handleChange,onClear:()=>j.setFieldValue("description",""),error:j.touched.description&&!!j.errors.description})})]})})})})},_=a(76399),j=a(38449),Z=a(67920),S=e=>{let{labels:s,maxAccess:a,storeRecordId:n}=e,{getRequest:i,postRequest:c}=(0,t.useContext)(o.$),{platformLabels:u}=(0,t.useContext)(g.l),{schema:m,requiredFields:h}=(0,Z.m)({userId:e=>null==e?void 0:e.userId},!0,a,"groups"),{formik:v}=(0,x.c)({validateOnChange:!0,validationSchema:p.Ry({groups:p.IX().of(m)}),conditionSchema:["groups"],initialValues:{groups:[{id:1,sgId:"",sgName:"",email:"",userId:""}]},onSubmit:async e=>{await S(e)}}),C=[{component:"resourcecombobox",name:"userId",label:s.name,props:{endpointId:j.r.Users.qry,parameters:"_startAt=0&_size=1000&_sortBy=fullName&_filter=",valueField:"recordId",displayField:"fullName",displayFieldWidth:1.5,columnsInDropDown:[{key:"fullName",value:"Name"},{key:"email",value:"Email"}],mapping:[{from:"email",to:"email"},{from:"recordId",to:"userId"},{from:"fullName",to:"fullName"}]}},{component:"textfield",label:s.email,name:"email",props:{readOnly:!0}}],S=async e=>{var s,a;let l=(null==e?void 0:null===(s=e.groups)||void 0===s?void 0:s.length)?null===(a=e.groups)||void 0===a?void 0:a.filter(e=>{var s;return null===(s=Object.values(h))||void 0===s?void 0:s.every(s=>s(e))}).map(e=>({sgId:n,userId:e.userId})):[];await c({extension:d.y.SecurityGroupUser.set2,record:JSON.stringify({userId:0,sgId:n,groups:l})}).then(()=>{r.ZP.success(u.Updated)})};return(0,t.useEffect)(()=>{n&&i({extension:d.y.SecurityGroupUser.qry,parameters:"_userId=0&_filter=&_sgId=".concat(n)}).then(e=>{var s;if((null==e?void 0:null===(s=e.list)||void 0===s?void 0:s.length)>0){let s=e.list.map((e,s)=>({...e,id:s+1}));v.setValues({groups:s})}})},[]),(0,l.jsx)(f.Z,{form:v,resourceId:I.i.Users,maxAccess:a,isInfo:!1,editMode:!!n,isParentWindow:!1,children:(0,l.jsx)(y.R,{children:(0,l.jsx)(b.Q,{children:(0,l.jsx)(_._,{onChange:e=>v.setFieldValue("groups",e),value:v.values.groups,error:v.errors.groups,columns:C})})})})},w=a(9522),A=a(23925),N=a(44258),R=a(9737),P=a(61802),T=a(8661),F=a(84100),G=a(33625),q=a(80968),k=a(12436),E=a(43337),D=a(48258),L=a(69627),V=e=>{let{labels:s,maxAccess:a,storeRecordId:r}=e,{getRequest:i}=(0,t.useContext)(o.$),{stack:c}=(0,P.zY)(),{getAllKvsByDataset:h}=(0,t.useContext)(q.k),{formik:p}=(0,x.c)({maxAccess:a,validateOnChange:!0,initialValues:{sgId:r,search:""}});async function f(e){var s;let{filters:a}=e;a.moduleId||(a.moduleId=10);let l=await g();return{list:(await i({extension:d.y.ModuleClass.qry,parameters:"_sgId=".concat(r,"&_filter=&_moduleId=").concat(null!==(s=null==a?void 0:a.moduleId)&&void 0!==s?s:10,"&_resourceId=0")})).list.map(e=>{let s=l.find(s=>e.accessLevel==s.key);return{...e,accessLevelString:s?s.value:null}})}}async function g(){return new Promise((e,s)=>{h({_dataset:F.v.ACCESS_LEVEL,callback:a=>{a?e(a):s()}})})}let{query:{data:C},refetch:_,filterBy:j,filters:Z,invalidate:S}=(0,v.J)({queryFn:f,endpointId:d.y.ModuleClass.qry,datasetId:I.i.SecurityGroup,enabled:!!r,filter:{filterFn:f,default:{moduleId:10}}}),w=e=>{j("moduleId",e)},V=p.values.search,O=(0,t.useMemo)(()=>{let e=(null==C?void 0:C.list)||[];return V?{...C,list:e.filter(e=>{var s;return e.resourceId&&(null===(s=e.resourceId.toString())||void 0===s?void 0:s.includes(V))||e.resourceName&&e.resourceName.toLowerCase().includes(V.toLowerCase())})}:C},[null==C?void 0:C.list,V]);return(0,t.useEffect)(()=>{Z.moduleId=10},[]),(0,l.jsxs)(y.R,{children:[(0,l.jsx)(G.g,{children:(0,l.jsx)(A.Z,{sx:{px:2,py:1},children:(0,l.jsxs)(u.ZP,{container:!0,alignItems:"center",spacing:2,children:[(0,l.jsx)(u.ZP,{item:!0,xs:5,children:(0,l.jsx)(T.Z,{datasetId:F.v.MODULE,name:"moduleId",values:{moduleId:Z.moduleId},valueField:"key",displayField:"value",onChange:(e,s)=>{w(null==s?void 0:s.key)}})}),(0,l.jsx)(u.ZP,{item:!0,xs:1,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.jsx)(L.Z,{onClick:function(){c({Component:D.Z,props:{labels:s,maxAccess:a,data:C,moduleId:Z.moduleId,invalidate:S,resourceId:I.i.SecurityGroup}})},icon:(0,l.jsx)(R.Z,{icon:"mdi:arrow-expand-right",width:18,height:18}),tooltipText:s.controlAccess})}),(0,l.jsx)(u.ZP,{item:!0,xs:5,children:(0,l.jsx)(m.Z,{name:"search",value:p.values.search,label:s.search,onClear:()=>p.setFieldValue("search",""),onChange:e=>{let{value:s}=e.target;p.setFieldValue("search",s)},fullWidth:!0})})]})})}),(0,l.jsx)(b.Q,{children:(0,l.jsx)(n.Z,{name:"accessLevel",columns:[{field:"resourceId",headerName:s.classId,flex:1},{field:"resourceName",headerName:s.className,flex:2},{field:"resourceGlobal",headerName:s.resourceGlobal,flex:1,cellRenderer:e=>(0,l.jsx)(A.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,l.jsx)(N.Z,{size:"small",onClick:()=>{c({Component:k.Z,props:{labels:s,maxAccess:a,row:e.data,resourceId:I.i.SecurityGroup}})},children:(0,l.jsx)(R.Z,{icon:"mdi:application-edit-outline",width:18,height:18})})})},{field:"Control Access",headerName:s.controlAccess,flex:1,cellRenderer:e=>(0,l.jsx)(A.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,l.jsx)(N.Z,{size:"small",onClick:()=>{c({Component:E.Z,props:{labels:s,maxAccess:a,row:e.data,invalidate:S,resourceId:I.i.SecurityGroup},title:s.controlAccessLevel})},children:(0,l.jsx)(R.Z,{icon:"mdi:application-edit-outline",width:18,height:18})})})}],gridData:O,rowId:["sgId","moduleId","resourceId"],isLoading:!1,maxAccess:a,refetch:_,pagination:!1})})]})},O=a(68676),z=a(54074);function M(e){let{labels:s,maxAccess:a,recordId:n,window:i}=e,{postRequest:c}=(0,t.useContext)(o.$),m=(0,v.E)({endpointId:d.y.SGReleaseCode.qry}),{formik:h}=(0,x.c)({initialValues:{sgId:n,codeId:null},maxAccess:a,validateOnChange:!0,validationSchema:p.Ry({codeId:p.Z_().required()}),onSubmit:async e=>{await c({extension:d.y.SGReleaseCode.set,record:JSON.stringify(e)}),r.ZP.success("Record Added Successfully"),m(),i.close()}});return(0,l.jsx)(z.Z,{onSave:h.handleSubmit,maxAccess:a,editMode:!!n,children:(0,l.jsx)(y.R,{children:(0,l.jsx)(b.Q,{children:(0,l.jsx)(u.ZP,{item:!0,xs:12,children:(0,l.jsx)(T.Z,{endpointId:O.y.ReleaseCode.qry,parameters:"_startAt=0&_pageSize=1000",name:"codeId",label:s.code,valueField:"recordId",displayField:"name",values:h.values,onChange:(e,s)=>{h.setFieldValue("codeId",s?s.recordId:null)},error:h.touched.codeId&&!!h.errors.codeId,maxAccess:a})})})})})}var U=e=>{let{labels:s,maxAccess:a,recordId:c}=e,{getRequest:u,postRequest:m}=(0,t.useContext)(o.$),{stack:h}=(0,P.zY)(),{platformLabels:x}=(0,t.useContext)(g.l),p=[{field:"releaseCode",headerName:s.code,flex:1}],{query:{data:f},invalidate:C}=(0,v.J)({queryFn:_,enabled:!!c,endpointId:d.y.SGReleaseCode.qry,datasetId:I.i.SecurityGroup});async function _(){return c?await u({extension:d.y.SGReleaseCode.qry,parameters:"_filter=&_sgId=".concat(c)}):{list:[]}}let j=async e=>{await m({extension:d.y.SGReleaseCode.del,record:JSON.stringify(e)}),r.ZP.success(x.Deleted),C()};return(0,l.jsx)(y.R,{children:(0,l.jsxs)(b.Q,{children:[(0,l.jsx)(i.Z,{onAdd:()=>{h({Component:M,props:{labels:s,recordId:c,maxAccess:a},width:500,height:400,title:s.releaseCode})},maxAccess:a}),(0,l.jsx)(n.Z,{name:"release",columns:p,gridData:f,rowId:["codeId"],onDelete:j,isLoading:!1,maxAccess:a,pagination:!1})]})})};function W(e){let{labels:s,maxAccess:a,recordId:i}=e,{getRequest:c,postRequest:h}=(0,t.useContext)(o.$),{platformLabels:p}=(0,t.useContext)(g.l),[v,f]=(0,t.useState)({list:[]}),C=[{field:"rowName",headerName:s.record,flex:2},{field:"rowRef",headerName:s.reference,flex:2}],{formik:_}=(0,x.c)({maxAccess:a,validateOnChange:!0,initialValues:{search:"",classId:I.i.DocumentTypes},onSubmit:async()=>{let e=v.list.filter(e=>e.checked).map(e=>({recordId:e.recordId,sgId:i,resourceId:parseInt(_.values.classId)})),s={sgId:i,resourceId:parseInt(_.values.classId),items:e};await h({extension:d.y.DataAccessItem.set2,record:JSON.stringify(s)}),r.ZP.success(p.Updated)}});async function j(e){let s=null!=e?e:I.i.DocumentTypes,a=await c({extension:d.y.DataAccessItem.qry,parameters:"_sgId=".concat(i,"&_filter=&_resourceId=").concat(s)});a.list=a.list.map(e=>(e.hasAccess&&(e.checked=!0),e)),f(a)}let Z=(0,t.useMemo)(()=>{var e;return{...v,list:null==v?void 0:null===(e=v.list)||void 0===e?void 0:e.filter(e=>e.rowRef&&e.rowRef.toString().includes(_.values.search)||e.rowName&&e.rowName.toLowerCase().includes(_.values.search.toLowerCase()))}},[_.values.search,v]);return(0,t.useEffect)(()=>{!async function(){i&&await j()}()},[i]),(0,l.jsx)(z.Z,{onSave:_.handleSubmit,maxAccess:a,editMode:!!i,children:(0,l.jsxs)(y.R,{children:[(0,l.jsx)(G.g,{children:(0,l.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(u.ZP,{item:!0,xs:6,children:(0,l.jsx)(T.Z,{label:s.module,valueField:"key",displayField:"value",name:"classId",datasetId:F.v.AU_RESOURCE_ROW_ACCESS,values:_.values,maxAccess:a,onChange:async(e,s)=>{var a;_.setFieldValue("classId",null!==(a=null==s?void 0:s.key)&&void 0!==a?a:I.i.DocumentTypes),await j(null==s?void 0:s.key)},error:_.touched.classId&&!!_.errors.classId})}),(0,l.jsx)(u.ZP,{xs:6,item:!0,children:(0,l.jsx)(m.Z,{name:"search",value:_.values.search,label:s.search,onClear:()=>{_.setFieldValue("search","")},onChange:e=>{let{value:s}=e.target;_.setFieldValue("search",s)}})})]})}),(0,l.jsx)(b.Q,{children:(0,l.jsx)(n.Z,{name:"rowAccess",columns:C,gridData:Z,rowId:["recordId"],isLoading:!1,maxAccess:a,pagination:!1,showCheckboxColumn:!0})})]})})}var J=e=>{let{labels:s,maxAccess:a,recordId:r,height:n}=e,[i,o]=(0,t.useState)(0),[d,u]=(0,t.useState)(r),m=[{label:null==s?void 0:s.groupInfo},{label:null==s?void 0:s.users,disabled:!d},{label:null==s?void 0:s.accessLevel,disabled:!d},{label:null==s?void 0:s.rowAccess,disabled:!d},{label:null==s?void 0:s.releaseCode,disabled:!d}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(w.Y,{tabs:m,activeTab:i,setActiveTab:o,maxAccess:a}),(0,l.jsx)(c.Z,{height:n,index:0,value:i,maxAccess:a,children:(0,l.jsx)(C,{labels:s,maxAccess:a,storeRecordId:d,setRecordId:u})}),(0,l.jsx)(c.Z,{index:1,value:i,maxAccess:a,children:(0,l.jsx)(S,{maxAccess:a,labels:s,storeRecordId:d})}),(0,l.jsx)(c.Z,{index:2,value:i,maxAccess:a,children:(0,l.jsx)(V,{maxAccess:a,labels:s,storeRecordId:d})}),(0,l.jsx)(c.Z,{index:3,value:i,maxAccess:a,children:(0,l.jsx)(W,{maxAccess:a,labels:s,recordId:d})}),(0,l.jsx)(c.Z,{index:4,value:i,maxAccess:a,children:(0,l.jsx)(U,{maxAccess:a,labels:s,recordId:d})})]})},Q=()=>{let{getRequest:e,postRequest:s}=(0,t.useContext)(o.$),{stack:a}=(0,P.zY)(),{platformLabels:c}=(0,t.useContext)(g.l);async function u(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:l=50}=s;return{...await e({extension:d.y.SecurityGroup.qry,parameters:"_startAt=".concat(a,"&_pageSize=").concat(l,"&filter=")}),_startAt:a}}let{query:{data:m},labels:h,refetch:x,search:p,clear:f,paginationParameters:C,access:_,invalidate:j}=(0,v.J)({queryFn:u,endpointId:d.y.SecurityGroup.qry,datasetId:I.i.SecurityGroup,search:{endpointId:d.y.SecurityGroup.snapshotGRP,searchFn:Z}});async function Z(s){let{qry:a}=s;return await e({extension:d.y.SecurityGroup.snapshotGRP,parameters:"_filter=".concat(a)})}function S(e){a({Component:J,props:{labels:h,recordId:e,maxAccess:_},width:900,height:700,title:h.securityGroups})}let w=[{field:"name",headerName:h.name,flex:1},{field:"description",headerName:h.description,flex:1}],A=async e=>{await s({extension:d.y.SecurityGroup.del,record:JSON.stringify(e)}),j(),r.ZP.success(c.Deleted)};return(0,l.jsxs)(y.R,{children:[(0,l.jsx)(G.g,{children:(0,l.jsx)(i.Z,{onAdd:()=>{S()},maxAccess:_,onSearch:p,onSearchClear:f,inputSearch:!0})}),(0,l.jsx)(b.Q,{children:(0,l.jsx)(n.Z,{columns:w,gridData:m,rowId:["recordId"],onEdit:e=>{S(e.recordId)},onDelete:A,isLoading:!1,pageSize:50,maxAccess:_,paginationParameters:C,paginationType:"api",refetch:x})})]})}},67920:function(e,s,a){"use strict";a.d(s,{m:function(){return t}});var l=a(48601);function t(e,s,a){var t;let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",n={...e};return null==a||null===(t=a.record)||void 0===t||t.controls.forEach(e=>{let{controlId:s,accessLevel:a}=e,[l,t]=null==s?void 0:s.split(".");l!==r||2!==a||t in n||(n[t]=e=>(null==e?void 0:e[t])!=null),(1===a||4===a)&&t in n&&delete n[t]}),{schema:l.Ry().shape({...Object.keys(n).reduce((e,a)=>(e[a]=l.nK().nullable().test(function(e){var l;let t=this.parent,[,r]=this.path.match(/^(\w+)\[(\d+)\]/)||[],i=(null===(l=this.options.context)||void 0===l?void 0:l[r])||[];if(s||!s&&i.length>1){if(null!==t[a]&&void 0!==t[a]&&0!==t[a]&&""!==n[a]&&!n[a](t))return!1;if(!Object.entries(n).some(e=>{let[,s]=e;return!!s(t)}))return!0}return!!n[a](t)&&void 0!==e}),e),{})}),requiredFields:n}}},29326:function(e,s,a){"use strict";var l=a(52322);a(2784);var t=a(23925),r=a(13980),n=a.n(r),i=a(95291),o=a.n(i),d=a(65947);let c=e=>{var s,a,r;let{children:n,value:i,index:c,maxAccess:u,...m}=e,h="".concat(e.name||"tab",".").concat(c),{accessLevel:x}=null!==(r=(null!==(a=null==u?void 0:null===(s=u.record)||void 0===s?void 0:s.controls)&&void 0!==a?a:[]).find(e=>e.controlId===h))&&void 0!==r?r:{accessLevel:0};if(x===d.A1)return null;let p=i===c;return(0,l.jsx)(t.Z,{role:"tabpanel",hidden:!p,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c),className:"".concat(o().tabPanel," ").concat(p?o().active:o().hidden),...m,children:n})};c.propTypes={children:n().node,index:n().number.isRequired,value:n().number.isRequired},s.Z=c},9522:function(e,s,a){"use strict";a.d(s,{Y:function(){return m}});var l=a(52322),t=a(23925),r=a(54582),n=a(68696),i=a(44258),o=a(2784),d=a(99266),c=a(52614),u=a.n(c);let m=e=>{var s,a,c,m,h;let{tabs:x,activeTab:p,setActiveTab:v,maxAccess:f,name:I="tab"}=e,y=(null==f?void 0:null===(a=f.record)||void 0===a?void 0:null===(s=a.controls)||void 0===s?void 0:s.filter(e=>{var s;return 4===e.accessLevel&&(null===(s=e.controlId)||void 0===s?void 0:s.startsWith("".concat(I,".")))}).map(e=>e.controlId.split(".")[1]))||[],b=null==x?void 0:null===(c=x.map((e,s)=>({...e,id:s})))||void 0===c?void 0:c.filter((e,s)=>!y.includes(String(s))),g=null===(m=b[p])||void 0===m?void 0:m.id,C=null===(h=b[p])||void 0===h?void 0:h.disabled;return(0,o.useEffect)(()=>{g>=0&&!C&&p!=g&&v(g)},[]),(0,l.jsx)(t.Z,{className:u().tabsContainer,children:(0,l.jsx)(t.Z,{className:u().tabsWrapper,children:(0,l.jsx)(r.Z,{value:p,onChange:(e,s)=>v(s),variant:"scrollable",scrollButtons:b.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==b?void 0:b.map(e=>(0,l.jsx)(n.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,l.jsxs)(t.Z,{display:"flex",alignItems:"center",children:[(0,l.jsx)("span",{children:e.label}),e.id===p&&(null==e?void 0:e.onRefetch)&&(0,l.jsx)(i.Z,{size:"small",className:u().refreshButton,onClick:s=>{s.stopPropagation(),e.onRefetch()},children:(0,l.jsx)(d.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[83435,49774,92888,40179],function(){return e(e.s=89977)}),_N_E=e.O()}]);