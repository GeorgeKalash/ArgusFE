(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[35244],{80545:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fi-tax-codes",function(){return t(96553)}])},96553:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return V}});var n=t(52322),s=t(2784),o=t(62202),r=t(69387),i=t(27723),l=t(65950),d=t(71987),c=t(26612),u=t(31389),m=t(33625),x=t(62362),b=t(61802),h=t(25870),f=t(29326),v=t(9522),_=t(60218),C=t(48601),p=t(82737),T=t(5088),y=t(80983),I=t(74898),j=t(19689),g=t(19473);function Z(e){var a;let{labels:t,maxAccess:r,setStore:i,store:m,editMode:b}=e,{recordId:f}=m,{getRequest:v,postRequest:Z}=(0,s.useContext)(l.$),{platformLabels:A}=(0,s.useContext)(g.l),w=(0,d.E)({endpointId:h.H.TaxCodes.qry}),{formik:P}=(0,y.c)({initialValues:{recordId:null,name:"",reference:"",nonDeductible:!1},maxAccess:r,validateOnChange:!0,validationSchema:C.Ry({name:C.Z_().required(),reference:C.Z_().required()}),onSubmit:async e=>{let a=await Z({extension:h.H.TaxCodes.set,record:JSON.stringify(e)});f||(i(e=>({...e,recordId:a.recordId})),P.setFieldValue("recordId",a.recordId)),o.ZP.success(e.recordId?A.Edited:A.Added),w()}});(0,s.useEffect)(()=>{!async function(){if(f){let e=await v({extension:h.H.TaxCodes.get,parameters:"_recordId=".concat(f)});P.setValues(e.record)}}()},[]);let N=[{key:"Integration Account",condition:!0,onClick:"onClickGIA",masterSource:I.N.TaxCode,disabled:!b}];return(0,n.jsx)(p.Z,{resourceId:c.i.TaxCodes,form:P,maxAccess:r,editMode:b,actions:N,children:(0,n.jsx)(u.R,{children:(0,n.jsx)(x.Q,{children:(0,n.jsxs)(_.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(T.Z,{name:"reference",label:t.reference,value:P.values.reference,required:!0,maxAccess:r,onChange:P.handleChange,onClear:()=>P.setFieldValue("reference",""),error:P.touched.reference&&!!P.errors.reference})}),(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(T.Z,{name:"name",label:t.name,value:P.values.name,required:!0,maxAccess:r,maxLength:"30",onChange:P.handleChange,onClear:()=>P.setFieldValue("name",""),error:P.touched.name&&!!P.errors.name})}),(0,n.jsx)(_.ZP,{item:!0,sx:{pb:"10px"},xs:12,children:(0,n.jsx)(j.Z,{name:"nonDeductible",value:null===(a=P.values)||void 0===a?void 0:a.nonDeductible,onChange:e=>P.setFieldValue("nonDeductible",e.target.checked),label:t.nonDeductible,maxAccess:r})})]})})})})}var A=t(76399),w=t(39812),P=e=>{let{store:a,setStore:t,maxAccess:r,labels:i,editMode:d}=e,{recordId:m}=a,{getRequest:b,postRequest:f}=(0,s.useContext)(l.$),{platformLabels:v}=(0,s.useContext)(g.l),{formik:_}=(0,y.c)({validateOnChange:!0,maxAccess:r,validationSchema:C.Ry({TaxHistoryView:C.IX().of(C.Ry().shape({amount:C.Z_().required(),date:C.Z_().required()})).required(" ")}),initialValues:{TaxHistoryView:[{id:1,taxCodeId:m||null,date:"",amount:"",seqNo:""}]},onSubmit:async e=>{await T(e)}}),T=async e=>{let a=null==e?void 0:e.TaxHistoryView.map((e,a)=>({...e,date:(0,w.ku)(e.date),taxCodeId:m,seqNo:a+1}));await f({extension:h.H.TaxHistoryPack.set2,record:JSON.stringify({taxCodeId:m,items:a})}),o.ZP.success(v.Edited),t(e=>({...e,TaxHistoryView:a}))};return(0,s.useEffect)(()=>{m&&b({extension:h.H.TaxHistoryPack.qry,parameters:"_taxCodeId=".concat(m)}).then(e=>{var a;if((null==e?void 0:null===(a=e.list)||void 0===a?void 0:a.length)>0){let a=e.list.map((e,a)=>({...e,id:a+1,date:(0,w.a1)(e.date),amount:e.amount}));_.setValues({TaxHistoryView:a}),t(e=>({...e,TaxHistoryView:a}))}})},[]),(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(p.Z,{form:_,resourceId:c.i.TaxCodes,maxAccess:r,isInfo:!1,editMode:d,children:(0,n.jsx)(u.R,{children:(0,n.jsx)(x.Q,{children:(0,n.jsx)(A._,{onChange:e=>_.setFieldValue("TaxHistoryView",e),value:_.values.TaxHistoryView,error:_.errors.TaxHistoryView,columns:[{component:"date",label:i.date,name:"date"},{component:"numberfield",label:i.amount,name:"amount",decimalScale:2}]})})})})})},N=e=>{let{recordId:a,labels:t,maxAccess:o}=e,[r,i]=(0,s.useState)(0),[l,d]=(0,s.useState)({recordId:a||null,TaxHistoryViewList:[]}),c=!!l.recordId,u=[{label:t.taxCodes},{label:t.history,disabled:!l.recordId}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Y,{tabs:u,activeTab:r,setActiveTab:i,maxAccess:o}),(0,n.jsx)(f.Z,{index:0,value:r,maxAccess:o,children:(0,n.jsx)(Z,{labels:t,setStore:d,store:l,editMode:c,maxAccess:o})}),(0,n.jsx)(f.Z,{index:1,value:r,maxAccess:o,children:(0,n.jsx)(P,{labels:t,setStore:d,maxAccess:o,store:l,editMode:c})})]})},V=()=>{let{getRequest:e,postRequest:a}=(0,s.useContext)(l.$),{stack:t}=(0,b.zY)();async function f(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:n=50}=a;return{...await e({extension:h.H.TaxCodes.qry,parameters:"_startAt=".concat(t,"&_pageSize=").concat(n,"&filter=")}),_startAt:t}}let{query:{data:v},labels:_,paginationParameters:C,invalidate:p,refetch:T,access:y}=(0,d.J)({queryFn:f,endpointId:h.H.TaxCodes.qry,datasetId:c.i.TaxCodes}),I=[{field:"reference",headerName:_.reference,flex:1},{field:"name",headerName:_.name,flex:1}],j=async e=>{await a({extension:h.H.TaxCodes.del,record:JSON.stringify(e)}),p(),o.ZP.success("Record Deleted Successfully")};function g(e){t({Component:N,props:{labels:_,recordId:e,maxAccess:y},width:800,height:460,title:_.taxCodes})}return(0,n.jsxs)(u.R,{children:[(0,n.jsx)(m.g,{children:(0,n.jsx)(i.Z,{onAdd:()=>{g()},maxAccess:y})}),(0,n.jsx)(x.Q,{children:(0,n.jsx)(r.Z,{columns:I,gridData:v,rowId:["recordId"],onEdit:e=>{g(null==e?void 0:e.recordId)},onDelete:j,isLoading:!1,pageSize:50,refetch:T,paginationParameters:C,paginationType:"api",maxAccess:y})})]})}},74898:function(e,a,t){"use strict";t.d(a,{N:function(){return n}});let n={Global:0,AccountGroup:10,Account:11,CashAccountGroup:20,CashAccount:21,ItemGroup:30,Item:31,ItemCategory:32,Site:33,ExpenseType:41,CostType:42,ProductionOverhead:51,TaxCode:12,PayrollGLGroup:61,PayrollEntitlementDeduction:62,AssetGroup:71,AssetClass:72}},29326:function(e,a,t){"use strict";var n=t(52322);t(2784);var s=t(23925),o=t(13980),r=t.n(o),i=t(95291),l=t.n(i),d=t(65947);let c=e=>{var a,t,o;let{children:r,value:i,index:c,maxAccess:u,...m}=e,x="".concat(e.name||"tab",".").concat(c),{accessLevel:b}=null!==(o=(null!==(t=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==t?t:[]).find(e=>e.controlId===x))&&void 0!==o?o:{accessLevel:0};if(b===d.A1)return null;let h=i===c;return(0,n.jsx)(s.Z,{role:"tabpanel",hidden:!h,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c),className:"".concat(l().tabPanel," ").concat(h?l().active:l().hidden),...m,children:r})};c.propTypes={children:r().node,index:r().number.isRequired,value:r().number.isRequired},a.Z=c},9522:function(e,a,t){"use strict";t.d(a,{Y:function(){return m}});var n=t(52322),s=t(23925),o=t(54582),r=t(68696),i=t(44258),l=t(2784),d=t(99266),c=t(52614),u=t.n(c);let m=e=>{var a,t,c,m,x;let{tabs:b,activeTab:h,setActiveTab:f,maxAccess:v,name:_="tab"}=e,C=(null==v?void 0:null===(t=v.record)||void 0===t?void 0:null===(a=t.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(_,".")))}).map(e=>e.controlId.split(".")[1]))||[],p=null==b?void 0:null===(c=b.map((e,a)=>({...e,id:a})))||void 0===c?void 0:c.filter((e,a)=>!C.includes(String(a))),T=null===(m=p[h])||void 0===m?void 0:m.id,y=null===(x=p[h])||void 0===x?void 0:x.disabled;return(0,l.useEffect)(()=>{T>=0&&!y&&h!=T&&f(T)},[]),(0,n.jsx)(s.Z,{className:u().tabsContainer,children:(0,n.jsx)(s.Z,{className:u().tabsWrapper,children:(0,n.jsx)(o.Z,{value:h,onChange:(e,a)=>f(a),variant:"scrollable",scrollButtons:p.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==p?void 0:p.map(e=>(0,n.jsx)(r.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,n.jsxs)(s.Z,{display:"flex",alignItems:"center",children:[(0,n.jsx)("span",{children:e.label}),e.id===h&&(null==e?void 0:e.onRefetch)&&(0,n.jsx)(i.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,n.jsx)(d.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=80545)}),_N_E=e.O()}]);