(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[515],{32421:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mf-item-disposal",function(){return r(10644)}])},10644:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return B}});var s=r(52322),a=r(90587),n=r(26612),l=r(7121),o=r(71987),d=r(19473),i=r(65950),u=r(2784),c=r(62202),p=r(60218),g=r(48601),v=r(96026),y=r(80983),m=r(65215),h=r(5088),I=r(54074),S=r(31389),q=r(62362);function f(e){var t,r;let{maxAccess:a,labels:n,form:l,window:o}=e,{getRequest:d}=(0,u.useContext)(i.$),{stack:c}=(0,v.V)(),{formik:f}=(0,y.c)({initialValues:{materialsTfr:"",wcSiteId:parseInt(null==l?void 0:null===(r=l.values)||void 0===r?void 0:null===(t=r.header)||void 0===t?void 0:t.wcSiteId)||null},maxAccess:a,validationSchema:g.Ry({materialsTfr:g.Z_().required()}),onSubmit:async e=>{if(!e.materialsTfr)return;let t=await D(null==e?void 0:e.materialsTfr);t.some(e=>null==e?void 0:e.itemId)?(l.setFieldValue("items",t),o.close()):f.setFieldValue("materialsTfr","")}});async function C(e){var t;if(!e)return;let r=await d({extension:m.$.MaterialTransferSerial.qry,parameters:"_transferId=".concat(e,"&_seqNo=",0,"&_componentSeqNo=",0)});return(null==r?void 0:null===(t=r.list)||void 0===t?void 0:t.length)?r.list.map((e,t)=>({...e,id:t+1})):[]}async function D(e){var t,r,s,a,o,i,u,p;if(!e)return;let{record:g}=await d({extension:m.$.MaterialsTransfer.get2,parameters:"_reference=".concat(e)});if(!g||!(null==g?void 0:g.header))return;for(let e of[{condition:(null==g?void 0:null===(t=g.header)||void 0===t?void 0:t.status)!=3,message:n.postedError},{condition:!(null==g?void 0:null===(r=g.header)||void 0===r?void 0:r.toSiteId),message:n.mandatorySite},{condition:!(null==f?void 0:null===(s=f.values)||void 0===s?void 0:s.wcSiteId)||(null==g?void 0:null===(a=g.header)||void 0===a?void 0:a.toSiteId)!=(null==f?void 0:null===(o=f.values)||void 0===o?void 0:o.wcSiteId),message:n.siteMismatch}])if(e.condition)return c({message:e.message}),(null==l?void 0:null===(p=l.values)||void 0===p?void 0:p.items)||[];let v=(null==g?void 0:g.items)||[],y=(await C(null==g?void 0:null===(i=g.header)||void 0===i?void 0:i.recordId)).reduce((e,t)=>{let r=t.seqNo;return e[r]||(e[r]=[]),e[r].push(t),e},{});return(null==v?void 0:v.length)?null==v?void 0:v.map((e,t)=>{let r=y[e.seqNo]||[];return{...e,id:t+1,serials:r,serialCount:r.length}}):(null==l?void 0:null===(u=l.values)||void 0===u?void 0:u.items)||[]}return(0,s.jsx)(I.Z,{form:f,isSaved:!1,actions:[{key:"Ok",condition:!0,onClick:()=>{f.handleSubmit()}}],maxAccess:a,children:(0,s.jsx)(S.R,{children:(0,s.jsx)(q.Q,{children:(0,s.jsx)(p.ZP,{container:!0,children:(0,s.jsx)(p.ZP,{item:!0,xs:12,children:(0,s.jsx)(h.Z,{name:"materialsTfr",label:n.materialsTfr,value:f.values.materialsTfr,required:!0,onChange:f.handleChange,onClear:()=>f.setFieldValue("materialsTfr",""),error:f.touched.materialsTfr&&!!f.errors.materialsTfr,maxAccess:a})})})})})})}var C=r(61802),D=r(98345),T=r(82737),x=r(33625),M=r(8661),O=r(38449),R=r(89330),A=r(21581),P=r(76399),w=r(91406),J=r(39812);function F(e){var t,r,I,F,k,N,B,b,L,W,j,Z,_,G,E,V,H,$,Q,z,K,U,X,Y,ee,et,er,es,ea,en,el,eo,ed,ei,eu;let{recordId:ec,access:ep,labels:eg}=e,{getRequest:ev,postRequest:ey}=(0,u.useContext)(i.$),{platformLabels:em}=(0,u.useContext)(d.l),{stack:eh}=(0,C.zY)(),{stack:eI}=(0,v.V)(),{documentType:eS,maxAccess:eq,changeDT:ef}=(0,D.H)({functionId:l.J.ItemDisposal,access:ep,enabled:!ec}),eC=(0,o.E)({endpointId:a.u.Disposal.page}),{formik:eD}=(0,y.c)({maxAccess:eq,documentType:{key:"dtId",value:null==eS?void 0:eS.dtId,reference:null==eS?void 0:eS.reference},initialValues:{recordId:null,header:{recordId:null,reference:"",dtId:null,date:new Date,siteId:null,notes:"",status:1,wip:1,workCenterId:null,wcSiteId:null},items:[{id:1,trxId:null,seqNo:null,itemId:null,itemName:"",sku:"",qty:0,trackby:null,serialCount:0}],serials:[]},validationSchema:g.Ry({header:g.Ry({date:g.hT().required(),workCenterId:g.Rx().required(),siteId:g.Rx().required()})}),onSubmit:async e=>{let t=(null==e?void 0:e.header)||{},r=[],s=((null==e?void 0:e.items)||[]).filter(e=>e.itemId).map((e,s)=>{let{serials:a,...n}=e;return(null==a?void 0:a.length)&&a.forEach((e,a)=>{r.push({...e,seqNo:s+1,srlSeqNo:a+1,trxId:t.recordId||0})}),{...n,seqNo:s+1,qty:(null==n?void 0:n.qty)||0,trxId:t.recordId||0}}),n=await ey({extension:a.u.Disposal.set2,record:JSON.stringify({header:{...t,date:t.date?formatDateToApi(t.date):null},items:s,serials:r})});c.ZP.success(t.recordId?em.Edited:em.Added),ek(n.recordId),eC()}}),eT=!!eD.values.recordId,ex=e=>{var t,r;return null==eD?void 0:null===(r=eD.values)||void 0===r?void 0:null===(t=r.items)||void 0===t?void 0:t.reduce((t,r)=>t+(parseFloat(r[e])||0),0)},eM=ex("qty"),eO=ex("serialCount");async function eR(e){var t;if(!e)return;let r=await ev({extension:m.$.Group.get,parameters:"_recordId=".concat(e)});return(null==r?void 0:null===(t=r.record)||void 0===t?void 0:t.name)||""}let eA=[{component:"resourcelookup",label:eg.sku,name:"sku",props:{endpointId:m.$.Item.snapshot,valueField:"sku",displayField:"sku",displayFieldWidth:3,mapping:[{from:"recordId",to:"itemId"},{from:"sku",to:"sku"},{from:"name",to:"itemName"},{from:"groupId",to:"groupId"},{from:"trackBy",to:"trackBy"}],columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"}]},async onChange(e){let{row:{update:t,newRow:r}}=e;if(null==r?void 0:r.isInactive){t({...eD.initialValues.items[0],id:r.id}),eI({message:eg.inactiveItem});return}t({itemGroupName:await eR((null==r?void 0:r.groupId)||null)})}},{component:"textfield",label:eg.itemName,name:"itemName",props:{readOnly:!0}},{component:"textfield",label:eg.itemGroup,name:"itemGroupName",props:{readOnly:!0}},{component:"numberfield",label:eg.qty,name:"qty",props:{maxLength:12,decimalScale:2}},{component:"button",name:"serials",label:em.serials,props:{onCondition:e=>1===e.trackBy?{imgSrc:"/images/TableIcons/imgSerials.png",hidden:!1}:{imgSrc:"",hidden:!0}},onClick:(e,t,r,s)=>{if((null==t?void 0:t.trackBy)==1){var a,n;eh({Component:SerialsForm,props:{row:{...t,serialCount:(null==t?void 0:t.serialCount)||0},siteId:null==eD?void 0:null===(n=eD.values)||void 0===n?void 0:null===(a=n.header)||void 0===a?void 0:a.siteId,checkForSiteId:!0,updateRow:s}})}}},{component:"numberfield",label:eg.serialCount,name:"serialCount",props:{readOnly:!0}}],eP=[{key:"IV",condition:!0,onClick:"onInventoryTransaction",disabled:!eT},{key:"ImportFromTransfer",condition:!0,onClick:()=>{eh({Component:f,props:{maxAccess:eq,labels:eg,form:eD},width:400,height:150,refresh:!1,title:eg.importFromTransfer})},disabled:eD.values.items.some(e=>e.itemId)}];async function ew(e){var t;if(!e)return;let r=await ev({extension:a.u.Disposal.get,parameters:"_recordId=".concat(e)});return{...null==r?void 0:r.record,date:(0,J.a1)(null==r?void 0:null===(t=r.record)||void 0===t?void 0:t.date)}}async function eJ(e){var t,r;if(!e)return;let s=await ev({extension:a.u.DisposalItem.qry,parameters:"_trxId=".concat(e)});return(null==s?void 0:null===(t=s.list)||void 0===t?void 0:t.length)?s.list.map((e,t)=>({...e,id:t+1})):null==eD?void 0:null===(r=eD.initialValues)||void 0===r?void 0:r.items}async function eF(e){var t,r;if(!e)return;let s=await ev({extension:a.u.DisposalSerial.qry,parameters:"_trxId=".concat(e,"&_seqNo=0")});return(null==s?void 0:null===(t=s.list)||void 0===t?void 0:t.length)?s.list.map((e,t)=>({...e,id:t+1})):null==eD?void 0:null===(r=eD.initialValues)||void 0===r?void 0:r.serials}async function ek(e){if(!e)return;let t=await ew(e),r=await eJ(e),s=(await eF(e)).reduce((e,t)=>{let r=t.seqNo;return e[r]||(e[r]=[]),e[r].push(t),e},{}),a=(r||[]).map(e=>{let t=s[e.seqNo]||[];return{...e,serials:t,serialCount:(null==t?void 0:t.length)||0}});eD.setValues({header:t,recordId:t.recordId||null,items:a})}return(0,u.useEffect)(()=>{ek(ec)},[]),(0,s.jsx)(T.Z,{resourceId:n.i.ItemDisposal,functionId:l.J.ItemDisposal,form:eD,maxAccess:eq,editMode:eT,actions:eP,children:(0,s.jsxs)(S.R,{children:[(0,s.jsx)(x.g,{children:(0,s.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(p.ZP,{item:!0,xs:4,children:(0,s.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(p.ZP,{item:!0,xs:12,children:(0,s.jsx)(M.Z,{endpointId:O.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(l.J.ItemDisposal),filter:eT?void 0:e=>1===e.activeStatus,name:"header.dtId",label:eg.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:eT,valueField:"recordId",displayField:["reference","name"],values:null===(t=eD.values)||void 0===t?void 0:t.header,maxAccess:eq,onChange:async(e,t)=>{await ef(t),eD.setFieldValue("header.dtId",(null==t?void 0:t.recordId)||null)},error:(null===(I=eD.touched)||void 0===I?void 0:null===(r=I.header)||void 0===r?void 0:r.dtId)&&!!(null===(k=eD.errors)||void 0===k?void 0:null===(F=k.header)||void 0===F?void 0:F.dtId)})}),(0,s.jsx)(p.ZP,{item:!0,xs:12,children:(0,s.jsx)(h.Z,{name:"header.reference",label:eg.reference,value:null==eD?void 0:null===(B=eD.values)||void 0===B?void 0:null===(N=B.header)||void 0===N?void 0:N.reference,maxAccess:!eT&&eq,readOnly:eT,onChange:eD.handleChange,onClear:()=>eD.setFieldValue("header.reference",null),error:(null===(L=eD.touched)||void 0===L?void 0:null===(b=L.header)||void 0===b?void 0:b.reference)&&!!(null===(j=eD.errors)||void 0===j?void 0:null===(W=j.header)||void 0===W?void 0:W.reference)})})]})}),(0,s.jsx)(p.ZP,{item:!0,xs:4,children:(0,s.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(p.ZP,{item:!0,xs:12,children:(0,s.jsx)(R.Z,{name:"header.date",required:!0,label:eg.date,value:null==eD?void 0:null===(_=eD.values)||void 0===_?void 0:null===(Z=_.header)||void 0===Z?void 0:Z.date,onChange:eD.setFieldValue,maxAccess:eq,onClear:()=>eD.setFieldValue("header.date",null),error:(null===(E=eD.touched)||void 0===E?void 0:null===(G=E.header)||void 0===G?void 0:G.date)&&!!(null===(H=eD.errors)||void 0===H?void 0:null===(V=H.header)||void 0===V?void 0:V.date)})}),(0,s.jsx)(p.ZP,{item:!0,xs:12,children:(0,s.jsx)(M.Z,{endpointId:m.$.Site.qry,name:"header.siteId",label:eg.site,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:null===($=eD.values)||void 0===$?void 0:$.header,valueField:"recordId",displayField:["reference","name"],maxAccess:eq,displayFieldWidth:1.5,required:!0,onChange:(e,t)=>eD.setFieldValue("header.siteId",(null==t?void 0:t.recordId)||null),error:(null===(z=eD.touched)||void 0===z?void 0:null===(Q=z.header)||void 0===Q?void 0:Q.siteId)&&!!(null===(U=eD.errors)||void 0===U?void 0:null===(K=U.header)||void 0===K?void 0:K.siteId)})})]})}),(0,s.jsx)(p.ZP,{item:!0,xs:4,children:(0,s.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(p.ZP,{item:!0,xs:12,children:(0,s.jsx)(M.Z,{endpointId:a.u.WorkCenter.qry,name:"header.workCenterId",label:eg.workCenter,required:!0,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:"name",displayFieldWidth:1.5,values:null===(X=eD.values)||void 0===X?void 0:X.header,maxAccess:eq,onChange:(e,t)=>{eD.setFieldValue("header.wcSiteId",(null==t?void 0:t.siteId)||null),eD.setFieldValue("header.workCenterId",(null==t?void 0:t.recordId)||null)},error:(null===(ee=eD.touched)||void 0===ee?void 0:null===(Y=ee.header)||void 0===Y?void 0:Y.workCenterId)&&!!(null===(er=eD.errors)||void 0===er?void 0:null===(et=er.header)||void 0===et?void 0:et.workCenterId)})}),(0,s.jsx)(p.ZP,{item:!0,xs:12,children:(0,s.jsx)(A.Z,{name:"header.notes",label:eg.notes,value:null===(ea=eD.values)||void 0===ea?void 0:null===(es=ea.header)||void 0===es?void 0:es.notes,maxLength:"100",rows:2,maxAccess:eq,onChange:eD.handleChange,onClear:()=>eD.setFieldValue("header.notes",""),error:(null===(el=eD.touched)||void 0===el?void 0:null===(en=el.header)||void 0===en?void 0:en.notes)&&!!(null===(ed=eD.errors)||void 0===ed?void 0:null===(eo=ed.header)||void 0===eo?void 0:eo.notes)})})]})})]})}),(0,s.jsx)(q.Q,{children:(0,s.jsx)(P._,{name:"disposalItem",onChange:e=>null==eD?void 0:eD.setFieldValue("items",e),maxAccess:eq,value:null==eD?void 0:null===(ei=eD.values)||void 0===ei?void 0:ei.items,error:null==eD?void 0:null===(eu=eD.errors)||void 0===eu?void 0:eu.items,columns:eA})}),(0,s.jsx)(x.g,{children:(0,s.jsxs)(p.ZP,{container:!0,spacing:2,justifyContent:"flex-end",children:[(0,s.jsx)(p.ZP,{item:!0,xs:3,children:(0,s.jsx)(w.Z,{name:"totalQty",value:eM,label:eg.totalQty,readOnly:!0})}),(0,s.jsx)(p.ZP,{item:!0,xs:3,children:(0,s.jsx)(w.Z,{name:"totalPcs",value:eO,label:eg.totalPcs,readOnly:!0})})]})})]})})}var k=r(27723),N=r(69387);function B(){let{postRequest:e,getRequest:t}=(0,u.useContext)(i.$),{platformLabels:r}=(0,u.useContext)(d.l),{stack:p}=(0,C.zY)(),{query:{data:g},search:v,clear:y,refetch:m,labels:h,access:I,paginationParameters:f,invalidate:T}=(0,o.J)({queryFn:M,endpointId:a.u.Disposal.page,datasetId:n.i.ItemDisposal,search:{searchFn:O}});async function M(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:s=50}=e;return{...await t({extension:a.u.Disposal.page,parameters:"_startAt=".concat(r,"&_pageSize=").concat(s,"&_filter=")}),_startAt:r}}async function O(e){let{qry:r}=e;return await t({extension:a.u.Disposal.snapshot,parameters:"_filter=".concat(r)})}let R=[{field:"reference",headerName:h.reference,flex:1},{field:"dtRef",headerName:h.documentType,flex:1},{field:"date",headerName:h.date,flex:1,type:"date"},{field:"wcRef",headerName:h.workCenter,flex:1},{field:"siteRef",headerName:h.site,flex:1},{field:"statusName",headerName:h.status,flex:1},{field:"notes",headerName:h.notes,flex:1}],A=async()=>{await P()},{proxyAction:P}=(0,D.G)({functionId:l.J.ItemDisposal,action:w});async function w(e){p({Component:F,props:{labels:h,recordId:e,access:I},width:900,height:650,title:h.itemDisposal})}let J=async t=>{await e({extension:a.u.Disposal.del,record:JSON.stringify(t)}),T(),c.ZP.success(r.Deleted)};return(0,s.jsxs)(S.R,{children:[(0,s.jsx)(x.g,{children:(0,s.jsx)(k.Z,{onAdd:A,maxAccess:I,onSearch:v,onSearchClear:y,inputSearch:!0})}),(0,s.jsx)(q.Q,{children:(0,s.jsx)(N.Z,{name:"itemDisposal",columns:R,gridData:g,rowId:["recordId"],onEdit:e=>{w(null==e?void 0:e.recordId)},refetch:m,onDelete:J,pageSize:50,maxAccess:I,paginationParameters:f,paginationType:"api"})})]})}},90587:function(e,t,r){"use strict";r.d(t,{u:function(){return a}});let s="MF.asmx/",a={DesignRawMaterial:{qry2:s+"qryDRM2",qry:s+"qryDRM",set2:s+"set2DRM"},JobOrdersItem:{qry:s+"qryJIT",set2:s+"set2JIT"},IssueOfMaterialsItems:{qry:s+"qryIMI",qry2:s+"qryIMI2"},LaborGroup:{snapshot:s+"snapshotLBG",page:s+"pageLBG",qry:s+"qryLBG",set:s+"setLBG",get:s+"getLBG",del:s+"delLBG"},ProductionLine:{page:s+"pageLIN",qry:s+"qryLIN",qry2:s+"qry2LIN",qry3:s+"qry3LIN",set:s+"setLIN",get:s+"getLIN",del:s+"delLIN"},CostGroup:{page:s+"pageCG",set:s+"setCG",get:s+"getCG",del:s+"delCG",qry:s+"qryCG"},WorkCenter:{page:s+"pageWCT",qry:s+"qryWCT",qry3:s+"qryWCT3",set:s+"setWCT",get:s+"getWCT",del:s+"delWCT",snapshot:s+"snapshotWCT"},Routing:{page:s+"pageRTN",qry:s+"qryRTN",set:s+"setRTN",get:s+"getRTN",del:s+"delRTN",snapshot2:s+"snapshot2RTN",snapshot:s+"snapshotRTN"},Operation:{snapshot:s+"snapshotOPR",qry:s+"qryOPR",page:s+"pageOPR",set:s+"setOPR",get:s+"getOPR",del:s+"delOPR"},Labor:{page:s+"pageLBR",qry:s+"qryLBR",qry2:s+"qry2LBR",set:s+"setLBR",get:s+"getLBR",del:s+"delLBR",snapshot:s+"snapshotLBR"},Machine:{page:s+"pageMAC",qry:s+"qryMAC",set:s+"setMAC",get:s+"getMAC",del:s+"delMAC",snapshot:s+"snapshotMAC"},MachineSpecification:{page:s+"pageMAS",qry:s+"qryMAS",set:s+"setMAS",get:s+"getMAS",del:s+"delMAS"},LeanProductionPlanning:{preview:s+"previewPQ",update:s+"updatePQ",snapshot:s+"snapshotPQ",del:s+"delPQ",cancel:s+"cancelPQ"},MaterialsAdjustment:{generate:s+"generateADJ"},ProductionClass:{page:s+"pageCLS",qry:s+"qryCLS",set:s+"setCLS",get:s+"getCLS",del:s+"delCLS",snapshot:s+"qryCLS"},ProductionStandard:{qry:s+"qrySTD",page:s+"pageSTD",set:s+"setSTD",get:s+"getSTD",del:s+"delSTD"},ProductionClassSemiFinished:{qry:s+"qryCSF",set:s+"setCSF",get:s+"getCSF",del:s+"delCSF",set2:s+"set2CSF"},RoutingSequence:{set2:s+"set2RTS",qry:s+"qryRTS"},Overhead:{qry:s+"qryOVH",set:s+"setOVH",get:s+"getOVH",del:s+"delOVH",page:s+"pageOVH",snapshot:s+"snapshotOVH"},Design:{qry:s+"qryDES",set:s+"setDES",get:s+"getDES",del:s+"delDES",snapshot:s+"snapshotDES",page:s+"pageDES"},MFJobOrder:{pack:s+"packJOB",qry:s+"qryJOB",qry2:s+"qryJOB2",set:s+"setJOB",get:s+"getJOB",get2:s+"get2JOB",del:s+"delJOB",snapshot:s+"snapshotJOB",snapshot2:s+"snapshotJOB2",snapshot3:s+"snapshotJOB3",cancel:s+"cancelJOB",post:s+"postJOB",start:s+"startJOB",stop:s+"stopJOB",wip:s+"wipJOB",sync:s+"syncJOB"},ProductionSheet:{page:s+"pagePST",qry:s+"qryPST",get:s+"getPST",set2:s+"set2PST",get2:s+"get2PST",del:s+"delPST",post:s+"postPST",unpost:s+"unpostPST",snapshot:s+"snapshotPST"},ProductionSheetItem:{qry:s+"qryPSI",set:s+"setPSI",get:s+"getPSI",del:s+"delPSI"},DocumentTypeDefault:{qry:s+"qryDTD",get:s+"getDTD",set:s+"setDTD",del:s+"delDTD",page:s+"pageDTD"},RawMaterialCategory:{qry:s+"qryRMC",get:s+"getRMC",set:s+"setRMC",del:s+"delRMC",page:s+"pageRMC"},WorksheetMaterials:{qry:s+"qryIMA",get:s+"getIMA",pack:s+"get2IMA",set:s+"setIMA",set2:s+"set2IMA",del:s+"delIMA",post:s+"postIMA"},ProductionSheetQueue:{qry:s+"qryPSQ"},Damage:{qry:s+"qryDMG",get:s+"getDMG",set:s+"setDMG",del:s+"delDMG",page:s+"pageDMG",snapshot:s+"snapshotDMG",post:s+"postDMG",get2:s+"get2DMG",set2:s+"set2DMG",preview:s+"previewDMG"},JobCategory:{qry:s+"qryJCA"},JobRouting:{qry:s+"qryJRO",get:s+"getJRO",set:s+"setJRO",set2:s+"set2JRO",del:s+"delJRO",sync:s+"syncJRO",close:s+"closeJRO",reopen:s+"reopenJRO"},Worksheet:{snapshot:s+"snapshotWST",get:s+"getWST",pack:s+"getPackWST",set:s+"setWST",del:s+"delWST",page:s+"pageWST",summary:s+"summaryWST",post:s+"postWST",qry2:s+"qryWST2",draft:s+"draftWST"},JobOverhead:{qry:s+"qryJOH",set2:s+"set2JOH",generate:s+"generateJOH"},JobMaterial:{qry:s+"qryJMA"},JobItemSize:{qry:s+"qryJSZ",set2:s+"set2JSZ"},MFSerial:{qry:s+"qrySRL",qry2:s+"qrySRL2",set2:s+"set2SRL",generate:s+"generateSRL"},SamplePack:{qry:s+"qrySPL",set2:s+"set2SPL"},DamageReturn:{get:s+"getDMR",set:s+"setDMR",del:s+"delDMR",page:s+"pageDMR",snapshot:s+"snapshotDMR",post:s+"postDMR"},ProductionOrder:{get2:s+"get2PO",set2:s+"set2PO",del:s+"delPO",page:s+"pagePO",snapshot:s+"snapshotPO",post:s+"postPO",gen:s+"genPO",close:s+"closePO"},BillOfMaterials:{get:s+"getBMA",qry2:s+"qry2BMA",set:s+"setBMA",del:s+"delBMA",page:s+"pageBMA",snapshot:s+"snapshotBMA"},Component:{get:s+"getBMI",qry:s+"qryBMI",del:s+"delBMI",set:s+"setBMI",set2:s+"set2BMI"},Assembly:{get:s+"getASM",set2:s+"set2ASM",del:s+"delASM",page:s+"pageASM",snapshot:s+"snapshotASM",post:s+"postASM",unpost:s+"unpostASM",generate:s+"genASM"},AssemblyItems:{qry:s+"qryASC"},AssemblyLot:{get:s+"getASL",set:s+"setASL"},AssemblyOverhead:{qry:s+"qryAOH",set2:s+"set2AOH"},MeasurementScheduleMap:{qry:s+"qryMSM",set:s+"setMSM",set2:s+"set2MSM",del:s+"delMSM"},JobCategory:{set:s+"setJCA",get:s+"getJCA",del:s+"delJCA",page:s+"pageJCA",qry:s+"qryJCA"},DesignGroup:{qry:s+"qryDEG",set:s+"setDEG",get:s+"getDEG",del:s+"delDEG",page:s+"pageDEG"},Components:{qry:s+"qryDEM",set2:s+"set2DEM"},DesignFamily:{qry:s+"qryDEF",set:s+"setDEF",get:s+"getDEF",del:s+"delDEF",page:s+"pageDEF"},ProductionShifts:{qry:s+"qrySHI",set:s+"setSHI",get:s+"getSHI",del:s+"delSHI",page:s+"pageSHI"},JobOrderWizard:{set2:s+"set2JOZ",get2:s+"get2JOZ",del:s+"delJOZ",page:s+"pageJOZ",snapshot:s+"snapshotJOZ",post:s+"postJOZ"},JobTransfer:{get2:s+"get2TFR",set2:s+"set2TFR",del:s+"delTFR",page:s+"pageTFR",snapshot:s+"snapshotTFR",post:s+"postTFR",close:s+"closeTFR",reopen:s+"reopenTFR",qry:s+"qryTFR"},JobWorkCenter:{qry:s+"qryJWC",close:s+"closeJWC",reopen:s+"reopenJWC",get:s+"getJWC",snapshot:s+"snapshotJWC",verify:s+"verifyJWC"},WorkCenterConsumption:{page:s+"pageCON",snapshot:s+"snapshotCON",del:s+"delCON",set2:s+"set2CON",get:s+"getCON",post:s+"postCON",unpost:s+"unpostCON",close:s+"closeCON",reopen:s+"reopenCON"},ConsumptionItemView:{qry:s+"qryCOI"},LineItemCapacity:{set2:s+"set2LIT",del:s+"delLIT",qry:s+"qryLIT",page:s+"pageLIT"},CostGroupOverhead:{set2:s+"set2CGV",qry:s+"qryCGV"},IssueOfMaterialDimension:{set:s+"setIMD",qry:s+"qryIMD"},JobOrder:{gen:s+"genORD"},RefreshPoItem:{refresh:s+"refreshPOI"},WorkCenterTransferMap:{qry:s+"qryWCTM",set2:s+"set2WCTM"},BatchWorksheet:{get2:s+"get2BWST",set2:s+"set2BWST",del:s+"delBWST",page:s+"pageBWST",snapshot:s+"snapshotBWST",post:s+"postBWST",gen:s+"genBWST",close:s+"closeBWST",reopen:s+"reopenBWST"},ProductionOrderFromSaleOrder:{gen:s+"generatePOFromSO"},BatchTransfer:{page:s+"pageBTFR",set2:s+"set2BTFR",del:s+"delBTFR",snapshot:s+"snapshotBTFR",get:s+"getBTFR",post:s+"postBTFR",unpost:s+"unpostBTFR"},BatchTransferJob:{qry:s+"qryBTFJ"},Disposal:{page:s+"pageDIS",snapshot:s+"snapshotDIS",get:s+"getDIS",set2:s+"set2DIS",del:s+"delDIS"},DisposalItem:{qry:s+"qryDII"},DisposalSerial:{qry:s+"qryDISRL"},MetalSetting:{page:s+"pageMTS",set:s+"setMTS",get:s+"getMTS",del:s+"delMTS"},DamageReason:{qry:s+"qryDRS",page:s+"pageDRS",set:s+"setDRS",get:s+"getDRS",del:s+"delDRS",snapshot:s+"snapshotDRS"},DamageCategory:{qry:s+"qryDCA",page:s+"pageDCA",set:s+"setDCA",get:s+"getDCA",del:s+"delDCA",snapshot:s+"snapshotDCA"}}},1685:function(e,t,r){"use strict";r.d(t,{m:function(){return s}});let s=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,r){"use strict";r.d(t,{H:function(){return y},G:function(){return v}});var s=r(45300),a=r(2784),n=r(96026),l=r(38449);r(26612);var o=r(65947),d=r(1685);let i=async(e,t,r)=>{try{let s=await e({extension:t,parameters:r});return t.includes("qry")?s:s.record}catch(e){return null}},u=(e,t,r,s)=>{let a=(e=JSON.parse(JSON.stringify(e))).record.controls,n=a.find(e=>"reference"===e.controlId);return n?n.accessLevel=(null==t?void 0:t.mandatory)?o.$7:o.rr:(null==t?void 0:t.mandatory)?a.push({sgId:0,resourceId:"",controlId:"".concat(s?s+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?o.$7:o.rr}):(null==t?void 0:t.readOnly)?a.push({sgId:0,resourceId:"",controlId:"".concat(s?s+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?o.rr:o.$7}):a=e.record.controls.filter(e=>"reference"!=e.controlId),r&&a.push({sgId:0,resourceId:"",controlId:"".concat(s?s+".":"","dtId"),accessLevel:o.$7}),{...e,record:{...e.record,controls:a}}},c=async(e,t,r)=>{let s,a;switch(r){case"dtId":let n=(0,d.m)("userData"),o=null==n?void 0:n.userId;a="_userId=".concat(o,"&_functionId=").concat(t),s=l.r.UserFunction.get;break;case"glbSysNumberRange":a="_recordId=".concat(t),s=l.r.SystemFunction.get;break;case"DocumentType":a="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),s=l.r.DocumentType.qry;break;case"DcTypNumberRange":a="_recordId=".concat(t),s=l.r.DocumentType.get;break;case"isExternal":a="_recordId=".concat(t),s=l.r.NumberRange.get;break;default:return null}return await i(e,s,a)},p=async function(e){let t,r,s,a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,d=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=arguments.length>5?arguments[5]:void 0,p=void 0===o&&n&&await c(e,n,"dtId"),g=null==p?void 0:p.dtId,v="",y=!0;if(p&&void 0===o||"nraId"===o){if(g){let r=await c(e,g,"DcTypNumberRange");t=null==r?void 0:r.nraId,y=!((null==r?void 0:r.activeStatus)<0),t||(v="Assign the document type to a number range")}if((!g||!y)&&d&&n){var m;let t=await c(e,n,"DocumentType");a=(null==t?void 0:null===(m=t.list)||void 0===m?void 0:m.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===o||void 0===o)&&n){if((!g||g)&&!t||t&&!y){let r=await c(e,n,"glbSysNumberRange");(t=null==r?void 0:r.nraId)&&a&&(a=!1),y=!0}v=t||a?"":"Assign the system Function to a number range"}o>0&&!t&&(t=o),t&&y?(r={readOnly:null==(s=await c(e,t,"isExternal"))||!s.external,mandatory:null!=s&&!!s.external},l&&(l=await u(l,r,a,i))):!t&&l&&(l=await u(l,r,a,i));let h=i?"".concat(i,".reference"):"reference";return{dtId:g,resetReference:null==r?void 0:r.readOnly,dcTypeRequired:a,reference:{fieldName:h,isEmpty:(null==s?void 0:s.external)!==void 0&&(null==s||!s.external)},errorMessage:v,maxAccess:l,selectNraId:o}};var g=r(65950);function v(e){let{functionId:t,action:r,hasDT:s}=e,{getRequest:l}=(0,a.useContext)(g.$),{stack:o}=(0,n.V)();return{proxyAction:async()=>{let e=await p(l,t,"",void 0,s);(null==e?void 0:e.errorMessage)?o({message:null==e?void 0:e.errorMessage}):await r()}}}function y(e){var t;let{functionId:r,access:l,hasDT:o,enabled:d=!0,objectName:i=""}=e,{getRequest:u}=(0,a.useContext)(g.$),{stack:c}=(0,n.V)(),[v,y]=(0,a.useState)(),m=async e=>{let t=await p(u,r,l,e,o,i);if(!t.errorMessage)return t;c({message:null==t?void 0:t.errorMessage})},h=(0,s.a)({retry:!1,staleTime:0,enabled:d,queryKey:[r,v,!!l,d],queryFn:v||"nraId"===v?()=>m(v):()=>m()});return{documentType:h.data,maxAccess:(null==h?void 0:null===(t=h.data)||void 0===t?void 0:t.maxAccess)||l,changeDT(e){y((null==e?void 0:e.nraId)||"nraId")}}}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=32421)}),_N_E=e.O()}]);