(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[32517],{21758:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/plants",function(){return s(76257)}])},76257:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return k}});var t=s(52322),l=s(2784),n=s(62202),r=s(69387),d=s(65950),i=s(38449),o=s(26612),c=s(29326),u=s(60218),m=s(5088),h=s(8661),v=s(66361),x=s(82737),p=s(48601),b=s(71987),f=s(80983),I=s(19473),_=s(21581),C=s(19689),g=s(31389),y=s(62362),N=e=>{var a,s;let{_labels:r,maxAccess:c,store:N,setStore:j,editMode:Z}=e,{getRequest:P,postRequest:A}=(0,l.useContext)(d.$),{platformLabels:T}=(0,l.useContext)(I.l),{recordId:w,address:S}=N,F=(0,b.E)({endpointId:i.r.Plant.page}),{formik:R}=(0,f.c)({maxAccess:c,initialValues:{recordId:w,addressId:null,address:null,reference:null,name:null,segmentRef:null,licenseNo:null,crNo:null,costCenterId:null,costCenterName:null,groupId:null,groupName:null,segmentName:null,flName:"",locationUrl:"",isInactive:!1},validateOnChange:!1,validationSchema:p.Ry({reference:p.Z_().required(),name:p.Z_().required()}),onSubmit:async e=>{await V(e)}}),V=async e=>{let a=(null==S?void 0:S.recordId)||null;a&&(e={...e,addressId:a}),await A({extension:i.r.Plant.set,record:JSON.stringify(e)}).then(a=>{Z?n.ZP.success(T.Edited):(R.setFieldValue("recordId",a.recordId),n.ZP.success(T.Added)),j(s=>({...s,plant:e,recordId:a.recordId})),F()})},E=[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!Z}];return(0,l.useEffect)(()=>{!async function(){if(w){var e=(await P({extension:i.r.Plant.get,parameters:"_recordId=".concat(w)})).record;R.setValues(e),j(a=>({...a,plant:e}))}}()},[]),(0,t.jsx)(x.Z,{form:R,resourceId:o.i.Plants,maxAccess:c,editMode:Z,actions:E,children:(0,t.jsx)(g.R,{children:(0,t.jsx)(y.Q,{children:(0,t.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(m.Z,{name:"reference",label:null==r?void 0:r.reference,value:null===(a=R.values)||void 0===a?void 0:a.reference,readOnly:Z,required:!0,onChange:R.handleChange,onClear:()=>R.setFieldValue("reference",""),error:R.touched.reference&&!!R.errors.reference,maxLength:"4",maxAccess:c})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(m.Z,{name:"name",label:r.name,value:R.values.name,required:!0,onChange:R.handleChange,onClear:()=>R.setFieldValue("name",""),error:R.touched.name&&!!R.errors.name,maxLength:"40",maxAccess:c})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(m.Z,{name:"licenseNo",label:r.licenseNo,value:R.values.licenseNo,onChange:R.handleChange,onClear:()=>R.setFieldValue("licenseNo",""),error:R.touched.licenseNo&&!!R.errors.licenseNo,maxLength:"20",maxAccess:c})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(m.Z,{name:"crNo",label:r.commReg,value:R.values.crNo,onChange:R.handleChange,onClear:()=>R.setFieldValue("crNo",""),error:R.touched.crNo&&!!R.errors.crNo,maxLength:"20",maxAccess:c})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(h.Z,{name:"costCenterId",endpointId:v.x.CostCenter.qry,parameters:"_params=&_startAt=0&_pageSize=1000",label:r.costCenter,valueField:"recordId",displayField:"name",values:R.values,onChange:(e,a)=>{R.setFieldValue("costCenterId",null==a?void 0:a.recordId)},error:R.touched.costCenterId&&!!R.errors.costCenterId,maxAccess:c})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(h.Z,{name:"groupId",endpointId:i.r.PlantGroup.qry,label:r.plantGrp,valueField:"recordId",displayField:"name",values:R.values,onChange:(e,a)=>{R.setFieldValue("groupId",null==a?void 0:a.recordId)},error:R.touched.groupId&&!!R.errors.groupId,maxAccess:c})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(m.Z,{name:"flName",label:r.flName,value:R.values.flName,maxLength:"30",maxAccess:c,onChange:R.handleChange,onClear:()=>R.setFieldValue("flName",""),error:R.touched.flName&&!!R.errors.flName})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(_.Z,{name:"locationUrl",label:r.locationUrl,value:R.values.locationUrl,rows:3,maxLength:"100",maxAccess:c,onChange:R.handleChange,onClear:()=>R.setFieldValue("locationUrl",""),error:R.touched.locationUrl&&!!R.errors.locationUrl})}),(0,t.jsx)(u.ZP,{item:!0,xs:12,children:(0,t.jsx)(C.Z,{name:"isInactive",value:null===(s=R.values)||void 0===s?void 0:s.isInactive,onChange:e=>R.setFieldValue("isInactive",e.target.checked),label:r.isInactive,maxAccess:c})})]})})})})},j=s(9522),Z=s(93894),P=s(76399),A=s(84100),T=s(80968),w=s(54074),S=e=>{var a,s;let{store:r,setStore:o,_labels:c,editMode:u,maxAccess:m}=e,{recordId:h}=r,{getRequest:v,postRequest:x}=(0,l.useContext)(d.$),{platformLabels:b}=(0,l.useContext)(I.l),{getAllKvsByDataset:_}=(0,l.useContext)(T.k),{formik:C}=(0,f.c)({initialValues:{plantId:h,schedules:[{id:1,plantId:h,day:"",startTime:"",endTime:""}]},validationSchema:p.Ry({schedules:p.IX().of(p.Ry().shape({startTime:p.Z_().required(),endTime:p.Z_().required(),description:p.Z_().required()})).required()}),validateOnChange:!0,maxAccess:m,onSubmit:async e=>{let a={plantId:h,items:e.schedules.map((e,a)=>({...e,id:a+1,plantId:h,dow:e.dow}))};try{await x({extension:i.r.PlantsSchedule.set2,record:JSON.stringify(a)})&&n.ZP.success(b.Edited),o(a=>({...a,schedules:e.schedules.map((e,a)=>({...e,id:a+1,plantId:h,dow:e.dow}))}))}catch(e){}}}),N=[{component:"resourcecombobox",label:c.day,name:"day",props:{datasetId:A.v.WEEK_DAY,valueField:"key",displayField:"value",displayFieldWidth:2,mapping:[{from:"key",to:"scheduleId"},{from:"value",to:"dayName"}],readOnly:!0}},{component:"textfield",label:c.startTime,name:"startTime"},{component:"textfield",label:c.endTime,name:"endTime"},{component:"textfield",label:c.description,name:"description"}];async function j(){return new Promise((e,a)=>{_({_dataset:A.v.WEEK_DAY,callback:s=>{s?e(s):a()}})})}return(0,l.useEffect)(()=>{!async function(){if(h)try{let e=await j(),a=await v({extension:i.r.PlantsSchedule.qry,parameters:"_plantId=".concat(h)}),s=e.map(e=>{let s={dow:parseInt(e.key),dayName:e.value,startTime:"",endTime:""},t=a.list.find(e=>e.dow==s.dow);return t&&(s.startTime=t.startTime,s.endTime=t.endTime,s.description=t.description),s});C.setValues({...C.values,schedules:s.map((e,a)=>({...e,id:a+1}))}),o(e=>({...e,schedules:s.map((e,a)=>({...e,id:a+1}))}))}catch(e){}}()},[h]),(0,t.jsx)(w.Z,{onSave:C.handleSubmit,maxAccess:m,editMode:u,isParentWindow:!1,children:(0,t.jsx)(g.R,{children:(0,t.jsx)(y.Q,{children:(0,t.jsx)(P._,{onChange:e=>C.setFieldValue("schedules",e),value:null===(a=C.values)||void 0===a?void 0:a.schedules,error:null===(s=C.errors)||void 0===s?void 0:s.schedules,columns:N,allowDelete:!1,allowAddNewLine:!1})})})})},F=e=>{var a;let{labels:s,editMode:r,maxAccess:u,recordId:m,height:h}=e,[v,x]=(0,l.useState)({recordId:m,plant:null,address:null,schedules:null}),[p,b]=(0,l.useState)(0),{platformLabels:f}=(0,l.useContext)(I.l),{getRequest:_,postRequest:C}=(0,l.useContext)(d.$),g=[{label:s.plant},{label:s.address,disabled:!v.recordId},{label:s.schedules,disabled:!v.recordId}];async function y(e){var a,s;let t={...e,recordId:null===(a=v.plant)||void 0===a?void 0:a.addressId},l=(await C({extension:i.r.Address.set,record:JSON.stringify(t)})).recordId,r={...e,addressId:l};if(x(e=>({...e,address:r,plant:{...e.plant,addressId:l}})),null===(s=v.plant)||void 0===s?void 0:s.addressId)n.ZP.success(f.Edited);else{let e={...v.plant,addressId:l,recordId:v.recordId};await C({extension:i.r.Plant.set,record:JSON.stringify(e)}),n.ZP.success(f.Added)}}return(0,l.useEffect)(()=>{var e;let a=null===(e=v.plant)||void 0===e?void 0:e.addressId;a&&_({extension:i.r.Address.get,parameters:"_filter=&_recordId=".concat(a)}).then(e=>{x(a=>({...a,address:e.record}))})},[null===(a=v.plant)||void 0===a?void 0:a.addressId]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.Y,{tabs:g,activeTab:p,setActiveTab:b,maxAccess:u}),(0,t.jsx)(c.Z,{height:h,index:0,value:p,maxAccess:u,children:(0,t.jsx)(N,{_labels:s,maxAccess:u,store:v,setStore:x,editMode:v.recordId})}),(0,t.jsx)(c.Z,{height:h,index:1,value:p,maxAccess:u,children:(0,t.jsx)(Z.O,{_labels:s,maxAccess:u,editMode:r,address:v.address,setAddress:e=>x(a=>({...a,address:e})),allowPost:!0,datasetId:o.i.ADDPlants,onSubmit:y,isCleared:!1})}),(0,t.jsx)(c.Z,{height:h,index:2,value:p,maxAccess:u,children:(0,t.jsx)(S,{_labels:s,maxAccess:u,store:v,setStore:x,editMode:v.recordId})})]})},R=s(61802),V=s(33625),E=s(36908),k=()=>{let{getRequest:e,postRequest:a}=(0,l.useContext)(d.$),{platformLabels:s}=(0,l.useContext)(I.l),{stack:c}=(0,R.zY)(),{query:{data:u},search:m,clear:h,filterBy:v,refetch:x,labels:p,paginationParameters:f,invalidate:_,access:C}=(0,b.J)({queryFn:N,endpointId:i.r.Plant.page,datasetId:o.i.Plants,filter:{filterFn:j}});async function N(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:s=0,_pageSize:t=50,params:l}=a;return{...await e({extension:i.r.Plant.page,parameters:"_startAt=".concat(s,"&_pageSize=").concat(t,"&filter=&_params=").concat(l||"")}),_startAt:s}}async function j(a){let{filters:s,pagination:t}=a;return(null==s?void 0:s.qry)?await e({extension:i.r.Plant.snapshot,parameters:"_filter=".concat(s.qry)}):N({_startAt:t._startAt||0,params:null==s?void 0:s.params})}let Z=[{field:"reference",headerName:p.reference,flex:1},{field:"name",headerName:p.name,flex:1},{field:"costCenterName",headerName:p.costCenter,flex:1},{field:"groupName",headerName:p.plantGrp,flex:1},{field:"isInactive",headerName:p.isInactive,type:"checkbox",flex:1}];function P(e){c({Component:F,props:{labels:p,recordId:e,editMode:e&&!0,maxAccess:C},width:800,height:640,title:p.plant})}return(0,t.jsxs)(g.R,{children:[(0,t.jsx)(V.g,{children:(0,t.jsx)(E.Z,{maxAccess:C,reportName:"SYPLT",filterBy:v,onAdd:()=>{P()},onSearch:m,onSearchClear:h,labels:p,inputSearch:!0,previewReport:o.i.Plants})}),(0,t.jsx)(y.Q,{children:(0,t.jsx)(r.Z,{columns:Z,gridData:u,rowId:["recordId"],onEdit:e=>{P(e.recordId)},onDelete:e=>{a({extension:i.r.Plant.del,record:JSON.stringify(e)}).then(e=>{_(),n.ZP.success(s.Deleted)})},refetch:x,paginationType:"api",paginationParameters:f,isLoading:!1,pageSize:50,maxAccess:C})})]})}},93894:function(e,a,s){"use strict";s.d(a,{O:function(){return u}});var t=s(52322),l=s(2784),n=s(82737),r=s(13073),d=s(80983),i=s(31389),o=s(33625),c=s(48601);let u=e=>{let{setAddress:a,address:s,editMode:u,window:m,readOnly:h,allowPost:v=!0,optional:x=!1,onSubmit:p,isSavedClear:b=!0,isCleared:f=!0,changeClear:I=!1,actions:_=[],...C}=e,[g,y]=(0,l.useState)(!x),[N,j]=(0,l.useState)({}),{formik:Z}=(0,d.c)({maxAccess:N.maxAccess,initialValues:{recordId:null,name:"",countryId:null,countryName:"",stateId:null,stateName:"",cityId:null,city:"",street1:"",street2:"",email1:"",email2:"",phone:"",phone2:"",phone3:"",addressId:null,postalCode:"",cityDistrictId:null,cityDistrict:"",bldgNo:"",unitNo:"",subNo:"",poBox:""},validateOnChange:!0,validateOnBlur:!0,validationSchema:c.Ry({...N.validate}),onSubmit:e=>{a(e),v?p(e,m):m.close()}});return(0,l.useEffect)(()=>{x&&(Z.values.name||Z.values.street1||Z.values.countryId||Z.values.cityId)&&y(!0),!x||Z.values.name||Z.values.street1||Z.values.countryId||Z.values.cityId||y(!1)},[Z.values]),(0,t.jsx)(n.Z,{form:Z,maxAccess:N.maxAccess,isInfo:!1,disabledSubmit:h,editMode:u,isSavedClear:b,isCleared:f,onClear:I?()=>{Z.resetForm({values:Z.initialValues})}:void 0,actions:_,...C,children:(0,t.jsx)(i.R,{children:(0,t.jsx)(o.g,{children:(0,t.jsx)(r.Z,{addressValidation:Z,readOnly:h,required:g,setFormik:j,address:s,...C})})})})}},29326:function(e,a,s){"use strict";var t=s(52322);s(2784);var l=s(23925),n=s(13980),r=s.n(n),d=s(95291),i=s.n(d),o=s(65947);let c=e=>{var a,s,n;let{children:r,value:d,index:c,maxAccess:u,...m}=e,h="".concat(e.name||"tab",".").concat(c),{accessLevel:v}=null!==(n=(null!==(s=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==s?s:[]).find(e=>e.controlId===h))&&void 0!==n?n:{accessLevel:0};if(v===o.A1)return null;let x=d===c;return(0,t.jsx)(l.Z,{role:"tabpanel",hidden:!x,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c),className:"".concat(i().tabPanel," ").concat(x?i().active:i().hidden),...m,children:r})};c.propTypes={children:r().node,index:r().number.isRequired,value:r().number.isRequired},a.Z=c},9522:function(e,a,s){"use strict";s.d(a,{Y:function(){return m}});var t=s(52322),l=s(23925),n=s(54582),r=s(68696),d=s(44258),i=s(2784),o=s(99266),c=s(52614),u=s.n(c);let m=e=>{var a,s,c,m,h;let{tabs:v,activeTab:x,setActiveTab:p,maxAccess:b,name:f="tab"}=e,I=(null==b?void 0:null===(s=b.record)||void 0===s?void 0:null===(a=s.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(f,".")))}).map(e=>e.controlId.split(".")[1]))||[],_=null==v?void 0:null===(c=v.map((e,a)=>({...e,id:a})))||void 0===c?void 0:c.filter((e,a)=>!I.includes(String(a))),C=null===(m=_[x])||void 0===m?void 0:m.id,g=null===(h=_[x])||void 0===h?void 0:h.disabled;return(0,i.useEffect)(()=>{C>=0&&!g&&x!=C&&p(C)},[]),(0,t.jsx)(l.Z,{className:u().tabsContainer,children:(0,t.jsx)(l.Z,{className:u().tabsWrapper,children:(0,t.jsx)(n.Z,{value:x,onChange:(e,a)=>p(a),variant:"scrollable",scrollButtons:_.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==_?void 0:_.map(e=>(0,t.jsx)(r.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,t.jsxs)(l.Z,{display:"flex",alignItems:"center",children:[(0,t.jsx)("span",{children:e.label}),e.id===x&&(null==e?void 0:e.onRefetch)&&(0,t.jsx)(d.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,t.jsx)(o.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[92515,2494,36908,13073,49774,92888,40179],function(){return e(e.s=21758)}),_N_E=e.O()}]);