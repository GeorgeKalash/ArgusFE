(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[13981],{95986:function(e,d,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mf-jo-wizard",function(){return r(92294)}])},92294:function(e,d,r){"use strict";r.r(d),r.d(d,{default:function(){return V}});var l=r(52322),a=r(2784),n=r(62202),i=r(69387),o=r(65950),t=r(71987),s=r(26612),u=r(31389),c=r(33625),v=r(62362),h=r(61802),m=r(19473),p=r(98345),I=r(7121),x=r(90587),g=r(89330),f=r(39812),y=r(60218),b=r(48601),w=r(82737),j=r(8661),k=r(38449),F=r(65215),Z=r(76399),N=r(80983),O=r(27423),C=r(91406),W=r(5088),P=r(21581);function _(e){var d,r,i,h,_,S,V,q,A,R,J,D,z,T,E,L,$,M,U,Q,K,X,G,H,B,Y,ee,ed,er,el,ea,en,ei,eo,et,es,eu,ec,ev,eh,em,ep,eI,ex,eg,ef,ey,eb,ew,ej,ek,eF,eZ,eN,eO,eC,eW,eP,e_,eS,eV,eq,eA,eR,eJ,eD;let{labels:ez,access:eT,recordId:eE}=e,{getRequest:eL,postRequest:e$}=(0,a.useContext)(o.$),{platformLabels:eM}=(0,a.useContext)(m.l),{documentType:eU,maxAccess:eQ,changeDT:eK}=(0,p.H)({functionId:I.J.JobOrderWizard,access:eT,enabled:!eE,objectName:"header"}),eX=(0,t.E)({endpointId:x.u.JobOrderWizard.page}),{formik:eG}=(0,N.c)({maxAccess:eQ,documentType:{key:"header.dtId",value:null==eU?void 0:eU.dtId},initialValues:{recordId:eE,header:{dtId:null,reference:"",recordId:null,jobId:null,bomId:null,workCenterId:null,operationId:null,laborId:null,avgWeight:0,expectedPcs:0,expectedQty:0,pcs:0,qty:0,sfItemId:null,itemId:null,shiftId:null,date:new Date,status:1,notes:"",producedWeight:0},rows:[{id:1,jozId:eE,sku:"",itemName:"",issued:0,returned:0,consumed:0,seqNo:1}]},validationSchema:b.Ry({header:b.Ry({date:b.hT().required(),itemId:b.Rx().required(),sfItemId:b.Rx().required(),expectedQty:b.Rx().required(),jobId:b.Rx().required(),operationId:b.Rx().required(),laborId:b.Rx().required(),pcs:b.Rx().min(.01).nullable(),avgWeight:b.Rx().min(.01).nullable(),producedWeight:b.Rx().min(.01).required()}),rows:b.IX().of(b.Ry().shape({sku:b.Z_().required(),issued:b.Rx().required(),returned:b.Rx().required(),consumed:b.Rx().required()})).required()}),onSubmit:async e=>{let d={header:{...e.header,pcs:parseInt(e.header.pcs),date:(0,f.ku)(e.header.date)},items:eG.values.rows.map((d,r)=>{var l;return{...d,jozId:null!==(l=e.recordId)&&void 0!==l?l:0,seqNo:r+1}})},r=await e$({extension:x.u.JobOrderWizard.set2,record:JSON.stringify(d)});n.ZP.success(e.recordId?eM.Edited:eM.Added),eX(),e2(null==r?void 0:r.recordId)}}),eH=!!eG.values.recordId,eB=3===eG.values.header.status;async function eY(){let e=await e$({extension:x.u.JobOrderWizard.post,record:JSON.stringify({...eG.values.header,date:(0,f.ku)(eG.values.header.date)})});(null==e?void 0:e.recordId)&&(n.ZP.success(eM.Posted),eX(),e2(null==e?void 0:e.recordId))}let e0=[{component:"resourcelookup",label:ez.sku,name:"sku",props:{endpointId:F.$.SFSKU.snapshot,valueField:"sku",displayField:"sku",mapping:[{from:"recordId",to:"itemId"},{from:"sku",to:"sku"},{from:"name",to:"itemName"}],columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"}],displayFieldWidth:3}},{component:"textfield",label:ez.itemName,name:"itemName",props:{readOnly:!0}},{component:"numberfield",name:"issued",label:ez.issued,props:{maxLength:9,decimalScale:3},async onChange(e){let{row:{update:d,newRow:r}}=e;d({consumed:r.issued-r.returned})}},{component:"numberfield",name:"returned",label:ez.returned,async onChange(e){let{row:{update:d,newRow:r}}=e;d({consumed:r.issued-r.returned})},props:{maxLength:9,decimalScale:3}},{component:"numberfield",name:"consumed",label:ez.consumed,props:{readOnly:!0,maxLength:9,decimalScale:3}}],e1=null===(r=eG.values)||void 0===r?void 0:null===(d=r.rows)||void 0===d?void 0:d.reduce((e,d)=>{var r;return e+(parseFloat(null===(r=d.issued)||void 0===r?void 0:r.toString().replace(/,/g,""))||0)},0);async function e2(e){var d,r,l,a,n;let i=await eL({extension:x.u.JobOrderWizard.get2,parameters:"_recordId=".concat(e)});if(null==i?void 0:null===(d=i.record)||void 0===d?void 0:d.header){let e=null==i?void 0:null===(l=i.record)||void 0===l?void 0:null===(r=l.items)||void 0===r?void 0:r.map((e,d)=>({...e,id:d+1}));return eG.setValues({recordId:i.record.header.recordId,header:{...i.record.header,date:(0,f.a1)(null==i?void 0:null===(n=i.record)||void 0===n?void 0:null===(a=n.header)||void 0===a?void 0:a.date),producedWeight:i.record.header.pcs*i.record.header.avgWeight},rows:e}),null==i?void 0:i.record}}async function e9(e){if(e){let d=await eL({extension:F.$.Physical.get,parameters:"_itemId=".concat(e)});return null==d?void 0:d.record}}async function e4(e){if(e){let d=await eL({extension:F.$.ItemProduction.get,parameters:"_recordId=".concat(e)});return null==d?void 0:d.record}}let e3=null===(h=eG.values)||void 0===h?void 0:null===(i=h.rows)||void 0===i?void 0:i.reduce((e,d)=>{var r;return e+(parseFloat(null===(r=d.returned)||void 0===r?void 0:r.toString().replace(/,/g,""))||0)},0),e8=[{key:"Unlocked",condition:!eB,onClick:eY,disabled:!eH},{key:"Locked",condition:eB,onClick:"onUnpostConfirmation",disabled:!0}],e5=null===(S=eG.values)||void 0===S?void 0:null===(_=S.rows)||void 0===_?void 0:_.reduce((e,d)=>{var r;return e+(parseFloat(null===(r=d.consumed)||void 0===r?void 0:r.toString().replace(/,/g,""))||0)},0),e6=eG.values.header.producedWeight-e5;return(0,a.useEffect)(()=>{eE&&e2(eE)},[]),(0,a.useEffect)(()=>{eG.setFieldValue("header.totalSFQty",parseFloat(e6).toFixed(2))},[e6]),(0,l.jsx)(w.Z,{resourceId:s.i.JobOrderWizard,functionId:I.J.JobOrderWizard,form:eG,maxAccess:eQ,editMode:eH,previewReport:eH,actions:e8,disabledSubmit:eB,children:(0,l.jsxs)(u.R,{children:[(0,l.jsx)(c.g,{children:(0,l.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(j.Z,{endpointId:k.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(I.J.JobOrderWizard),name:"header.dtId",readOnly:eH,label:ez.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:eG.values.header,displayFieldWidth:2,maxAccess:eQ,onChange:async(e,d)=>{await eK(d),eG.setFieldValue("header.dtId",(null==d?void 0:d.recordId)||null)},error:(null===(V=eG.touched.header)||void 0===V?void 0:V.dtId)&&!!(null===(q=eG.errors.header)||void 0===q?void 0:q.dtId)})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(W.Z,{name:"header.reference",label:ez.reference,value:null==eG?void 0:null===(R=eG.values)||void 0===R?void 0:null===(A=R.header)||void 0===A?void 0:A.reference,maxAccess:!eH&&eQ,readOnly:eH,onChange:eG.handleChange,onClear:()=>eG.setFieldValue("header.reference",""),error:(null===(J=eG.touched.header)||void 0===J?void 0:J.reference)&&!!(null===(D=eG.errors.header)||void 0===D?void 0:D.reference)})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(g.Z,{name:"header.date",label:ez.date,readOnly:eB,value:null==eG?void 0:null===(z=eG.values)||void 0===z?void 0:z.header.date,onChange:eG.setFieldValue,required:!0,maxAccess:eQ,onClear:()=>eG.setFieldValue("header.date",null),error:(null==eG?void 0:null===(E=eG.touched)||void 0===E?void 0:null===(T=E.header)||void 0===T?void 0:T.date)&&!!(null==eG?void 0:null===($=eG.errors)||void 0===$?void 0:null===(L=$.header)||void 0===L?void 0:L.date)})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(j.Z,{endpointId:x.u.MFJobOrder.qry2,name:"header.jobId",label:ez.jobOrder,values:eG.values.header,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference",width:1},{key:"date",value:"Date",type:"date",width:1},{key:"sku",value:"sku",width:1},{key:"itemName",value:"Item Name",width:2},{key:"productionLineName",value:"Prod Line",width:1}],displayFieldWidth:2.5,required:!0,readOnly:eH,maxAccess:eQ,onChange:async(e,d)=>{eG.setFieldValue("header.jobId",(null==d?void 0:d.recordId)||null),eG.setFieldValue("header.sku",(null==d?void 0:d.sku)||null),eG.setFieldValue("header.itemName",(null==d?void 0:d.itemName)||""),eG.setFieldValue("header.itemId",(null==d?void 0:d.itemId)||null),eG.setFieldValue("header.expectedPcs",(null==d?void 0:d.expectedPcs)||0),eG.setFieldValue("header.avgWeight",(null==d?void 0:d.avgWeight)||0),eG.setFieldValue("header.workCenterName",(null==d?void 0:d.wcName)||""),eG.setFieldValue("header.workCenterId",(null==d?void 0:d.workCenterId)||null),eG.setFieldValue("header.operationId",null),eG.setFieldValue("header.laborId",null);let r=await e9(null==d?void 0:d.itemId);eG.setFieldValue("header.weight",(null==r?void 0:r.weight)||0);let l=await e4(null==d?void 0:d.itemId);eG.setFieldValue("header.bomId",(null==l?void 0:l.bomId)||0),eG.setFieldValue("header.producedWeight",(null==d?void 0:d.avgWeight)*eG.values.header.pcs)},onClear:async(e,d)=>{eG.setFieldValue("header.workCenterName",""),eG.setFieldValue("header.workCenterId",null),eG.setFieldValue("header.operationId",null),eG.setFieldValue("header.laborId",null)},error:(null==eG?void 0:null===(U=eG.touched)||void 0===U?void 0:null===(M=U.header)||void 0===M?void 0:M.jobId)&&!!(null==eG?void 0:null===(K=eG.errors)||void 0===K?void 0:null===(Q=K.header)||void 0===Q?void 0:Q.jobId)})}),(0,l.jsx)(y.ZP,{item:!0,xs:8,children:(0,l.jsx)(O.U,{endpointId:F.$.Item.snapshot,name:"header.itemId",label:ez.sku,valueField:"recordId",displayField:"name",valueShow:"sku",secondValueShow:"itemName",formObject:eG.values.header,readOnly:!0,maxAccess:eQ})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(W.Z,{name:"header.workCenterName",label:ez.workCenter,value:null==eG?void 0:null===(G=eG.values)||void 0===G?void 0:null===(X=G.header)||void 0===X?void 0:X.workCenterName,readOnly:!0})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(j.Z,{endpointId:eG.values.header.workCenterId&&x.u.Operation.qry,parameters:"_workCenterId=".concat(eG.values.header.workCenterId),name:"header.operationId",label:ez.operation,values:eG.values.header,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"reference",width:1},{key:"name",value:"name",width:2}],displayFieldWidth:1.5,required:!0,readOnly:!(null==eG?void 0:null===(B=eG.values)||void 0===B?void 0:null===(H=B.header)||void 0===H?void 0:H.workCenterId)||eH,maxAccess:eQ,onChange:(e,d)=>{eG.setFieldValue("header.operationId",(null==d?void 0:d.recordId)||null)},error:(null==eG?void 0:null===(ee=eG.touched)||void 0===ee?void 0:null===(Y=ee.header)||void 0===Y?void 0:Y.operationId)&&!!(null==eG?void 0:null===(er=eG.errors)||void 0===er?void 0:null===(ed=er.header)||void 0===ed?void 0:ed.operationId)})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(j.Z,{endpointId:eG.values.header.workCenterId&&x.u.Labor.qry2,parameters:"_workCenterId=".concat(eG.values.header.workCenterId),name:"header.laborId",label:ez.labor,values:eG.values.header,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"reference",width:1},{key:"name",value:"name",width:2}],displayFieldWidth:1.5,required:!0,readOnly:!(null==eG?void 0:null===(ea=eG.values)||void 0===ea?void 0:null===(el=ea.header)||void 0===el?void 0:el.workCenterId)||eH,maxAccess:eQ,onChange:(e,d)=>{eG.setFieldValue("header.laborId",(null==d?void 0:d.recordId)||null)},error:(null==eG?void 0:null===(ei=eG.touched)||void 0===ei?void 0:null===(en=ei.header)||void 0===en?void 0:en.laborId)&&!!(null==eG?void 0:null===(et=eG.errors)||void 0===et?void 0:null===(eo=et.header)||void 0===eo?void 0:eo.laborId)})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(C.Z,{name:"header.expectedPcs",label:ez.expectedPcs,value:null==eG?void 0:null===(eu=eG.values)||void 0===eu?void 0:null===(es=eu.header)||void 0===es?void 0:es.expectedPcs,maxAccess:eQ,readOnly:!0})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(C.Z,{name:"header.pcs",label:ez.producedPcs,value:eG.values.header.pcs,onChange:(e,d)=>{eG.setFieldValue("header.producedWeight",d*eG.values.header.avgWeight),eG.setFieldValue("header.pcs",d||0)},onClear:()=>{eG.setFieldValue("header.pcs",0),eG.setFieldValue("header.producedWeight",0)},readOnly:eB,maxLength:9,required:!0,error:(null==eG?void 0:null===(ev=eG.touched)||void 0===ev?void 0:null===(ec=ev.header)||void 0===ec?void 0:ec.pcs)&&!!(null==eG?void 0:null===(em=eG.errors)||void 0===em?void 0:null===(eh=em.header)||void 0===eh?void 0:eh.pcs)})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(C.Z,{name:"header.avgWeight",allowNegative:!1,label:ez.avgWeight,value:null==eG?void 0:null===(ep=eG.values)||void 0===ep?void 0:ep.header.avgWeight,maxAccess:eQ,readOnly:!0,error:(null==eG?void 0:null===(ex=eG.touched)||void 0===ex?void 0:null===(eI=ex.header)||void 0===eI?void 0:eI.avgWeight)&&!!(null==eG?void 0:null===(ef=eG.errors)||void 0===ef?void 0:null===(eg=ef.header)||void 0===eg?void 0:eg.avgWeight)})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(j.Z,{endpointId:eG.values.header.bomId&&x.u.Component.qry,parameters:"_bomId=".concat(eG.values.header.bomId),name:"header.sfItemId",label:ez.semiFinishedItem,values:eG.values.header,valueField:"itemId",displayField:["sku","itemName"],columnsInDropDown:[{key:"sku",value:"sku",width:1},{key:"itemName",value:"Item Name",width:2}],displayFieldWidth:1.5,required:!0,readOnly:!(null==eG?void 0:null===(eb=eG.values)||void 0===eb?void 0:null===(ey=eb.header)||void 0===ey?void 0:ey.bomId)||eH,maxAccess:eQ,onChange:(e,d)=>{eG.setFieldValue("header.sfItemId",(null==d?void 0:d.itemId)||null)},error:(null==eG?void 0:null===(ej=eG.touched)||void 0===ej?void 0:null===(ew=ej.header)||void 0===ew?void 0:ew.sfItemId)&&!!(null==eG?void 0:null===(eF=eG.errors)||void 0===eF?void 0:null===(ek=eF.header)||void 0===ek?void 0:ek.sfItemId)})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(C.Z,{name:"header.producedWeight",label:ez.producedWeight,allowNegative:!1,value:eG.values.header.producedWeight,maxAccess:eQ,readOnly:!0,error:(null==eG?void 0:null===(eN=eG.touched)||void 0===eN?void 0:null===(eZ=eN.header)||void 0===eZ?void 0:eZ.producedWeight)&&!!(null==eG?void 0:null===(eC=eG.errors)||void 0===eC?void 0:null===(eO=eC.header)||void 0===eO?void 0:eO.producedWeight)})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(C.Z,{name:"header.weight",label:ez.weight,value:null==eG?void 0:null===(eP=eG.values)||void 0===eP?void 0:null===(eW=eP.header)||void 0===eW?void 0:eW.weight,maxAccess:eQ,readOnly:!0})}),(0,l.jsx)(y.ZP,{item:!0,xs:4,children:(0,l.jsx)(j.Z,{endpointId:x.u.ProductionShifts.qry,name:"header.shiftId",label:ez.shift,maxAccess:eT,readOnly:eB,valueField:"recordId",displayField:"name",values:null===(e_=eG.values)||void 0===e_?void 0:e_.header,onChange:(e,d)=>{eG.setFieldValue("header.shiftId",(null==d?void 0:d.recordId)||null)},error:(null===(eV=eG.touched)||void 0===eV?void 0:null===(eS=eV.header)||void 0===eS?void 0:eS.shiftId)&&!!(null===(eA=eG.errors)||void 0===eA?void 0:null===(eq=eA.header)||void 0===eq?void 0:eq.shiftId)})})]})}),(0,l.jsx)(v.Q,{children:(0,l.jsx)(Z._,{onChange:e=>eG.setFieldValue("rows",e),value:eG.values.rows,error:eG.errors.rows,name:"rows",maxAccess:eQ,columns:e0,allowAddNewLine:!eB,allowDelete:!eB,disabled:eB})}),(0,l.jsx)(c.g,{children:(0,l.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(y.ZP,{item:!0,xs:6,children:(0,l.jsx)(y.ZP,{container:!0,spacing:2,children:(0,l.jsx)(y.ZP,{item:!0,xs:12,children:(0,l.jsx)(P.Z,{name:"header.notes",label:ez.notes,value:null===(eR=eG.values.header)||void 0===eR?void 0:eR.notes,rows:2.5,maxAccess:eQ,readOnly:eB,onChange:eG.handleChange,onClear:()=>eG.setFieldValue("header.notes",""),error:(null===(eJ=eG.touched.header)||void 0===eJ?void 0:eJ.notes)&&!!(null===(eD=eG.errors.header)||void 0===eD?void 0:eD.notes)})})})}),(0,l.jsx)(y.ZP,{item:!0,xs:3,children:(0,l.jsx)(y.ZP,{container:!0,spacing:2,children:(0,l.jsx)(y.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"header.totalSFQty",label:ez.totalUsedSemiFinished,value:e6,maxAccess:eQ,readOnly:!0})})})}),(0,l.jsx)(y.ZP,{item:!0,xs:3,children:(0,l.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(y.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"header.totalIssued",label:ez.totalIssued,value:e1,readOnly:!0})}),(0,l.jsx)(y.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"header.totalReturned",label:ez.totalReturned,value:e3,maxAccess:eQ,readOnly:!0})}),(0,l.jsx)(y.ZP,{item:!0,xs:12,children:(0,l.jsx)(C.Z,{name:"header.totalConsumed",label:ez.totalConsumed,value:e5,maxAccess:eQ,readOnly:!0})})]})})]})})]})})}var S=r(36908),V=()=>{let{getRequest:e,postRequest:d}=(0,a.useContext)(o.$),{platformLabels:r}=(0,a.useContext)(m.l),{stack:g}=(0,h.zY)();async function f(){let d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:l=50,params:a=[]}=d,n=await e({extension:x.u.JobOrderWizard.page,parameters:"_filter=&_startAt=".concat(r,"&&_pageSize=").concat(l,"&_params=").concat(a)});if(n&&(null==n?void 0:n.list)){var i;n.list=null==n?void 0:null===(i=n.list)||void 0===i?void 0:i.map(e=>({...e,producedWeight:e.pcs*e.avgWeight}))}return{...n,_startAt:r}}async function y(d){let{filters:r,pagination:l}=d,a=null;if(r.qry){if((a=await e({extension:x.u.JobOrderWizard.snapshot,parameters:"_filter=".concat(r.qry)}))&&(null==a?void 0:a.list)){var n;a.list=null==a?void 0:null===(n=a.list)||void 0===n?void 0:n.map(e=>({...e,producedWeight:e.pcs*e.avgWeight}))}}else a=f({_startAt:l._startAt||0,params:null==r?void 0:r.params});return a}let{query:{data:b},filterBy:w,refetch:j,labels:k,access:F,paginationParameters:Z,invalidate:N}=(0,t.J)({queryFn:f,endpointId:x.u.JobOrderWizard.page,datasetId:s.i.JobOrderWizard,filter:{filterFn:y}}),{proxyAction:O}=(0,p.G)({functionId:I.J.JobOrderWizard,action:P}),C=async()=>{await O()},W=[{field:"reference",headerName:k.reference,flex:1},{field:"date",headerName:k.date,flex:1,type:"date"},{field:"jobRef",headerName:k.jobRef,flex:1},{field:"sfItemSku",headerName:k.semiFinishedSku,flex:1},{field:"sfItemName",headerName:k.sfItemName,flex:1},{field:"pcs",headerName:k.producedPcs,flex:1,type:"number"},{field:"producedWeight",headerName:k.producedWeight,flex:1,type:"number"},{field:"statusName",headerName:k.status,flex:1}];function P(e){g({Component:_,props:{labels:k,recordId:e,access:F},width:1e3,height:700,title:k.JobOrderWizard})}let V=async e=>{await d({extension:x.u.JobOrderWizard.del,record:JSON.stringify(e)}),N(),n.ZP.success(r.Deleted)};return(0,l.jsxs)(u.R,{children:[(0,l.jsx)(c.g,{children:(0,l.jsx)(S.Z,{onAdd:C,maxAccess:F,filterBy:w,reportName:"MFJOZ"})}),(0,l.jsx)(v.Q,{children:(0,l.jsx)(i.Z,{name:"table",columns:W,gridData:b,rowId:["recordId"],onEdit:e=>{P(null==e?void 0:e.recordId)},onDelete:V,pageSize:50,paginationType:"api",paginationParameters:Z,refetch:j,maxAccess:F})})]})}},1685:function(e,d,r){"use strict";r.d(d,{m:function(){return l}});let l=e=>{let d=window.sessionStorage.getItem(e);return d?JSON.parse(d):null}},98345:function(e,d,r){"use strict";r.d(d,{H:function(){return p},G:function(){return m}});var l=r(45300),a=r(2784),n=r(96026),i=r(38449);r(26612);var o=r(65947),t=r(1685);let s=async(e,d,r)=>{try{let l=await e({extension:d,parameters:r});return d.includes("qry")?l:l.record}catch(e){return null}},u=(e,d,r,l)=>{let a=(e=JSON.parse(JSON.stringify(e))).record.controls,n=a.find(e=>"reference"===e.controlId);return n?n.accessLevel=(null==d?void 0:d.mandatory)?o.$7:o.rr:(null==d?void 0:d.mandatory)?a.push({sgId:0,resourceId:"",controlId:"".concat(l?l+".":"","reference"),accessLevel:(null==d?void 0:d.mandatory)?o.$7:o.rr}):(null==d?void 0:d.readOnly)?a.push({sgId:0,resourceId:"",controlId:"".concat(l?l+".":"","reference"),accessLevel:(null==d?void 0:d.readOnly)?o.rr:o.$7}):a=e.record.controls.filter(e=>"reference"!=e.controlId),r&&a.push({sgId:0,resourceId:"",controlId:"".concat(l?l+".":"","dtId"),accessLevel:o.$7}),{...e,record:{...e.record,controls:a}}},c=async(e,d,r)=>{let l,a;switch(r){case"dtId":let n=(0,t.m)("userData"),o=null==n?void 0:n.userId;a="_userId=".concat(o,"&_functionId=").concat(d),l=i.r.UserFunction.get;break;case"glbSysNumberRange":a="_recordId=".concat(d),l=i.r.SystemFunction.get;break;case"DocumentType":a="_dgId=".concat(d,"&_startAt=",0,"&_pageSize=",50),l=i.r.DocumentType.qry;break;case"DcTypNumberRange":a="_recordId=".concat(d),l=i.r.DocumentType.get;break;case"isExternal":a="_recordId=".concat(d),l=i.r.NumberRange.get;break;default:return null}return await s(e,l,a)},v=async function(e){let d,r,l,a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,t=!(arguments.length>4)||void 0===arguments[4]||arguments[4],s=arguments.length>5?arguments[5]:void 0,v=void 0===o&&n&&await c(e,n,"dtId"),h=null==v?void 0:v.dtId,m="",p=!0;if(v&&void 0===o||"nraId"===o){if(h){let r=await c(e,h,"DcTypNumberRange");d=null==r?void 0:r.nraId,p=!((null==r?void 0:r.activeStatus)<0),d||(m="Assign the document type to a number range")}if((!h||!p)&&t&&n){var I;let d=await c(e,n,"DocumentType");a=(null==d?void 0:null===(I=d.list)||void 0===I?void 0:I.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===o||void 0===o)&&n){if((!h||h)&&!d||d&&!p){let r=await c(e,n,"glbSysNumberRange");(d=null==r?void 0:r.nraId)&&a&&(a=!1),p=!0}m=d||a?"":"Assign the system Function to a number range"}o>0&&!d&&(d=o),d&&p?(r={readOnly:null==(l=await c(e,d,"isExternal"))||!l.external,mandatory:null!=l&&!!l.external},i&&(i=await u(i,r,a,s))):!d&&i&&(i=await u(i,r,a,s));let x=s?"".concat(s,".reference"):"reference";return{dtId:h,resetReference:null==r?void 0:r.readOnly,dcTypeRequired:a,reference:{fieldName:x,isEmpty:(null==l?void 0:l.external)!==void 0&&(null==l||!l.external)},errorMessage:m,maxAccess:i,selectNraId:o}};var h=r(65950);function m(e){let{functionId:d,action:r,hasDT:l}=e,{getRequest:i}=(0,a.useContext)(h.$),{stack:o}=(0,n.V)();return{proxyAction:async()=>{let e=await v(i,d,"",void 0,l);(null==e?void 0:e.errorMessage)?o({message:null==e?void 0:e.errorMessage}):await r()}}}function p(e){var d;let{functionId:r,access:i,hasDT:o,enabled:t=!0,objectName:s=""}=e,{getRequest:u}=(0,a.useContext)(h.$),{stack:c}=(0,n.V)(),[m,p]=(0,a.useState)(),I=async e=>{let d=await v(u,r,i,e,o,s);if(!d.errorMessage)return d;c({message:null==d?void 0:d.errorMessage})},x=(0,l.a)({retry:!1,staleTime:0,enabled:t,queryKey:[r,m,!!i,t],queryFn:m||"nraId"===m?()=>I(m):()=>I()});return{documentType:x.data,maxAccess:(null==x?void 0:null===(d=x.data)||void 0===d?void 0:d.maxAccess)||i,changeDT(e){p((null==e?void 0:e.nraId)||"nraId")}}}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=95986)}),_N_E=e.O()}]);