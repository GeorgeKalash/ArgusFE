(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[99479],{92120:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/hr-final-sett",function(){return l(64932)}])},64932:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return V}});var n=l(52322),r=l(2784),t=l(62202),o=l(69387),i=l(65950),d=l(71987),s=l(26612),c=l(31389),u=l(33625),m=l(62362),h=l(61802),v=l(19473),x=l(36908),p=l(83562),y=l(60218),f=l(48601),g=l(82737),C=l(5088),N=l(80983),j=l(89330),Z=l(27423),F=l(92407),b=l(21581),D=l(39812),I=l(91406);function P(e){let{labels:a,maxAccess:l,recordId:o}=e,{getRequest:u,postRequest:h}=(0,r.useContext)(i.$),{platformLabels:x}=(0,r.useContext)(v.l),P=(0,d.E)({endpointId:p.m.FinalSettlement.page}),{formik:V}=(0,N.c)({initialValues:{recordId:null,fsRef:"",date:new Date,employeeId:null,indemnity:null,notes:"",esName:"",salary:null,loanBalance:null,serviceDuration:"",employeeRef:"",employeeName:"",hireDate:null,department:"",positionName:""},maxAccess:l,validationSchema:f.Ry({employeeId:f.Rx().required(),date:f.hT().required()}),onSubmit:async e=>{let a=await h({extension:p.m.FinalSettlement.set,record:JSON.stringify(e)});e.recordId||V.setFieldValue("recordId",a.recordId),t.ZP.success(e.recordId?x.Edited:x.Added),P()}}),_=!!V.values.recordId;(0,r.useEffect)(()=>{!async function(){if(o){var e,a,l;let n=await u({extension:p.m.FinalSettlement.get,parameters:"_recordId=".concat(o)});u({extension:F.y.QuickView.get,parameters:"_recordId=".concat(null===(e=n.record)||void 0===e?void 0:e.employeeId,"&_asOfDate=").concat((null===(a=n.record)||void 0===a?void 0:a.date)?(0,D.Uf)((0,D.a1)(null===(l=n.record)||void 0===l?void 0:l.date)):new Date)}).then(e=>{var a,l,r,t,o;V.setValues({...V.values,...n.record,...e.record,hireDate:(0,D.a1)(null==e?void 0:null===(a=e.record)||void 0===a?void 0:a.hireDate),department:null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.departmentName,branch:null==e?void 0:null===(r=e.record)||void 0===r?void 0:r.branchName,date:(0,D.a1)(n.record.date),employeeName:(null==e?void 0:null===(t=e.record)||void 0===t?void 0:t.fullName)||"",employeeRef:(null==e?void 0:null===(o=e.record)||void 0===o?void 0:o.reference)||""})})}}()},[]);let A=async e=>{if(e){var a,l,n;let r=await u({extension:F.y.TerminationEmployee.get,parameters:"_employeeId=".concat(e)});u({extension:F.y.QuickView.get,parameters:"_recordId=".concat(null==r?void 0:null===(a=r.record)||void 0===a?void 0:a.employeeId,"&_asOfDate=").concat((null==r?void 0:null===(l=r.record)||void 0===l?void 0:l.date)?(0,D.Uf)((0,D.a1)(null==r?void 0:null===(n=r.record)||void 0===n?void 0:n.date)):new Date)}).then(a=>{var l,n,r,t,o,i,d;V.setValues({...V.values,...a.record,employeeId:e,hireDate:(0,D.a1)(null==a?void 0:null===(l=a.record)||void 0===l?void 0:l.hireDate),department:null==a?void 0:null===(n=a.record)||void 0===n?void 0:n.departmentName,positionName:null==a?void 0:null===(r=a.record)||void 0===r?void 0:r.positionName,branch:null==a?void 0:null===(t=a.record)||void 0===t?void 0:t.branchName,serviceDuration:null==a?void 0:null===(o=a.record)||void 0===o?void 0:o.serviceDuration,netSalary:null==a?void 0:null===(i=a.record)||void 0===i?void 0:i.salary,employeeRef:null==a?void 0:null===(d=a.record)||void 0===d?void 0:d.reference})})}};return(0,n.jsx)(g.Z,{resourceId:s.i.FinalSettlement,form:V,maxAccess:l,editMode:_,children:(0,n.jsx)(c.R,{children:(0,n.jsx)(m.Q,{children:(0,n.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(y.ZP,{item:!0,xs:6,children:(0,n.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"fsRef",label:a.ref,value:V.values.fsRef,maxAccess:l,maxLength:"10",onChange:V.handleChange,onClear:()=>V.setFieldValue("fsRef",""),error:V.touched.fsRef&&!!V.errors.fsRef})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"employeeRef",label:a.employeeRef,value:V.values.employeeRef,maxAccess:l,readOnly:!0,onChange:V.handleChange,onClear:()=>V.setFieldValue("employeeRef",""),error:V.touched.employeeRef&&!!V.errors.employeeRef})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{name:"date",label:a.day,value:V.values.date,onChange:V.setFieldValue,maxAccess:l,required:!0,onClear:()=>V.setFieldValue("date",null),error:V.touched.date&&!!V.errors.date})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(Z.U,{endpointId:F.y.Employee.snapshot,filter:{activeStatus:-1},parameters:{_branchId:0},form:V,maxAccess:l,valueField:"fullName",displayField:"fullName",name:"employeeName",label:a.employee,secondDisplayField:!1,required:!0,onChange:async(e,a)=>{await A(null==a?void 0:a.recordId),V.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},error:V.touched.employeeId&&!!V.errors.employeeId})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"nationalityName",label:a.nationality,value:V.values.nationalityName,maxAccess:l,readOnly:!0,onChange:V.handleChange,onClear:()=>V.setFieldValue("nationalityName",""),error:V.touched.nationalityName&&!!V.errors.nationalityName})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"branch",label:a.branch,value:V.values.branch,maxAccess:l,readOnly:!0,onChange:V.handleChange,onClear:()=>V.setFieldValue("branch",""),error:V.touched.branch&&!!V.errors.branch})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"department",label:a.department,value:V.values.department,maxAccess:l,readOnly:!0,onChange:V.handleChange,onClear:()=>V.setFieldValue("department",""),error:V.touched.department&&!!V.errors.department})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"positionName",label:a.position,value:V.values.positionName,maxAccess:l,readOnly:!0,onChange:V.handleChange,onClear:()=>V.setFieldValue("positionName",""),error:V.touched.positionName&&!!V.errors.positionName})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{name:"hireDate",label:a.hireDate,value:V.values.hireDate,onChange:V.setFieldValue,maxAccess:l,readOnly:!0,onClear:()=>V.setFieldValue("hireDate",null),error:V.touched.hireDate&&!!V.errors.hireDate})})]})}),(0,n.jsx)(y.ZP,{item:!0,xs:6,children:(0,n.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.Z,{name:"notes",label:a.notes,value:V.values.notes,rows:2.5,maxAccess:l,onChange:e=>V.setFieldValue("notes",e.target.value),onClear:()=>V.setFieldValue("notes",""),error:V.touched.notes&&!!V.errors.notes})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"esName",label:a.employmentStatus,value:V.values.esName,maxAccess:l,readOnly:!0,onChange:V.handleChange,onClear:()=>V.setFieldValue("esName",""),error:V.touched.esName&&!!V.errors.esName})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{name:"loanBalance",label:a.loanBalance,value:V.values.loanBalance,onChange:V.handleChange,onClear:()=>V.setFieldValue("loanBalance",""),readOnly:!0})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"divisionName",label:a.division,value:V.values.divisionName,maxAccess:l,readOnly:!0,onChange:V.handleChange,onClear:()=>V.setFieldValue("divisionName",""),error:V.touched.divisionName&&!!V.errors.divisionName})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"reportToName",label:a.manager,value:V.values.reportToName,maxAccess:l,readOnly:!0,onChange:V.handleChange,onClear:()=>V.setFieldValue("reportToName",""),error:V.touched.reportToName&&!!V.errors.reportToName})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{name:"indemnity",label:a.indemnity,value:V.values.indemnity,onChange:V.handleChange,onClear:()=>V.setFieldValue("indemnity",null),readOnly:!0})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{name:"salary",label:a.salary,value:V.values.salary,onChange:V.handleChange,onClear:()=>V.setFieldValue("salary",null),readOnly:!0})}),(0,n.jsx)(y.ZP,{item:!0,xs:12,children:(0,n.jsx)(C.Z,{name:"serviceDuration",label:a.serviceDuration,value:V.values.serviceDuration,maxAccess:l,readOnly:!0,onChange:V.handleChange,onClear:()=>V.setFieldValue("serviceDuration",""),error:V.touched.serviceDuration&&!!V.errors.serviceDuration})})]})})]})})})})}var V=()=>{let{getRequest:e,postRequest:a}=(0,r.useContext)(i.$),{platformLabels:l}=(0,r.useContext)(v.l),{stack:y}=(0,h.zY)();async function f(){var a;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0,_pageSize:r=50,params:t}=l,o=await e({extension:p.m.FinalSettlement.page,parameters:"_startAt=".concat(n,"&_pageSize=").concat(r,"&_params=").concat(t||"")});return o.list=null==o?void 0:null===(a=o.list)||void 0===a?void 0:a.map(e=>{var a;return{...e,employeeName:(null==e?void 0:null===(a=e.employee)||void 0===a?void 0:a.parent.fullName)||""}}),{...o,_startAt:n}}let{query:{data:g},labels:C,paginationParameters:N,refetch:j,access:Z,invalidate:F,filterBy:b}=(0,d.J)({queryFn:f,endpointId:p.m.FinalSettlement.page,datasetId:s.i.FinalSettlement,filter:{filterFn:I}}),D=[{field:"fsRef",headerName:C.ref,flex:1},{field:"employeeName",headerName:C.employee,flex:1},{field:"date",headerName:C.date,flex:1,type:"date"}];async function I(a){let{filters:l,pagination:n}=a;return(null==l?void 0:l.qry)?await e({extension:p.m.FinalSettlement.snapshot,parameters:"_filter=".concat(l.qry)}):f({_startAt:n._startAt||0,params:null==l?void 0:l.params})}function V(e){y({Component:P,props:{labels:C,recordId:e,maxAccess:Z},width:700,height:600,title:C.finalSettlement})}let _=async e=>{await a({extension:p.m.FinalSettlement.del,record:JSON.stringify(e)}),F(),t.ZP.success(l.Deleted)};return(0,n.jsxs)(c.R,{children:[(0,n.jsx)(u.g,{children:(0,n.jsx)(x.Z,{labels:C,maxAccess:Z,filterBy:b,onAdd:()=>{V()},reportName:"PYFS"})}),(0,n.jsx)(m.Q,{children:(0,n.jsx)(o.Z,{name:"table",columns:D,gridData:g,rowId:["recordId"],onEdit:e=>{V(null==e?void 0:e.recordId)},onDelete:_,pageSize:50,paginationType:"api",paginationParameters:N,refetch:j,maxAccess:Z})})]})}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=92120)}),_N_E=e.O()}]);