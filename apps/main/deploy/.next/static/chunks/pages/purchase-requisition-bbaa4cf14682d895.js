(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90143],{11938:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/purchase-requisition",function(){return r(92314)}])},92314:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var a=r(52322),n=r(2784),o=r(71987),i=r(65950),c=r(69387),l=r(62202),d=r(61802),s=r(26612),u=r(31389),f=r(33625),m=r(62362),p=r(19473),h=r(98345),v=r(7121),y=r(36908),g=r(40300),I=r(2454);function x(){let{postRequest:e,getRequest:t}=(0,n.useContext)(i.$),{platformLabels:r}=(0,n.useContext)(p.l),{stack:x}=(0,d.zY)(),{query:{data:w},filterBy:b,refetch:N,labels:_,access:k,paginationParameters:S,invalidate:E}=(0,o.J)({queryFn:F,endpointId:I.y.PurchaseRequisition.page,datasetId:s.i.PurchaseRequisition,filter:{filterFn:R}}),q=[{field:"reference",headerName:_.reference,flex:1},{field:"date",headerName:_.date,flex:1,type:"date"},{field:"deliveryDate",headerName:_.deliveryDate,flex:1,type:"date"},{field:"departmentName",headerName:_.department,flex:1},{field:"notes",headerName:_.notes,flex:1},{field:"statusName",headerName:_.status,flex:1},{field:"rsName",headerName:_.releaseStatus,flex:1},{field:"wipName",headerName:_.wip,flex:1}];async function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:a=50,params:n=[]}=e;return{...await t({extension:I.y.PurchaseRequisition.page,parameters:"_startAt=".concat(r,"&_pageSize=").concat(a,"&_sortBy=recordId desc&_params=").concat(n,"&filter=")}),_startAt:r}}async function R(e){let{filters:r,pagination:a}=e;return r.qry?await t({extension:I.y.PurchaseRequisition.snapshot,parameters:"_filter=".concat(r.qry)}):F({_startAt:a._startAt||0,params:null==r?void 0:r.params})}let{proxyAction:A}=(0,h.G)({functionId:v.J.PurchaseRequisition,action:T}),D=async()=>{await A()};async function T(e){x({Component:g.Z,props:{recordId:e}})}let j=async t=>{await e({extension:I.y.PurchaseRequisition.del,record:JSON.stringify(t)}),E(),l.ZP.success(r.Deleted)};return(0,a.jsxs)(u.R,{children:[(0,a.jsx)(f.g,{children:(0,a.jsx)(y.Z,{onAdd:D,maxAccess:k,reportName:"PUREQ",filterBy:b})}),(0,a.jsx)(m.Q,{children:(0,a.jsx)(c.Z,{name:"table",columns:q,gridData:w,rowId:["recordId"],onEdit:e=>{T(null==e?void 0:e.recordId)},refetch:N,onDelete:j,deleteConfirmationType:"strict",pageSize:50,maxAccess:k,paginationParameters:S,paginationType:"api"})})]})}},1685:function(e,t,r){"use strict";r.d(t,{m:function(){return a}});let a=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,r){"use strict";r.d(t,{H:function(){return h},G:function(){return p}});var a=r(45300),n=r(2784),o=r(96026),i=r(38449);r(26612);var c=r(65947),l=r(1685);let d=async(e,t,r)=>{try{let a=await e({extension:t,parameters:r});return t.includes("qry")?a:a.record}catch(e){return null}},s=(e,t,r,a)=>{let n=(e=JSON.parse(JSON.stringify(e))).record.controls,o=n.find(e=>"reference"===e.controlId);return o?o.accessLevel=(null==t?void 0:t.mandatory)?c.$7:c.rr:(null==t?void 0:t.mandatory)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?c.$7:c.rr}):(null==t?void 0:t.readOnly)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?c.rr:c.$7}):n=e.record.controls.filter(e=>"reference"!=e.controlId),r&&n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","dtId"),accessLevel:c.$7}),{...e,record:{...e.record,controls:n}}},u=async(e,t,r)=>{let a,n;switch(r){case"dtId":let o=(0,l.m)("userData"),c=null==o?void 0:o.userId;n="_userId=".concat(c,"&_functionId=").concat(t),a=i.r.UserFunction.get;break;case"glbSysNumberRange":n="_recordId=".concat(t),a=i.r.SystemFunction.get;break;case"DocumentType":n="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),a=i.r.DocumentType.qry;break;case"DcTypNumberRange":n="_recordId=".concat(t),a=i.r.DocumentType.get;break;case"isExternal":n="_recordId=".concat(t),a=i.r.NumberRange.get;break;default:return null}return await d(e,a,n)},f=async function(e){let t,r,a,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,l=!(arguments.length>4)||void 0===arguments[4]||arguments[4],d=arguments.length>5?arguments[5]:void 0,f=void 0===c&&o&&await u(e,o,"dtId"),m=null==f?void 0:f.dtId,p="",h=!0;if(f&&void 0===c||"nraId"===c){if(m){let r=await u(e,m,"DcTypNumberRange");t=null==r?void 0:r.nraId,h=!((null==r?void 0:r.activeStatus)<0),t||(p="Assign the document type to a number range")}if((!m||!h)&&l&&o){var v;let t=await u(e,o,"DocumentType");n=(null==t?void 0:null===(v=t.list)||void 0===v?void 0:v.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===c||void 0===c)&&o){if((!m||m)&&!t||t&&!h){let r=await u(e,o,"glbSysNumberRange");(t=null==r?void 0:r.nraId)&&n&&(n=!1),h=!0}p=t||n?"":"Assign the system Function to a number range"}c>0&&!t&&(t=c),t&&h?(r={readOnly:null==(a=await u(e,t,"isExternal"))||!a.external,mandatory:null!=a&&!!a.external},i&&(i=await s(i,r,n,d))):!t&&i&&(i=await s(i,r,n,d));let y=d?"".concat(d,".reference"):"reference";return{dtId:m,resetReference:null==r?void 0:r.readOnly,dcTypeRequired:n,reference:{fieldName:y,isEmpty:(null==a?void 0:a.external)!==void 0&&(null==a||!a.external)},errorMessage:p,maxAccess:i,selectNraId:c}};var m=r(65950);function p(e){let{functionId:t,action:r,hasDT:a}=e,{getRequest:i}=(0,n.useContext)(m.$),{stack:c}=(0,o.V)();return{proxyAction:async()=>{let e=await f(i,t,"",void 0,a);(null==e?void 0:e.errorMessage)?c({message:null==e?void 0:e.errorMessage}):await r()}}}function h(e){var t;let{functionId:r,access:i,hasDT:c,enabled:l=!0,objectName:d=""}=e,{getRequest:s}=(0,n.useContext)(m.$),{stack:u}=(0,o.V)(),[p,h]=(0,n.useState)(),v=async e=>{let t=await f(s,r,i,e,c,d);if(!t.errorMessage)return t;u({message:null==t?void 0:t.errorMessage})},y=(0,a.a)({retry:!1,staleTime:0,enabled:l,queryKey:[r,p,!!i,l],queryFn:p||"nraId"===p?()=>v(p):()=>v()});return{documentType:y.data,maxAccess:(null==y?void 0:null===(t=y.data)||void 0===t?void 0:t.maxAccess)||i,changeDT(e){h((null==e?void 0:e.nraId)||"nraId")}}}},39704:function(e,t,r){"use strict";var a=r(52322),n=r(2784),o=r(22341),i=r(65950),c=r(85325),l=r(21326),d=r(19473),s=r(35656),u=r(24868),f=r.n(u);let m=e=>{let{functionId:t,recordId:r,window:u}=e,{getRequest:m}=(0,n.useContext)(i.$),{languageId:p}=(0,n.useContext)(c.V),{platformLabels:h}=(0,n.useContext)(d.l),v=r+"-"+t;(0,l.Z)({title:h.WorkFlow,window:u});let{width:y}=(0,s.d)(),g=y<=1024,I=y>1024&&y<=1280,x=g?10:I?12:14,w=g?75:I?85:95,b=g?15:I?20:25,N=async()=>{var e="_functionId=".concat(t,"&_recordId=").concat(r);let a=await m({extension:o.P.WorkFlow.graph,parameters:e});return null==a?void 0:a.record},_=e=>{let t=[],r=[],a="",n="";return e.objects.forEach(e=>{t.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(t=>{e.objects.forEach(e=>{let r=e.functionName.split(" ").join("\r\n");t.parentId===e.recordId&&t.parentFunctionId===e.functionId&&(a=e.reference+"\r\n"+e.date+"\r\n"+r,t.parentId),t.childId===e.recordId&&t.childFunctionId===e.functionId&&(n=e.reference+"\r\n"+e.date+"\r\n"+r,t.childId)}),""===a||""===n||r.push({from:a,to:n,value:1,labelText:""}),a="",n=""}),r};return(0,n.useEffect)(()=>{!async function(){var e=await N();if(e){let t=(e,t)=>{let r=document.createElement("script");r.type="text/javascript",r.src=e,r.async=!0,r.onload=t,document.head.appendChild(r)};t("https://cdn.amcharts.com/lib/4/core.js",()=>{t("https://cdn.amcharts.com/lib/4/charts.js",()=>{t("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let t=am4core.create(v,am4charts.SankeyDiagram),r=_(e);t.data=r,t.dataFields.fromName="from",t.dataFields.toName="to",t.dataFields.value="value",t.paddingRight=2===p?0:40,t.paddingLeft=2===p?40:0,t.tooltip.label.fontSize=x;let a=t.nodes.template;a.draggable=!1,a.inert=!0,a.clickable=!1,a.width=w,a.height=b,a.nameLabel.label.fontSize=x,a.nameLabel.locationX=2===p?.85:0,a.nameLabel.height=void 0,a.nameLabel.label.fontWeight="bold";let n=t.links.template;n.middleLine.strokeOpacity=.3,n.middleLine.stroke=am4core.color("#555"),n.middleLine.strokeWidth=5,n.middleLine.hoverable=!1,n.fillOpacity=0,n.hoverable=!0,n.hoverOnFocus=!0,n.fill=am4core.color("#A8C686"),n.isHover=!0,t.appear(1e3,100)})})})})}}()},[]),(0,a.jsx)("div",{id:v,className:f().root})};m.width=950,t.Z=m},24868:function(e){e.exports={root:"WorkFlow_root__EINm1"}}},function(e){e.O(0,[92515,2494,36908,40300,49774,92888,40179],function(){return e(e.s=11938)}),_N_E=e.O()}]);