(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[58992],{45405:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/financial-statements",function(){return n(55445)}])},55445:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var l=n(52322),a=n(2784),i=n(62202),r=n(69387),o=n(65950),s=n(26045),d=n(71987),u=n(26612),c=n(29326),m=n(60218),v=n(48601),p=n(82737),f=n(5088),x=n(19473),h=n(31389),g=n(62362),b=n(19689),I=n(8661),y=n(95982),N=n(96026),w=n(80983);function C(e){var t,n,r,c,C;let{node:S,initialData:j,labels:F,maxAccess:A,setRecId:_,mainRecordId:R,onImportData:Z}=e,{getRequest:k,postRequest:q}=(0,a.useContext)(o.$),{platformLabels:T}=(0,a.useContext)(x.l),{stack:V}=(0,N.V)(),P=!!R,L=(0,d.E)({endpointId:s.U.FinancialStatement.page}),{formik:E}=(0,w.c)({maxAccess:A,initialValues:{recordId:null,name:"",showMetalCurrencyAmount:!1,showFiatCurrencyAmount:!1,showBaseAmount:!1,sgId:null,isConfidential:!1,showCurrentRateBaseAmount:!1},validationSchema:v.Ry({name:v.Z_().required(),sgId:v.Rx().nullable().test("sgId-required-if-confidential","sgId is required when confidential",function(e){let{isConfidential:t}=this.parent;return!(t&&!e)})}),onSubmit:async e=>{if(!e.showBaseAmount&&!e.showMetalCurrencyAmount&&!e.showFiatCurrencyAmount&&!e.showCurrentRateBaseAmount){V({message:F.checkBoxesError});return}let t=await q({extension:s.U.FinancialStatement.set,record:JSON.stringify(e)});e.recordId||(E.setFieldValue("recordId",t.recordId),_(t.recordId)),i.ZP.success(e.recordId?T.Edited:T.Added),L()}});(0,a.useEffect)(()=>{j&&Object.keys(j).length>0&&E.setValues(j)},[j]);let M=async()=>{let e=await k({extension:s.U.FinancialStatement.get2,parameters:"_recordId=".concat(R)});if(e.record){let t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),l=document.createElement("a");l.href=n,l.download="financial_statement_".concat(R,".json"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(n)}},B=async()=>{let e=document.createElement("input");e.type="file",e.accept=".json",e.style.display="none",e.onchange=async e=>{let t=e.target.files[0];if(!t)return;let n=JSON.parse(await t.text()).record;if(!(null==n?void 0:n.fs))return;let l=structuredClone(n),a=R||E.values.recordId;if(!a)return;l.fs.recordId=a,Array.isArray(l.nodes)&&(l.nodes=l.nodes.map(e=>({...e,fsId:a}))),Array.isArray(l.titles)&&(l.titles=l.titles.map(e=>({...e,fsId:a}))),Array.isArray(l.ledgers)&&(l.ledgers=l.ledgers.map(e=>({...e,fsId:a}))),Z&&Z(l),S.current.viewNodeId=null,S.current.viewNodeRef="",S.current.viewNodedesc="";let i=await q({extension:s.U.FinancialStatement.set2,record:JSON.stringify(l)});(null==i?void 0:i.recordId)&&(E.setFieldValue("recordId",i.recordId),_(i.recordId)),L()},document.body.appendChild(e),e.click(),document.body.removeChild(e)};return(0,l.jsx)(p.Z,{resourceId:u.i.FinancialStatements,form:E,maxAccess:A,editMode:P,actions:[{key:"Export",condition:!0,onClick:M,disabled:!P},{key:"Import",condition:!0,onClick:B,disabled:!P}],children:(0,l.jsx)(h.R,{children:(0,l.jsx)(g.Q,{children:(0,l.jsxs)(m.ZP,{container:!0,spacing:2,children:[(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(f.Z,{name:"name",label:F.name,value:E.values.name,maxLength:"50",required:!0,maxAccess:A,onChange:E.handleChange,onClear:()=>E.setFieldValue("name",""),error:E.touched.name&&!!E.errors.name})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"isConfidential",value:null===(t=E.values)||void 0===t?void 0:t.isConfidential,onChange:e=>{E.setFieldValue("sgId",null),E.setFieldValue("isConfidential",e.target.checked)},label:F.isConfidential,maxAccess:A})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(I.Z,{endpointId:y.y.SecurityGroup.qry,parameters:"_startAt=0&_pageSize=1000&filter=",name:"sgId",label:F.securityGrp,values:E.values,valueField:"recordId",displayField:"name",maxAccess:A,onChange:(e,t)=>{E.setFieldValue("sgId",(null==t?void 0:t.recordId)||null)},required:E.values.isConfidential,readOnly:!E.values.isConfidential,error:E.touched.sgId&&!!E.errors.sgId})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"showBaseAmount",value:null===(n=E.values)||void 0===n?void 0:n.showBaseAmount,onChange:e=>E.setFieldValue("showBaseAmount",e.target.checked),label:F.showBaseAmount,maxAccess:A})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"showMetalCurrencyAmount",value:null===(r=E.values)||void 0===r?void 0:r.showMetalCurrencyAmount,onChange:e=>E.setFieldValue("showMetalCurrencyAmount",e.target.checked),label:F.showMetalCurrencyAmount,maxAccess:A})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"showFiatCurrencyAmount",value:null===(c=E.values)||void 0===c?void 0:c.showFiatCurrencyAmount,onChange:e=>E.setFieldValue("showFiatCurrencyAmount",e.target.checked),label:F.showFiatCurrencyAmount,maxAccess:A})}),(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsx)(b.Z,{name:"showCurrentRateBaseAmount",value:null===(C=E.values)||void 0===C?void 0:C.showCurrentRateBaseAmount,onChange:e=>E.setFieldValue("showCurrentRateBaseAmount",e.target.checked),label:F.showCurrentRateBaseAmount,maxAccess:A})})]})})})})}var S=n(61802),j=n(76399),F=n(54074),A=n(84100),_=n(80968);function R(e){let{nodeForm:t,labels:n,maxAccess:i,window:o,updateNodeFlags:s}=e,{getAllKvsByDataset:d}=(0,a.useContext)(_.k),[u,c]=(0,a.useState)([]);async function m(){return new Promise((e,t)=>{d({_dataset:A.v.GLFS_FLAGS,callback:n=>{n?e(n):t()}})})}let v=[{field:"isChecked",headerName:"",type:"checkbox",editable:!0},{field:"value",headerName:n.name,flex:1}],p=()=>{let e=function(e){let t=0;for(let n=0;n<e.length;n++)t+=(e[n]?1:0)*Math.pow(2,n);return t}(null==u?void 0:u.map(e=>{var t;return null!==(t=e.isChecked)&&void 0!==t&&t}));s(null==t?void 0:t.seqNo,e),o.close()};return(0,a.useEffect)(()=>{!async function(){let e=await m(),n=function(e,t){let n=[];for(;e>0;){let t=e%2;e=Math.floor(e/2),n.push(!!t)}for(;n.length<t;)n.push(!1);return n.reverse(),n}(null==t?void 0:t.flags,e.length);c(e.map((e,t)=>({isChecked:n[t]||!1,key:e.key,value:e.value})))}()},[]),(0,l.jsx)(F.Z,{onSave:p,actions:[{key:"Ok",condition:!0,onClick:()=>p()}],maxAccess:i,isSaved:!1,isParentWindow:!1,children:(0,l.jsx)(h.R,{children:(0,l.jsx)(g.Q,{children:(0,l.jsx)(r.Z,{name:"flagsTable",columns:v,gridData:{list:u},rowId:["key"],maxAccess:i,pagination:!1})})})})}var Z=n(38449),k=n(85325),q=e=>{var t,n,i;let{labels:r,maxAccess:s,node:d,mainRecordId:u,onOk:c,window:m,initialData:v=[]}=e,{getRequest:p}=(0,a.useContext)(o.$),{user:f}=(0,a.useContext)(k.V),{formik:x}=(0,w.c)({maxAccess:s,initialValues:{titles:[]}}),b=[{component:"textfield",label:r.language,name:"languageName",props:{readOnly:!0}},{component:"textfield",label:r.title,name:"title",props:{maxLength:50}}];async function I(){var e,t,n,l,a;if(!(null==d?void 0:null===(e=d.current)||void 0===e?void 0:e.viewNodeId))return;let i=await p({extension:Z.r.KeyValueStore,parameters:"_dataset=".concat(A.v.LANGUAGE,"&_language=").concat(f.languageId)}),r=null==d?void 0:null===(t=d.current)||void 0===t?void 0:t.viewNodeId,o=(null!=v?v:[]).find(e=>Number(e.seqNo)===Number(r)),s=null!==(l=null==o?void 0:o.titles)&&void 0!==l?l:[],c=null!==(a=null==i?void 0:null===(n=i.list)||void 0===n?void 0:n.map((e,t)=>{var n;let l=s.find(t=>{var n;return(null===(n=t.languageId)||void 0===n?void 0:n.toString())===e.key});return{id:t+1,languageId:parseInt(e.key,10),languageName:e.value,title:null!==(n=null==l?void 0:l.title)&&void 0!==n?n:"",fsId:u,seqNo:r}}).filter(Boolean))&&void 0!==a?a:[];x.setFieldValue("titles",c)}(0,a.useEffect)(()=>{I()},[null==d?void 0:null===(t=d.current)||void 0===t?void 0:t.viewNodeId,v.length]);let y=()=>{var e;let t=(null!==(e=x.values.titles)&&void 0!==e?e:[]).map(e=>{var t;return{...e,seqNo:null==d?void 0:null===(t=d.current)||void 0===t?void 0:t.viewNodeId,fsId:u}});c&&c(t),m.close()},N=[{key:"Ok",condition:!0,onClick:y,disabled:!1}];return(0,l.jsx)(F.Z,{onSave:y,maxAccess:s,isParentWindow:!1,actions:N,isSaved:!1,children:(0,l.jsx)(h.R,{children:(0,l.jsx)(g.Q,{children:(0,l.jsx)(j._,{name:"nodeTitleTable",onChange:e=>x.setFieldValue("titles",e),value:null==x?void 0:null===(n=x.values)||void 0===n?void 0:n.titles,error:null==x?void 0:null===(i=x.errors)||void 0===i?void 0:i.titles,maxAccess:s,columns:b,allowDelete:!1,allowAddNewLine:!1})})})})},T=n(67920),V=e=>{var t,n;let{node:r,mainRecordId:d,labels:u,maxAccess:c,fetchData:m,initialData:p}=e,{postRequest:f}=(0,a.useContext)(o.$),{stack:b}=(0,S.zY)(),{platformLabels:I}=(0,a.useContext)(x.l),y=(0,a.useRef)([]),N=(e,t)=>{Z.setFieldValue("items",Z.values.items.map(n=>n.seqNo===e?{...n,flags:t}:n))},{schema:C,requiredFields:_}=(0,T.m)({reference:e=>(null==e?void 0:e.reference)!=null,displayOrder:e=>(null==e?void 0:e.displayOrder)!=null,numberFormat:e=>(null==e?void 0:e.numberFormat)!=null,amountSource:e=>(null==e?void 0:e.amountSource)!=null},!0,c,"data"),{formik:Z}=(0,w.c)({conditionSchema:["items"],maxAccess:c,initialValues:{fsId:d,items:[{id:1,fsId:d||0,reference:"",parentSeqNo:null,numberFormat:null,displayOrder:null,description:"",flag:!0,seqNo:null,flags:0}],titles:null!==(n=null==p?void 0:p.titles)&&void 0!==n?n:[]},validationSchema:v.Ry({items:v.IX().of(C)}),onSubmit:async e=>{var t,n,l,a,o;let u=null!==(a=null===(t=e.items)||void 0===t?void 0:t.filter(e=>{var t;return null===(t=Object.values(_))||void 0===t?void 0:t.every(t=>t(e))}).map(e=>({...e,fsId:d})))&&void 0!==a?a:[],c=u.map(e=>e.seqNo),v=null!==(o=null===(l=e.titles)||void 0===l?void 0:null===(n=l.filter(e=>{var t;return c.includes(e.seqNo)&&!!e.languageId&&(null===(t=e.title)||void 0===t?void 0:t.trim())}))||void 0===n?void 0:n.map(e=>({...e,fsId:d})))&&void 0!==o?o:[];await f({extension:s.U.Node.set2,record:JSON.stringify({fsId:d,items:u,titles:v})});let p=u.find(e=>{var t;return Number(e.seqNo)===Number(null===(t=r.current)||void 0===t?void 0:t.viewNodeId)});p&&(r.current.viewNodeRef=p.reference||"",r.current.viewNodedesc=p.description||""),i.ZP.success(I.Edited),P(await m())}}),k=e=>{var t;let n=[...null!==(t=Z.values.titles)&&void 0!==t?t:[]].filter(e=>{var t;return e.seqNo!==(null===(t=r.current)||void 0===t?void 0:t.viewNodeId)}),l=e.filter(e=>!!e.languageId),a=[...n,...l];Z.setFieldValue("titles",a),Z.setFieldValue("items",Z.values.items.map(e=>{var t;return e.seqNo==(null===(t=r.current)||void 0===t?void 0:t.viewNodeId)?{...e,titles:l}:e}))},V=[{component:"textfield",label:u.reference,name:"reference",props:{maxLength:10},flex:1},{component:"resourcecombobox",label:u.parent,name:"parentSeqNo",props:{store:null==y?void 0:y.current,valueField:"seqNo",displayField:"reference",mapping:[{from:"seqNo",to:"parentSeqNo"},{from:"reference",to:"parentRef"}],displayFieldWidth:2,refresh:!1},propsReducer(e){let{row:t,props:n}=e;return{...n,store:y.current.filter(e=>e.seqNo!=(null==t?void 0:t.seqNo))}},flex:1},{component:"resourcecombobox",label:u.format,name:"numberFormat",props:{datasetId:A.v.GLFS_NB_FORMAT,valueField:"key",displayField:"value",mapping:[{from:"key",to:"numberFormat"},{from:"value",to:"numberFormatName"}],displayFieldWidth:2},flex:2},{component:"resourcecombobox",label:u.amount,name:"amountSource",props:{datasetId:A.v.GLFS_SIGN,valueField:"key",displayField:"value",mapping:[{from:"key",to:"amountSource"},{from:"value",to:"amountSourceName"}],displayFieldWidth:2},flex:2},{component:"numberfield",label:u.order,name:"displayOrder",props:{allowNegative:!1,maxLength:4,decimalScale:0},flex:1},{component:"textfield",label:u.description,name:"description",props:{maxLength:40}},{component:"button",name:"flag",flex:.75,label:u.flag,onClick:(e,t)=>{b({Component:R,props:{nodeForm:t,labels:u,maxAccess:c,updateNodeFlags:N},width:700,title:u.flags})}},{component:"button",name:"nodeTitle",flex:.75,label:u.title,onClick:()=>{b({Component:q,props:{node:r,labels:u,maxAccess:c,mainRecordId:d,initialData:Z.values.items,onOk:k},width:700,title:u.nodesTitle})}}],P=e=>{var t;Z.setValues({...Z.values,fsId:d,items:e.nodes.length>0?e.nodes.map((t,n)=>{var l,a,i;return{id:n+1,titles:null!==(i=null===(a=e.titles)||void 0===a?void 0:null===(l=a.filter(e=>e.seqNo===t.seqNo))||void 0===l?void 0:l.map(e=>({languageId:e.languageId,title:e.title})))&&void 0!==i?i:[],...t}}):Z.initialValues.items,titles:null!==(t=e.titles)&&void 0!==t?t:[]})};return(0,a.useEffect)(()=>{var e,t,n;d&&(null==p||null===(e=p.nodes)||void 0===e||!e.length||(null==Z?void 0:null===(n=Z.values)||void 0===n?void 0:null===(t=n.items[0])||void 0===t?void 0:t.reference)||(y.current=p.nodes.map((e,t)=>{var n;return{...e,id:null!==(n=e.seqNo)&&void 0!==n?n:t+1}})),P(p))},[null==p?void 0:p.nodes]),(0,l.jsx)(F.Z,{onSave:Z.handleSubmit,maxAccess:c,children:(0,l.jsx)(h.R,{children:(0,l.jsx)(g.Q,{children:(0,l.jsx)(j._,{name:"items",onChange:(e,t)=>{"delete"===t&&(r.current.viewNodeId=null,r.current.viewNodeRef="",r.current.viewNodedesc="");let n=e.map(t=>{var n;return{...t,seqNo:null!==(n=t.seqNo)&&void 0!==n?n:((null==e?void 0:e.length)?Math.max(...e.map(e=>e.seqNo)):0)+1}});y.current=n,Z.setFieldValue("items",n)},value:Z.values.items,error:Z.errors.items,columns:V,maxAccess:c,initialValues:null===(t=Z.initialValues.items)||void 0===t?void 0:t[0],onSelectionChange:e=>{r.current.viewNodeId=(null==e?void 0:e.seqNo)||null,r.current.viewNodeRef=(null==e?void 0:e.reference)||"",r.current.viewNodedesc=(null==e?void 0:e.description)||""},isDeleteDisabled:e=>{var t;return null===(t=Z.values.items)||void 0===t?void 0:t.find(t=>(null==t?void 0:t.parentSeqNo)==(null==e?void 0:e.seqNo))}})})})})},P=e=>{let{node:t,labels:n,maxAccess:r,mainRecordId:d,initialData:u,fetchData:c}=e,{viewNodeId:m,viewNodeRef:p,viewNodedesc:b}=(null==t?void 0:t.current)||{},I=null==u?void 0:u.ledgers,{postRequest:y}=(0,a.useContext)(o.$),{platformLabels:C}=(0,a.useContext)(x.l),S=(0,a.useRef)(m||null),{stack:A}=(0,N.V)(),_=e=>({nodeRef:p,ledgers:[{id:1,seqNo:e||null,seg0:"",seg1:"",seg2:"",seg3:"",seg4:"",ccgRef:"",ccRef:""}]}),{formik:R}=(0,w.c)({initialValues:_(m),validationSchema:v.Ry({nodeRef:v.Z_().required()}),maxAccess:r,onSubmit:async e=>{var t,l;if(null==e?void 0:null===(t=e.ledgers)||void 0===t?void 0:t.some(e=>!e.seg0&&!e.seg1&&!e.seg2&&!e.seg3&&!e.seg4)){A({message:n.mandatorySeg});return}let a={fsId:d,seqNo:m,ledgers:null==e?void 0:null===(l=e.ledgers)||void 0===l?void 0:l.map((e,t)=>({...e,seqNo:m,ledgerSeqNo:t+1}))};await y({extension:s.U.Ledger.set2,record:JSON.stringify(a)}),c(),i.ZP.success(C.Edited)}}),Z=[{component:"textfield",label:n.seg1,name:"seg0",props:{maxLength:8}},{component:"textfield",label:n.seg2,name:"seg1",props:{maxLength:8}},{component:"textfield",label:n.seg3,name:"seg2",props:{maxLength:8}},{component:"textfield",label:n.seg4,name:"seg3",props:{maxLength:8}},{component:"textfield",label:n.seg5,name:"seg4",props:{maxLength:8}},{component:"textfield",label:n.ccgRef,name:"ccgRef",props:{maxLength:10}},{component:"textfield",label:n.ccRef,name:"ccRef",props:{maxLength:10}}];return(0,a.useEffect)(()=>{if(d){if((null==I?void 0:I.length)&&m){let e=I.filter(e=>Number(e.seqNo)===Number(m)).map((e,t)=>({id:t+1,...e}));R.setValues({nodeRef:p,ledgers:e.length?e:_(m).ledgers});return}m&&(S.current=m),R.resetForm({values:_(m||null)})}},[m,d,I]),(0,l.jsx)(F.Z,{onSave:R.handleSubmit,maxAccess:r,children:(0,l.jsx)(h.R,{children:(0,l.jsxs)(g.Q,{children:[(0,l.jsx)(f.Z,{name:"nodeRef",label:n.selectedNode,value:"".concat(p||"","  ").concat(b||""),required:!0,readOnly:!0,error:R.touched.nodeRef&&!!R.errors.nodeRef}),(0,l.jsx)(j._,{name:"ledgerTable",onChange:e=>R.setFieldValue("ledgers",e),value:R.values.ledgers,error:R.errors.ledgers,columns:Z,maxAccess:r})]})})})},L=n(78711),E=n(82235),M=e=>{let{maxAccess:t,initialData:n,fetchData:i}=e,r=(0,L.TA)({initialValues:{languageId:1},validationSchema:v.Ry({languageId:v.Rx().required()})}),o=(0,a.useMemo)(()=>{var e;if(!(null==n?void 0:null===(e=n.nodes)||void 0===e?void 0:e.length))return[];let{nodes:t,titles:l=[]}=n;return t.map(e=>{var t;let n=l.find(t=>t.seqNo==e.seqNo&&t.fsId==e.fsId&&t.languageId==r.values.languageId);return{...e,name:(null==n?void 0:n.title)||"undefined",parentId:null!==(t=e.parentSeqNo)&&void 0!==t?t:null,recordId:e.seqNo}})},[n,r.values.languageId]);return(0,a.useEffect)(()=>{r.values.languageId&&i&&i(r.values.languageId)},[r.values.languageId]),(0,l.jsx)(h.R,{children:(0,l.jsxs)(g.Q,{children:[(0,l.jsx)(m.ZP,{item:!0,margin:3,children:(0,l.jsx)(I.Z,{datasetId:A.v.LANGUAGE,name:"languageId",valueField:"key",displayField:"value",defaultIndex:0,values:r.values,required:!0,maxAccess:t,onChange:(e,t)=>{r.setFieldValue("languageId",(null==t?void 0:t.key)||1)},error:r.touched.languageId&&!!r.errors.languageId})}),(0,l.jsx)(E.Z,{data:{list:o},printable:!1})]})})},B=n(9522),O=e=>{var t,n,i,r,d;let{labels:u,maxAccess:m,recordId:v}=e,[p,f]=(0,a.useState)(0),[x,h]=(0,a.useState)(v),g=(0,a.useRef)({viewNodeId:null,viewNodeRef:"",viewNodedesc:""}),{getRequest:b}=(0,a.useContext)(o.$),[I,y]=(0,a.useState)(null),N=async()=>{if(!x)return;let e=await b({extension:s.U.FinancialStatement.get2,parameters:"_recordId=".concat(x)});return y(null==e?void 0:e.record),null==e?void 0:e.record};(0,a.useEffect)(()=>{N()},[x]);let w=[{label:u.financialStatement},{label:u.node,disabled:!x},{label:u.ledger,disabled:!x},{label:u.tree,disabled:!x}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(B.Y,{tabs:w,activeTab:p,setActiveTab:f,maxAccess:m}),(0,l.jsx)(c.Z,{index:0,value:p,maxAccess:m,children:(0,l.jsx)(C,{labels:u,node:g,maxAccess:m,setRecId:h,mainRecordId:x,initialData:null!==(t=null==I?void 0:I.fs)&&void 0!==t?t:{},onImportData:e=>{var t;y(e),h(null==e?void 0:null===(t=e.fs)||void 0===t?void 0:t.recordId)}})}),(0,l.jsx)(c.Z,{index:1,value:p,maxAccess:m,children:(0,l.jsx)(V,{maxAccess:m,labels:u,mainRecordId:x,node:g,fetchData:N,initialData:{nodes:null!==(n=null==I?void 0:I.nodes)&&void 0!==n?n:[],titles:null!==(i=null==I?void 0:I.titles)&&void 0!==i?i:[]}})}),(0,l.jsx)(c.Z,{index:2,value:p,maxAccess:m,children:(0,l.jsx)(P,{maxAccess:m,labels:u,node:g,mainRecordId:x,initialData:I,fetchData:N})}),(0,l.jsx)(c.Z,{index:3,value:p,maxAccess:m,children:(0,l.jsx)(M,{maxAccess:m,initialData:{nodes:null!==(r=null==I?void 0:I.nodes)&&void 0!==r?r:[],titles:null!==(d=null==I?void 0:I.titles)&&void 0!==d?d:[]},fetchData:N})})]})},D=n(33625),U=n(27723),z=()=>{let{getRequest:e,postRequest:t}=(0,a.useContext)(o.$),{platformLabels:n}=(0,a.useContext)(x.l),{stack:c}=(0,S.zY)(),{query:{data:m},refetch:v,labels:p,access:f,paginationParameters:b,invalidate:I}=(0,d.J)({queryFn:N,endpointId:s.U.FinancialStatement.page,datasetId:u.i.FinancialStatements}),y=[{field:"name",headerName:p.name,flex:1},{field:"isConfidential",headerName:p.isConfidential,flex:1,type:"checkbox"},{field:"sgName",headerName:p.securityGrp,flex:1}];async function N(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0,_pageSize:l=50}=t;return{...await e({extension:s.U.FinancialStatement.page,parameters:"_startAt=".concat(n,"&_pageSize=").concat(l,"&&filter=")}),_startAt:n}}let w=async e=>{await t({extension:s.U.FinancialStatement.del,record:JSON.stringify(e)}),I(),i.ZP.success(n.Deleted)};async function C(e){c({Component:O,props:{labels:p,maxAccess:f,recordId:e},width:1e3,height:630,title:p.financialStatement})}return(0,l.jsxs)(h.R,{children:[(0,l.jsx)(D.g,{children:(0,l.jsx)(U.Z,{onAdd:()=>{C()},maxAccess:f,labels:p})}),(0,l.jsx)(g.Q,{children:(0,l.jsx)(r.Z,{name:"FiStatementTable",columns:y,gridData:m,rowId:["recordId"],onEdit:e=>{C(null==e?void 0:e.recordId)},onDelete:w,refetch:v,pageSize:50,paginationType:"api",maxAccess:f,paginationParameters:b})})]})}},26045:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});let l="FS.asmx/",a={FinancialStatement:{page:l+"pageFS",qry:l+"qryFS",get:l+"getFS",set:l+"setFS",del:l+"delFS",get2:l+"get2FS",set2:l+"set2FS"},Node:{qry:l+"qryFSN",get:l+"getFSN",set:l+"setFSN",del:l+"delFSN",set2:l+"set2FSN"},Ledger:{qry:l+"qryFSL",set2:l+"set2FSL"},Title:{qry:l+"qryFST",set2:l+"set2FST"}}},67920:function(e,t,n){"use strict";n.d(t,{m:function(){return a}});var l=n(48601);function a(e,t,n){var a;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",r={...e};return null==n||null===(a=n.record)||void 0===a||a.controls.forEach(e=>{let{controlId:t,accessLevel:n}=e,[l,a]=null==t?void 0:t.split(".");l!==i||2!==n||a in r||(r[a]=e=>(null==e?void 0:e[a])!=null),(1===n||4===n)&&a in r&&delete r[a]}),{schema:l.Ry().shape({...Object.keys(r).reduce((e,n)=>(e[n]=l.nK().nullable().test(function(e){var l;let a=this.parent,[,i]=this.path.match(/^(\w+)\[(\d+)\]/)||[],o=(null===(l=this.options.context)||void 0===l?void 0:l[i])||[];if(t||!t&&o.length>1){if(null!==a[n]&&void 0!==a[n]&&0!==a[n]&&""!==r[n]&&!r[n](a))return!1;if(!Object.entries(r).some(e=>{let[,t]=e;return!!t(a)}))return!0}return!!r[n](a)&&void 0!==e}),e),{})}),requiredFields:r}}},29326:function(e,t,n){"use strict";var l=n(52322);n(2784);var a=n(23925),i=n(13980),r=n.n(i),o=n(95291),s=n.n(o),d=n(65947);let u=e=>{var t,n,i;let{children:r,value:o,index:u,maxAccess:c,...m}=e,v="".concat(e.name||"tab",".").concat(u),{accessLevel:p}=null!==(i=(null!==(n=null==c?void 0:null===(t=c.record)||void 0===t?void 0:t.controls)&&void 0!==n?n:[]).find(e=>e.controlId===v))&&void 0!==i?i:{accessLevel:0};if(p===d.A1)return null;let f=o===u;return(0,l.jsx)(a.Z,{role:"tabpanel",hidden:!f,id:"simple-tabpanel-".concat(u),"aria-labelledby":"simple-tab-".concat(u),className:"".concat(s().tabPanel," ").concat(f?s().active:s().hidden),...m,children:r})};u.propTypes={children:r().node,index:r().number.isRequired,value:r().number.isRequired},t.Z=u},9522:function(e,t,n){"use strict";n.d(t,{Y:function(){return m}});var l=n(52322),a=n(23925),i=n(54582),r=n(68696),o=n(44258),s=n(2784),d=n(99266),u=n(52614),c=n.n(u);let m=e=>{var t,n,u,m,v;let{tabs:p,activeTab:f,setActiveTab:x,maxAccess:h,name:g="tab"}=e,b=(null==h?void 0:null===(n=h.record)||void 0===n?void 0:null===(t=n.controls)||void 0===t?void 0:t.filter(e=>{var t;return 4===e.accessLevel&&(null===(t=e.controlId)||void 0===t?void 0:t.startsWith("".concat(g,".")))}).map(e=>e.controlId.split(".")[1]))||[],I=null==p?void 0:null===(u=p.map((e,t)=>({...e,id:t})))||void 0===u?void 0:u.filter((e,t)=>!b.includes(String(t))),y=null===(m=I[f])||void 0===m?void 0:m.id,N=null===(v=I[f])||void 0===v?void 0:v.disabled;return(0,s.useEffect)(()=>{y>=0&&!N&&f!=y&&x(y)},[]),(0,l.jsx)(a.Z,{className:c().tabsContainer,children:(0,l.jsx)(a.Z,{className:c().tabsWrapper,children:(0,l.jsx)(i.Z,{value:f,onChange:(e,t)=>x(t),variant:"scrollable",scrollButtons:I.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:c().tabsIndicator},className:c().tabs,children:null==I?void 0:I.map(e=>(0,l.jsx)(r.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(c().tabName," ").concat(e.disabled?c().tabDisabled:""),classes:{root:c().tabRoot,selected:c().selectedTab},label:(0,l.jsxs)(a.Z,{display:"flex",alignItems:"center",children:[(0,l.jsx)("span",{children:e.label}),e.id===f&&(null==e?void 0:e.onRefetch)&&(0,l.jsx)(o.Z,{size:"small",className:c().refreshButton,onClick:t=>{t.stopPropagation(),e.onRefetch()},children:(0,l.jsx)(d.Z,{className:c().refreshIcon})})]})},e.id))})})})}},82235:function(e,t,n){"use strict";var l=n(52322),a=n(2784),i=n(7913),r=n(61676),o=n(44781),s=n(78502),d=n(94045),u=n(55182),c=n(40234),m=n(55648),v=n(27149),p=n(94668),f=n(3),x=n(19473),h=n(21326);let g=e=>{let t=[];return e.forEach(e=>{t.push(e.recordId.toString()),e.children&&(t=t.concat(g(e.children)))}),t},b=e=>{let{nodes:t}=e,n=g(t),a=e=>(0,l.jsx)(y,{nodeId:e.recordId.toString(),label:e.name,children:Array.isArray(e.children)?e.children.map(e=>a(e)):null},e.recordId);return(0,l.jsx)(I,{"aria-label":"plant tree",expanded:n,defaultCollapseIcon:(0,l.jsx)(d.Z,{}),defaultExpandIcon:(0,l.jsx)(u.Z,{}),children:t.map(e=>a(e))})},I=(0,o.ZP)(i.Z)(e=>{let{theme:t}=e;return{width:"100%",flex:1,minHeight:0,overflowY:"auto",boxSizing:"border-box",padding:0,"--tree-font":"clamp(11px, 0.25vw + 10px, 13px)","--tree-rowH":"clamp(22px, 0.35vw + 20px, 26px)","--tree-py":"0px","--tree-px":"6px","--tree-iconBoxW":"18px","--tree-iconSize":"18px","--tree-indent":"18px","--tree-radius":"0px","& .MuiTreeItem-content":{minHeight:"var(--tree-rowH)",paddingTop:"var(--tree-py)",paddingBottom:"var(--tree-py)",paddingLeft:"var(--tree-px)",paddingRight:"var(--tree-px)",borderRadius:"var(--tree-radius)",alignItems:"center",gap:6},"& .MuiTreeItem-label":{fontSize:"var(--tree-font)",lineHeight:1.2,whiteSpace:"normal",wordBreak:"break-word"},"& .MuiTreeItem-iconContainer":{width:"var(--tree-iconBoxW)",minWidth:"var(--tree-iconBoxW)",marginRight:0,display:"flex",alignItems:"center",justifyContent:"center"},"& .MuiSvgIcon-root":{fontSize:"var(--tree-iconSize)"},"& .MuiTreeItem-group":{marginLeft:"var(--tree-indent)",paddingLeft:0},"& .MuiTreeItem-content:hover":{backgroundColor:t.palette.action.hover},"@media print":{overflowY:"visible","--tree-font":"11pt","--tree-rowH":"auto"},[t.breakpoints.down("sm")]:{"--tree-font":"clamp(10.5px, 0.4vw + 9.5px, 12px)","--tree-rowH":"clamp(20px, 0.4vw + 18px, 24px)","--tree-iconBoxW":"16px","--tree-iconSize":"16px","--tree-indent":"16px","--tree-px":"4px"}}}),y=(0,o.ZP)(r.Z)(e=>{let{theme:t}=e;return{"&.Mui-selected > .MuiTreeItem-content":{backgroundColor:"#d9d9d9"},"&.Mui-selected > .MuiTreeItem-content:hover":{backgroundColor:"#d9d9d9"},"&.Mui-focused > .MuiTreeItem-content":{backgroundColor:"#d9d9d9"},"& .MuiTreeItem-content .MuiTreeItem-label":{fontSize:"var(--tree-font) !important",lineHeight:"1.2 !important",whiteSpace:"normal",wordBreak:"break-word"}}});function N(e){let{data:t,window:n,printable:i=!0}=e,{platformLabels:r}=(0,a.useContext)(x.l),o=(0,s.Z)();(0,v.Z)(o.breakpoints.down("sm"));let g=(0,a.useRef)();(0,h.Z)({title:r.Tree,window:n});let N=(0,c.useReactToPrint)({content:()=>g.current,documentTitle:"Tree_Structure",removeAfterPrint:!0}),w=(0,a.useMemo)(()=>{if(t){var e,n;let l=new Map(null==t?void 0:null===(e=t.list)||void 0===e?void 0:e.map(e=>[e.recordId,{...e,children:[]}]));return null==t||null===(n=t.list)||void 0===n||n.forEach(e=>{if(e.parentId){let t=l.get(e.parentId);t&&t.children.push(l.get(e.recordId))}}),[...l.values()].filter(e=>!e.parentId)}return[]},[t]),C=e=>(0,l.jsx)(y,{nodeId:e.recordId.toString(),label:e.name,children:Array.isArray(e.children)?e.children.map(e=>C(e)):null},e.recordId);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(p.Z,{sx:{p:0,display:"flex",flexDirection:"column",width:"100%",height:"100%",minHeight:0,overflow:"hidden"},children:[(0,l.jsx)(I,{"aria-label":"plant tree",defaultCollapseIcon:(0,l.jsx)(d.Z,{}),defaultExpandIcon:(0,l.jsx)(u.Z,{}),children:w.map(e=>C(e))}),(0,l.jsx)("div",{style:{display:"none",visibility:"hidden"},children:(0,l.jsx)("div",{ref:g,children:(0,l.jsx)(b,{nodes:w})})})]}),(0,l.jsx)(f.Z,{sx:{p:0,width:"100%"},children:(0,l.jsx)(m.Z,{actions:i?[{key:"Print",condition:!0,onClick:N,disabled:!1}]:[],isCleared:!1,isSaved:!1,isInfo:!1})})]})}N.width=500,N.height=400,t.Z=N},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[40234,9783,49774,92888,40179],function(){return e(e.s=45405)}),_N_E=e.O()}]);