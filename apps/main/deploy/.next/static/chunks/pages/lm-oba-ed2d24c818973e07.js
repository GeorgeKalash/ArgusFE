(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[27864],{1253:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/lm-oba",function(){return l(58698)}])},58698:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return O}});var n=l(52322),r=l(69387),s=l(65950),d=l(71987),i=l(26612),t=l(31389),c=l(33625),o=l(62362),u=l(61802),m=l(19473),p=l(60218),f=l(2784),y=l(48601),h=l(82737),x=l(62202),I=l(91406),g=l(80983),v=l(50496),_=l(38449),N=l(92407),S=l(8661),Y=l(27423);function j(e){let{labels:a,maxAccess:l,obj:r}=e,{getRequest:c,postRequest:u}=(0,f.useContext)(s.$),{platformLabels:j}=(0,f.useContext)(m.l),F=(0,d.E)({endpointId:v.U.OpeningBalances.page}),{formik:O}=(0,g.c)({initialValues:{fiscalYear:null,employeeId:null,lsId:null,days:null},maxAccess:l,validateOnChange:!0,validationSchema:y.Ry({fiscalYear:y.Rx().required(),employeeId:y.Rx().required(),lsId:y.Rx().required(),days:y.Rx().required().min(0).max(999)}),onSubmit:async e=>{await u({extension:v.U.OpeningBalances.set,record:JSON.stringify(e)}),x.ZP.success(e.recordId?j.Edited:j.Added),e.recordId||O.setFieldValue("recordId",String(100*e.employeeId)+String(10*e.fiscalYear)+String(e.lsId)),F()}}),w=!!O.values.recordId;return(0,f.useEffect)(()=>{!async function(){if((null==r?void 0:r.employeeId)&&(null==r?void 0:r.fiscalYear)&&(null==r?void 0:r.lsId)){let{record:e}=await c({extension:v.U.OpeningBalances.get,parameters:"_employeeId=".concat(r.employeeId,"&_fiscalYear=").concat(r.fiscalYear,"&_lsId=").concat(r.lsId)});O.setValues({...e,recordId:String(100*e.employeeId)+String(10*e.fiscalYear)+String(e.lsId)})}}()},[]),(0,n.jsx)(h.Z,{resourceId:i.i.LMOpeningBalances,form:O,maxAccess:l,editMode:w,children:(0,n.jsx)(t.R,{children:(0,n.jsx)(o.Q,{children:(0,n.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{endpointId:_.r.FiscalYears.qry,name:"fiscalYear",label:a.fiscalYear,values:O.values,valueField:"fiscalYear",displayField:"fiscalYear",readOnly:w,required:!0,maxAccess:l,onChange:(e,a)=>{O.setFieldValue("fiscalYear",(null==a?void 0:a.fiscalYear)||null)},error:O.touched.fiscalYear&&!!O.errors.fiscalYear})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(Y.U,{endpointId:N.y.Employee.snapshot,parameters:{_branchId:0},valueField:"reference",displayField:"fullName",name:"employeeId",readOnly:w,label:a.employee,form:O,required:!0,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",maxAccess:l,onChange:(e,a)=>{O.setFieldValue("employeeName",a.fullName||""),O.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),O.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(S.Z,{endpointId:v.U.LeaveScheduleFilters.qry,name:"lsId",label:a.leaveSchedule,values:O.values,valueField:"recordId",displayField:["reference","name"],readOnly:w,required:!0,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],maxAccess:l,onChange:(e,a)=>{O.setFieldValue("lsId",(null==a?void 0:a.recordId)||null)},error:O.touched.lsId&&!!O.errors.lsId})}),(0,n.jsx)(p.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{name:"days",label:a.days,value:O.values.days,onChange:O.handleChange,required:!0,maxLength:5,allowNegative:!1,maxAccess:l,error:O.touched.days&&!!O.errors.days})})]})})})})}var F=l(36908),O=()=>{let{getRequest:e,postRequest:a}=(0,f.useContext)(s.$),{platformLabels:l}=(0,f.useContext)(m.l),{stack:p}=(0,u.zY)();async function y(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:l=0,_pageSize:n=50,params:r}=a;return{...await e({extension:v.U.OpeningBalances.page,parameters:"_startAt=".concat(l,"&_pageSize=").concat(n,"&_params=").concat(r||"")}),_startAt:l}}async function h(e){let{filters:a,pagination:l}=e;return y({_startAt:l._startAt||0,params:null==a?void 0:a.params})}let{query:{data:I},labels:g,paginationParameters:_,filterBy:N,refetch:S,invalidate:Y,access:O}=(0,d.J)({queryFn:y,endpointId:v.U.OpeningBalances.page,datasetId:i.i.LMOpeningBalances,filter:{filterFn:h}}),w=[{field:"fiscalYear",headerName:g.fiscalYear,flex:1},{field:"employeeRef",headerName:g.employee,flex:1},{field:"lsName",headerName:g.leaveSchedule,flex:1},{field:"days",headerName:g.days,flex:1}];function A(e){p({Component:j,props:{labels:g,obj:e,maxAccess:O},width:500,height:500,title:g.leaveSchedule})}let C=async e=>{await a({extension:v.U.OpeningBalances.del,record:JSON.stringify(e)}),x.ZP.success(l.Deleted),Y()};return(0,n.jsxs)(t.R,{children:[(0,n.jsx)(c.g,{children:(0,n.jsx)(F.Z,{hasSearch:!1,onAdd:()=>{A()},maxAccess:O,filterBy:N,reportName:"LMOBA"})}),(0,n.jsx)(o.Q,{children:(0,n.jsx)(r.Z,{name:"table",columns:w,gridData:I,rowId:["recordId"],onEdit:e=>{A(e)},onDelete:C,pageSize:50,paginationType:"api",paginationParameters:_,refetch:S,maxAccess:O})})]})}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=1253)}),_N_E=e.O()}]);