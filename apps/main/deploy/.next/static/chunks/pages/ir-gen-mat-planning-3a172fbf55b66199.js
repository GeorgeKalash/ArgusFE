(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7835],{32972:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ir-gen-mat-planning",function(){return n(73961)}])},73961:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return S}});var l=n(52322),t=n(60218),r=n(2784),o=n(71987),i=n(65950),s=n(26612),d=n(8661),m=n(31389),c=n(33625),u=n(62362),p=n(36908),h=n(58912),v=n(5088),b=n(19473),f=n(62202),g=n(80983),y=n(76399),w=n(96026),k=n(54074),S=()=>{var e,a,n;let{getRequest:S,postRequest:C}=(0,r.useContext)(i.$),{platformLabels:x}=(0,r.useContext)(b.l),{stack:O}=(0,w.V)(),[P,I]=(0,r.useState)("");async function V(){var e;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=await S({extension:h.I.materialPlaning.preview,parameters:"_startAt=".concat(0,"&_pageSize=",1e4,"&_params=").concat(a.params||"")}),l=null==n?void 0:null===(e=n.list)||void 0===e?void 0:e.map((e,a)=>{var n,l;return{...e,id:a+1,totalStockCoverage:(null==e?void 0:e.totalStockCoverage)?Number(null===(n=e.totalStockCoverage)||void 0===n?void 0:n.toFixed(2)):0,siteCoverageStock:(null==e?void 0:e.siteCoverageStock)?Number(null===(l=e.siteCoverageStock)||void 0===l?void 0:l.toFixed(2)):0,qty:e.qty||0}});j.setFieldValue("items",l)}async function _(e){let{filters:a}=e;return V({params:null==a?void 0:a.params})}let{labels:F,filterBy:N,access:R}=(0,o.J)({datasetId:s.i.GenerateMRPs,endpointId:h.I.materialPlaning.preview,queryFn:V,filter:{filterFn:_}}),{formik:j}=(0,g.c)({maxAccess:R,initialValues:{searchValue:"",search:!1,mrpId:"",items:[]},onSubmit:async e=>{var a;let n=null==e?void 0:null===(a=e.items)||void 0===a?void 0:a.filter(e=>null==e?void 0:e.isChecked).map(e=>{let{id:a,isChecked:n,...l}=e;return l});if(!(null==n?void 0:n.length)){O({message:F.checkItem});return}await C({extension:h.I.MatPlanningItem.append,record:JSON.stringify({mrpId:e.mrpId,items:n})}),f.ZP.success(x.Generated)}}),q=(null===(e=j.values.items)||void 0===e?void 0:e.length)>0&&(null===(a=j.values.items)||void 0===a?void 0:a.every(e=>null==e?void 0:e.isChecked));(0,r.useEffect)(()=>{j.values.search&&I(j.values.searchValue)},[j.values.search,j.values.searchValue]);let A=[{component:"checkbox",name:"isChecked",flex:.3,checkAll:{value:q,visible:!0,onChange(e){let{checked:a}=e,n=j.values.items.map(e=>{let{isChecked:n,...l}=e;return{...l,isChecked:a,qty:a?l.suggestedPRQty:0}});j.setFieldValue("items",n)}},async onChange(e){let{row:{update:a,newRow:n}}=e;a({qty:(null==n?void 0:n.isChecked)?null==n?void 0:n.suggestedPRQty:0})}},{component:"textfield",label:F.sku,name:"sku",width:100,props:{readOnly:!0}},{component:"textfield",label:F.name,name:"name",width:150,props:{readOnly:!0}},{component:"numberfield",label:F.onHand,name:"onHand",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.openPr,name:"openPR",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.openPo,name:"openPO",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.leadTime,name:"leadTime",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.safetyStock,name:"safetyStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.reorderPoint,name:"reorderPoint",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.min,name:"minStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.max,name:"maxStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.amcShortTerm,name:"amcShortTerm",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.amcLongTerm,name:"amcLongTerm",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.siteCoverageStock,name:"siteCoverageStock",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.totalCoverageStock,name:"totalStockCoverage",width:100,props:{readOnly:!0}},{component:"textfield",label:F.mu,name:"msRef",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.unitCost,name:"unitCost",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.totalCost,name:"totalCost",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.sugQty,name:"suggestedPRQty",width:100,props:{readOnly:!0}},{component:"numberfield",label:F.reqQty,name:"qty",width:100,props:{decimalScale:2},propsReducer(e){let{row:a,props:n}=e;return{...n,readOnly:!a.isChecked}}}],T=[{key:"add",condition:!0,onClick:()=>{j.handleSubmit()},disabled:!j.values.mrpId}];return(0,l.jsx)(k.Z,{actions:T,onSave:()=>j.handleSubmit,disabedSubmit:!j.values.mrpId,isSaved:!1,maxAccess:R,fullSize:!0,children:(0,l.jsxs)(m.R,{children:[(0,l.jsx)(c.g,{children:(0,l.jsx)(p.Z,{maxAccess:R,reportName:"previewMRP",filterBy:N,hasSearch:!1,middleSection:(0,l.jsx)(t.ZP,{item:!0,xs:3,children:(0,l.jsx)(v.Z,{name:"search",label:x.Search,value:j.values.searchValue,search:!0,onChange:e=>{var a;j.setFieldValue("searchValue",e.target.value),j.setFieldValue("search",!((null===(a=e.target.value)||void 0===a?void 0:a.length)>0))},onSearch:e=>j.setFieldValue("search",!0),onClear:()=>{j.setFieldValue("searchValue",""),j.setFieldValue("search",!0)},maxAccess:R})}),rightSection:(0,l.jsx)(d.Z,{endpointId:h.I.MatPlanning.qry,parameters:"_params=",filter:e=>1===e.status,label:F.matReqPlan,name:"mrpId",values:j.values,valueField:"recordId",displayField:"reference",onChange:(e,a)=>{j.setFieldValue("mrpId",(null==a?void 0:a.recordId)||null)},maxAccess:R})})}),(0,l.jsx)(u.Q,{children:(0,l.jsx)(y._,{searchValue:P,onChange:e=>{console.log(e),j.setFieldValue("items",e)},value:null===(n=j.values)||void 0===n?void 0:n.items,error:j.errors.items,columns:A,name:"items",allowDelete:!1,allowAddNewLine:!1,maxAccess:R})})]})})}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=32972)}),_N_E=e.O()}]);