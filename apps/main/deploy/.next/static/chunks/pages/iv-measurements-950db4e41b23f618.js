(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9547],{79836:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/iv-measurements",function(){return s(33881)}])},33881:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return T}});var n=s(52322),r=s(2784),t=s(62202),l=s(69387),i=s(27723),c=s(65950),d=s(71987),o=s(33625),u=s(62362),m=s(31389),x=s(26612),h=s(65215),b=s(19473),f=s(29326),v=s(9522),_=s(60218),p=s(48601),C=s(82737),g=s(5088),j=s(80983),I=s(19689),Z=s(91406);function y(e){var a;let{labels:s,maxAccess:l,setStore:i,store:o}=e,{recordId:f}=o,{getRequest:v,postRequest:y}=(0,r.useContext)(c.$),{platformLabels:A}=(0,r.useContext)(b.l),P=!!o.recordId,q=(0,d.E)({endpointId:h.$.Measurement.page}),{formik:N}=(0,j.c)({initialValues:{recordId:"",reference:"",name:"",type:0,decimals:0,serialItems:!1},maxAccess:l,validateOnChange:!0,validationSchema:p.Ry({reference:p.Z_().required(),name:p.Z_().required(),decimals:p.Rx().required().min(0).max(5)}),onSubmit:async e=>{let a=await y({extension:h.$.Measurement.set,record:JSON.stringify(e)});e.recordId?t.ZP.success(A.Edited):(i(e=>({...e,recordId:a.recordId,decimals:N.values.decimals})),t.ZP.success(A.Added),N.setFieldValue("recordId",a.recordId)),q()}});return(0,r.useEffect)(()=>{!async function(){if(f){let e=await v({extension:h.$.Measurement.get,parameters:"_recordId=".concat(f)});N.setValues(e.record),i(a=>({...a,decimals:e.record.decimals}))}}()},[]),(0,n.jsx)(C.Z,{resourceId:x.i.Measurement,form:N,maxAccess:l,editMode:P,children:(0,n.jsx)(m.R,{children:(0,n.jsx)(u.Q,{children:(0,n.jsxs)(_.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"reference",label:s.reference,value:N.values.reference,required:!0,maxAccess:l,onChange:N.handleChange,onClear:()=>N.setFieldValue("reference",""),error:N.touched.reference&&!!N.errors.reference})}),(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"name",label:s.name,value:N.values.name,required:!0,maxAccess:l,onChange:N.handleChange,onClear:()=>N.setFieldValue("name",""),error:N.touched.name&&!!N.errors.name})}),(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(I.Z,{name:"serialItems",value:null===(a=N.values)||void 0===a?void 0:a.serialItems,onChange:e=>N.setFieldValue("serialItems",e.target.checked),label:s.serialItem,maxAccess:l})}),(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(Z.Z,{name:"decimals",label:s.decimals,value:N.values.decimals,decimalScale:0,required:!0,allowNegative:!1,readOnly:P,maxAccess:l,onChange:e=>N.setFieldValue("decimals",e.target.value),onClear:()=>N.setFieldValue("decimals",0),error:N.touched.decimals&&!!N.errors.decimals})})]})})})})}var A=s(61802);function P(e){var a,s,l;let{msId:i,recordId:d,labels:o,maxAccess:f,getMeasurementUnitGridData:v,window:I,store:y}=e,{getRequest:A,postRequest:P}=(0,r.useContext)(c.$),{platformLabels:q}=(0,r.useContext)(b.l),N=!!y.recordId,{formik:T}=(0,j.c)({initialValues:{recordId:d||null,msId:i,reference:"",name:"",qty:""},validateOnChange:!0,validationSchema:p.Ry({reference:p.Z_().required(),name:p.Z_().required(),qty:p.Rx().required().min(1e-5)}),onSubmit:async e=>{let a={msId:i,recordId:d,...e},s=await P({extension:h.$.MeasurementUnit.set,record:JSON.stringify(a)});d?t.ZP.success(q.Edited):t.ZP.success(q.Added),T.setFieldValue("recordId",s.recordId),await v(i),I.close()}}),w=async e=>{let a=await A({extension:h.$.MeasurementUnit.get,parameters:"_recordId=".concat(e)});T.setValues(a.record)};return(0,r.useEffect)(()=>{d&&w(d)},[d]),(0,n.jsx)(C.Z,{resourceId:x.i.Measurement,form:T,maxAccess:f,editMode:N,isInfo:!1,children:(0,n.jsx)(m.R,{children:(0,n.jsx)(u.Q,{children:(0,n.jsxs)(_.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"reference",label:o.reference,value:null==T?void 0:null===(a=T.values)||void 0===a?void 0:a.reference,required:!0,maxAccess:f,onChange:T.handleChange,onClear:()=>T.setFieldValue("reference",""),error:T.touched.reference&&!!T.errors.reference})}),(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"name",label:o.name,value:null==T?void 0:null===(s=T.values)||void 0===s?void 0:s.name,required:!0,maxAccess:f,onChange:T.handleChange,onClear:()=>T.setFieldValue("name",""),error:T.touched.name&&!!T.errors.name})}),(0,n.jsx)(_.ZP,{item:!0,xs:12,children:(0,n.jsx)(Z.Z,{name:"qty",required:!0,label:o.qty,value:null==T?void 0:null===(l=T.values)||void 0===l?void 0:l.qty,allowNegative:!1,maxAccess:f,onChange:T.handleChange,onClear:()=>T.setFieldValue("qty",""),error:T.touched.qty&&!!T.errors.qty,decimalScale:y.decimals})})]})})})})}var q=e=>{let{store:a,maxAccess:s,labels:d}=e,{recordId:x}=a,{getRequest:f,postRequest:v}=(0,r.useContext)(c.$),{platformLabels:_}=(0,r.useContext)(b.l),[p,C]=(0,r.useState)([]),{stack:g}=(0,A.zY)(),j=async e=>{try{let a=await f({extension:h.$.MeasurementUnit.qry,parameters:"_msId=".concat(e)});C(a)}catch(e){}},I=[{field:"reference",headerName:d.reference,flex:1},{field:"name",headerName:d.name,flex:1},{field:"qty",headerName:d.qty,flex:1}],Z=e=>{g({Component:P,props:{labels:d,maxAccess:s,recordId:e,msId:x,store:a,getMeasurementUnitGridData:j},width:450,height:330,title:d.measurementUnit})};(0,r.useEffect)(()=>{x&&j(x)},[x]);let y=async e=>{try{await v({extension:h.$.MeasurementUnit.del,record:JSON.stringify(e)}),t.ZP.success(_.Deleted),await j(x)}catch(e){}};return(0,n.jsxs)(m.R,{children:[(0,n.jsx)(o.g,{children:(0,n.jsx)(i.Z,{onAdd:()=>{Z()},maxAccess:s})}),(0,n.jsx)(u.Q,{children:(0,n.jsx)(l.Z,{columns:I,gridData:p,rowId:["recordId"],api:j,onEdit:e=>{Z(null==e?void 0:e.recordId)},onDelete:y,isLoading:!1,maxAccess:s,pagination:!1})})]})},N=e=>{let{recordId:a,labels:s,maxAccess:t}=e,[l,i]=(0,r.useState)(0),[c,d]=(0,r.useState)({recordId:a||null}),o=!!c.recordId,u=[{label:s.measurement},{label:s.measurementUnit,disabled:!o}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Y,{tabs:u,activeTab:l,setActiveTab:i,maxAccess:t}),(0,n.jsx)(f.Z,{index:0,value:l,maxAccess:t,children:(0,n.jsx)(y,{labels:s,setStore:d,store:c,maxAccess:t})}),(0,n.jsx)(f.Z,{index:1,value:l,maxAccess:t,children:(0,n.jsx)(q,{labels:s,maxAccess:t,store:c})})]})},T=()=>{let{getRequest:e,postRequest:a}=(0,r.useContext)(c.$),{platformLabels:s}=(0,r.useContext)(b.l),{stack:f}=(0,A.zY)();async function v(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:s=0,_pageSize:n=50}=a;try{return{...await e({extension:h.$.Measurement.page,parameters:"_startAt=".concat(s,"&_pageSize=").concat(n,"&filter=")}),_startAt:s}}catch(e){}}let{query:{data:_},labels:p,access:C,invalidate:g,refetch:j,paginationParameters:I}=(0,d.J)({queryFn:v,endpointId:h.$.Measurement.page,datasetId:x.i.Measurement}),Z=[{field:"reference",headerName:p.reference,flex:1},{field:"name",headerName:p.name,flex:1},{field:"decimals",headerName:p.decimals,flex:1}],y=async e=>{try{await a({extension:h.$.Measurement.del,record:JSON.stringify(e)}),g(),t.ZP.success(s.Deleted)}catch(e){}};function P(e){f({Component:N,props:{labels:p,recordId:e,maxAccess:C},width:600,height:400,title:p.measurement})}return(0,n.jsxs)(m.R,{children:[(0,n.jsx)(o.g,{children:(0,n.jsx)(i.Z,{onAdd:()=>{P()},maxAccess:C})}),(0,n.jsx)(u.Q,{children:(0,n.jsx)(l.Z,{columns:Z,gridData:_,rowId:["recordId"],onEdit:e=>{P(null==e?void 0:e.recordId)},onDelete:y,deleteConfirmationType:"strict",isLoading:!1,pageSize:50,paginationType:"api",paginationParameters:I,refetch:j,maxAccess:C})})]})}},29326:function(e,a,s){"use strict";var n=s(52322);s(2784);var r=s(23925),t=s(13980),l=s.n(t),i=s(95291),c=s.n(i),d=s(65947);let o=e=>{var a,s,t;let{children:l,value:i,index:o,maxAccess:u,...m}=e,x="".concat(e.name||"tab",".").concat(o),{accessLevel:h}=null!==(t=(null!==(s=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==s?s:[]).find(e=>e.controlId===x))&&void 0!==t?t:{accessLevel:0};if(h===d.A1)return null;let b=i===o;return(0,n.jsx)(r.Z,{role:"tabpanel",hidden:!b,id:"simple-tabpanel-".concat(o),"aria-labelledby":"simple-tab-".concat(o),className:"".concat(c().tabPanel," ").concat(b?c().active:c().hidden),...m,children:l})};o.propTypes={children:l().node,index:l().number.isRequired,value:l().number.isRequired},a.Z=o},9522:function(e,a,s){"use strict";s.d(a,{Y:function(){return m}});var n=s(52322),r=s(23925),t=s(54582),l=s(68696),i=s(44258),c=s(2784),d=s(99266),o=s(52614),u=s.n(o);let m=e=>{var a,s,o,m,x;let{tabs:h,activeTab:b,setActiveTab:f,maxAccess:v,name:_="tab"}=e,p=(null==v?void 0:null===(s=v.record)||void 0===s?void 0:null===(a=s.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(_,".")))}).map(e=>e.controlId.split(".")[1]))||[],C=null==h?void 0:null===(o=h.map((e,a)=>({...e,id:a})))||void 0===o?void 0:o.filter((e,a)=>!p.includes(String(a))),g=null===(m=C[b])||void 0===m?void 0:m.id,j=null===(x=C[b])||void 0===x?void 0:x.disabled;return(0,c.useEffect)(()=>{g>=0&&!j&&b!=g&&f(g)},[]),(0,n.jsx)(r.Z,{className:u().tabsContainer,children:(0,n.jsx)(r.Z,{className:u().tabsWrapper,children:(0,n.jsx)(t.Z,{value:b,onChange:(e,a)=>f(a),variant:"scrollable",scrollButtons:C.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==C?void 0:C.map(e=>(0,n.jsx)(l.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,n.jsxs)(r.Z,{display:"flex",alignItems:"center",children:[(0,n.jsx)("span",{children:e.label}),e.id===b&&(null==e?void 0:e.onRefetch)&&(0,n.jsx)(i.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,n.jsx)(d.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=79836)}),_N_E=e.O()}]);