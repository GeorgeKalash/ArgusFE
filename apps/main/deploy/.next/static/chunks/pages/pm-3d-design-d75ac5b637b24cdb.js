(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[39573],{69100:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pm-3d-design",function(){return r(54436)}])},54436:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var n=r(52322),a=r(2784),i=r(71987),l=r(65950),d=r(69387),o=r(62202),c=r(61802),s=r(26612),u=r(31389),f=r(33625),m=r(62362),g=r(19473),y=r(98345),v=r(7121),p=r(36908),h=r(63518),N=r(38096),x=()=>{let{postRequest:e,getRequest:t}=(0,a.useContext)(l.$),{platformLabels:r}=(0,a.useContext)(g.l),{stack:x}=(0,c.zY)();async function I(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:n=50,params:a=[]}=e;return{...await t({extension:h.z.ThreeDDesign.page,parameters:"_startAt=".concat(r,"&_pageSize=").concat(n,"&_filter=&_params=").concat(a)}),_startAt:r}}async function _(e){let{filters:r,pagination:n}=e;return r.qry?await t({extension:h.z.ThreeDDesign.snapshot,parameters:"_filter=".concat(r.qry)}):I({_startAt:n._startAt||0,params:null==r?void 0:r.params})}let{query:{data:w},filterBy:D,refetch:T,labels:b,access:S,paginationParameters:k,invalidate:A}=(0,i.J)({queryFn:I,endpointId:h.z.ThreeDDesign.page,datasetId:s.i.ThreeDDesign,filter:{filterFn:_}}),R=[{field:"dtName",headerName:b.doctype,flex:1},{field:"reference",headerName:b.reference,flex:1},{field:"date",headerName:b.date,flex:1,type:"date"},{field:"sourceName",headerName:b.source,flex:1},{field:"sketchRef",headerName:b.sketchRef,flex:1},{field:"designerName",headerName:b.designerName,flex:1},{field:"itemGroupName",headerName:b.itemGroup,flex:1},{field:"collectionName",headerName:b.collection,flex:1},{field:"metalRef",headerName:b.purity,flex:1},{field:"castingName",headerName:b.castingType,flex:1},{field:"fileReference",headerName:b.threeDFile,flex:1},{field:"rsName",headerName:b.releaseStatus,flex:1},{field:"wipName",headerName:b.wipName,flex:1},{field:"statusName",headerName:b.status,flex:1}],{proxyAction:O}=(0,y.G)({functionId:v.J.ThreeDDesign,action:async()=>{q()}}),E=async()=>{O()};async function q(e){x({Component:N.Z,props:{recordId:null==e?void 0:e.recordId}})}let z=async t=>{await e({extension:h.z.ThreeDDesign.del,record:JSON.stringify(t)}),A(),o.ZP.success(r.Deleted)};return(0,n.jsxs)(u.R,{children:[(0,n.jsx)(f.g,{children:(0,n.jsx)(p.Z,{onAdd:E,maxAccess:S,filterBy:D,reportName:"PM3DD"})}),(0,n.jsx)(m.Q,{children:(0,n.jsx)(d.Z,{name:"3dDesignTable",columns:R,gridData:w,rowId:["recordId"],onEdit:e=>{q(e)},refetch:T,deleteConfirmationType:"strict",onDelete:z,isLoading:!1,pageSize:50,maxAccess:S,paginationParameters:k,paginationType:"api"})})]})}},1685:function(e,t,r){"use strict";r.d(t,{m:function(){return n}});let n=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,r){"use strict";r.d(t,{H:function(){return y},G:function(){return g}});var n=r(45300),a=r(2784),i=r(96026),l=r(38449);r(26612);var d=r(65947),o=r(1685);let c=async(e,t,r)=>{try{let n=await e({extension:t,parameters:r});return t.includes("qry")?n:n.record}catch(e){return null}},s=(e,t,r,n)=>{let a=(e=JSON.parse(JSON.stringify(e))).record.controls,i=a.find(e=>"reference"===e.controlId);return i?i.accessLevel=(null==t?void 0:t.mandatory)?d.$7:d.rr:(null==t?void 0:t.mandatory)?a.push({sgId:0,resourceId:"",controlId:"".concat(n?n+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?d.$7:d.rr}):(null==t?void 0:t.readOnly)?a.push({sgId:0,resourceId:"",controlId:"".concat(n?n+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?d.rr:d.$7}):a=e.record.controls.filter(e=>"reference"!=e.controlId),r&&a.push({sgId:0,resourceId:"",controlId:"".concat(n?n+".":"","dtId"),accessLevel:d.$7}),{...e,record:{...e.record,controls:a}}},u=async(e,t,r)=>{let n,a;switch(r){case"dtId":let i=(0,o.m)("userData"),d=null==i?void 0:i.userId;a="_userId=".concat(d,"&_functionId=").concat(t),n=l.r.UserFunction.get;break;case"glbSysNumberRange":a="_recordId=".concat(t),n=l.r.SystemFunction.get;break;case"DocumentType":a="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),n=l.r.DocumentType.qry;break;case"DcTypNumberRange":a="_recordId=".concat(t),n=l.r.DocumentType.get;break;case"isExternal":a="_recordId=".concat(t),n=l.r.NumberRange.get;break;default:return null}return await c(e,n,a)},f=async function(e){let t,r,n,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=!(arguments.length>4)||void 0===arguments[4]||arguments[4],c=arguments.length>5?arguments[5]:void 0,f=void 0===d&&i&&await u(e,i,"dtId"),m=null==f?void 0:f.dtId,g="",y=!0;if(f&&void 0===d||"nraId"===d){if(m){let r=await u(e,m,"DcTypNumberRange");t=null==r?void 0:r.nraId,y=!((null==r?void 0:r.activeStatus)<0),t||(g="Assign the document type to a number range")}if((!m||!y)&&o&&i){var v;let t=await u(e,i,"DocumentType");a=(null==t?void 0:null===(v=t.list)||void 0===v?void 0:v.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===d||void 0===d)&&i){if((!m||m)&&!t||t&&!y){let r=await u(e,i,"glbSysNumberRange");(t=null==r?void 0:r.nraId)&&a&&(a=!1),y=!0}g=t||a?"":"Assign the system Function to a number range"}d>0&&!t&&(t=d),t&&y?(r={readOnly:null==(n=await u(e,t,"isExternal"))||!n.external,mandatory:null!=n&&!!n.external},l&&(l=await s(l,r,a,c))):!t&&l&&(l=await s(l,r,a,c));let p=c?"".concat(c,".reference"):"reference";return{dtId:m,resetReference:null==r?void 0:r.readOnly,dcTypeRequired:a,reference:{fieldName:p,isEmpty:(null==n?void 0:n.external)!==void 0&&(null==n||!n.external)},errorMessage:g,maxAccess:l,selectNraId:d}};var m=r(65950);function g(e){let{functionId:t,action:r,hasDT:n}=e,{getRequest:l}=(0,a.useContext)(m.$),{stack:d}=(0,i.V)();return{proxyAction:async()=>{let e=await f(l,t,"",void 0,n);(null==e?void 0:e.errorMessage)?d({message:null==e?void 0:e.errorMessage}):await r()}}}function y(e){var t;let{functionId:r,access:l,hasDT:d,enabled:o=!0,objectName:c=""}=e,{getRequest:s}=(0,a.useContext)(m.$),{stack:u}=(0,i.V)(),[g,y]=(0,a.useState)(),v=async e=>{let t=await f(s,r,l,e,d,c);if(!t.errorMessage)return t;u({message:null==t?void 0:t.errorMessage})},p=(0,n.a)({retry:!1,staleTime:0,enabled:o,queryKey:[r,g,!!l,o],queryFn:g||"nraId"===g?()=>v(g):()=>v()});return{documentType:p.data,maxAccess:(null==p?void 0:null===(t=p.data)||void 0===t?void 0:t.maxAccess)||l,changeDT(e){y((null==e?void 0:e.nraId)||"nraId")}}}}},function(e){e.O(0,[92515,2494,36908,44129,38096,49774,92888,40179],function(){return e(e.s=69100)}),_N_E=e.O()}]);