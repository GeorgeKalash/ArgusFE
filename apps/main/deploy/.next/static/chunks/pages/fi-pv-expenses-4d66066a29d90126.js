(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[79134],{6236:function(e,a,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fi-pv-expenses",function(){return l(10199)}])},10199:function(e,a,l){"use strict";l.r(a),l.d(a,{default:function(){return p}});var t=l(52322),n=l(2784),i=l(62202),d=l(69387),o=l(65950),u=l(71987),r=l(26612),s=l(31389),c=l(33625),v=l(62362),m=l(61802),x=l(19473),h=l(25870),f=l(40082),y=l(36908),p=()=>{var e,a;let{getRequest:l,postRequest:p}=(0,n.useContext)(o.$),{platformLabels:N,userDefaultsData:C}=(0,n.useContext)(x.l),{stack:b}=(0,m.zY)(),g=parseInt(null==C?void 0:null===(a=C.list)||void 0===a?void 0:null===(e=a.find(e=>"plantId"===e.key))||void 0===e?void 0:e.value);async function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:t=50,params:n}=e,i=await l({extension:h.H.PaymentVouchers.page2,parameters:"_startAt=".concat(a,"&_pageSize=").concat(t,"&_params=").concat(n||"","&filter=")});if(i&&(null==i?void 0:i.list)){var d;i.list=null==i?void 0:null===(d=i.list)||void 0===d?void 0:d.map(e=>({...e,isVerified:(null==e?void 0:e.isVerified)!==null&&(null==e?void 0:e.isVerified)}))}return{...i,_startAt:a}}async function V(e){let{filters:a,pagination:t}=e;return(null==a?void 0:a.qry)?await l({extension:h.H.PaymentVouchers.snapshot2,parameters:"_filter=".concat(a.qry)}):A({_startAt:t._startAt||0,params:null==a?void 0:a.params})}let{query:{data:F},labels:j,filterBy:I,paginationParameters:Z,refetch:_,access:M,invalidate:R}=(0,u.J)({queryFn:A,endpointId:h.H.PaymentVouchers.page2,datasetId:r.i.PaymentVoucherExpenses,filter:{filterFn:V}}),P=[{field:"plantName",headerName:j.plant,flex:1},{field:"reference",headerName:j.reference,flex:1},{field:"date",headerName:j.date,flex:1,type:"date"},{field:"currencyRef",headerName:j.currency,flex:1},{field:"paymentMethodName",headerName:j.paymentMethod,flex:1},{field:"amount",headerName:j.amount,flex:1,type:"number"},{field:"cashAccountName",headerName:j.cashAccount,flex:1},{field:"notes",headerName:j.notes,flex:1},{field:"isVerified",headerName:j.isVerified,type:"checkbox"},{field:"statusName",headerName:j.status,flex:1}];function T(e){b({Component:f.Z,props:{recordId:e,plantId:g}})}let w=async e=>{try{await p({extension:h.H.PaymentVouchers.del,record:JSON.stringify(e)}),R(),i.ZP.success(N.Deleted)}catch(e){}};return(0,t.jsxs)(s.R,{children:[(0,t.jsx)(c.g,{children:(0,t.jsx)(y.Z,{labels:j,onAdd:()=>{T()},maxAccess:M,reportName:"FIPVb",filterBy:I})}),(0,t.jsx)(v.Q,{children:(0,t.jsx)(d.Z,{columns:P,gridData:F,rowId:["recordId"],onEdit:e=>{T(null==e?void 0:e.recordId)},onDelete:w,isLoading:!1,pageSize:50,deleteConfirmationType:"strict",paginationType:"api",paginationParameters:Z,refetch:_,maxAccess:M})})]})}},77595:function(e,a,l){"use strict";l.d(a,{Z:function(){return b}});var t=l(52322),n=l(60218),i=l(2784),d=l(26612),o=l(5088),u=l(80983),r=l(31389),s=l(62362),c=l(91406),v=l(30657),m=l(65950),x=l(1251),h=l(39812),f=l(26553),y=l(71987),p=l(21326),N=l(19473),C=l(54074);function b(e){var a,l,b,g,A,V,F,j,I;let{data:Z,onOk:_,DatasetIdAccess:M,window:R}=e,{getRequest:P}=(0,i.useContext)(m.$),{platformLabels:T}=(0,i.useContext)(N.l);(0,p.Z)({title:T.MultiCurrencyRate,window:R});let{labels:w,access:O}=(0,y.J)({endpointId:x.q.Currency.get,DatasetIdAccess:M,datasetId:d.i.MultiCurrencyRate}),{formik:k}=(0,u.c)({initialValues:{currencyId:null==Z?void 0:Z.currencyId,currencyName:null==Z?void 0:Z.currencyName,exchangeId:null==Z?void 0:Z.exchangeId,exchangeName:null==Z?void 0:Z.exchangeName,rateCalcMethod:null==Z?void 0:Z.rateCalcMethod,rateCalcMethodName:null==Z?void 0:Z.rateCalcMethodName,rateTypeId:null==Z?void 0:Z.rateTypeId,exRate:(null==Z?void 0:Z.exRate)||null,amount:(null==Z?void 0:Z.amount)||0,baseAmount:null==Z?void 0:Z.baseAmount,rateTypeName:null==Z?void 0:Z.rateTypeName},maxAccess:O,validateOnChange:!0});async function E(){if((null==Z?void 0:Z.currencyId)&&(null==Z?void 0:Z.date)){var e,a,l,t,n;let i=await P({extension:x.q.Currency.get,parameters:"_currencyId=".concat(null==Z?void 0:Z.currencyId,"&_date=").concat((0,h.Uf)(null==Z?void 0:Z.date),"&_rateDivision=").concat(f.B.FINANCIALS)});k.setFieldValue("rateCalcMethod",null===(e=i.record)||void 0===e?void 0:e.rateCalcMethod),k.setFieldValue("rateCalcMethodName",null===(a=i.record)||void 0===a?void 0:a.rateCalcMethodName),k.setFieldValue("exchangeId",null===(l=i.record)||void 0===l?void 0:l.exchangeId),k.setFieldValue("exchangeName",null===(t=i.record)||void 0===t?void 0:t.exchangeName),k.setFieldValue("rateTypeName",null===(n=i.record)||void 0===n?void 0:n.rateTypeName)}}(0,i.useEffect)(()=>{!async function(){await E()}()},[]);let S=()=>{_&&(_({...k.values,exRate:k.values.exRate,baseAmount:k.values.baseAmount,amount:k.values.amount}),R.close())},q=[{key:"Ok",condition:!0,onClick:S,disabled:!1}];return(0,t.jsx)(C.Z,{onSave:S,actions:q,maxAccess:O,editMode:!1,isSaved:!1,children:(0,t.jsx)(r.R,{children:(0,t.jsx)(s.Q,{children:(0,t.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,t.jsx)(n.ZP,{item:!0,xs:12,children:(0,t.jsx)(o.Z,{name:"currencyName",value:null==k?void 0:null===(a=k.values)||void 0===a?void 0:a.currencyName,label:w.currency,readOnly:!0})}),(0,t.jsx)(n.ZP,{item:!0,xs:12,children:(0,t.jsx)(o.Z,{name:"rateTypeName",value:null==k?void 0:null===(l=k.values)||void 0===l?void 0:l.rateTypeName,label:w.rateType,readOnly:!0})}),(0,t.jsx)(n.ZP,{item:!0,xs:12,children:(0,t.jsx)(o.Z,{name:"exchangeName",value:null==k?void 0:null===(b=k.values)||void 0===b?void 0:b.exchangeName,label:w.exchangeTable,readOnly:!0})}),(0,t.jsx)(n.ZP,{item:!0,xs:12,children:(0,t.jsx)(o.Z,{name:"rateCalcMethodName",value:null==k?void 0:null===(g=k.values)||void 0===g?void 0:g.rateCalcMethodName,label:w.rateCalcMethod,readOnly:!0})}),(0,t.jsx)(n.ZP,{item:!0,xs:12,children:(0,t.jsx)(c.Z,{name:"exRate",value:null==k?void 0:null===(A=k.values)||void 0===A?void 0:A.exRate,label:w.rate,readOnly:(null==k?void 0:null===(V=k.values)||void 0===V?void 0:V.amount)==0,maxAccess:O,onClear:()=>{k.setFieldValue("baseAmount",""),k.setFieldValue("exRate","")},decimalScale:7,onChange:e=>{var a,l;let t=e.target.value;if(!t){k.setFieldValue("exRate",""),k.setFieldValue("baseAmount","");return}k.setFieldValue("exRate",t);let n=(0,v.fB)({amount:(null==Z?void 0:Z.amount)||0,exRate:t,baseAmount:parseFloat((null==k?void 0:null===(a=k.values)||void 0===a?void 0:a.baseAmount)||0).toFixed(2),rateCalcMethod:null==k?void 0:null===(l=k.values)||void 0===l?void 0:l.rateCalcMethod,dirtyField:v.ss});k.setValues({...k.values,...n,baseAmount:parseFloat(n.baseAmount).toFixed(2)})}})}),(0,t.jsx)(n.ZP,{item:!0,xs:12,children:(0,t.jsx)(c.Z,{name:"amount",value:null==k?void 0:null===(F=k.values)||void 0===F?void 0:F.amount,label:w.amount,readOnly:!0})}),(0,t.jsx)(n.ZP,{item:!0,xs:12,children:(0,t.jsx)(c.Z,{name:"baseAmount",value:null==k?void 0:null===(j=k.values)||void 0===j?void 0:j.baseAmount,label:w.baseAmount,readOnly:(null==k?void 0:null===(I=k.values)||void 0===I?void 0:I.amount)==0,onClear:()=>{k.setFieldValue("baseAmount",""),k.setFieldValue("exRate","")},maxAccess:O,onChange:e=>{var a,l;let t=e.target.value;if(!t){k.setFieldValue("baseAmount",""),k.setFieldValue("exRate","");return}k.setFieldValue("baseAmount",t);let n=(0,v.fB)({amount:(null==Z?void 0:Z.amount)||0,exRate:null==k?void 0:null===(a=k.values)||void 0===a?void 0:a.exRate,baseAmount:parseFloat(t||0).toFixed(2),rateCalcMethod:null==k?void 0:null===(l=k.values)||void 0===l?void 0:l.rateCalcMethod,dirtyField:v.i5});k.setValues({...k.values,...n})}})})]})})})})}b.width=500,b.height=500}},function(e){e.O(0,[92515,2494,36908,62482,40082,49774,92888,40179],function(){return e(e.s=6236)}),_N_E=e.O()}]);