(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[45125],{99237:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/change-password",function(){return a(79883)}])},79883:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return i}});var n=a(52322),t=a(61802),r=a(26612),o=a(15153),i=()=>(0,n.jsx)(t.ut,{datasetId:r.i.ChangePassword,labelKey:"ChangePassword",Component:o.Z})},62795:function(e,s,a){"use strict";a.d(s,{P:function(){return t}});let n="MA.asmx/",t={Identity:{set:n+"setID",get:n+"getID"},UserIdentity:{check:n+"check"},changePW:n+"changePW"}},1685:function(e,s,a){"use strict";a.d(s,{m:function(){return n}});let n=e=>{let s=window.sessionStorage.getItem(e);return s?JSON.parse(s):null}},15153:function(e,s,a){"use strict";var n=a(52322),t=a(2784),r=a(60218),o=a(44258),i=a(9737),l=a(5088),c=a(62362),d=a(31389),u=a(80983),w=a(62202),p=a(48601),h=a(34257),m=a(96026),x=a(85325),f=a(2422),P=a(19473),v=a(21326),g=a(91406),y=a(62795),Z=a(65950),_=a(1685),j=a(7087),k=a.n(j);let C=e=>{var s,j;let{_labels:C,reopenLogin:N=!1,loggedUser:E,window:D,username:I="",onClose:S}=e,[b,V]=(0,t.useState)(0),[O,W]=(0,t.useState)(!1),{stack:F}=(0,m.V)(),T=(0,h.a)(),{encryptePWD:M,getAccessToken:q}=(0,t.useContext)(x.V),{platformLabels:B}=(0,t.useContext)(P.l),{getIdentityRequest:J,postIdentityRequest:R}=(0,t.useContext)(Z.$);(0,v.Z)({title:B.ChangePassword,window:D});let U=(0,_.m)("userData");(0,t.useEffect)(()=>{!async function(){if(!1==N){var e;let s=await J({extension:y.P.Identity.get,parameters:"_email=".concat(null==U?void 0:U.username)});X.setFieldValue("passwordExpiryDays",null===(e=s.record)||void 0===e?void 0:e.passwordExpiryDays)}}()},[N]);let{formik:X}=(0,u.c)({validateOnChange:!0,initialValues:{username:I||(null==T?void 0:null===(s=T.user)||void 0===s?void 0:s.username),password:"",newPassword:"",confirmPassword:""},validationSchema:p.Ry({newPassword:p.Z_().required(),confirmPassword:p.Z_().required()}),onSubmit:async()=>{if(X.values.newPassword===X.values.confirmPassword){let e;let s={userName:X.values.username,oldPW:M(X.values.password),newPW:M(X.values.newPassword)};if(!(e=E&&E.accessToken?E.accessToken:await q()))throw Error("Failed to retrieve access token");await R({extension:y.P.changePW,accessToken:e,record:JSON.stringify(s)}).then(e=>{w.ZP.success(C.passSuccess),X.setFieldValue("password",""),X.setFieldValue("newPassword",""),X.setFieldValue("confirmPassword",""),V(0)}),!0===N&&(D.close(),S())}else w.ZP.error(C.passNotMatching)}});return(0,n.jsx)(d.R,{children:(0,n.jsxs)(c.Q,{children:[(0,n.jsxs)(r.ZP,{container:!0,spacing:2,sx:{pl:"10px",pt:"10px",pr:"10px"},children:[(0,n.jsx)(r.ZP,{item:!0,xs:12,children:(0,n.jsx)(g.Z,{name:"passwordExpiryDays",label:C.passwordExpiryDays,value:null===(j=X.values)||void 0===j?void 0:j.passwordExpiryDays,readOnly:!0,hidden:N})}),(0,n.jsx)(r.ZP,{item:!0,xs:12,children:(0,n.jsx)(l.Z,{name:"password",fullWidth:!0,label:C.password,type:O?"text":"password",value:X.values.password,onChange:X.handleChange,error:X.touched.password&&X.errors.password,startIcons:[(0,n.jsx)("div",{className:k().iconButton,children:(0,n.jsx)("img",{className:k().iconImage,src:a(8440).Z.src})})],endIcons:[(0,n.jsx)(o.Z,{className:k().iconButton,onClick:()=>W(!O),onMouseDown:e=>e.preventDefault(),children:(0,n.jsx)(i.Z,{className:k().icon,icon:O?"mdi:eye-outline":"mdi:eye-off-outline"})})]})})]}),(0,n.jsx)(f.Z,{formik:X,labels:C,score:b,setScore:V})]})})};C.width=600,C.height=400,s.Z=C}},function(e){e.O(0,[41697,49774,92888,40179],function(){return e(e.s=99237)}),_N_E=e.O()}]);