(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53427],{52991:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/hr-lr-less",function(){return t(66658)}])},66658:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return g}});var r=t(52322),n=t(2784),l=t(69387),s=t(65950),d=t(71987),i=t(26612),o=t(31389),u=t(33625),c=t(62362),v=t(36908),m=t(50496),f=t(51682),y=t(61802),h=t(98345),p=t(7121),x=t(62202),I=t(19473),g=()=>{let{getRequest:e,postRequest:a}=(0,n.useContext)(s.$),{stack:t}=(0,y.zY)(),{platformLabels:g}=(0,n.useContext)(I.l);async function D(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:r=50,params:n}=a;return{...await e({extension:m.U.LeaveRequest.page,parameters:"_startAt=".concat(t,"&_pageSize=").concat(r,"&_size=50&_filter=&_sortBy=recordId&_multiDayLeave=1&_params=").concat(n||"")}),_startAt:t}}let{query:{data:N},labels:w,paginationParameters:R,filterBy:q,refetch:_,access:b,invalidate:j}=(0,d.J)({queryFn:D,endpointId:m.U.LeaveRequest.page,datasetId:i.i.LeaveRequest,filter:{filterFn:C,default:{_multiDayLeave:1}}});async function C(a){let{filters:t,pagination:r}=a;return t.qry?await e({extension:m.U.LeaveRequest.snapshot,parameters:"_filter=".concat(t.qry,"&_multiDayLeave=1")}):D({_startAt:r._startAt||0,params:null==t?void 0:t.params})}let{proxyAction:k}=(0,h.G)({functionId:p.J.LeaveRequest,action:F}),Z=[{field:"reference",headerName:w.reference,flex:1},{field:"employeeRef",headerName:w.employeeRef,flex:1},{field:"employeeName",headerName:w.employeeName,flex:1},{field:"startDate",headerName:w.startDate,flex:1,type:"date"},{field:"endDate",headerName:w.endDate,flex:1,type:"date"},{field:"actualReturnDate",headerName:w.actualReturnDate,flex:1,type:"date"},{field:"leaveDays",headerName:w.leaveDays,flex:1},{field:"ltName",headerName:w.lateDays,flex:1},{field:"statusName",headerName:w.status,flex:1},{field:"rsName",headerName:w.releaseStatus,flex:1},{field:"wipName",headerName:w.wip,flex:1}];function F(e){t({Component:f.Z,props:{recordId:e}})}let L=async e=>{await a({extension:m.U.LeaveRequest.del,record:JSON.stringify(e)}),j(),x.ZP.success(g.Deleted)};return(0,r.jsxs)(o.R,{children:[(0,r.jsx)(u.g,{children:(0,r.jsx)(v.Z,{onAdd:()=>{k()},maxAccess:b,reportName:"LMLR",filterBy:q})}),(0,r.jsx)(c.Q,{children:(0,r.jsx)(l.Z,{name:"table",columns:Z,gridData:N,rowId:["recordId"],onEdit:e=>{F(null==e?void 0:e.recordId)},onDelete:L,pageSize:50,refetch:_,paginationParameters:R,paginationType:"api",maxAccess:b})})]})}},1685:function(e,a,t){"use strict";t.d(a,{m:function(){return r}});let r=e=>{let a=window.sessionStorage.getItem(e);return a?JSON.parse(a):null}},98345:function(e,a,t){"use strict";t.d(a,{H:function(){return y},G:function(){return f}});var r=t(45300),n=t(2784),l=t(96026),s=t(38449);t(26612);var d=t(65947),i=t(1685);let o=async(e,a,t)=>{try{let r=await e({extension:a,parameters:t});return a.includes("qry")?r:r.record}catch(e){return null}},u=(e,a,t,r)=>{let n=(e=JSON.parse(JSON.stringify(e))).record.controls,l=n.find(e=>"reference"===e.controlId);return l?l.accessLevel=(null==a?void 0:a.mandatory)?d.$7:d.rr:(null==a?void 0:a.mandatory)?n.push({sgId:0,resourceId:"",controlId:"".concat(r?r+".":"","reference"),accessLevel:(null==a?void 0:a.mandatory)?d.$7:d.rr}):(null==a?void 0:a.readOnly)?n.push({sgId:0,resourceId:"",controlId:"".concat(r?r+".":"","reference"),accessLevel:(null==a?void 0:a.readOnly)?d.rr:d.$7}):n=e.record.controls.filter(e=>"reference"!=e.controlId),t&&n.push({sgId:0,resourceId:"",controlId:"".concat(r?r+".":"","dtId"),accessLevel:d.$7}),{...e,record:{...e.record,controls:n}}},c=async(e,a,t)=>{let r,n;switch(t){case"dtId":let l=(0,i.m)("userData"),d=null==l?void 0:l.userId;n="_userId=".concat(d,"&_functionId=").concat(a),r=s.r.UserFunction.get;break;case"glbSysNumberRange":n="_recordId=".concat(a),r=s.r.SystemFunction.get;break;case"DocumentType":n="_dgId=".concat(a,"&_startAt=",0,"&_pageSize=",50),r=s.r.DocumentType.qry;break;case"DcTypNumberRange":n="_recordId=".concat(a),r=s.r.DocumentType.get;break;case"isExternal":n="_recordId=".concat(a),r=s.r.NumberRange.get;break;default:return null}return await o(e,r,n)},v=async function(e){let a,t,r,n,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=!(arguments.length>4)||void 0===arguments[4]||arguments[4],o=arguments.length>5?arguments[5]:void 0,v=void 0===d&&l&&await c(e,l,"dtId"),m=null==v?void 0:v.dtId,f="",y=!0;if(v&&void 0===d||"nraId"===d){if(m){let t=await c(e,m,"DcTypNumberRange");a=null==t?void 0:t.nraId,y=!((null==t?void 0:t.activeStatus)<0),a||(f="Assign the document type to a number range")}if((!m||!y)&&i&&l){var h;let a=await c(e,l,"DocumentType");n=(null==a?void 0:null===(h=a.list)||void 0===h?void 0:h.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===d||void 0===d)&&l){if((!m||m)&&!a||a&&!y){let t=await c(e,l,"glbSysNumberRange");(a=null==t?void 0:t.nraId)&&n&&(n=!1),y=!0}f=a||n?"":"Assign the system Function to a number range"}d>0&&!a&&(a=d),a&&y?(t={readOnly:null==(r=await c(e,a,"isExternal"))||!r.external,mandatory:null!=r&&!!r.external},s&&(s=await u(s,t,n,o))):!a&&s&&(s=await u(s,t,n,o));let p=o?"".concat(o,".reference"):"reference";return{dtId:m,resetReference:null==t?void 0:t.readOnly,dcTypeRequired:n,reference:{fieldName:p,isEmpty:(null==r?void 0:r.external)!==void 0&&(null==r||!r.external)},errorMessage:f,maxAccess:s,selectNraId:d}};var m=t(65950);function f(e){let{functionId:a,action:t,hasDT:r}=e,{getRequest:s}=(0,n.useContext)(m.$),{stack:d}=(0,l.V)();return{proxyAction:async()=>{let e=await v(s,a,"",void 0,r);(null==e?void 0:e.errorMessage)?d({message:null==e?void 0:e.errorMessage}):await t()}}}function y(e){var a;let{functionId:t,access:s,hasDT:d,enabled:i=!0,objectName:o=""}=e,{getRequest:u}=(0,n.useContext)(m.$),{stack:c}=(0,l.V)(),[f,y]=(0,n.useState)(),h=async e=>{let a=await v(u,t,s,e,d,o);if(!a.errorMessage)return a;c({message:null==a?void 0:a.errorMessage})},p=(0,r.a)({retry:!1,staleTime:0,enabled:i,queryKey:[t,f,!!s,i],queryFn:f||"nraId"===f?()=>h(f):()=>h()});return{documentType:p.data,maxAccess:(null==p?void 0:null===(a=p.data)||void 0===a?void 0:a.maxAccess)||s,changeDT(e){y((null==e?void 0:e.nraId)||"nraId")}}}},51682:function(e,a,t){"use strict";t.d(a,{Z:function(){return C}});var r=t(52322),n=t(60218),l=t(2784),s=t(48601),d=t(82737),i=t(62202),o=t(65950),u=t(71987),c=t(26612),v=t(5088),m=t(80983),f=t(19473),y=t(31389),h=t(62362),p=t(50496),x=t(27423),I=t(92407),g=t(89330),D=t(91406),N=t(21581),w=t(39812),R=t(7121),q=t(98345),_=t(8661),b=t(50023),j=t(21326);function C(e){var a,t,C;let{recordId:k,window:Z}=e,{getRequest:F,postRequest:L}=(0,l.useContext)(o.$),{platformLabels:A}=(0,l.useContext)(f.l),{labels:S,access:O}=(0,b.Z)({datasetId:c.i.LeaveRequest,editMode:!!k});(0,j.Z)({title:S.title,window:Z});let V=(0,u.E)({endpointId:p.U.LeaveRequest.page}),{maxAccess:P}=(0,q.H)({functionId:R.J.LeaveRequest,access:O,enabled:!k}),{formik:T}=(0,m.c)({initialValues:{recordId:null,name:"",startDate:null,endDate:null,date:new Date,employeeId:null,justification:"",destination:"",ltId:null,status:1,reference:"",hours:null,multiDayLeave:1,wip:1},maxAccess:P,validateOnChange:!0,validationSchema:s.Ry({hours:s.Rx().required(),startDate:s.hT().required(),date:s.hT().required(),destination:s.Z_().required(),employeeId:s.Rx().required(),ltId:s.Rx().required(),justification:s.Z_().required()}),onSubmit:async e=>{let a=await L({extension:p.U.LeaveRequest.set,record:JSON.stringify({...e,date:(0,w.ku)(e.date),startDate:(0,w.ku)(e.startDate),endDate:(0,w.ku)(e.endDate)})});i.ZP.success(e.recordId?A.Edited:A.Added),J(a.recordId),V()}}),E=!!T.values.recordId,U=(null==T?void 0:null===(a=T.values)||void 0===a?void 0:a.wip)===2;async function J(e){if(e){let{record:a}=await F({extension:p.U.LeaveRequest.get,parameters:"_recordId=".concat(e)});T.setValues({...a,date:(0,w.a1)(a.date),startDate:(0,w.a1)(a.startDate),endDate:(0,w.a1)(a.endDate)})}}(0,l.useEffect)(()=>{J(k)},[]);let $=[{key:"Close",condition:!U,onClick:async()=>{await L({extension:p.U.LeaveRequest.close,record:JSON.stringify({...T.values,date:(0,w.ku)(T.values.date),startDate:(0,w.ku)(T.values.startDate),endDate:(0,w.ku)(T.values.endDate)})}),i.ZP.success(A.Closed),J(T.values.recordId),V()},disabled:U||!E},{key:"Reopen",condition:U,onClick:async()=>{await L({extension:p.U.LeaveRequest.reopen,record:JSON.stringify({...T.values,date:(0,w.ku)(T.values.date),startDate:(0,w.ku)(T.values.startDate),endDate:(0,w.ku)(T.values.endDate)})}),i.ZP.success(A.Reopened),J(T.values.recordId),V()},disabled:!U||!E||3===T.values.releaseStatus},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!U}];return(0,r.jsx)(d.Z,{resourceId:c.i.LeaveRequest,functionId:R.J.LeaveRequest,previewReport:E,form:T,maxAccess:P,editMode:E,actions:$,children:(0,r.jsx)(y.R,{children:(0,r.jsx)(h.Q,{children:(0,r.jsxs)(n.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(v.Z,{name:"reference",label:S.ref,value:T.values.reference,maxAccess:P,maxLength:"30",readOnly:U,onChange:T.handleChange,onClear:()=>T.setFieldValue("reference",""),error:T.touched.reference&&!!T.errors.reference})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(x.U,{endpointId:I.y.Employee.snapshot,parameters:{_branchId:0},filter:{activeStatus:1},valueField:"reference",displayField:"fullName",name:"employeeId",required:!0,label:S.employee,secondFieldLabel:S.employeeName,form:T,readOnly:U,displayFieldWidth:2,valueShow:"employeeRef",secondValueShow:"employeeName",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"fullName",value:"Name"}],maxAccess:P,onChange:async(e,a)=>{T.setFieldValue("employeeRef",(null==a?void 0:a.reference)||""),T.setFieldValue("employeeName",(null==a?void 0:a.fullName)||""),T.setFieldValue("employeeId",(null==a?void 0:a.recordId)||null)},errorCheck:"employeeId"})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(g.Z,{name:"date",label:S.date,value:null===(t=T.values)||void 0===t?void 0:t.date,required:!0,readOnly:U,onChange:(e,a)=>{T.setFieldValue("date",a||null)},onClear:()=>T.setFieldValue("date",null),error:T.touched.date&&!!T.errors.date,maxAccess:P})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(g.Z,{name:"startDate",label:S.startDate,value:null===(C=T.values)||void 0===C?void 0:C.startDate,required:!0,readOnly:U,onChange:(e,a)=>{T.setFieldValue("startDate",a||null),T.setFieldValue("endDate",a||null)},onClear:()=>{T.setFieldValue("startDate",null),T.setFieldValue("endDate",null)},error:T.touched.startDate&&!!T.errors.startDate,maxAccess:P})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(D.Z,{name:"hours",label:S.hours,value:T.values.hours,maxAccess:P,readOnly:U,required:!0,onChange:e=>T.setFieldValue("hours",e.target.value),onClear:()=>T.setFieldValue("hours",null),error:T.touched.hours&&!!T.errors.hours,decimalScale:2})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(N.Z,{name:"justification",label:S.justification,value:T.values.justification,rows:3,required:!0,readOnly:U,maxAccess:P,onChange:T.handleChange,onClear:()=>T.setFieldValue("justification",""),error:T.touched.justification&&!!T.errors.justification})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(v.Z,{name:"destination",label:S.destination,value:T.values.destination,onChange:T.handleChange,required:!0,readOnly:U,maxLength:100,maxAccess:P,onClear:()=>T.setFieldValue("destination",""),error:T.touched.destination&&!!T.errors.destination})}),(0,r.jsx)(n.ZP,{item:!0,xs:12,children:(0,r.jsx)(_.Z,{endpointId:p.U.IndemnityAccuralsFilters.qry,name:"ltId",label:S.leaveType,valueField:"recordId",values:T.values,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,readOnly:E,maxAccess:P,onChange:(e,a)=>{T.setFieldValue("ltId",null==a?void 0:a.recordId)},error:T.touched.ltId&&!!T.errors.ltId})})]})})})})}C.width=800,C.height=500}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=52991)}),_N_E=e.O()}]);