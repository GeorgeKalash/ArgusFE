(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[13098],{22288:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/batchpost",function(){return n(36339)}])},36339:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var a=n(52322),r=n(2784),s=n(61802),c=n(60218),l=n(48601),i=n(62202),o=n(65950),d=n(31389),u=n(62362),h=n(80983),p=n(8661),x=n(38449),f=n(27423),m=n(89330),v=n(19473),b=n(84309),w=n(54074);function j(e){var t,n;let{access:j}=e,{postRequest:I}=(0,r.useContext)(o.$),{platformLabels:P}=(0,r.useContext)(v.l),{stack:g}=(0,s.zY)(),Z=new URLSearchParams(window.location.search),_=Z.get("api"),D=Z.get("status"),C=new Date,y=new Date;y.setMonth(0),y.setDate(1);let{formik:S}=(0,h.c)({initialValues:{startDate:y,endDate:C,status:parseInt(D)},maxAccess:j,validateOnChange:!0,validationSchema:l.Ry({startDate:l.Z_().required(),endDate:l.Z_().required()}),onSubmit:async e=>{e.batchId||(delete e.batchId,delete e.batchRef,delete e.batchName);let t=await I({extension:_,record:JSON.stringify(e)});g({Component:b.R,props:{recordId:t.recordId},closable:!1}),i.ZP.success(P.Added)}});return(0,a.jsx)(w.Z,{onSave:S.handleSubmit,actions:[{key:"Locked",condition:!0,onClick:()=>S.handleSubmit(),disabled:!1}],isSaved:!1,editMode:!0,maxAccess:j,children:(0,a.jsx)(d.R,{children:(0,a.jsx)(u.Q,{children:(0,a.jsxs)(c.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(c.ZP,{item:!0,xs:12,children:(0,a.jsx)(m.Z,{name:"startDate",label:P.startDate,value:null===(t=S.values)||void 0===t?void 0:t.startDate,required:!0,onChange:S.setFieldValue,onClear:()=>S.setFieldValue("startDate",""),error:S.touched.startDate&&!!S.errors.startDate,maxAccess:j})}),(0,a.jsx)(c.ZP,{item:!0,xs:12,children:(0,a.jsx)(m.Z,{name:"endDate",label:P.endDate,value:null===(n=S.values)||void 0===n?void 0:n.endDate,required:!0,onChange:S.setFieldValue,onClear:()=>S.setFieldValue("endDate",""),error:S.touched.endDate&&!!S.errors.endDate,maxAccess:j})}),(0,a.jsx)(c.ZP,{item:!0,xs:12,children:(0,a.jsx)(p.Z,{endpointId:x.r.Plant.qry,name:"plantId",label:P.plant,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"plant Ref"},{key:"name",value:"Name"}],values:S.values,onChange:(e,t)=>S.setFieldValue("plantId",(null==t?void 0:t.recordId)||null),error:S.touched.plantId&&!!S.errors.plantId,maxAccess:j})}),(0,a.jsx)(c.ZP,{item:!0,xs:12,children:(0,a.jsx)(f.U,{endpointId:x.r.Batch.snapshot,parameters:{_sortBy:"recordId desc",_functionId:5102},name:"batchId",label:P.batch,valueField:"reference",displayField:"name",valueShow:"batchRef",secondValueShow:"batchName",displayFieldWidth:2,form:S,onChange:(e,t)=>{S.setFieldValue("batchId",(null==t?void 0:t.recordId)||""),S.setFieldValue("batchRef",(null==t?void 0:t.reference)||""),S.setFieldValue("batchName",(null==t?void 0:t.name)||"")},error:S.touched.batchId&&!!S.errors.batchId,maxAccess:j})})]})})})})}var I=()=>{let{platformLabels:e}=(0,r.useContext)(v.l);return(0,a.jsx)(s.ut,{titleName:e.BatchPost,Component:j})}},84309:function(e,t,n){"use strict";n.d(t,{R:function(){return k}});var a=n(73235),r=n(52322),s=n(3854),c=n(2784),l=n(82737),i=n(65950),o=n(62362),d=n(31389),u=n(60218),h=n(21581),p=n(38449),x=n(5088),f=n(19473),m=n(21326);function v(){let e=(0,a._)(["\n  container-type: inline-size;\n  font-size: clamp(12px, 3.2cqw, 16px);\n"]);return v=function(){return e},e}function b(){let e=(0,a._)(["\n  font-size: clamp(10px, 2.2cqw, 12px);\n  font-weight: 600;\n  color: #888888;\n  position: absolute;\n  width: 100%;\n  text-align: center;\n  top: 50%;\n  transform: translateY(-50%);\n"]);return b=function(){return e},e}function w(){let e=(0,a._)(["\n  font-size: clamp(11px, 2.4cqw, 13px);\n  font-weight: 600;\n  margin-bottom: 3px;\n  margin-top: 5px;\n  color: #000;\n"]);return w=function(){return e},e}function j(){let e=(0,a._)(["\n  width: 100%;\n  height: clamp(28px, 7cqw, 35px);\n  background-color: #f0f0f0;\n  border-radius: 5px;\n  overflow: hidden;\n  margin: 10px 0;\n  position: relative;\n"]);return j=function(){return e},e}function I(){let e=(0,a._)(["\n  container-type: inline-size;\n"]);return I=function(){return e},e}function P(){let e=(0,a._)(["\n  height: 100%;\n  background-color: #cce6ff;\n  transition: width 1.5s ease-in-out;\n"]);return P=function(){return e},e}let g=s.ZP.div(v()),Z=s.ZP.span(b()),_=s.ZP.span(w()),D=s.ZP.div(j()),C=s.ZP.div(I()),y=s.ZP.div(P());function S(e){let{label:t,topLabel:n,width:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsxs)(_,{children:[n,": "]}),(0,r.jsxs)(D,{children:[(0,r.jsx)(y,{style:{width:a}}),(0,r.jsx)(Z,{children:t})]})]})}let k=e=>{let{recordId:t,onComplete:n,access:a,window:s}=e,{getRequest:v}=(0,c.useContext)(i.$),{platformLabels:b}=(0,c.useContext)(f.l);(0,m.Z)({title:b.Progress,window:s});let[w,j]=(0,c.useState)({recordId:t,iterations:0,completed:0,phases:0,currentPhase:0,currentPhaseName:"",logInfo:"",status:0}),I=async()=>(await v({extension:p.r.THD.get,parameters:"_recordId=".concat(t)})).record,P=w.currentPhase===w.phases&&w.completed===w.iterations,Z=!!w.status&&w.status<0;(0,c.useEffect)(()=>{n&&(P||Z)&&n()},[Z,P]),(0,c.useEffect)(()=>{(async()=>{j(await I())})();let e=setInterval(async()=>{let t=await I();j(t);let n=t.currentPhase===t.phases&&t.completed===t.iterations,a=!!t.status&&t.status<0;(t.status&&t.status<0||n||a)&&clearInterval(e)},2e3);return()=>clearInterval(e)},[]);let _=w.phases?w.currentPhase/w.phases*100:0,D=w.iterations?w.completed/w.iterations*100:0;return(0,r.jsx)(l.Z,{form:w,maxAccess:a,isInfo:!1,editMode:!0,isCleared:!1,actions:[{key:"Cancel",condition:!0,onClick:()=>s.close(),disabled:!P&&!Z}],isSaved:!1,children:(0,r.jsx)(d.R,{children:(0,r.jsx)(o.Q,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(x.Z,{name:"phase",label:b.Phase,value:w.currentPhaseName,readOnly:!0,maxAccess:a})}),(0,r.jsxs)(C,{children:[(0,r.jsx)(S,{label:"".concat(b.Step," ").concat(w.currentPhase," of ").concat(w.phases,"..."),topLabel:b.currentPhase,width:"".concat(_,"%")}),(0,r.jsx)(S,{label:"".concat(b.Step," ").concat(w.completed," of ").concat(w.iterations,"..."),topLabel:b.Completed,width:"".concat(D,"%")})]}),(0,r.jsx)(h.Z,{name:"log",label:b.Log,value:w.logInfo,rows:4,maxAccess:a,readOnly:!0})]})})})})};k.width=500,k.height=450}},function(e){e.O(0,[3854,49774,92888,40179],function(){return e(e.s=22288)}),_N_E=e.O()}]);