(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[47841],{51979:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sa-cog-sites",function(){return t(29234)}])},29234:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return w}});var i=t(52322),s=t(2784),r=t(62202),a=t(69387),l=t(27723),d=t(65950),c=t(61802),o=t(71987),u=t(26612),f=t(31389),m=t(33625),x=t(62362),h=t(19473),I=t(22341),p=t(60218),g=t(48601),_=t(82737),y=t(80983),N=t(8661),S=t(27423),C=t(65215);function v(e){let{labels:n,maxAccess:t,recordId:a}=e,{platformLabels:l}=(0,s.useContext)(h.l),{getRequest:c,postRequest:m}=(0,s.useContext)(d.$),v=(0,o.E)({endpointId:I.P.ConsignmentSites.qry}),{formik:w}=(0,y.c)({initialValues:{recordId:a||null,clientId:"",siteId:"",clientRef:""},maxAccess:t,validationSchema:g.Ry({clientRef:g.Z_().required()}),onSubmit:async e=>{await m({extension:I.P.ConsignmentSites.set,record:JSON.stringify(e)}),w.values.recordId?r.ZP.success(l.Edited):(w.setFieldValue("recordId",w.values.clientId),r.ZP.success(l.Added)),v()}}),P=!!w.values.recordId;return(0,s.useEffect)(()=>{!async function(){if(a){let e=await c({extension:I.P.ConsignmentSites.get,parameters:"_clientId=".concat(a)});w.setValues({...e.record,recordId:e.record.clientId})}}()},[]),(0,i.jsx)(_.Z,{resourceId:u.i.ConsignmentSites,form:w,maxAccess:t,editMode:P,children:(0,i.jsx)(f.R,{children:(0,i.jsx)(x.Q,{children:(0,i.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,i.jsx)(p.ZP,{item:!0,xs:12,children:(0,i.jsx)(S.U,{endpointId:I.P.Client.snapshot,parameters:"_startAt=0&_pageSize=50&_filter=",valueField:"reference",displayField:"name",name:"clientRef",label:n.client,form:w,required:!0,readOnly:P,valueShow:"clientRef",secondValueShow:"clientName",maxAccess:t,displayFieldWidth:2,columnsInDropDown:[{key:"reference",value:"Ref."},{key:"name",value:"Name"}],onChange:(e,n)=>{w.setFieldValue("clientId",n?n.recordId:""),w.setFieldValue("clientName",n?n.name:""),w.setFieldValue("clientRef",n?n.reference:"")},error:w.touched.clientRef&&!!w.errors.clientRef})}),(0,i.jsx)(p.ZP,{item:!0,xs:12,children:(0,i.jsx)(N.Z,{name:"siteId",endpointId:C.$.Site.qry,parameters:"_filter=",label:n.site,valueField:"recordId",displayField:"name",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:w.values,maxAccess:t,onChange:(e,n)=>{w.setFieldValue("siteId",n?n.recordId:"")},error:w.touched.siteId&&!!w.errors.siteId})})]})})})})}var w=()=>{let{getRequest:e,postRequest:n}=(0,s.useContext)(d.$),{platformLabels:t}=(0,s.useContext)(h.l),{stack:p}=(0,c.zY)();async function g(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:t=0,_pageSize:i=50}=n;return{...await e({extension:I.P.ConsignmentSites.qry,parameters:"_startAt=".concat(t,"&_pageSize=").concat(i,"&_filter=&_clientId=0")}),_startAt:t}}let{query:{data:_},labels:y,invalidate:N,paginationParameters:S,refetch:C,access:w}=(0,o.J)({queryFn:g,endpointId:I.P.ConsignmentSites.qry,datasetId:u.i.ConsignmentSites}),P=[{field:"clientRef",headerName:y.clientRef,flex:1},{field:"clientName",headerName:y.clientName,flex:1},{field:"siteRef",headerName:y.siteRef,flex:1},{field:"siteName",headerName:y.siteName,flex:1}],R=async e=>{await n({extension:I.P.ConsignmentSites.del,record:JSON.stringify(e)}),N(),r.ZP.success(t.Deleted)};function j(e){p({Component:v,props:{labels:y,recordId:null==e?void 0:e.clientId,maxAccess:w},width:600,height:300,title:y.consignmentSites})}return(0,i.jsxs)(f.R,{children:[(0,i.jsx)(m.g,{children:(0,i.jsx)(l.Z,{onAdd:()=>{j()},maxAccess:w})}),(0,i.jsx)(x.Q,{children:(0,i.jsx)(a.Z,{columns:P,gridData:_,rowId:["clientId"],onEdit:e=>{j(e)},onDelete:R,isLoading:!1,pageSize:50,refetch:C,paginationParameters:S,paginationType:"api",maxAccess:w})})]})}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=51979)}),_N_E=e.O()}]);