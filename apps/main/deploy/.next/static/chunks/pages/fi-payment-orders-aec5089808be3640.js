(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22129],{42091:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fi-payment-orders",function(){return a(47113)}])},47113:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var r=a(52322),n=a(2784),o=a(62202),c=a(69387),l=a(65950),d=a(71987),i=a(26612),s=a(31389),u=a(33625),m=a(62362),f=a(61802),p=a(19473),h=a(25870),y=a(36908),v=a(7121),g=a(98345),I=a(32304),x=()=>{let{getRequest:e,postRequest:t}=(0,n.useContext)(l.$),{platformLabels:a}=(0,n.useContext)(p.l),{stack:x}=(0,f.zY)();async function N(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:r=50,params:n}=t;return{...await e({extension:h.H.PaymentOrders.page2,parameters:"_startAt=".concat(a,"&_pageSize=").concat(r,"&_params=").concat(n||"")}),_startAt:a}}async function b(t){let{filters:a,pagination:r}=t;return(null==a?void 0:a.qry)?await e({extension:h.H.PaymentOrders.snapshot,parameters:"_filter=".concat(a.qry)}):N({_startAt:r._startAt||0,params:null==a?void 0:a.params})}let{query:{data:w},labels:_,filterBy:k,paginationParameters:O,refetch:S,access:A,invalidate:F}=(0,d.J)({queryFn:N,endpointId:h.H.PaymentOrders.page2,datasetId:i.i.PaymentOrder,filter:{filterFn:b}}),T=[{field:"date",headerName:_.date,flex:1,type:"date"},{field:"reference",headerName:_.reference,flex:1},{field:"accountTypeName",headerName:_.accountType,flex:1},{field:"accountRef",headerName:_.account,flex:1},{field:"accountName",headerName:_.accountName,flex:1},{field:"cashAccountName",headerName:_.cashAccount,flex:1},{field:"amount",headerName:_.amount,flex:1,type:"number"},{field:"currencyRef",headerName:_.currency,flex:1},{field:"notes",headerName:_.notes,flex:1},{field:"statusName",headerName:_.status,flex:1},{field:"rsName",headerName:_.releaseStatus,flex:1},{field:"wipName",headerName:_.wip,flex:1}],E=async()=>{await j()};function L(e){x({Component:I.Z,props:{recordId:e}})}let{proxyAction:j}=(0,g.G)({functionId:v.J.PaymentOrder,action:L}),C=async e=>{await t({extension:h.H.PaymentOrders.del,record:JSON.stringify(e)}),F(),o.ZP.success(a.Deleted)};return(0,r.jsxs)(s.R,{children:[(0,r.jsx)(u.g,{children:(0,r.jsx)(y.Z,{labels:_,onAdd:E,maxAccess:A,reportName:"FIPO",filterBy:k})}),(0,r.jsx)(m.Q,{children:(0,r.jsx)(c.Z,{name:"table",columns:T,gridData:w,rowId:["recordId"],onEdit:e=>{L(null==e?void 0:e.recordId)},onDelete:C,isLoading:!1,deleteConfirmationType:"strict",pageSize:50,paginationType:"api",paginationParameters:O,refetch:S,maxAccess:A})})]})}},1685:function(e,t,a){"use strict";a.d(t,{m:function(){return r}});let r=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,a){"use strict";a.d(t,{H:function(){return h},G:function(){return p}});var r=a(45300),n=a(2784),o=a(96026),c=a(38449);a(26612);var l=a(65947),d=a(1685);let i=async(e,t,a)=>{try{let r=await e({extension:t,parameters:a});return t.includes("qry")?r:r.record}catch(e){return null}},s=(e,t,a,r)=>{let n=(e=JSON.parse(JSON.stringify(e))).record.controls,o=n.find(e=>"reference"===e.controlId);return o?o.accessLevel=(null==t?void 0:t.mandatory)?l.$7:l.rr:(null==t?void 0:t.mandatory)?n.push({sgId:0,resourceId:"",controlId:"".concat(r?r+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?l.$7:l.rr}):(null==t?void 0:t.readOnly)?n.push({sgId:0,resourceId:"",controlId:"".concat(r?r+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?l.rr:l.$7}):n=e.record.controls.filter(e=>"reference"!=e.controlId),a&&n.push({sgId:0,resourceId:"",controlId:"".concat(r?r+".":"","dtId"),accessLevel:l.$7}),{...e,record:{...e.record,controls:n}}},u=async(e,t,a)=>{let r,n;switch(a){case"dtId":let o=(0,d.m)("userData"),l=null==o?void 0:o.userId;n="_userId=".concat(l,"&_functionId=").concat(t),r=c.r.UserFunction.get;break;case"glbSysNumberRange":n="_recordId=".concat(t),r=c.r.SystemFunction.get;break;case"DocumentType":n="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),r=c.r.DocumentType.qry;break;case"DcTypNumberRange":n="_recordId=".concat(t),r=c.r.DocumentType.get;break;case"isExternal":n="_recordId=".concat(t),r=c.r.NumberRange.get;break;default:return null}return await i(e,r,n)},m=async function(e){let t,a,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,d=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=arguments.length>5?arguments[5]:void 0,m=void 0===l&&o&&await u(e,o,"dtId"),f=null==m?void 0:m.dtId,p="",h=!0;if(m&&void 0===l||"nraId"===l){if(f){let a=await u(e,f,"DcTypNumberRange");t=null==a?void 0:a.nraId,h=!((null==a?void 0:a.activeStatus)<0),t||(p="Assign the document type to a number range")}if((!f||!h)&&d&&o){var y;let t=await u(e,o,"DocumentType");n=(null==t?void 0:null===(y=t.list)||void 0===y?void 0:y.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===l||void 0===l)&&o){if((!f||f)&&!t||t&&!h){let a=await u(e,o,"glbSysNumberRange");(t=null==a?void 0:a.nraId)&&n&&(n=!1),h=!0}p=t||n?"":"Assign the system Function to a number range"}l>0&&!t&&(t=l),t&&h?(a={readOnly:null==(r=await u(e,t,"isExternal"))||!r.external,mandatory:null!=r&&!!r.external},c&&(c=await s(c,a,n,i))):!t&&c&&(c=await s(c,a,n,i));let v=i?"".concat(i,".reference"):"reference";return{dtId:f,resetReference:null==a?void 0:a.readOnly,dcTypeRequired:n,reference:{fieldName:v,isEmpty:(null==r?void 0:r.external)!==void 0&&(null==r||!r.external)},errorMessage:p,maxAccess:c,selectNraId:l}};var f=a(65950);function p(e){let{functionId:t,action:a,hasDT:r}=e,{getRequest:c}=(0,n.useContext)(f.$),{stack:l}=(0,o.V)();return{proxyAction:async()=>{let e=await m(c,t,"",void 0,r);(null==e?void 0:e.errorMessage)?l({message:null==e?void 0:e.errorMessage}):await a()}}}function h(e){var t;let{functionId:a,access:c,hasDT:l,enabled:d=!0,objectName:i=""}=e,{getRequest:s}=(0,n.useContext)(f.$),{stack:u}=(0,o.V)(),[p,h]=(0,n.useState)(),y=async e=>{let t=await m(s,a,c,e,l,i);if(!t.errorMessage)return t;u({message:null==t?void 0:t.errorMessage})},v=(0,r.a)({retry:!1,staleTime:0,enabled:d,queryKey:[a,p,!!c,d],queryFn:p||"nraId"===p?()=>y(p):()=>y()});return{documentType:v.data,maxAccess:(null==v?void 0:null===(t=v.data)||void 0===t?void 0:t.maxAccess)||c,changeDT(e){h((null==e?void 0:e.nraId)||"nraId")}}}},39704:function(e,t,a){"use strict";var r=a(52322),n=a(2784),o=a(22341),c=a(65950),l=a(85325),d=a(21326),i=a(19473),s=a(35656),u=a(24868),m=a.n(u);let f=e=>{let{functionId:t,recordId:a,window:u}=e,{getRequest:f}=(0,n.useContext)(c.$),{languageId:p}=(0,n.useContext)(l.V),{platformLabels:h}=(0,n.useContext)(i.l),y=a+"-"+t;(0,d.Z)({title:h.WorkFlow,window:u});let{width:v}=(0,s.d)(),g=v<=1024,I=v>1024&&v<=1280,x=g?10:I?12:14,N=g?75:I?85:95,b=g?15:I?20:25,w=async()=>{var e="_functionId=".concat(t,"&_recordId=").concat(a);let r=await f({extension:o.P.WorkFlow.graph,parameters:e});return null==r?void 0:r.record},_=e=>{let t=[],a=[],r="",n="";return e.objects.forEach(e=>{t.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(t=>{e.objects.forEach(e=>{let a=e.functionName.split(" ").join("\r\n");t.parentId===e.recordId&&t.parentFunctionId===e.functionId&&(r=e.reference+"\r\n"+e.date+"\r\n"+a,t.parentId),t.childId===e.recordId&&t.childFunctionId===e.functionId&&(n=e.reference+"\r\n"+e.date+"\r\n"+a,t.childId)}),""===r||""===n||a.push({from:r,to:n,value:1,labelText:""}),r="",n=""}),a};return(0,n.useEffect)(()=>{!async function(){var e=await w();if(e){let t=(e,t)=>{let a=document.createElement("script");a.type="text/javascript",a.src=e,a.async=!0,a.onload=t,document.head.appendChild(a)};t("https://cdn.amcharts.com/lib/4/core.js",()=>{t("https://cdn.amcharts.com/lib/4/charts.js",()=>{t("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let t=am4core.create(y,am4charts.SankeyDiagram),a=_(e);t.data=a,t.dataFields.fromName="from",t.dataFields.toName="to",t.dataFields.value="value",t.paddingRight=2===p?0:40,t.paddingLeft=2===p?40:0,t.tooltip.label.fontSize=x;let r=t.nodes.template;r.draggable=!1,r.inert=!0,r.clickable=!1,r.width=N,r.height=b,r.nameLabel.label.fontSize=x,r.nameLabel.locationX=2===p?.85:0,r.nameLabel.height=void 0,r.nameLabel.label.fontWeight="bold";let n=t.links.template;n.middleLine.strokeOpacity=.3,n.middleLine.stroke=am4core.color("#555"),n.middleLine.strokeWidth=5,n.middleLine.hoverable=!1,n.fillOpacity=0,n.hoverable=!0,n.hoverOnFocus=!0,n.fill=am4core.color("#A8C686"),n.isHover=!0,t.appear(1e3,100)})})})})}}()},[]),(0,r.jsx)("div",{id:y,className:m().root})};f.width=950,t.Z=f},24868:function(e){e.exports={root:"WorkFlow_root__EINm1"}}},function(e){e.O(0,[92515,2494,36908,32304,49774,92888,40179],function(){return e(e.s=42091)}),_N_E=e.O()}]);