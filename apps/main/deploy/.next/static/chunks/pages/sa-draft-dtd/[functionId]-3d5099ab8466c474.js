(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[56525],{96803:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sa-draft-dtd/[functionId]",function(){return a(66673)}])},66673:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var n=a(52322),r=a(2784),d=a(62202),s=a(69387),l=a(27723),i=a(65950),o=a(71987),c=a(26612),u=a(31389),f=a(33625),p=a(62362),I=a(61802),m=a(22341),x=a(19473),v=a(7121),D=a(60218),y=a(48601),h=a(82737),g=a(80983),P=a(38449),_=a(8661),N=a(65215),j=a(19689);function S(e){var t;let{labels:a,maxAccess:s,recordId:l,functionId:f}=e,{platformLabels:I}=(0,r.useContext)(x.l),{getRequest:v,postRequest:S}=(0,r.useContext)(i.$),Z=(0,o.E)({endpointId:m.P.DocumentTypeDefault.page}),{formik:k}=(0,g.c)({initialValues:{dtId:"",recordId:l,plantId:"",spId:"",siteId:"",disableSKULookup:!1},maxAccess:s,validationSchema:y.Ry({dtId:y.Z_().required()}),onSubmit:async e=>{await S({extension:m.P.DocumentTypeDefault.set,record:JSON.stringify(e)}),l?d.ZP.success(I.Edited):(k.setFieldValue("recordId",k.values.dtId),d.ZP.success(I.Added)),Z()}}),w=!!k.values.recordId;return(0,r.useEffect)(()=>{!async function(){if(l){let e=await v({extension:m.P.DocumentTypeDefault.get,parameters:"_dtId=".concat(l)});k.setValues({...e.record,recordId:e.record.dtId})}}()},[]),(0,n.jsx)(h.Z,{resourceId:c.i.DocumentTypeDefault,form:k,maxAccess:s,editMode:w,functionId:f,children:(0,n.jsx)(u.R,{children:(0,n.jsx)(p.Q,{children:(0,n.jsxs)(D.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(D.ZP,{item:!0,xs:12,children:(0,n.jsx)(_.Z,{endpointId:P.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(f),name:"dtId",required:!0,label:a.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],readOnly:w,values:k.values,maxAccess:s,onChange:(e,t)=>{k&&k.setFieldValue("dtId",null==t?void 0:t.recordId)},error:k.touched.dtId&&!!k.errors.dtId})}),(0,n.jsx)(D.ZP,{item:!0,xs:12,children:(0,n.jsx)(_.Z,{endpointId:m.P.SalesPerson.qry,name:"spId",label:a.salesPerson,valueField:"recordId",displayField:["spRef","name"],columnsInDropDown:[{key:"spRef",value:"Ref"},{key:"name",value:"Name"}],values:k.values,onChange:(e,t)=>{k.setFieldValue("spId",null==t?void 0:t.recordId)},error:k.touched.spId&&!!k.errors.spId})}),(0,n.jsx)(D.ZP,{item:!0,xs:12,children:(0,n.jsx)(_.Z,{endpointId:P.r.Plant.qry,name:"plantId",label:a.plant,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Ref"},{key:"name",value:"Name"}],values:k.values,maxAccess:s,onChange:(e,t)=>{k.setFieldValue("plantId",null==t?void 0:t.recordId)},error:k.touched.plantId&&!!k.errors.plantId})}),(0,n.jsx)(D.ZP,{item:!0,xs:12,children:(0,n.jsx)(_.Z,{endpointId:N.$.Site.qry,name:"siteId",label:a.site,values:k.values,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Ref"},{key:"name",value:"Name"}],maxAccess:s,onChange:(e,t)=>{k.setFieldValue("siteId",null==t?void 0:t.recordId)},error:k.touched.siteId&&!!k.errors.siteId})}),(0,n.jsx)(D.ZP,{item:!0,xs:12,children:(0,n.jsx)(j.Z,{name:"disableSKULookup",value:null===(t=k.values)||void 0===t?void 0:t.disableSKULookup,onChange:e=>k.setFieldValue("disableSKULookup",e.target.checked),label:a.dsl,maxAccess:s})})]})})})})}var Z=a(63165),k=()=>{let{getRequest:e,postRequest:t}=(0,r.useContext)(i.$),{platformLabels:a}=(0,r.useContext)(x.l),{stack:D}=(0,I.zY)(),{functionId:y}=(0,Z.F)();async function h(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:n=50}=t;return{...await e({extension:m.P.DocumentTypeDefault.page,parameters:"_startAt=".concat(a,"&_pageSize=").concat(n,"&_functionId=").concat(y)}),_startAt:a}}let{query:{data:g},labels:P,access:_,invalidate:N,refetch:j,paginationParameters:k}=(0,o.J)({queryFn:h,endpointId:m.P.DocumentTypeDefault.page,datasetId:c.i.DraftSerialsInvoiceDTD,DatasetIdAccess:(e=>{switch(e){case v.J.DraftSerialsIn:return c.i.DraftSerialsInvoiceDTD;case v.J.DraftInvoiceReturn:return c.i.DraftSerialsReturnDTD;default:return}})(parseInt(y))}),w=e=>e===v.J.DraftSerialsIn?P.saDraft:e===v.J.DraftInvoiceReturn?P.saDraftReturn:void 0,F=[{field:"dtName",headerName:P.documentType,flex:1},{field:"spName",headerName:P.salesPerson,flex:1},{field:"plantName",headerName:P.plant,flex:1},{field:"siteRef",headerName:P.siteRef,flex:1},{field:"siteName",headerName:P.site,flex:1}];function R(e){D({Component:S,props:{labels:P,recordId:null==e?void 0:e.dtId,maxAccess:_,functionId:y},width:500,height:380,title:w(parseInt(y))})}let T=async()=>{R()},A=async e=>{await t({extension:m.P.DocumentTypeDefault.del,record:JSON.stringify(e)}),N(),d.ZP.success(a.Deleted)};return(0,n.jsxs)(u.R,{children:[(0,n.jsx)(f.g,{children:(0,n.jsx)(l.Z,{onAdd:T,maxAccess:_})}),(0,n.jsx)(p.Q,{children:(0,n.jsx)(s.Z,{columns:F,gridData:g,rowId:["dtId"],onEdit:e=>{R(e)},onDelete:A,isLoading:!1,pageSize:50,paginationParameters:k,refetch:j,paginationType:"api",maxAccess:_})})]})}},63165:function(e,t,a){"use strict";a.d(t,{F:function(){return d}});var n=a(5632),r=a(2784);let d=()=>{let e=(0,n.useRouter)(),[t,a]=(0,r.useState)(e.query);return t}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=96803)}),_N_E=e.O()}]);