(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[52091],{33438:function(e,l,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/iv-items",function(){return a(94285)}])},94285:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return es}});var r=a(52322),t=a(2784),n=a(62202),d=a(69387),i=a(65950),s=a(71987),o=a(26612),c=a(31389),u=a(33625),m=a(62362),v=a(61802),p=a(19473),I=a(65215),h=a(29326),x=a(9522),y=a(60218),f=a(48601),g=a(82737),b=a(2801),k=a(80983),j=a(5088),C=a(8661),F=a(21581),Z=a(243),P=a(74898),_=a(19689),w=a(84100),N=a(38449),V=a(22341),A=e=>{let{recordId:l}=e,{getRequest:a}=(0,t.useContext)(i.$),{query:{data:n},labels:u,access:v}=(0,s.J)({queryFn:I,endpointId:V.P.PriceListItem.qry,datasetId:o.i.PriceListUpdates}),p=[{field:"pluRef",headerName:u.reference,flex:1},{field:"pluDate",headerName:u.date,flex:1,type:"date"},,{field:"plName",headerName:u.priceLevel,flex:1},{field:"ptName",headerName:u.priceType,flex:1},{field:"currencyRef",headerName:u.currency,flex:1},{field:"value",headerName:u.price,flex:1,type:"number"}];async function I(){return await a({extension:V.P.PriceListItem.qry,parameters:"_pluId=0&_itemId=".concat(l,"&_filter=")})}return(0,r.jsx)(c.R,{children:(0,r.jsx)(m.Q,{children:(0,r.jsx)(d.Z,{table:"history",columns:p,gridData:n,rowId:["recordId"],maxAccess:v,pagination:!1})})})},S=a(96026),T=a(76426),D=a(61072);function L(e){var l,a,d,u,h,x,V,L,R;let{labels:q,maxAccess:E,setStore:$,store:M,setFormikInitial:O,window:B}=e,{platformLabels:U,defaultsData:W}=(0,t.useContext)(p.l),[G,J]=(0,t.useState)(!1),[z,Y]=(0,t.useState)(!1),{recordId:Q}=M,[H,K]=(0,t.useState)(!1),{getRequest:X,postRequest:ee}=(0,t.useContext)(i.$),{stack:el}=(0,v.zY)(),{stack:ea}=(0,S.V)(),er=null==W?void 0:null===(a=W.list)||void 0===a?void 0:null===(l=a.find(e=>{let{key:l}=e;return"currencyId"===l}))||void 0===l?void 0:l.value,et=null==W?void 0:null===(u=W.list)||void 0===u?void 0:null===(d=u.find(e=>{let{key:l}=e;return"plId"===l}))||void 0===d?void 0:d.value,en=(0,s.E)({endpointId:I.$.Items.qry}),ed=(0,t.useRef)(null),{changeDT:ei,maxAccess:es}=(0,Z.r)({access:E,readOnlyOnEditMode:M.recordId,name:"sku"}),{formik:eo}=(0,k.c)({initialValues:{recordId:null,name:"",sku:"",categoryId:null,flName:"",shortName:"",groupId:null,msId:null,description:"",priceType:null,ptName:"",procurementMethod:null,valuationMethod:null,volume:"",weght:"",trackBy:null,unitPrice:"",ivtItem:!0,salesItem:!0,purchaseItem:!0,kitItem:!1,taxId:"",lotCategoryId:null,spfId:"",categoryName:"",defSaleMUId:"",pgId:"",productionLevel:"",collectionId:null,isInactive:!1,isExternal:!1},maxAccess:es,validateOnChange:!0,validationSchema:f.Ry({categoryId:f.Z_().required(),name:f.Z_().required(),priceType:f.Rx().required(),msId:f.Z_().required(),lotCategoryId:f.Z_().nullable().test(function(e){let{trackBy:l}=this.parent;return 2!==l||null!=e&&""!==e.trim()}),spfId:f.Z_().nullable().test(function(e){let{trackBy:l}=this.parent;return 1!==l||null!=e&&""!==e.trim()})}),onSubmit:async e=>{let l=await ee({extension:I.$.Items.set,record:JSON.stringify({...e,attachment:null})});e.recordId?n.ZP.success(U.Edited):(K(!1),n.ZP.success(U.Added),eo.setValues({...e,recordId:l.recordId}),$(e=>({...e,recordId:l.recordId,_msId:eo.values.msId,_kit:eo.values.kitItem,_name:eo.values.name,_reference:eo.values.sku}))),O(eo.values),ed.current&&(ed.current.value=l.recordId,await ed.current.submit());let a=await X({extension:I.$.Items.get,parameters:"_recordId=".concat(l.recordId)});$(e=>({...e,_reference:a.record.sku})),eo.setFieldValue("sku",a.record.sku),B.setTitle&&!eu&&B.setTitle(a.record.sku?"".concat(q.items," ").concat(a.record.sku):q.items),await em(l.recordId),en()}}),ec=async e=>{if(e&&e)return(await X({extension:N.r.NumberRange.get,parameters:"_recordId=".concat(e)})).record.external},eu=!!eo.values.recordId,em=async e=>{var l;let a=await X({extension:I.$.Items.get,parameters:"_recordId=".concat(e)}),r=await X({extension:I.$.Category.get,parameters:"_recordId=".concat(null==a?void 0:null===(l=a.record)||void 0===l?void 0:l.categoryId)}),t=await ec(r.record.nraId);a.record.isInactive=a.record.isInactive||!1,O(a.record),eo.setValues({...a.record,kitItem:!!a.record.kitItem,isExternal:t}),J(2===a.record.trackBy),Y(1===a.record.trackBy),$(e=>{var l;return{...e,nraId:null==r?void 0:null===(l=r.record)||void 0===l?void 0:l.nraId,_msId:a.record.msId,_kit:a.record.kitItem,productionLevel:a.record.productionLevel,measurementId:a.record.defSaleMUId,priceGroupId:a.record.pgId,returnPolicy:a.record.returnPolicyId,_name:a.record.name,_reference:a.record.sku}})};async function ev(e){ee({extension:I.$.Item.clone,record:JSON.stringify(e)}).then(e=>{n.ZP.success(U.Saved),em(e.recordId),en()})}async function ep(e){el({Component:A,props:{labels:q,maxAccess:es,recordId:e.recordId},width:700,height:500,title:q.history})}async function eI(){let{barcode:e,error:l}=await eh();!l&&e&&el({Component:D.Z,props:{Print:eh,barcode:e},width:400,height:200})}async function eh(){let e=eo.values;if(!e.labelTemplateId)return ea({message:U.defaultTemplateError}),{error:!0};if(!er)return ea({message:U.DefaultSalesCurrency}),{error:!0};let l=await X({extension:T.x.LabelTemplate.get,parameters:"_recordId=".concat(e.labelTemplateId)});return l&&l.record.format?et?{barcode:(await X({extension:I.$.LabelString.md,parameters:"_templateId=".concat(e.labelTemplateId,"&_currencyId=").concat(er,"&_printFormat=").concat(l.record.format,"&_plId=").concat(et,"&_items=").concat(Q,",1")})).record.data}:(ea({message:U.DefaultSalesPrice}),{error:!0}):(ea({message:U.DefaultTemplateFormat}),{error:!0})}(0,t.useEffect)(()=>{Q&&em(Q)},[]);let ex=[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!eu},{key:"Integration Account",condition:!0,onClick:"onClickGIA",masterSource:P.N.Item,disabled:!eu},{key:"Copy",condition:!0,onClick:()=>ev(null==eo?void 0:eo.values),disabled:!((null==M?void 0:M.nraId)&&!eo.values.isExternal)},{key:"History",condition:!0,onClick:()=>ep(null==eo?void 0:eo.values),disabled:!eu}];return(0,t.useEffect)(()=>{eo.values.kitItem?(K(!0),eo.setFieldValue("ivtItem",!1),eo.setFieldValue("trackBy",""),eo.setFieldValue("valuationMethod","")):(K(!1),eo.setFieldValue("priceType",""))},[eo.values.kitItem]),(0,r.jsx)(g.Z,{resourceId:o.i.Items,form:eo,maxAccess:es,editMode:eu,actions:ex,onPrint:eI,children:(0,r.jsx)(c.R,{children:(0,r.jsx)(m.Q,{children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:8,children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:8,children:(0,r.jsx)(C.Z,{dataGrid:!0,endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.categories},values:eo.values,name:"categoryId",label:q.category,valueField:"recordId",displayField:["caRef","name"],displayFieldWidth:1,columnsInDropDown:[{key:"caRef",value:"Reference"},{key:"name",value:"Name",width:8}],required:!0,maxAccess:es,onChange:(e,l)=>{ei(l),$(e=>({...e,nraId:null==l?void 0:l.nraId})),eo.setFieldValue("categoryId",(null==l?void 0:l.recordId)||""),eo.values.kitItem||eo.setFieldValue("priceType",(null==l?void 0:l.priceType)||""),eo.setFieldValue("trackBy",(null==l?void 0:l.trackBy)||""),eo.setFieldValue("procurementMethod",(null==l?void 0:l.procurementMethod)||""),eo.setFieldValue("msId",(null==l?void 0:l.msId)||""),eo.setFieldValue("valuationMethod",(null==l?void 0:l.valuationMethod)||""),eo.setFieldValue("taxId",(null==l?void 0:l.taxId)||""),eo.setFieldValue("lotCategoryId",(null==l?void 0:l.lotCategoryId)||""),eo.setFieldValue("spfId",(null==l?void 0:l.spfId)||""),J((null==l?void 0:l.trackBy)==="2"||(null==l?void 0:l.trackBy)===2),Y((null==l?void 0:l.trackBy)==="1"||(null==l?void 0:l.trackBy)===1),$(e=>({...e,_metal:eo.values.metalId,_isMetal:null==l?void 0:l.isMetal}))},error:eo.touched.categoryId&&eo.errors.categoryId})}),(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsx)(C.Z,{dataGrid:!0,endpointId:I.$.Items.pack,reducer:e=>{var l,a;return null==e?void 0:null===(a=e.record)||void 0===a?void 0:null===(l=a.priceTypes)||void 0===l?void 0:l.map(e=>({key:parseInt(e.key),value:e.value}))},values:eo.values,defaultIndex:H&&0,name:"priceType",label:q.priceType,readOnly:eo.values.kitItem,valueField:"key",displayField:"value",displayFieldWidth:1,required:!0,maxAccess:es,onChange:(e,l)=>{eo.setFieldValue("priceType",(null==l?void 0:l.key)||null)},error:eo.touched.priceType&&eo.errors.priceType})}),(0,r.jsx)(y.ZP,{item:!0,xs:8,children:(0,r.jsx)(j.Z,{name:"sku",required:!0,label:q.reference,value:eo.values.sku,maxAccess:E,readOnly:eu,onChange:eo.handleChange,onClear:()=>eo.setFieldValue("sku",""),error:eo.touched.sku&&eo.errors.sku})}),(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsx)(C.Z,{dataGrid:!0,endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.procurementMethods.map(e=>({key:parseInt(e.key),value:e.value}))},name:"procurementMethod",label:q.procurement,valueField:"key",displayField:"value",values:eo.values,maxAccess:es,onChange:(e,l)=>{eo.setFieldValue("procurementMethod",(null==l?void 0:l.key)||""),eo.setFieldValue("procurementName",(null==l?void 0:l.value)||"")},error:eo.touched.procurementMethod&&eo.errors.procurementMethod})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(j.Z,{name:"name",label:q.name,value:eo.values.name,required:!0,maxAccess:es,onChange:eo.handleChange,onClear:()=>eo.setFieldValue("name",""),error:eo.touched.name&&eo.errors.name})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(j.Z,{name:"flName",label:q.flName,value:eo.values.flName,maxAccess:es,onChange:eo.handleChange,onClear:()=>eo.setFieldValue("flName","")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(j.Z,{name:"shortName",label:q.shortName,value:eo.values.shortName,maxAccess:es,onChange:eo.handleChange,onClear:()=>eo.setFieldValue("shortName","")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,dataGrid:!0,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.itemGroups},values:eo.values,name:"groupId",label:q.itemGroup,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],maxAccess:es,onChange:(e,l)=>{eo.setFieldValue("groupId",(null==l?void 0:l.recordId)||"")},error:eo.touched.groupId&&eo.errors.groupId})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Collections.qry,name:"collectionId",label:q.collection,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],maxAccess:es,values:eo.values,onChange:(e,l)=>{eo.setFieldValue("collectionId",null==l?void 0:l.recordId)},error:eo.touched.collectionId&&!!eo.errors.collectionId})}),(0,r.jsx)(y.ZP,{item:!0,xs:6,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.measurementSchedules},values:eo.values,name:"msId",label:q.measure,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:eu,required:!0,maxAccess:es,onChange:(e,l)=>{eo.setFieldValue("msId",(null==l?void 0:l.recordId)||"")},error:eo.touched.msId&&eo.errors.msId})}),(0,r.jsx)(y.ZP,{item:!0,xs:6,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.valuations.map(e=>({key:parseInt(e.key),value:e.value}))},values:eo.values,name:"valuationMethod",label:q.valation,readOnly:eo.values.kitItem,valueField:"key",displayField:"value",displayFieldWidth:1,maxAccess:es,onChange:(e,l)=>{eo.setFieldValue("valuationMethod",(null==l?void 0:l.key)||"")},error:eo.touched.valuationMethod&&eo.errors.valuationMethod})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(F.Z,{name:"description",label:q.description,value:eo.values.description,maxAccess:es,onChange:eo.handleChange,onClear:()=>eo.setFieldValue("description","")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(_.Z,{name:"isInactive",value:null===(h=eo.values)||void 0===h?void 0:h.isInactive,onChange:e=>eo.setFieldValue("isInactive",e.target.checked),label:q.isInactive,maxAccess:es})})]})}),(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(b.Z,{ref:ed,resourceId:o.i.Items,seqNo:0,recordId:Q})}),(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsx)(_.Z,{name:"ivtItem",value:null===(x=eo.values)||void 0===x?void 0:x.ivtItem,onChange:e=>eo.setFieldValue("ivtItem",e.target.checked),label:q.inventory,maxAccess:es,disabled:eo.values.kitItem||eu})}),(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsx)(_.Z,{name:"salesItem",value:null===(V=eo.values)||void 0===V?void 0:V.salesItem,onChange:e=>eo.setFieldValue("salesItem",e.target.checked),label:q.sales,maxAccess:es})}),(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsx)(_.Z,{name:"purchaseItem",value:null===(L=eo.values)||void 0===L?void 0:L.purchaseItem,onChange:e=>eo.setFieldValue("purchaseItem",e.target.checked),label:q.purchase,maxAccess:es})}),(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsx)(_.Z,{name:"kitItem",value:null===(R=eo.values)||void 0===R?void 0:R.kitItem,onChange:e=>eo.setFieldValue("kitItem",e.target.checked),label:q.kitItem,disabled:eu,maxAccess:es})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{datasetId:w.v.PRODUCTION_LEVEL,name:"productionLevel",label:q.productionLevel,valueField:"key",displayField:"value",values:eo.values,onChange:(e,l)=>{eo.setFieldValue("productionLevel",(null==l?void 0:l.key)||""),$(e=>({...e,productionLevel:null==l?void 0:l.key}))},maxAccess:es,error:eo.touched.productionLevel&&!!eo.errors.productionLevel})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(j.Z,{name:"unitPrice",label:q.unitPrice,value:eo.values.unitPrice,maxAccess:es,onChange:eo.handleChange,onClear:()=>eo.setFieldValue("unitPrice",""),error:eo.touched.unitPrice&&eo.errors.unitPrice})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.taxSchedules},values:eo.values,name:"taxId",label:q.vatSchedule,valueField:"recordId",displayField:"name",displayFieldWidth:1,maxAccess:es,onChange:(e,l)=>{eo.setFieldValue("taxId",(null==l?void 0:l.recordId)||"")},error:eo.touched.taxId&&eo.errors.taxId})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.trackByList.map(e=>({key:parseInt(e.key),value:e.value}))},values:eo.values,name:"trackBy",label:q.trackBy,valueField:"key",displayField:"value",displayFieldWidth:1,readOnly:eu||eo.values.kitItem,maxAccess:es,onChange:(e,l)=>{let a=(null==l?void 0:l.key)||"";eo.setFieldValue("trackBy",a),J("2"===a||2===a),Y("1"===a||1===a)},error:eo.touched.trackBy&&eo.errors.trackBy})}),G&&!eo.values.kitItem&&(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.lotCategories},values:eo.values,name:"lotCategoryId",label:q.lotCategory,valueField:"recordId",displayField:"name",readOnly:eu,displayFieldWidth:1,required:!0,maxAccess:es,onChange:(e,l)=>{eo.setFieldValue("lotCategoryId",(null==l?void 0:l.recordId)||""),eo.setFieldValue("lotCategoryName",(null==l?void 0:l.name)||"")},error:eo.touched.lotCategoryId&&!!eo.errors.lotCategoryId&&!eo.values.lotCategoryName})}),z&&!eo.values.kitItem&&(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.serialProfiles},required:!0,values:eo.values,readOnly:eu,name:"spfId",label:q.sprofile,valueField:"recordId",displayField:"name",displayFieldWidth:1,maxAccess:es,onChange:(e,l)=>{eo.setFieldValue("spfId",(null==l?void 0:l.recordId)||""),eo.setFieldValue("spfName",(null==l?void 0:l.name)||"")},error:eo.touched.spfId&&!!eo.errors.spfId&&!eo.values.spfName})})]})})]})})})})}var R=a(91406);let q={LENGTH:1,WIDTH:2,DEPTH:3,DIAMETER:4,VOLUME:5,WEIGHT:6,DENSITY:7},E={CUBIC:1,CYLINDER:2};class ${constructor(){this.dirtyField=null,this.shape=null,this.length=0,this.width=0,this.depth=0,this.diameter=0,this.volume=0,this.weight=0,this.density=0}}class M{recalWeight(e){e.density>0&&(e.weight=parseFloat((e.volume*e.density).toFixed(2)))}recalVolume(e){e.density>0&&(e.volume=parseFloat((e.weight/e.density).toFixed(2)))}recalDensity(e){e.volume>0&&(e.density=parseFloat((e.weight/e.volume).toFixed(2)))}recalc(e){switch(e.dirtyField){case q.VOLUME:e.weight>0?this.recalDensity(e):e.density>0&&this.recalWeight(e);break;case q.WEIGHT:e.volume>0?this.recalDensity(e):e.density>0&&this.recalVolume(e);break;case q.DENSITY:e.volume>0?this.recalWeight(e):e.weight>0&&this.recalVolume(e)}}get(e){let l=new $;return l.dirtyField=e[0],l.shape=e[1],l.length=e[2],l.width=e[3],l.depth=e[4],l.diameter=e[5],l.volume=e[6],l.weight=e[7],l.density=e[8],this.getRec(l),l}getRec(e){switch(e.dirtyField){case q.DIAMETER:case q.LENGTH:case q.WIDTH:case q.DEPTH:e.length>0&&(e.dirtyField=q.VOLUME,e.shape===E.CUBIC?e.width>0&&e.depth>0&&(e.volume=parseFloat((e.length*e.width*e.depth).toFixed(2))):e.diameter>0&&(e.volume=parseFloat((e.length*Math.PI*Math.pow(e.diameter/2,2)).toFixed(2))),this.recalc(e));break;case q.VOLUME:case q.WEIGHT:case q.DENSITY:this.recalc(e)}}log(e,l){console.log("Logging: ".concat(l),e)}}var O=e=>{var l;let{labels:a,editMode:d,maxAccess:u,store:m}=e,{postRequest:v,getRequest:h}=(0,t.useContext)(i.$),{platformLabels:x}=(0,t.useContext)(p.l),{recordId:b}=m,j=(0,s.E)({endpointId:I.$.Items.snapshot}),{formik:F}=(0,k.c)({maxAccess:u,initialValues:{itemId:b,shape:1,diameter:0,isMetal:m.isMetal||!1,metalColorId:"",metalId:m._metalId||"",length:0,width:0,depth:0,volume:0,weight:0,density:0,metalPurity:"",isOpenMetalPurity:!1},enableReinitialize:!0,validationSchema:f.Ry({metalId:f.Z_().nullable().test(function(e){let{isMetal:l}=this.parent;return!l||null!=e&&""!==e.trim()}),metalColorId:f.Z_().nullable().test(function(e){let{isMetal:l}=this.parent;return!l||null!=e&&""!==e.trim()})}),onSubmit:async e=>{await Z(e)}}),Z=async e=>{let l=!(null==e?void 0:e.itemId);await v({extension:I.$.Physical.set,record:JSON.stringify(e)}),n.ZP.success(l?x.Added:x.Edited),j()};(0,t.useEffect)(()=>{(async()=>{if(b){let e=await h({extension:I.$.Physical.get,parameters:"_itemId=".concat(b)});e.record&&F.setValues({...e.record,isMetal:!!e.record.isMetal})}})()},[b]);let P=(e,l,a)=>{var r;let t=Number((null==a?void 0:null===(r=a.target)||void 0===r?void 0:r.value)||0);if(t>=0){let a={...F.values,[e]:t},r=[l,F.values.shape,a.length,a.width,a.depth,a.diameter,a.volume,a.weight,a.density],n=new M().get(r);F.setValues(e=>({...e,...n}))}},w=e=>{F.setFieldValue(e,0)};return(0,r.jsx)(g.Z,{form:F,resourceId:o.i.PhysicalProperty,maxAccess:u,editMode:d,isInfo:!1,isCleared:!1,children:(0,r.jsx)(c.R,{children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,reducer:e=>{var l,a;return null==e?void 0:null===(a=e.record)||void 0===a?void 0:null===(l=a.shapes)||void 0===l?void 0:l.map(e=>({key:parseInt(e.key),value:e.value}))},values:F.values,name:"shape",label:a.shape,valueField:"key",displayField:"value",displayFieldWidth:1,maxAccess:u,onChange:(e,l)=>{F.setFieldValue("shape",(null==l?void 0:l.key)||""),(null==l?void 0:l.key)===E.CUBIC&&F.setFieldValue("diameter",0),(null==l?void 0:l.key)===E.CYLINDER&&(F.setFieldValue("width",0),F.setFieldValue("depth",0))},error:F.touched.shape&&F.errors.shape})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"diameter",label:a.diameter,value:F.values.diameter,maxAccess:u,readOnly:F.values.shape===E.CUBIC,onBlur:e=>P("diameter",q.DIAMETER,e),onClear:()=>w("diameter")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"length",label:a.length,value:F.values.length,maxAccess:u,onBlur:e=>P("length",q.LENGTH,e),onClear:()=>w("length")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"width",label:a.width,value:F.values.width,maxAccess:u,readOnly:F.values.shape===E.CYLINDER,onBlur:e=>P("width",q.WIDTH,e),onClear:()=>w("width")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"depth",label:a.depth,value:F.values.depth,maxAccess:u,readOnly:F.values.shape===E.CYLINDER,onBlur:e=>P("depth",q.DEPTH,e),onClear:()=>w("depth")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"volume",label:a.volume,value:F.values.volume,maxAccess:u,decimalScale:4,onBlur:e=>P("volume",q.VOLUME,e),onClear:()=>w("volume")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"weight",label:a.weight,value:F.values.weight,maxAccess:u,allowNegative:!1,onBlur:e=>P("weight",q.WEIGHT,e),onClear:()=>w("weight")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"density",label:a.density,value:F.values.density,maxAccess:u,decimalScale:3,onBlur:e=>P("density",q.DENSITY,e),onClear:()=>w("density")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(_.Z,{name:"isMetal",value:F.values.isMetal,onChange:e=>{e.target.checked||(F.setFieldValue("metalId",""),F.setFieldValue("metalColorId",""),F.setFieldValue("metalPurity",""),F.setFieldValue("weight",0),F.setFieldValue("density",0)),F.setFieldValue("isMetal",e.target.checked)},label:a.isMetal,maxAccess:u})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.metals},values:F.values,name:"metalId",label:a.metal,readOnly:!F.values.isMetal,required:F.values.isMetal,valueField:"recordId",displayField:"reference",displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"}],maxAccess:u,onChange:(e,l)=>{F.setFieldValue("metalId",(null==l?void 0:l.recordId)||""),F.setFieldValue("metalPurity",(null==l?void 0:l.purity)||"")},error:F.touched.metalId&&F.errors.metalId})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Items.pack,reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.metalColors},values:F.values,name:"metalColorId",label:a.metalColor,readOnly:!F.values.isMetal,valueField:"recordId",displayField:"reference",displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"}],required:F.values.isMetal,maxAccess:u,onChange:(e,l)=>{F.setFieldValue("metalColorId",(null==l?void 0:l.recordId)||"")},error:F.touched.metalColorId&&F.errors.metalColorId})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"metalPurity",label:a.metalPurity,readOnly:!0,decimalScale:5,maxLength:10,value:F.values.metalPurity,maxAccess:u,onChange:F.handleChange,onClear:()=>F.setFieldValue("metalPurity","")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(_.Z,{name:"isOpenMetalPurity",value:null===(l=F.values)||void 0===l?void 0:l.isOpenMetalPurity,onChange:e=>F.setFieldValue("isOpenMetalPurity",e.target.checked),label:a.isOpenMetalPurity,maxAccess:u})})]})})})},B=a(27723),U=a(2454),W=a(27423),G=e=>{var l;let{labels:a,editMode:d,maxAccess:u,store:v,record:I}=e,{postRequest:h,getRequest:x}=(0,t.useContext)(i.$),{platformLabels:b}=(0,t.useContext)(p.l),F=(0,s.E)({endpointId:U.y.PriceList.qry}),{recordId:Z}=v,{formik:P}=(0,k.c)({maxAccess:u,initialValues:{itemId:Z,vendorId:(null==I?void 0:I.vendorId)||"",currencyId:(null==I?void 0:I.currencyId)||"",baseLaborPrice:"",priceList:"",markdown:"",sku:"",isPreferred:!1,deliveryLeadDays:""},validateOnChange:!0,validationSchema:f.Ry({vendorId:f.Z_().required(),currencyId:f.Z_().required(),baseLaborPrice:f.Z_().required(),priceList:f.Z_().required()}),onSubmit:async e=>{let l=P.values.vendorId,a=P.values.currencyId,r={...e,markdown:e.markdown||0};await h({extension:U.y.PriceList.set,record:JSON.stringify(r)}),l||a?n.ZP.success(b.Edited):n.ZP.success(b.Added),P.setValues(r),F()}});return(0,t.useEffect)(()=>{(async()=>{if(I&&I.currencyId&&I.vendorId){let e=await x({extension:U.y.PriceList.get,parameters:"_itemId=".concat(Z,"&_vendorId=").concat(P.values.vendorId,"&_currencyId=").concat(P.values.currencyId)});e.record&&P.setValues(e.record)}})()},[I]),(0,r.jsx)(g.Z,{form:P,isInfo:!1,resourceId:o.i.PriceList,maxAccess:u,editMode:d,isCleared:!1,children:(0,r.jsx)(c.R,{children:(0,r.jsx)(m.Q,{children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(W.U,{endpointId:U.y.Vendor.snapshot,name:"vendorId",label:a.vendor,form:P,displayFieldWidth:2,valueField:"vendorRef",displayField:"name",required:!0,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueShow:"vendorRef",secondValueShow:"vendorName",onChange:(e,l)=>{P.setFieldValue("vendorId",l.recordId||""),P.setFieldValue("vendorName",l.name||""),P.setFieldValue("vendorRef",l.reference||"")},maxAccess:u})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:N.r.Currency.qry,name:"currencyId",label:a.currency,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:P.values,required:!0,maxAccess:u,onChange:(e,l)=>{P.setFieldValue("currencyId",(null==l?void 0:l.recordId)||null)},error:P.touched.currencyId&&!!P.errors.currencyId})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"baseLaborPrice",label:a.baseLabor,value:P.values.baseLaborPrice,onChange:P.handleChange,onClear:()=>P.setFieldValue("baseLaborPrice",""),required:!0,error:P.touched.baseLaborPrice&&!!P.errors.baseLaborPrice})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"priceList",label:a.priceList,value:P.values.priceList,onChange:P.handleChange,onClear:()=>P.setFieldValue("priceList",""),required:!0,error:P.touched.priceList&&!!P.errors.priceList})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"markdown",label:a.markdown,value:P.values.markdown,onChange:P.handleChange,onClear:()=>P.setFieldValue("markdown","")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(j.Z,{name:"sku",label:a.sku,value:P.values.sku,maxAccess:u,onChange:P.handleChange,onClear:()=>P.setFieldValue("sku","")})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(_.Z,{name:"isPreferred",value:null===(l=P.values)||void 0===l?void 0:l.isPreferred,onChange:e=>P.setFieldValue("isPreferred",e.target.checked),label:a.isPreffered,maxAccess:u})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"deliveryLeadDays",label:a.dld,value:P.values.deliveryLeadDays,onChange:P.handleChange,onClear:()=>P.setFieldValue("deliveryLeadDays","")})})]})})})})},J=e=>{let{store:l,labels:a,maxAccess:I}=e,{getRequest:h,postRequest:x}=(0,t.useContext)(i.$),{recordId:y}=l,{platformLabels:f}=(0,t.useContext)(p.l),{stack:g}=(0,v.zY)();async function b(){return await h({extension:U.y.PriceList.qry,parameters:"&_itemId=".concat(y)})}let{query:{data:k},labels:j,refetch:C}=(0,s.J)({enabled:!!y,datasetId:o.i.PriceList,queryFn:b,endpointId:U.y.PriceList.qry}),F=[{field:"vendorName",headerName:a.vendorName,flex:1},{field:"currencyRef",headerName:a.currency,flex:1},{field:"baseLaborPrice",headerName:a.baseLabor,flex:1},{field:"priceList",headerName:a.priceList,flex:1},{field:"markdown",headerName:a.markdown,flex:1},{field:"sku",headerName:a.sku,flex:1},{field:"isPreferred",headerName:a.isPreffered,type:"checkbox"},{field:"deliveryLeadDays",headerName:a.dld,flex:1}],Z=async e=>{await x({extension:U.y.PriceList.del,record:JSON.stringify(e)}),C(),n.ZP.success(f.Deleted)};function P(e){g({Component:G,props:{labels:a,recordId:y||null,record:e,maxAccess:I,store:l},title:a.vendor})}return(0,r.jsxs)(c.R,{children:[(0,r.jsx)(u.g,{children:(0,r.jsx)(B.Z,{onAdd:()=>{P()},maxAccess:I})}),(0,r.jsx)(m.Q,{children:(0,r.jsx)(d.Z,{name:"vendor",columns:F,gridData:k,rowId:["vendorId","currencyId"],isLoading:!1,pageSize:50,onEdit:e=>{P(e)},pagination:!1,onDelete:Z,maxAccess:I,height:200})})]})},z=a(76399),Y=a(67920),Q=a(54074),H=e=>{var l,a,d,s;let{store:o,labels:v,maxAccess:h,formikInitial:x}=e,{getRequest:g,postRequest:b}=(0,t.useContext)(i.$),{recordId:j}=o,{platformLabels:F}=(0,t.useContext)(p.l),{schema:Z,requiredFields:P}=(0,Y.m)({currencyId:e=>null==e?void 0:e.currencyId,plId:e=>null==e?void 0:e.plId,ptName:e=>null==e?void 0:e.ptName,value:e=>(null==e?void 0:e.value)||(null==e?void 0:e.value)===0,vtName:e=>null==e?void 0:e.vtName,minPrice:e=>(e.value>0||(null==e?void 0:e.plId)>0||(null==e?void 0:e.ptName)>0||(null==e?void 0:e.currencyId)>0)&&(null==e?void 0:e.minPrice)<=(null==e?void 0:e.value)},!0,h,"items"),{formik:_}=(0,k.c)({initialValues:{defSaleMUId:o.measurementId||"",pgId:o.priceGroupId||"",returnPolicyId:o.returnPolicy||"",items:[{id:1,itemId:o.recordId,currencyId:null,plId:null,priceType:"",muId:0,valueType:"",value:null,minPrice:null}]},conditionSchema:["items"],validationSchema:f.Ry({items:f.IX().of(Z)}),onSubmit:async e=>{let l={...x,recordId:j,pgId:(null==e?void 0:e.pgId)||null,defSaleMUId:_.values.defSaleMUId,returnPolicyId:_.values.returnPolicyId};await b({extension:I.$.Items.set,record:JSON.stringify(l)}),await b({extension:V.P.Sales.set2,record:JSON.stringify({itemId:j,pgId:(null==e?void 0:e.pgId)||null,items:e.items.filter(e=>{var l;return null===(l=Object.values(P))||void 0===l?void 0:l.every(l=>l(e))}).map(e=>({...e,itemId:j}))})}),n.ZP.success(F.Updated)}}),A=async e=>{var l;if(!e)return;let a=await g({extension:V.P.Sales.qry,parameters:"&_itemId=".concat(e,"&_currencyId=",0)});return(null==a?void 0:null===(l=a.list)||void 0===l?void 0:l.length)>0?a.list.map((e,l)=>({...e,id:l+1})):_.values.items.map((e,l)=>{var a;return{...e,id:null!==(a=e.id)&&void 0!==a?a:l}})};(0,t.useEffect)(()=>{!async function(){if(j){let e=await A(j);_.setValues({..._.values,items:e})}}()},[j]),(0,t.useEffect)(()=>{_.setFieldValue("defSaleMUId",o.measurementId||null),_.setFieldValue("pgId",o.priceGroupId||null),_.setFieldValue("returnPolicyId",o.returnPolicy||null)},[o.measurementId,o.priceGroupId,o.returnPolicy]);let S=[{component:"resourcecombobox",label:v.priceLevel,name:"plId",props:{endpointId:V.P.PriceLevel.qry,valueField:"recordId",displayField:"name",mapping:[{from:"recordId",to:"plId"},{from:"reference",to:"plRef"},{from:"name",to:"plName"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:2}},{component:"resourcecombobox",label:v.measure,name:"muId",props:{endpointId:I.$.MeasurementUnit.qry,parameters:"_msId=".concat(o._msId),valueField:"recordId",displayField:"name",mapping:[{from:"recordId",to:"muId"},{from:"reference",to:"muRef"},{from:"name",to:"muName"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:2}},{component:"resourcecombobox",label:v.currency,name:"currencyId",props:{endpointId:N.r.Currency.qry,parameters:"_msId=".concat(o._msId,"&_filter="),valueField:"recordId",displayField:"name",mapping:[{from:"recordId",to:"currencyId"},{from:"reference",to:"currencyRef"},{from:"name",to:"currencyName"}]}},{component:"resourcecombobox",label:v.priceType,name:"ptName",props:{endpointId:I.$.Items.pack,valueField:"recordId",valueField:"key",displayField:"value",displayFieldWidth:2,mapping:[{from:"key",to:"priceType"},{from:"value",to:"ptName"}],reducer:e=>{var l;return null==e?void 0:null===(l=e.record)||void 0===l?void 0:l.priceTypes.map(e=>({key:parseInt(e.key),value:e.value}))}}},{component:"resourcecombobox",label:v.valueType,name:"vtName",props:{datasetId:w.v.VALUE_TYPE,valueField:"key",displayField:"value",displayFieldWidth:2,mapping:[{from:"key",to:"valueType"},{from:"value",to:"vtName"}]}},{component:"numberfield",label:v.price,name:"value",props:{allowNegative:!1,maxLength:17,decimalScale:5}},{component:"numberfield",label:v.minPrice,name:"minPrice",props:{allowNegative:!1,maxLength:12,decimalScale:3}}];return(0,r.jsx)(Q.Z,{onSave:_.handleSubmit,maxAccess:h,children:(0,r.jsxs)(c.R,{children:[(0,r.jsx)(u.g,{children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsx)(C.Z,{endpointId:o._msId?I.$.MeasurementUnit.qry:"",parameters:"_msId=".concat(o._msId),name:"defSaleMUId",label:v.measure,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:_.values,valueField:"recordId",displayField:["reference","name"],maxAccess:h,onChange:(e,l)=>{_.setFieldValue("defSaleMUId",(null==l?void 0:l.recordId)||"")}})}),(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsx)(C.Z,{endpointId:V.P.PriceGroups.qry,name:"pgId",label:v.priceGroups,valueField:"recordId",displayField:"name",values:_.values,maxAccess:h,onChange:(e,l)=>{_.setFieldValue("pgId",(null==l?void 0:l.recordId)||"")},onClear:()=>_.setFieldValue("pgId","")})}),(0,r.jsx)(y.ZP,{item:!0,xs:4,children:(0,r.jsx)(C.Z,{endpointId:V.P.ReturnPolicy.qry,name:"returnPolicyId",label:v.returnPolicy,valueField:"recordId",displayField:"name",values:_.values,maxAccess:h,onChange:(e,l)=>{_.setFieldValue("returnPolicyId",(null==l?void 0:l.recordId)||"")},onClear:()=>_.setFieldValue("returnPolicyId","")})})]})}),(0,r.jsx)(m.Q,{children:(0,r.jsx)(z._,{onChange:e=>_.setFieldValue("items",e),value:null===(l=_.values)||void 0===l?void 0:l.items,error:null===(a=_.errors)||void 0===a?void 0:a.items,name:"salesTable",initialValues:null==_?void 0:null===(s=_.initialValues)||void 0===s?void 0:null===(d=s.items)||void 0===d?void 0:d[0],columns:S,maxAccess:h})})]})})},K=e=>{let{store:l,maxAccess:a}=e,{getRequest:d,postRequest:s}=(0,t.useContext)(i.$),{recordId:o}=l,{platformLabels:u}=(0,t.useContext)(p.l),[v,h]=(0,t.useState)([]),[x,f]=(0,t.useState)([]);(0,t.useEffect)(()=>{o&&(async()=>{var e,l;let a=await d({extension:N.r.Defaults.qry,parameters:"_filter="});h(null==a?void 0:null===(e=a.list)||void 0===e?void 0:e.filter(e=>{var l;return e.key.includes("ivtDimension")&&(null==e?void 0:null===(l=e.value)||void 0===l?void 0:l.length)>0})),f(null==a?void 0:null===(l=a.list)||void 0===l?void 0:l.filter(e=>{var l;return e.key.includes("ivtUDT")&&"ivtUDTCount"!==e.key&&(null==e?void 0:null===(l=e.value)||void 0===l?void 0:l.length)>0}))})()},[o]),(0,t.useEffect)(()=>{(async()=>{if(o&&(null==v?void 0:v.length)>0){let e=v.map(e=>{var l;let a=null===(l=e.key.match(/\d+$/))||void 0===l?void 0:l[0];return d({extension:I.$.DimensionId.get,parameters:"_itemId=".concat(o,"&_dimension=").concat(a)})}),l=(await Promise.all(e)).reduce((e,l,a)=>{var r;return e[v[a].key]=(null===(r=l.record)||void 0===r?void 0:r.id)||"",e},{}),a=x.map(e=>{var l;let a=null===(l=e.key.match(/\d+$/))||void 0===l?void 0:l[0];return d({extension:I.$.DimensionUDT.get,parameters:"_itemId=".concat(o,"&_dimension=").concat(a)})}),r=(await Promise.all(a)).reduce((e,l,a)=>{var r,t;return e[null===(r=x[a])||void 0===r?void 0:r.key]=(null===(t=l.record)||void 0===t?void 0:t.value)||"",e},{});g.setValues(e=>({...e,...l,...r}))}})()},[o,x,v]);let{formik:g}=(0,k.c)({initialValues:{},validateOnChange:!0,onSubmit:async()=>{let e=v.map(e=>{var l;return{dimension:null===(l=e.key.match(/\d+$/))||void 0===l?void 0:l[0],id:g.values[e.key],itemId:o}}).filter(e=>""!==e.id&&void 0!==e.id&&null!==e.id),l=x.map(e=>{var l;return{dimension:null===(l=e.key.match(/\d+$/))||void 0===l?void 0:l[0],itemId:o,value:g.values[e.key]}}).filter(e=>""!==e.value&&void 0!==e.value&&null!==e.value);(null==e?void 0:e.length)>0&&await s({extension:I.$.DimensionId.set,record:JSON.stringify({itemId:o,data:e})}),(null==l?void 0:l.length)>0&&await s({extension:I.$.DimensionUDT.set,record:JSON.stringify({itemId:o,data:l})}),n.ZP.success(u.Edited)}});return(0,r.jsx)(Q.Z,{onSave:g.handleSubmit,maxAccess:a,children:(0,r.jsx)(c.R,{children:(0,r.jsx)(m.Q,{children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:6,children:v.map((e,l)=>{var a;let t=(null===(a=e.key.match(/\d+$/))||void 0===a?void 0:a[0])||"";return(0,r.jsx)(y.ZP,{container:!0,mt:.2,spacing:2,children:(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.Dimension.qry,parameters:"_dimension=".concat(t),name:e.key,label:e.value,valueField:"id",displayField:"name",values:g.values,onChange:(l,a)=>{g.setFieldValue("".concat(e.key),null==a?void 0:a.id)}})})},l)})}),(0,r.jsx)(y.ZP,{item:!0,xs:6,children:x.map((e,l)=>(0,r.jsx)(y.ZP,{container:!0,mt:.2,spacing:2,children:(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(j.Z,{name:e.key,label:e.value,value:g.values[e.key],onChange:g.handleChange,maxAccess:a,onClear:()=>g.setFieldValue([e.key],"")})})},l))})]})})})})},X=a(48290),ee=e=>{let{store:l,labels:a}=e,{recordId:h}=l,{getRequest:x,postRequest:y}=(0,t.useContext)(i.$),{stack:f}=(0,v.zY)(),{platformLabels:g}=(0,t.useContext)(p.l),b=[{field:"barcode",headerName:a.barcode,flex:1},{field:"muName",headerName:a.msUnit,flex:1},{field:"defaultQty",headerName:a.defaultQty,flex:1},{field:"isInactive",headerName:a.isInactive,flex:1,type:"checkbox"}];async function k(){return await x({extension:I.$.Barcode.qry,parameters:"_itemId=".concat(h,"&_pageSize=50&_startAt=0")})}let{query:{data:j},labels:C,refetch:F,invalidate:Z,search:P,access:_}=(0,s.J)({enabled:!!h,datasetId:o.i.Barcodes,queryFn:k,endpointId:I.$.Barcode.qry,search:{endpointId:I.$.Barcodes.snapshot,searchFn:N}});function w(e){f({Component:X.Z,props:{labels:C,recordId:null==e?void 0:e.recordId,barcode:null==e?void 0:e.barcode,access:_,store:l,msId:null==l?void 0:l._msId},title:C.Barcodes})}async function N(e){let{options:l={},qry:a}=e,{_startAt:r=0,_size:t=50}=l;return await x({extension:I.$.Barcodes.snapshot,parameters:"_filter=".concat(a,"&_startAt=").concat(r,"&_size=").concat(t)})}let V=async e=>{await y({extension:I.$.Barcodes.del,record:JSON.stringify(e)}),Z(),n.ZP.success(g.Deleted)};return(0,r.jsxs)(c.R,{children:[(0,r.jsx)(u.g,{children:(0,r.jsx)(B.Z,{onAdd:()=>{w()},maxAccess:_,onSearch:P,inputSearch:!0})}),(0,r.jsx)(m.Q,{children:(0,r.jsx)(d.Z,{columns:b,gridData:j,rowId:"barcode",onEdit:e=>{w(e)},onDelete:V,deleteConfirmationType:"strict",isLoading:!1,pageSize:50,pagination:!1,maxAccess:_})})]})},el=a(90587);function ea(e){var l;let{labels:a,editMode:d,maxAccess:s,store:u}=e,{getRequest:v,postRequest:h}=(0,t.useContext)(i.$),{recordId:x,productionLevel:f}=u,{platformLabels:b}=(0,t.useContext)(p.l),{formik:j}=(0,k.c)({initialValues:{itemId:x,lineId:"",spfId:"",ltId:"",classId:"",designName:"",designRef:"",designId:"",standardCost:"",standardId:"",cgId:"",rmcId:"",bomId:null,wipItemId:null,wipItemSku:"",wipItemName:""},maxAccess:s,validateOnChange:!0,onSubmit:async e=>{await h({extension:I.$.ItemProduction.set,record:JSON.stringify({...e,itemId:x})}),j.setValues(e),n.ZP.success(b.Edited),invalidate()}});return(0,t.useEffect)(()=>{!async function(){if(x){let e=await v({extension:I.$.ItemProduction.get,parameters:"_recordId=".concat(x)});if(null==e?void 0:e.record){let l=Object.keys(j.initialValues).reduce((l,a)=>(l[a]=null!==e.record[a]?e.record[a]:j.initialValues[a],l),{});j.setValues(l)}}}()},[x]),(0,r.jsx)(g.Z,{resourceId:o.i.Items,form:j,maxAccess:s,editMode:d,isCleared:!1,isInfo:!1,children:(0,r.jsx)(c.R,{children:(0,r.jsx)(m.Q,{children:(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:el.u.ProductionLine.qry,name:"lineId",label:a.productionLine,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:j.values,maxAccess:s,onChange:(e,l)=>{j.setFieldValue("lineId",(null==l?void 0:l.recordId)||""),j.setFieldValue("ltId","")}})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:el.u.ProductionClass.qry,values:j.values,name:"classId",label:a.productionClass,valueField:"recordId",displayField:"name",maxAccess:s,onChange:(e,l)=>{j.setFieldValue("classId",(null==l?void 0:l.recordId)||"")},error:j.touched.classId&&!!j.errors.classId})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:el.u.ProductionStandard.qry,values:j.values,name:"standardId",label:a.productionStandard,valueField:"recordId",displayField:"reference",maxAccess:s,onChange:(e,l)=>{j.setFieldValue("standardId",(null==l?void 0:l.recordId)||"")},error:j.touched.standardId&&!!j.errors.standardId})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:I.$.SerialsProfile.qry,values:j.values,name:"spfId",label:a.sprofile,valueField:"recordId",displayField:"name",maxAccess:s,onChange:(e,l)=>{j.setFieldValue("spfId",(null==l?void 0:l.recordId)||"")},error:j.touched.spfId&&!!j.errors.spfId})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(W.U,{endpointId:el.u.Design.snapshot,valueField:"reference",displayField:"name",name:"designId",label:a.design,form:j,secondDisplayField:!0,firstValue:j.values.designRef,secondValue:j.values.designName,errorCheck:"designId",maxAccess:s,onChange:(e,l)=>{j.setFieldValue("designId",(null==l?void 0:l.recordId)||""),j.setFieldValue("designRef",(null==l?void 0:l.reference)||""),j.setFieldValue("designName",(null==l?void 0:l.name)||"")}})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(R.Z,{name:"standardCost",label:a.standardCost,value:j.values.standardCost,onChange:j.handleChange,onClear:()=>j.setFieldValue("standardCost",""),error:j.touched.grossWgt&&!!j.errors.grossWgt})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:el.u.CostGroup.qry,name:"cgId",label:a.cg,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:j.values,valueField:"recordId",displayField:"name",maxAccess:s,onChange:(e,l)=>{j.setFieldValue("cgId",null==l?void 0:l.recordId)}})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:T.x.LabelTemplate.qry,name:"ltId",label:a.template,valueField:"recordId",displayField:"name",values:j.values,onChange:(e,l)=>{j.setFieldValue("ltId",l?l.recordId:"")},error:j.touched.ltId&&!!j.errors.ltId,maxAccess:s})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:el.u.RawMaterialCategory.qry,name:"rmcId",label:a.rmc,valueField:"recordId",displayField:"name",values:j.values,onChange:(e,l)=>{j.setFieldValue("rmcId",null==l?void 0:l.recordId)},error:j.touched.rmcId&&!!j.errors.rmcId,maxAccess:s})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(C.Z,{endpointId:j.values.itemId&&el.u.BillOfMaterials.qry2,parameters:"_itemId=".concat(null==j?void 0:null===(l=j.values)||void 0===l?void 0:l.itemId),name:"bomId",label:a.bom,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:j.values,maxAccess:s,onChange:(e,l)=>{j.setFieldValue("bomId",(null==l?void 0:l.recordId)||"")}})}),(0,r.jsx)(y.ZP,{item:!0,xs:12,children:(0,r.jsx)(W.U,{endpointId:I.$.Item.snapshot3,parameters:{_productionLevel:4},name:"wipItemId",label:a.wipItem,valueField:"sku",displayField:"name",valueShow:"wipItemSku",secondValueShow:"wipItemName",form:j,readOnly:4==f,onChange:(e,l)=>{j.setFieldValue("wipItemSku",(null==l?void 0:l.sku)||null),j.setFieldValue("wipItemName",(null==l?void 0:l.name)||""),j.setFieldValue("wipItemId",(null==l?void 0:l.recordId)||"")},errorCheck:"wipItemId",maxAccess:s})})]})})})})}var er=e=>{let{store:l,labels:a,maxAccess:d}=e,{recordId:s}=l,{getRequest:u,postRequest:v}=(0,t.useContext)(i.$),{platformLabels:h}=(0,t.useContext)(p.l),{formik:x}=(0,k.c)({validateOnChange:!0,initialValues:{kit:[{id:1,kitId:s,muiId:"",componentId:"",componentName:"",componentSKU:"",qty:""}]},validationSchema:f.Ry({kit:f.IX().of(f.Ry().shape({componentSKU:f.Z_().test(function(e){var l,a,r;let t=this.parent,n=t.qty||t.componentSKU;return(null===(r=this.options.from[1])||void 0===r?void 0:null===(a=r.value)||void 0===a?void 0:null===(l=a.kit)||void 0===l?void 0:l.length)===1&&!n||!!e}),qty:f.Z_().test(function(e){var l,a,r;let t=this.parent,n=t.qty||t.componentSKU;return(null===(r=this.options.from[1])||void 0===r?void 0:null===(a=r.value)||void 0===a?void 0:null===(l=a.kit)||void 0===l?void 0:l.length)===1&&!n||!!e})})).required()}),onSubmit:e=>{b(e)}}),b=async e=>{let l=null==e?void 0:e.kit.map((e,l)=>({...e,kitId:s,seqNo:l+1})).filter(e=>e.componentId||e.componentName||e.componentSKU),a={kitId:s,components:l.length>0?l:[]};await v({extension:I.$.Kit.set,record:JSON.stringify(a)}).then(e=>{n.ZP.success(h.Edited)})},C=[{component:"resourcelookup",label:a.reference,name:"componentSKU",props:{endpointId:I.$.Items.snapshot,parameters:{_startAt:0,_size:50},displayField:"sku",valueField:"sku",mapping:[{from:"recordId",to:"componentId"},{from:"sku",to:"componentSKU"},{from:"name",to:"componentName"},{from:"defSaleMUId",to:"muId"}],columnsInDropDown:[{key:"name",value:"Name"},{key:"sku",value:"Reference"}]}},{component:"textfield",label:a.name,name:"componentName",props:{readOnly:!0}},{component:"numberfield",label:a.qty,name:"qty"}];return(0,t.useEffect)(()=>{!async function(){if(s){var e;let l=null===(e=(await u({extension:I.$.Kit.qry,parameters:"_kitId=".concat(s)})).list)||void 0===e?void 0:e.map((e,l)=>({...e,id:l+1}));(null==l?void 0:l.length)>0&&x.setValues({kit:l})}}()},[]),(0,r.jsx)(g.Z,{form:x,resourceId:o.i.PointOfSale,isCleared:!1,isInfo:!1,maxAccess:d,children:(0,r.jsxs)(c.R,{children:[(0,r.jsxs)(y.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(y.ZP,{item:!0,width:"50.1%",children:(0,r.jsx)(j.Z,{name:"name",label:a.name,value:null==l?void 0:l._name,readOnly:!0,maxAccess:d})}),(0,r.jsx)(y.ZP,{item:!0,width:"50.1%",children:(0,r.jsx)(j.Z,{name:"reference",label:a.reference,value:null==l?void 0:l._reference,readOnly:!0,maxAccess:d})})]}),(0,r.jsx)(m.Q,{children:(0,r.jsx)(z._,{onChange:e=>x.setFieldValue("kit",e),value:x.values.kit,error:x.errors.kit,columns:C,maxAccess:d,name:"kit"})})]})})},et=a(80968),en=e=>{let{store:l,maxAccess:a}=e,[s,o]=(0,t.useState)([]),[u,v]=(0,t.useState)(0),{getRequest:h,postRequest:x}=(0,t.useContext)(i.$),{platformLabels:y}=(0,t.useContext)(p.l),{getAllKvsByDataset:f}=(0,t.useContext)(et.k),g=()=>new Promise((e,l)=>{f({_dataset:w.v.IV_ITEM_RETAIL_SETTINGS,callback:a=>{a?e(a):l(Error("Failed to retrieve access level"))}})});(0,t.useEffect)(()=>{(async()=>{let e=await g();v(e.length),o(e.map(e=>({key:e.key,value:e.value,checked:!1})))})()},[]),(0,t.useEffect)(()=>{l.recordId&&u>0&&async function(){let e=await h({extension:I.$.ItemRetail.qry,parameters:"_itemId=".concat(l.recordId,"&_count=").concat(u)});o(null==s?void 0:s.map(l=>{let a=e.list.find(e=>e.idx===parseInt(l.key));return a?{...l,checked:a.flag}:l}))}()},[l.recordId,u]);let b=async()=>{let e=s.map(e=>({idx:parseInt(e.key),flag:e.checked})),a={itemId:l.recordId,flags:e};await x({extension:I.$.ItemRetail.set,record:JSON.stringify(a)}),n.ZP.success(y.Updated)};return(0,r.jsx)(Q.Z,{onSave:b,maxAccess:a,children:(0,r.jsx)(c.R,{children:(0,r.jsx)(m.Q,{children:(0,r.jsx)(d.Z,{name:"retail",columns:[{field:"value",flex:1,headerName:""}],gridData:{list:s},rowId:["key"],pageSize:50,pagination:!1,paginationType:"client",isLoading:!1,maxAccess:a,showCheckboxColumn:!0})})})})},ed=e=>{let{recordId:l,labels:a,msId:n,maxAccess:d,window:i}=e,[s,o]=(0,t.useState)(0),[c,u]=(0,t.useState)([]),m=!!l,[v,p]=(0,t.useState)({recordId:l||null,_msId:n,measurementId:null,priceGroupId:null,returnPolicy:null,_kit:!1,_name:null,_reference:null,_isMetal:!1,_metal:null,nraId:null,productionLevel:null}),I=[{label:a.items},{label:a.barcode,disabled:!v.recordId},{label:a.sales,disabled:!v.recordId},{label:a.properties,disabled:!v.recordId},{label:a.physical,disabled:!v.recordId},{label:a.vendor,disabled:!v.recordId},{label:a.production,disabled:!v.recordId},{label:a.kit,disabled:!v._kit},{label:a.retail,disabled:!v.recordId}];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Y,{tabs:I,activeTab:s,setActiveTab:o,maxAccess:d}),(0,r.jsx)(h.Z,{height:670,index:0,value:s,maxAccess:d,children:(0,r.jsx)(L,{labels:a,setStore:p,store:v,editMode:m,maxAccess:d,setFormikInitial:u,window:i})}),(0,r.jsx)(h.Z,{index:1,value:s,maxAccess:d,children:(0,r.jsx)(ee,{labels:a,setStore:p,store:v})}),(0,r.jsx)(h.Z,{index:2,value:s,maxAccess:d,children:(0,r.jsx)(H,{labels:a,maxAccess:d,store:v,formikInitial:c})}),(0,r.jsx)(h.Z,{index:3,value:s,maxAccess:d,children:(0,r.jsx)(K,{labels:a,maxAccess:d,store:v})}),(0,r.jsx)(h.Z,{index:4,value:s,maxAccess:d,children:(0,r.jsx)(O,{labels:a,setStore:p,maxAccess:d,store:v,editMode:m})}),(0,r.jsx)(h.Z,{index:5,value:s,maxAccess:d,children:(0,r.jsx)(J,{labels:a,setStore:p,maxAccess:d,store:v})}),(0,r.jsx)(h.Z,{index:6,value:s,maxAccess:d,children:(0,r.jsx)(ea,{labels:a,setStore:p,maxAccess:d,store:v})}),(0,r.jsx)(h.Z,{index:7,value:s,maxAccess:d,children:(0,r.jsx)(er,{labels:a,setStore:p,maxAccess:d,store:v})}),(0,r.jsx)(h.Z,{index:8,value:s,maxAccess:d,children:(0,r.jsx)(en,{labels:a,setStore:p,maxAccess:d,store:v})})]})},ei=a(36908),es=()=>{let{getRequest:e,postRequest:l}=(0,t.useContext)(i.$),{platformLabels:a}=(0,t.useContext)(p.l),[h,x]=(0,t.useState)(""),{stack:y}=(0,v.zY)();async function f(){let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:r=50,params:t=[]}=l;return{...await e({extension:I.$.Items.qry,parameters:"_startAt=".concat(a,"&_pageSize=").concat(r,"&_filter=&_sortField=recordId desc&_params=").concat(t)}),_startAt:a}}let{query:{data:g},filterBy:b,refetch:k,labels:j,access:C,paginationParameters:F,invalidate:Z}=(0,s.J)({queryFn:f,endpointId:I.$.Items.qry,datasetId:o.i.Items,filter:{filterFn:P}});async function P(l){let{filters:a,pagination:r={}}=l,{_startAt:t=0,_size:n=50}=r;return a.qry?{...await e({extension:I.$.Items.snapshot,parameters:"_filter=".concat(a.qry,"&_startAt=").concat(t,"&_size=").concat(n)}),_startAt:t}:f({_startAt:r._startAt||0,params:null==a?void 0:a.params})}let _=[{field:"sku",headerName:j.sku,flex:1},{field:"name",headerName:j.name,flex:1},{field:"flName",headerName:j.flName,flex:1},{field:"shortName",headerName:j.shortName,flex:1},{field:"description",headerName:j.description,flex:1},{field:"categoryName",headerName:j.category,flex:1},{field:"msName",headerName:j.measure,flex:1},{field:"ptName",headerName:j.priceType,flex:1},{field:"volume",headerName:j.volume,flex:1,type:{field:"number",decimal:4}},{field:"weight",headerName:j.weight,flex:1}];function w(e){y({Component:ed,props:{labels:j,recordId:null==e?void 0:e.recordId,msId:null==e?void 0:e.msId,maxAccess:C,sku:null==e?void 0:e.sku},width:1200,height:670,title:j.items,nextToTitle:null==e?void 0:e.sku})}let N=async e=>{await l({extension:I.$.Items.del,record:JSON.stringify(e)}),Z(),n.ZP.success(a.Deleted)};return(0,r.jsxs)(c.R,{children:[(0,r.jsx)(u.g,{children:(0,r.jsx)(ei.Z,{onAdd:()=>{w()},maxAccess:C,reportName:"IVIT",filterBy:b})}),(0,r.jsx)(m.Q,{children:(0,r.jsx)(d.Z,{name:"table",columns:_,gridData:g,rowId:["recordId"],onEdit:e=>{w(e)},onDelete:N,deleteConfirmationType:"strict",isLoading:!1,pageSize:50,paginationType:"api",paginationParameters:F,refetch:k,maxAccess:C})})]})}},61072:function(e,l,a){"use strict";a.d(l,{Z:function(){return g}});var r=a(52322),t=a(2784),n=a(55648),d=a(60218),i=a(76385),s=a(19473),o=a(21326),c=a(61802),u=a(26612),m=a(5088),v=a(80983),p=a(31389),I=a(62362),h=a(33625),x=a(71987);function y(e){let{barcode:l,window:a}=e,{labels:t,access:i}=(0,x.J)({datasetId:u.i.Items}),{formik:s}=(0,v.c)({initialValues:{barcode:l},maxAccess:i,onSubmit:e=>{navigator.clipboard.writeText(e.barcode),a.close()}}),o=[{key:"Ok",condition:!0,onClick:s.handleSubmit,disabled:!1}];return(0,r.jsxs)(p.R,{children:[(0,r.jsx)(I.Q,{children:(0,r.jsx)(d.ZP,{container:!0,spacing:2,sx:{padding:2},children:(0,r.jsx)(d.ZP,{item:!0,xs:12,children:(0,r.jsx)(m.Z,{name:"barcode",label:t.label,value:s.values.barcode,onChange:s.handleChange,onClear:()=>s.setFieldValue("barcode",""),error:s.touched.barcode&&!!s.errors.barcode})})})}),(0,r.jsx)(h.g,{children:(0,r.jsx)(n.Z,{actions:o,smallBox:!0})})]})}var f=a(40234),g=(0,t.forwardRef)(e=>{let{window:l,Print:a,barcode:u}=e,{platformLabels:m}=(0,t.useContext)(s.l),{stack:v}=(0,c.zY)();(0,o.Z)({title:m.Confirmation,window:l});let x=(0,t.useRef)(),g=(0,f.useReactToPrint)({content:()=>x.current}),b=[{key:"Copy",condition:!0,onClick:()=>{a(),v({Component:y,props:{barcode:u},width:400,height:200,title:m.printLabel})},disabled:!1},{key:"Print",condition:!0,onClick:()=>{g(),l.close()},disabled:!1}];return(0,r.jsxs)(p.R,{children:[(0,r.jsx)(I.Q,{children:(0,r.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(d.ZP,{item:!0,xs:12,children:(0,r.jsx)(i.Z,{padding:4,children:m.printConfirmation})}),(0,r.jsx)("div",{style:{display:"none"},children:(0,r.jsx)("div",{ref:x,style:{padding:"20px"},children:(0,r.jsx)("p",{children:u})})})]})}),(0,r.jsx)(h.g,{children:(0,r.jsx)(n.Z,{actions:b,smallBox:!0})})]})})},67920:function(e,l,a){"use strict";a.d(l,{m:function(){return t}});var r=a(48601);function t(e,l,a){var t;let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"items",d={...e};return null==a||null===(t=a.record)||void 0===t||t.controls.forEach(e=>{let{controlId:l,accessLevel:a}=e,[r,t]=null==l?void 0:l.split(".");r!==n||2!==a||t in d||(d[t]=e=>(null==e?void 0:e[t])!=null),(1===a||4===a)&&t in d&&delete d[t]}),{schema:r.Ry().shape({...Object.keys(d).reduce((e,a)=>(e[a]=r.nK().nullable().test(function(e){var r;let t=this.parent,[,n]=this.path.match(/^(\w+)\[(\d+)\]/)||[],i=(null===(r=this.options.context)||void 0===r?void 0:r[n])||[];if(l||!l&&i.length>1){if(null!==t[a]&&void 0!==t[a]&&0!==t[a]&&""!==d[a]&&!d[a](t))return!1;if(!Object.entries(d).some(e=>{let[,l]=e;return!!l(t)}))return!0}return!!d[a](t)&&void 0!==e}),e),{})}),requiredFields:d}}},74898:function(e,l,a){"use strict";a.d(l,{N:function(){return r}});let r={Global:0,AccountGroup:10,Account:11,CashAccountGroup:20,CashAccount:21,ItemGroup:30,Item:31,ItemCategory:32,Site:33,ExpenseType:41,CostType:42,ProductionOverhead:51,TaxCode:12,PayrollGLGroup:61,PayrollEntitlementDeduction:62,AssetGroup:71,AssetClass:72}},243:function(e,l,a){"use strict";a.d(l,{r:function(){return m}});var r=a(45300),t=a(2784),n=a(38449),d=a(65947);let i=async(e,l,a)=>{try{let r=await e({extension:l,parameters:a});return l.includes("qry")?r:r.record}catch(e){return null}},s=(e,l,a)=>{let r=(e=JSON.parse(JSON.stringify(e))).record.controls,t=r.find(e=>e.controlId===a);return t?t.accessLevel=(null==l?void 0:l.mandatory)?d.$7:d.rr:(null==l?void 0:l.mandatory)?r.push({sgId:18,resourceId:"",controlId:a,accessLevel:(null==l?void 0:l.mandatory)?d.$7:d.rr}):(null==l?void 0:l.readOnly)?r.push({sgId:18,resourceId:"",controlId:a,accessLevel:(null==l?void 0:l.readOnly)?d.rr:d.$7}):r=e.record.controls.filter(e=>e.controlId!==a),{...e,record:{...e.record,controls:r}}},o=async(e,l,a)=>{let r,t;return"isExternal"!==a?null:(t="_recordId=".concat(l),r=n.r.NumberRange.get,await i(e,r,t))},c=async function(e,l){let a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"reference",d={readOnly:!1,mandatory:!1};return d=r?{readOnly:null==(a=await o(e,r,"isExternal"))||!a.external,mandatory:null!=a&&!!a.external}:{readOnly:!1,mandatory:!0},t&&(d={readOnly:!0,mandatory:!1}),l&&d&&(l=await s(l,d,n)),{type:d,maxAccess:l,selectNraId:r}};var u=a(65950);function m(e){var l;let{access:a,readOnlyOnEditMode:n,name:d}=e,{getRequest:i}=(0,t.useContext)(u.$),[s,o]=(0,t.useState)(),m=async e=>await c(i,a,e,n,d),v=(0,r.a)({retry:!1,enabled:!0,staleTime:0,queryKey:[s,!!a],queryFn:()=>m(s)});return{refBehavior:v.data,maxAccess:null==v?void 0:null===(l=v.data)||void 0===l?void 0:l.maxAccess,changeDT(e){o(null==e?void 0:e.nraId)}}}},29326:function(e,l,a){"use strict";var r=a(52322);a(2784);var t=a(23925),n=a(13980),d=a.n(n),i=a(95291),s=a.n(i),o=a(65947);let c=e=>{var l,a,n;let{children:d,value:i,index:c,maxAccess:u,...m}=e,v="".concat(e.name||"tab",".").concat(c),{accessLevel:p}=null!==(n=(null!==(a=null==u?void 0:null===(l=u.record)||void 0===l?void 0:l.controls)&&void 0!==a?a:[]).find(e=>e.controlId===v))&&void 0!==n?n:{accessLevel:0};if(p===o.A1)return null;let I=i===c;return(0,r.jsx)(t.Z,{role:"tabpanel",hidden:!I,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c),className:"".concat(s().tabPanel," ").concat(I?s().active:s().hidden),...m,children:d})};c.propTypes={children:d().node,index:d().number.isRequired,value:d().number.isRequired},l.Z=c},9522:function(e,l,a){"use strict";a.d(l,{Y:function(){return m}});var r=a(52322),t=a(23925),n=a(54582),d=a(68696),i=a(44258),s=a(2784),o=a(99266),c=a(52614),u=a.n(c);let m=e=>{var l,a,c,m,v;let{tabs:p,activeTab:I,setActiveTab:h,maxAccess:x,name:y="tab"}=e,f=(null==x?void 0:null===(a=x.record)||void 0===a?void 0:null===(l=a.controls)||void 0===l?void 0:l.filter(e=>{var l;return 4===e.accessLevel&&(null===(l=e.controlId)||void 0===l?void 0:l.startsWith("".concat(y,".")))}).map(e=>e.controlId.split(".")[1]))||[],g=null==p?void 0:null===(c=p.map((e,l)=>({...e,id:l})))||void 0===c?void 0:c.filter((e,l)=>!f.includes(String(l))),b=null===(m=g[I])||void 0===m?void 0:m.id,k=null===(v=g[I])||void 0===v?void 0:v.disabled;return(0,s.useEffect)(()=>{b>=0&&!k&&I!=b&&h(b)},[]),(0,r.jsx)(t.Z,{className:u().tabsContainer,children:(0,r.jsx)(t.Z,{className:u().tabsWrapper,children:(0,r.jsx)(n.Z,{value:I,onChange:(e,l)=>h(l),variant:"scrollable",scrollButtons:g.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==g?void 0:g.map(e=>(0,r.jsx)(d.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,r.jsxs)(t.Z,{display:"flex",alignItems:"center",children:[(0,r.jsx)("span",{children:e.label}),e.id===I&&(null==e?void 0:e.onRefetch)&&(0,r.jsx)(i.Z,{size:"small",className:u().refreshButton,onClick:l=>{l.stopPropagation(),e.onRefetch()},children:(0,r.jsx)(o.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[92515,2494,40234,36908,48290,49774,92888,40179],function(){return e(e.s=33438)}),_N_E=e.O()}]);