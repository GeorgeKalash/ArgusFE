(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[77501],{31291:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/material-request",function(){return n(14244)}])},14244:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var a=n(52322),r=n(2784),l=n(62202),d=n(69387),i=n(65950),o=n(71987),s=n(26612),c=n(31389),u=n(33625),m=n(62362),v=n(61802),f=n(19473),I=n(98345),p=n(36908),y=n(7121),h=n(58912),x=n(20899),g=()=>{let{getRequest:e,postRequest:t}=(0,r.useContext)(i.$),{platformLabels:n}=(0,r.useContext)(f.l),{stack:g}=(0,v.zY)();async function w(){var t;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:r=50,params:l}=n,d=await e({extension:h.I.MaterialReplenishment.page,parameters:"_filter=&_size=30&_startAt=".concat(a,"&_sortBy=recordId desc&_pageSize=").concat(r,"&_params=").concat(l||"")});return d.list=null==d?void 0:null===(t=d.list)||void 0===t?void 0:t.map(e=>({...e,isVerified:!!(null==e?void 0:e.isVerified)})),{...d,_startAt:a}}async function b(t){let{filters:n,pagination:a}=t;return(null==n?void 0:n.qry)?await e({extension:h.I.MaterialReplenishment.snapshot,parameters:"_filter=".concat(n.qry)}):w({_startAt:a._startAt||0,params:null==n?void 0:n.params})}let{query:{data:_},labels:k,filterBy:N,paginationParameters:S,refetch:C,access:F,invalidate:R}=(0,o.J)({queryFn:w,endpointId:h.I.MaterialReplenishment.page,datasetId:s.i.MaterialReplenishment,filter:{filterFn:b}}),{proxyAction:q}=(0,I.G)({functionId:y.J.MaterialRequest,action:O}),j=async()=>{await q()},Z=[{field:"reference",headerName:k.reference,flex:1},{field:"date",headerName:k.date,flex:1,type:"date"},{field:"departmentName",headerName:k.department,flex:1},{field:"siteName",headerName:k.site,flex:1},{field:"fromSiteName",headerName:k.fromSite,flex:1},{field:"notes",headerName:k.notes,flex:1},{field:"rsName",headerName:k.releaseStatus,flex:1},{field:"wipName",headerName:k.wip,flex:1}];function O(e){g({Component:x.Z,props:{recordId:e}})}let A=async e=>{await t({extension:h.I.MaterialReplenishment.del,record:JSON.stringify(e)}),R(),l.ZP.success(n.Deleted)};return(0,a.jsxs)(c.R,{children:[(0,a.jsx)(u.g,{children:(0,a.jsx)(p.Z,{labels:k,onAdd:j,maxAccess:F,reportName:"IRREQ",filterBy:N})}),(0,a.jsx)(m.Q,{children:(0,a.jsx)(d.Z,{name:"table",columns:Z,gridData:_,rowId:["recordId"],onEdit:e=>{O(null==e?void 0:e.recordId)},onDelete:A,isLoading:!1,pageSize:50,paginationType:"api",paginationParameters:S,refetch:C,maxAccess:F})})]})}},1685:function(e,t,n){"use strict";n.d(t,{m:function(){return a}});let a=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,n){"use strict";n.d(t,{H:function(){return I},G:function(){return f}});var a=n(45300),r=n(2784),l=n(96026),d=n(38449);n(26612);var i=n(65947),o=n(1685);let s=async(e,t,n)=>{try{let a=await e({extension:t,parameters:n});return t.includes("qry")?a:a.record}catch(e){return null}},c=(e,t,n,a)=>{let r=(e=JSON.parse(JSON.stringify(e))).record.controls,l=r.find(e=>"reference"===e.controlId);return l?l.accessLevel=(null==t?void 0:t.mandatory)?i.$7:i.rr:(null==t?void 0:t.mandatory)?r.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?i.$7:i.rr}):(null==t?void 0:t.readOnly)?r.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?i.rr:i.$7}):r=e.record.controls.filter(e=>"reference"!=e.controlId),n&&r.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","dtId"),accessLevel:i.$7}),{...e,record:{...e.record,controls:r}}},u=async(e,t,n)=>{let a,r;switch(n){case"dtId":let l=(0,o.m)("userData"),i=null==l?void 0:l.userId;r="_userId=".concat(i,"&_functionId=").concat(t),a=d.r.UserFunction.get;break;case"glbSysNumberRange":r="_recordId=".concat(t),a=d.r.SystemFunction.get;break;case"DocumentType":r="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),a=d.r.DocumentType.qry;break;case"DcTypNumberRange":r="_recordId=".concat(t),a=d.r.DocumentType.get;break;case"isExternal":r="_recordId=".concat(t),a=d.r.NumberRange.get;break;default:return null}return await s(e,a,r)},m=async function(e){let t,n,a,r,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,d=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=!(arguments.length>4)||void 0===arguments[4]||arguments[4],s=arguments.length>5?arguments[5]:void 0,m=void 0===i&&l&&await u(e,l,"dtId"),v=null==m?void 0:m.dtId,f="",I=!0;if(m&&void 0===i||"nraId"===i){if(v){let n=await u(e,v,"DcTypNumberRange");t=null==n?void 0:n.nraId,I=!((null==n?void 0:n.activeStatus)<0),t||(f="Assign the document type to a number range")}if((!v||!I)&&o&&l){var p;let t=await u(e,l,"DocumentType");r=(null==t?void 0:null===(p=t.list)||void 0===p?void 0:p.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===i||void 0===i)&&l){if((!v||v)&&!t||t&&!I){let n=await u(e,l,"glbSysNumberRange");(t=null==n?void 0:n.nraId)&&r&&(r=!1),I=!0}f=t||r?"":"Assign the system Function to a number range"}i>0&&!t&&(t=i),t&&I?(n={readOnly:null==(a=await u(e,t,"isExternal"))||!a.external,mandatory:null!=a&&!!a.external},d&&(d=await c(d,n,r,s))):!t&&d&&(d=await c(d,n,r,s));let y=s?"".concat(s,".reference"):"reference";return{dtId:v,resetReference:null==n?void 0:n.readOnly,dcTypeRequired:r,reference:{fieldName:y,isEmpty:(null==a?void 0:a.external)!==void 0&&(null==a||!a.external)},errorMessage:f,maxAccess:d,selectNraId:i}};var v=n(65950);function f(e){let{functionId:t,action:n,hasDT:a}=e,{getRequest:d}=(0,r.useContext)(v.$),{stack:i}=(0,l.V)();return{proxyAction:async()=>{let e=await m(d,t,"",void 0,a);(null==e?void 0:e.errorMessage)?i({message:null==e?void 0:e.errorMessage}):await n()}}}function I(e){var t;let{functionId:n,access:d,hasDT:i,enabled:o=!0,objectName:s=""}=e,{getRequest:c}=(0,r.useContext)(v.$),{stack:u}=(0,l.V)(),[f,I]=(0,r.useState)(),p=async e=>{let t=await m(c,n,d,e,i,s);if(!t.errorMessage)return t;u({message:null==t?void 0:t.errorMessage})},y=(0,a.a)({retry:!1,staleTime:0,enabled:o,queryKey:[n,f,!!d,o],queryFn:f||"nraId"===f?()=>p(f):()=>p()});return{documentType:y.data,maxAccess:(null==y?void 0:null===(t=y.data)||void 0===t?void 0:t.maxAccess)||d,changeDT(e){I((null==e?void 0:e.nraId)||"nraId")}}}},20899:function(e,t,n){"use strict";n.d(t,{Z:function(){return P}});var a=n(52322),r=n(60218),l=n(2784),d=n(48601),i=n(82737),o=n(62202),s=n(76399),c=n(65950),u=n(71987),m=n(26612),v=n(5088),f=n(80983),I=n(19473),p=n(31389),y=n(62362),h=n(89330),x=n(8661),g=n(38449),w=n(7121),b=n(21581),_=n(98345),k=n(39812),N=n(39704),S=n(61802),C=n(65215),F=n(96026),R=n(70104),q=n(58912),j=n(92407),Z=n(33625),O=n(27423),A=n(90587),V=n(21326),M=n(50023);function P(e){var t,n,P,D,E,J,T,L;let{recordId:$,window:H}=e,{getRequest:z,postRequest:Q}=(0,l.useContext)(c.$),{platformLabels:W,defaultsData:B}=(0,l.useContext)(I.l),{stack:G}=(0,S.zY)(),{stack:U}=(0,F.V)(),[X,K]=(0,l.useState)([]),Y=(0,l.useRef)([]),{labels:ee,access:et}=(0,M.Z)({datasetId:m.i.MaterialReplenishment,editMode:!!$});(0,V.Z)({title:ee.MaterialRequest,window:H});let{documentType:en,maxAccess:ea,changeDT:er}=(0,_.H)({functionId:w.J.MaterialRequest,access:et,enabled:!$}),el=(0,u.E)({endpointId:q.I.MaterialReplenishment.page});async function ed(){if(!ev&&(null==en||!en.dtId)){var e;let t=null==B?void 0:null===(e=B.list)||void 0===e?void 0:e.find(e=>{let{key:t}=e;return"de_siteId"===t});(null==t?void 0:t.value)&&es.setFieldValue("fromSiteId",parseInt(null==t?void 0:t.value))}}let ei=null===(t=JSON.parse(window.sessionStorage.getItem("userData")))||void 0===t?void 0:t.userId,eo=async()=>{var e,t;let n=await z({extension:g.r.Users.get,parameters:"_recordId=".concat(ei)});if(null==n?void 0:null===(e=n.record)||void 0===e?void 0:e.employeeId){let e=await z({extension:j.y.Employee.get1,parameters:"_recordId=".concat(null==n?void 0:null===(t=n.record)||void 0===t?void 0:t.employeeId)});es.setFieldValue("departmentId",e.record.departmentId)}},{formik:es}=(0,f.c)({documentType:{key:"dtId",value:null==en?void 0:en.dtId},initialValues:{recordId:null,functionId:w.J.MaterialRequest,reference:"",dtId:null,siteId:null,siteName:"",date:new Date,fromSiteId:"",departmentId:null,departmentName:"",statusName:"",rsName:"",wipName:"",notes:"",workCenterId:null,wcName:"",wcRef:"",status:1,wip:1,items:[{id:1,requestId:$||0,seqNo:1,sku:"",itemName:null,itemId:null,qty:null,notes:"",onHandSite:0,onHandGlobal:null,deliveredQty:null,deliveryStatus:"",muId:null,muQty:"",muRef:"",muName:"",msId:null}]},maxAccess:ea,validateOnChange:!0,validationSchema:d.Ry({date:d.hT().required(),fromSiteId:d.Z_().required(),items:d.IX().of(d.Ry().shape({sku:d.Z_().required(),qty:d.Z_().required().min(1)})).required()}),onSubmit:async e=>{let t={...e,date:(0,k.ku)(null==e?void 0:e.date)||null};delete t.items;let n=null==e?void 0:e.items.map((t,n)=>({...t,seqNo:n+1,requestId:e.recordId||0}));if(e.fromSiteId===e.siteId){U({message:ee.errorMessage});return}let a=await Q({extension:q.I.MaterialReplenishment.set2,record:JSON.stringify({header:t,items:n})});if(e.recordId)o.ZP.success(W.Edited);else{o.ZP.success(W.Added),es.setFieldValue("recordId",a.recordId);let e=await eh(a.recordId),t=await e_(a.recordId);es.setValues({...e.record,items:t}),el()}}});async function ec(e){var t,n;if(!e)return;let a=null===(n=es.values.items)||void 0===n?void 0:null===(t=n.find(t=>parseInt(t.itemId)===e))||void 0===t?void 0:t.msId,r=(null==X?void 0:X.filter(e=>e.msId===a))||[];Y.current=r}let eu=2===es.values.wip,em=-1==es.values.status,ev=!!es.values.recordId,ef=async()=>await z({extension:C.$.MeasurementUnit.qry,parameters:"_msId=0"});async function eI(e){let t=await z({extension:C.$.Item.get,parameters:"_recordId=".concat(e)});return null==t?void 0:t.record}async function ep(e){let t=await z({extension:C.$.Availability.qry,parameters:"_siteId=".concat(es.values.fromSiteId||0,"&_itemId=").concat(e,"&_startAt=0&_pageSize=1000")}),n=(null==t?void 0:t.count)>0,a=n&&0!==t.list[0].siteId;return n&&a?(es.setFieldValue("onHandSite",t.list[0].onhand),t.list[0].onhand):(es.setFieldValue("onHandSite",0),null)}let ey=[{component:"resourcelookup",label:ee.sku,name:"sku",props:{endpointId:C.$.Item.snapshot,valueField:"sku",displayField:"sku",mandatory:!0,readOnly:eu||em,displayFieldWidth:3,mapping:[{from:"recordId",to:"itemId"},{from:"msId",to:"msId"},{from:"onHandGlobal",to:"onHandGlobal"},{from:"deliveredQty",to:"deliveredQty"},{from:"sku",to:"sku"},{from:"name",to:"itemName"},{from:"isInactive",to:"isInactive"}],columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"},{key:"flName",value:"flName"}]},async onChange(e){let{row:{update:t,newRow:n}}=e;if(!(null==n?void 0:n.itemId)){t({details:!1});return}if(n.isInactive){t({...es.initialValues.items[0],id:n.id}),U({message:ee.inactiveItem});return}if(null==n?void 0:n.itemId){var a,r,l;let e=await eI(n.itemId);ec(null==n?void 0:n.itemId);let d=null==X?void 0:X.filter(t=>t.msId===(null==e?void 0:e.msId)),i=null!==(l=await ep(null==n?void 0:n.itemId))&&void 0!==l?l:0;t({msId:null==e?void 0:e.msId,onHandSite:i,muRef:null==d?void 0:null===(a=d[0])||void 0===a?void 0:a.reference,muId:null==d?void 0:null===(r=d[0])||void 0===r?void 0:r.recordId})}}},{component:"textfield",label:ee.itemName,name:"itemName",props:{readOnly:!0}},{component:"resourcecombobox",label:ee.muId,name:"muRef",props:{store:null==Y?void 0:Y.current,displayField:"reference",valueField:"recordId",readOnly:eu||em,mapping:[{from:"reference",to:"muRef"},{from:"recordId",to:"muId"}]},async onChange(e){var t;let{row:{update:n,newRow:a}}=e,r=null==Y?void 0:Y.current.filter(e=>e.recordId===(null==a?void 0:a.muId));n({qtyInBase:(null==a?void 0:a.qty)*(null==r?void 0:r.muQty),muQty:null==a?void 0:a.muQty})},propsReducer(e){let{row:t,props:n}=e;return{...n,store:null==Y?void 0:Y.current}}},{component:"numberfield",label:ee.qty,name:"qty",props:{readOnly:eu||em,mandatory:!0},async onChange(e){let{row:{update:t,newRow:n}}=e;if(n){var a;t({qtyInBase:(null==n?void 0:n.qty)*(null==n?void 0:n.muQty)})}}},{component:"numberfield",label:ee.onHandSite,name:"onHandSite",props:{readOnly:!0}},{component:"textfield",label:ee.notes,name:"notes",props:{readOnly:eu||em}}];async function eh(e){var t;let n=await z({extension:q.I.MaterialReplenishment.get,parameters:"_requestId=".concat(e,"&_params=")});return n.record.date=(0,k.a1)(null==n?void 0:null===(t=n.record)||void 0===t?void 0:t.date),n}let ex=async e=>{await Q({extension:q.I.MaterialReplenishment.close,record:JSON.stringify({recordId:e})}),o.ZP.success(W.Closed),el();let t=await eh(e),n=await e_(e);es.setValues({...t.record,items:n})},eg=async e=>{var t;let n={...es.values,date:(0,k.ku)(null===(t=es.values)||void 0===t?void 0:t.date)||null};delete n.items,await Q({extension:q.I.MaterialReplenishment.reopen,record:JSON.stringify(n)}),o.ZP.success(W.Reopened),el();let a=await eh(e),r=await e_(e);es.setValues({...a.record,items:r})},ew=async e=>{var t;let n={...es.values,date:(0,k.ku)(null===(t=es.values)||void 0===t?void 0:t.date)||null};delete n.items,await Q({extension:q.I.MaterialReplenishment.cancel,record:JSON.stringify(n)}),o.ZP.success(W.Cancelled),el();let a=await eh(e),r=await e_(e);es.setValues({...a.record,items:r})},eb=[{key:"Approval",condition:!0,onClick:"onApproval",disabled:!eu},{key:"Close",condition:!eu,onClick:()=>ex(es.values.recordId),disabled:!ev||em},{key:"Reopen",condition:eu,onClick:()=>eg(es.values.recordId),disabled:!ev||em},{key:"WorkFlow",condition:!0,onClick:async()=>{G({Component:N.Z,props:{functionId:w.J.MaterialRequest,recordId:es.values.recordId}})},disabled:!ev},{key:"Cancel",condition:!0,onClick:()=>ew(es.values.recordId),disabled:!ev||em||eu}];async function e_(e){var t,n;let a=await z({extension:q.I.OrderItem.qry,parameters:"_requestId=".concat(e,"&_functionId=").concat(w.J.MaterialRequest,"&_params=&_startAt=0")});return(null==a?void 0:null===(t=a.list)||void 0===t?void 0:t.length)?await Promise.all(null==a?void 0:null===(n=a.list)||void 0===n?void 0:n.map(async e=>({...e,id:e.seqNo,onHandSite:e.onhandSite}))):[]}return(0,l.useEffect)(()=>{!async function(){let e=await ef();K(null==e?void 0:e.list),ed(),await eo()}()},[]),(0,l.useEffect)(()=>{!async function(){if($&&X){let e=await eh($),t=await e_($);es.setValues({...e.record,items:t})}}()},[$,X]),(0,a.jsx)(i.Z,{resourceId:m.i.MaterialReplenishment,form:es,maxAccess:ea,editMode:ev,previewReport:ev,actions:eb,functionId:w.J.MaterialRequest,disabledSubmit:eu||em,children:(0,a.jsxs)(p.R,{children:[(0,a.jsx)(Z.g,{children:(0,a.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(r.ZP,{item:!0,xs:6,children:(0,a.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(r.ZP,{item:!0,xs:12,children:(0,a.jsx)(x.Z,{endpointId:g.r.DocumentType.qry,parameters:"_dgId=".concat(w.J.MaterialRequest,"&_startAt=0&_pageSize=50"),filter:ev?void 0:e=>1===e.activeStatus,name:"dtId",label:ee.documentType,readOnly:eu||em,valueField:"recordId",displayField:"name",values:null==es?void 0:es.values,onChange:async(e,t)=>{es.setFieldValue("dtId",(null==t?void 0:t.recordId)||null),er(t)},error:es.touched.dtId&&!!es.errors.dtId,maxAccess:ea})}),(0,a.jsx)(r.ZP,{item:!0,xs:12,children:(0,a.jsx)(v.Z,{name:"reference",label:ee.reference,value:null==es?void 0:null===(n=es.values)||void 0===n?void 0:n.reference,readOnly:ev,maxAccess:!ev&&ea,onChange:es.handleChange,onClear:()=>es.setFieldValue("reference",""),error:es.touched.reference&&!!es.errors.reference})}),(0,a.jsx)(r.ZP,{item:!0,xs:12,children:(0,a.jsx)(h.Z,{name:"date",label:ee.date,value:null==es?void 0:null===(P=es.values)||void 0===P?void 0:P.date,required:!0,onChange:es.setFieldValue,onClear:()=>es.setFieldValue("date",null),readOnly:eu||em,error:es.touched.date&&!!es.errors.date,maxAccess:ea})}),(0,a.jsx)(r.ZP,{item:!0,xs:12,children:(0,a.jsx)(x.Z,{endpointId:R.K.DepartmentFilters.qry,parameters:"_filter=&_size=1000&_startAt=0&_type=0&_activeStatus=0&_sortBy=recordId",name:"departmentId",readOnly:eu||em,label:ee.department,values:es.values,displayField:"name",maxAccess:ea,onChange:(e,t)=>{es.setFieldValue("departmentId",(null==t?void 0:t.recordId)||null)},error:es.touched.departmentId&&!!es.errors.departmentId})})]})}),(0,a.jsx)(r.ZP,{item:!0,xs:6,children:(0,a.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(r.ZP,{item:!0,xs:12,children:(0,a.jsx)(O.U,{endpointId:A.u.WorkCenter.snapshot,name:"workCenterId",label:ee.workCenter,valueField:"reference",displayField:"name",valueShow:"wcRef",secondValueShow:"wcName",displayFieldWidth:2,form:es,onChange:(e,t)=>{es.setFieldValue("workCenterId",(null==t?void 0:t.recordId)||null),es.setFieldValue("wcRef",(null==t?void 0:t.reference)||""),es.setFieldValue("wcName",(null==t?void 0:t.name)||"")},error:es.touched.workCenterId&&!!es.errors.workCenterId})}),(0,a.jsx)(r.ZP,{item:!0,xs:12,children:(0,a.jsx)(x.Z,{endpointId:C.$.Site.qry,name:"siteId",readOnly:eu||em,refresh:ev,label:ee.site,values:es.values,displayField:"name",maxAccess:ea,onChange:(e,t)=>{es.setFieldValue("siteId",(null==t?void 0:t.recordId)||null)},error:es.touched.siteId&&!!es.errors.siteId})}),(0,a.jsx)(r.ZP,{item:!0,xs:12,children:(0,a.jsx)(x.Z,{endpointId:C.$.Site.qry,name:"fromSiteId",readOnly:eu||em||(null==es?void 0:null===(E=es.values)||void 0===E?void 0:null===(D=E.items)||void 0===D?void 0:D.some(e=>e.sku)),label:ee.fromSite,values:es.values,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:1,required:!0,maxAccess:ea,onChange:(e,t)=>{es.setFieldValue("fromSiteId",(null==t?void 0:t.recordId)||null)},error:es.touched.fromSiteId&&!!es.errors.fromSiteId})}),(0,a.jsx)(r.ZP,{item:!0,xs:12,children:(0,a.jsx)(b.Z,{name:"notes",label:ee.notes,value:null==es?void 0:null===(J=es.values)||void 0===J?void 0:J.notes,readOnly:eu||em,maxLength:"200",maxAccess:ea,onChange:es.handleChange,onClear:()=>es.setFieldValue("notes",""),error:es.touched.notes&&!!es.errors.notes})})]})})]})}),(0,a.jsx)(y.Q,{children:(0,a.jsx)(s._,{onChange:e=>{let t=null==e?void 0:e.map(e=>({...e,details:!1,qtyInBase:0}));null==es||es.setFieldValue("items",t)},onSelectionChange:(e,t,n)=>{"muRef"==n&&ec(null==e?void 0:e.itemId)},name:"items",maxAccess:ea,value:null==es?void 0:null===(T=es.values)||void 0===T?void 0:T.items,error:null==es?void 0:null===(L=es.errors)||void 0===L?void 0:L.items,columns:ey,allowDelete:!eu&&!em})})]})})}P.width=1e3,P.height=680},39704:function(e,t,n){"use strict";var a=n(52322),r=n(2784),l=n(22341),d=n(65950),i=n(85325),o=n(21326),s=n(19473),c=n(35656),u=n(24868),m=n.n(u);let v=e=>{let{functionId:t,recordId:n,window:u}=e,{getRequest:v}=(0,r.useContext)(d.$),{languageId:f}=(0,r.useContext)(i.V),{platformLabels:I}=(0,r.useContext)(s.l),p=n+"-"+t;(0,o.Z)({title:I.WorkFlow,window:u});let{width:y}=(0,c.d)(),h=y<=1024,x=y>1024&&y<=1280,g=h?10:x?12:14,w=h?75:x?85:95,b=h?15:x?20:25,_=async()=>{var e="_functionId=".concat(t,"&_recordId=").concat(n);let a=await v({extension:l.P.WorkFlow.graph,parameters:e});return null==a?void 0:a.record},k=e=>{let t=[],n=[],a="",r="";return e.objects.forEach(e=>{t.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(t=>{e.objects.forEach(e=>{let n=e.functionName.split(" ").join("\r\n");t.parentId===e.recordId&&t.parentFunctionId===e.functionId&&(a=e.reference+"\r\n"+e.date+"\r\n"+n,t.parentId),t.childId===e.recordId&&t.childFunctionId===e.functionId&&(r=e.reference+"\r\n"+e.date+"\r\n"+n,t.childId)}),""===a||""===r||n.push({from:a,to:r,value:1,labelText:""}),a="",r=""}),n};return(0,r.useEffect)(()=>{!async function(){var e=await _();if(e){let t=(e,t)=>{let n=document.createElement("script");n.type="text/javascript",n.src=e,n.async=!0,n.onload=t,document.head.appendChild(n)};t("https://cdn.amcharts.com/lib/4/core.js",()=>{t("https://cdn.amcharts.com/lib/4/charts.js",()=>{t("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let t=am4core.create(p,am4charts.SankeyDiagram),n=k(e);t.data=n,t.dataFields.fromName="from",t.dataFields.toName="to",t.dataFields.value="value",t.paddingRight=2===f?0:40,t.paddingLeft=2===f?40:0,t.tooltip.label.fontSize=g;let a=t.nodes.template;a.draggable=!1,a.inert=!0,a.clickable=!1,a.width=w,a.height=b,a.nameLabel.label.fontSize=g,a.nameLabel.locationX=2===f?.85:0,a.nameLabel.height=void 0,a.nameLabel.label.fontWeight="bold";let r=t.links.template;r.middleLine.strokeOpacity=.3,r.middleLine.stroke=am4core.color("#555"),r.middleLine.strokeWidth=5,r.middleLine.hoverable=!1,r.fillOpacity=0,r.hoverable=!0,r.hoverOnFocus=!0,r.fill=am4core.color("#A8C686"),r.isHover=!0,t.appear(1e3,100)})})})})}}()},[]),(0,a.jsx)("div",{id:p,className:m().root})};v.width=950,t.Z=v},24868:function(e){e.exports={root:"WorkFlow_root__EINm1"}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=31291)}),_N_E=e.O()}]);