(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[87464],{51379:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/rt-cor-disp-rate",function(){return t(59873)}])},59873:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return f}});var a=t(52322),n=t(60218),l=t(2784),s=t(65950),d=t(26612),o=t(84100),u=t(48601),i=t(53621),c=t(76399),y=t(62202),p=t(31389),m=t(33625),I=t(62362),C=t(19473),q=t(80983),g=t(71987),v=t(8661),R=t(88635),x=t(38449),h=t(69627);t(82737);var P=t(54074),f=()=>{var e,r,t,f,F,T,S;let{postRequest:A,getRequest:O}=(0,l.useContext)(s.$),{platformLabels:D}=(0,l.useContext)(C.l),{labels:E,access:N}=(0,g.J)({datasetId:d.i.CorrespondentDispersalRate}),{formik:b}=(0,q.c)({initialValues:{corId:null,currencyId:null,plantId:0,countryId:null,dispersalType:null,items:[]},maxAccess:N,validateOnChange:!0,validationSchema:u.Ry({countryId:u.Rx().required(),corId:u.Rx().required(),currencyId:u.Rx().required(),dispersalType:u.Rx().required(),items:u.IX().of(u.Ry().shape({minRate:u.Rx().nullable().transform(e=>""===e?null:e).test("min-required-if-any","minRate is required",function(e){let{maxRate:r,rate:t}=this.parent;return null==r&&null==t||null!=e}),maxRate:u.Rx().nullable().transform(e=>""===e?null:e).test("max-required-if-any","maxRate is required",function(e){let{minRate:r,rate:t}=this.parent;return null==r&&null==t||null!=e}),rate:u.Rx().nullable().transform(e=>""===e?null:e).test("rate-required-if-any","rate is required",function(e){let{minRate:r,maxRate:t}=this.parent;return null==r&&null==t||null!=e}).test("rate-between","rate must be between minRate and maxRate",function(e){let{minRate:r,maxRate:t}=this.parent;return null==e||null==r||null==t||r<=e&&e<=t})})).required()}),onSubmit:async e=>{var r;let t=null==e?void 0:null===(r=e.items)||void 0===r?void 0:r.filter(e=>null!=e.rate||null!=e.minRate||null!=e.maxRate),a={...e,items:t};await A({extension:i.d.CorrespondentDispersalRate.set2,record:JSON.stringify(a)}),y.ZP.success(D.Updated)}}),_=[{component:"textfield",label:E.plant,name:"plantName",props:{readOnly:!0}},{component:"textfield",label:E.defaultRate,name:"defaultRate",props:{readOnly:!0}},{component:"textfield",label:E.rcm,name:"rateCalcMethodName",props:{readOnly:!0}},{component:"numberfield",label:E.min,name:"minRate",props:{maxLength:15,decimalScale:7}},{component:"numberfield",label:E.rate,name:"rate",props:{maxLength:15,decimalScale:7}},{component:"numberfield",label:E.max,name:"maxRate",props:{maxLength:15,decimalScale:7}}],V=async e=>e?await O({extension:x.r.Plant.get,parameters:"_recordId=".concat(e)}):await O({extension:x.r.Plant.qry}),w=async(e,r,t,a,n)=>await O({extension:i.d.CorrespondentDispersalRate.qry,parameters:"_corId=".concat(e,"&_countryId=").concat(r||0,"&_currencyId=").concat(t||0,"&_plantId=").concat(a||0,"&_dispersalType=").concat(n||0)}),B=async e=>await O({extension:R.L.ATPExchangeRate.get2,parameters:"_toCurrencyId=".concat(e||0)}),G=async()=>{var e,r;let{plantId:t,corId:a,countryId:n,currencyId:l,dispersalType:s}=b.values,d=(null===(e=await w(a,n,l,t,s))||void 0===e?void 0:e.list)||[],{fxRate:o,rateCalcMethodName:u,rateCalcMethod:i}=(null===(r=await B(l))||void 0===r?void 0:r.record)||[],c=await V(t),y=t?[c.record]:null==c?void 0:c.list,p=null==y?void 0:y.map((e,r)=>{let t=d.find(r=>r.plantId===e.recordId);return{id:r+1,corId:b.values.corId,plantId:e.recordId,plantName:e.name,minRate:(null==t?void 0:t.minRate)||null,rate:(null==t?void 0:t.rate)||null,maxRate:(null==t?void 0:t.maxRate)||null,currencyId:b.values.currencyId,rateCalcMethod:i,defaultRate:o,rateCalcMethodName:u}});b.setFieldValue("items",p)},M=e=>{let r=e.values.items[0],t=e.values.items.map(e=>({...e,minRate:r.minRate,maxRate:r.maxRate,rate:r.rate}));e.setValues({...e.values,items:t})};return(0,l.useEffect)(()=>{b.values.corId&&b.values.currencyId&&b.values.countryId&&b.values.dispersalType?G():b.setFieldValue("items",[])},[b.values.corId,b.values.countryId,b.values.currencyId,b.values.plantId,b.values.dispersalType]),(0,a.jsx)(P.Z,{onSave:b.handleSubmit,maxAccess:N,fullSize:!0,children:(0,a.jsxs)(p.R,{children:[(0,a.jsx)(m.g,{children:(0,a.jsxs)(n.ZP,{container:!0,spacing:2,p:2,children:[(0,a.jsx)(n.ZP,{item:!0,xs:2,children:(0,a.jsx)(v.Z,{endpointId:i.d.Correspondent.qry2,name:"corId",label:E.corName,valueField:"recordId",displayField:"name",required:!0,values:b.values,maxAccess:N,onChange:(e,r)=>{b.setFieldValue("corId",(null==r?void 0:r.recordId)||null),b.setFieldValue("interfaceId",(null==r?void 0:r.interfaceId)||""),b.setFieldValue("corName",(null==r?void 0:r.name)||""),b.setFieldValue("corRef",(null==r?void 0:r.reference)||""),r||(b.setFieldValue("currencyId",null),b.setFieldValue("currencyName",""),b.setFieldValue("countryId",null),b.setFieldValue("countryName",""))},error:b.touched.corId&&!!b.errors.corId})}),(0,a.jsx)(n.ZP,{item:!0,xs:2,children:(0,a.jsx)(v.Z,{endpointId:R.L.Countries.qry,parameters:"_interfaceId=".concat(b.values.interfaceId||2),name:"countryId",label:E.country,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,values:b.values,displayFieldWidth:1.75,onChange:(e,r)=>{b.setFieldValue("countryId",(null==r?void 0:r.recordId)||null),b.setFieldValue("countryName",(null==r?void 0:r.name)||""),r||(b.setFieldValue("currencyId",null),b.setFieldValue("currencyName",""))},readOnly:!b.values.corId,error:b.touched.countryId&&!!b.errors.countryId,maxAccess:N})}),(0,a.jsx)(n.ZP,{item:!0,xs:2,children:(0,a.jsx)(v.Z,{endpointId:R.L.Currencies.qry,parameters:"_interfaceId=".concat(b.values.interfaceId||2,"&_countryId=").concat(b.values.countryId||0),name:"currencyId",label:E.currency,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,values:b.values,maxAccess:N,onChange:(e,r)=>{b.setFieldValue("currencyId",(null==r?void 0:r.recordId)||null),b.setFieldValue("currencyName",(null==r?void 0:r.name)||"")},readOnly:!b.values.corId||!b.values.countryId,error:b.touched.currencyId&&!!b.errors.currencyId})}),(0,a.jsx)(n.ZP,{item:!0,xs:2,children:(0,a.jsx)(v.Z,{values:b.values,datasetId:o.v.RT_Dispersal_Type,name:"dispersalType",label:E.dispersalType,valueField:"key",displayField:"value",maxAccess:N,required:!0,onChange:(e,r)=>{b.setFieldValue("dispersalType",(null==r?void 0:r.key)||null)},error:b.touched.dispersalType&&!!b.errors.dispersalType})}),(0,a.jsx)(n.ZP,{item:!0,xs:2,children:(0,a.jsx)(v.Z,{endpointId:x.r.Plant.qry,name:"plantId",label:E.plant,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"plant Ref"},{key:"name",value:"Name"}],values:b.values,maxAccess:N,onChange:(e,r)=>{b.setFieldValue("plantId",(null==r?void 0:r.recordId)||0),b.setFieldValue("plantName",(null==r?void 0:r.name)||"")},error:b.touched.plantId&&!!b.errors.plantId})}),(0,a.jsx)(n.ZP,{item:!0,xs:1,children:(0,a.jsx)(h.Z,{onClick:()=>M(b),variant:"contained",color:"#231f20",label:D.Copy,disabled:!(null==b?void 0:null===(e=b.values)||void 0===e?void 0:e.items)||!(null==b?void 0:null===(t=b.values)||void 0===t?void 0:null===(r=t.items[0])||void 0===r?void 0:r.rate)||!(null==b?void 0:null===(F=b.values)||void 0===F?void 0:null===(f=F.items[0])||void 0===f?void 0:f.minRate)||!(null==b?void 0:null===(S=b.values)||void 0===S?void 0:null===(T=S.items[0])||void 0===T?void 0:T.maxRate)})})]})}),(0,a.jsx)(I.Q,{children:(0,a.jsx)(c._,{onChange:e=>b.setFieldValue("items",e),value:b.values.items,error:b.errors.items,columns:_,allowDelete:!1,allowAddNewLine:!1,name:"items",maxAccess:N})})]})})}},88635:function(e,r,t){"use strict";t.d(r,{L:function(){return n}});let a="RTBI.asmx/",n={Combos:{qryCBX:a+"qryCBX",qryTerrapayCBX:a+"qryTerrapayCBX",qryTerrapyBanks:a+"qryTerrapyBanks",terrapayAccountStatus:a+"terrapayAccountStatus"},ReceivingCountries:{qry:a+"qryRVC"},PayingAgent:{qry:a+"qryAGT"},Bank:{snapshot:a+"snapshotBank"},InstantCashRates:{qry:a+"qryICFees",get:a+"getICFees"},exchange:{get:a+"getICExchangeRates"},Agents:{qry:a+"qryAgents"},Currencies:{qry:a+"qryBICurrencies"},Countries:{qry:a+"qryBICountries"},DeliveryMode:{qry:a+"qryBIDVRow"},ATPExchangeRate:{get2:a+"getATPExchangeRate2"}}},53621:function(e,r,t){"use strict";t.d(r,{d:function(){return n}});let a="RTSET.asmx/",n={Interface:{qry:a+"qryITF",page:a+"pageITF",get:a+"getITF",set:a+"setITF",del:a+"delITF"},ProductMaster:{qry:a+"qryPRO",page:a+"pagePRO",get:a+"getPRO",set:a+"setPRO",del:a+"delPRO",snapshot:a+"snapshotPRO"},ProductCountries:{qry:a+"qryPCO",set2:a+"set2PCO"},ProductMonetaries:{qry:a+"qryPMO",set2:a+"set2PMO"},ProductDispersal:{qry:a+"qryPDI",get:a+"getPDI",set:a+"setPDI",del:a+"delPDI"},ProductSchedules:{qry:a+"qryPSC",set2:a+"set2PSC"},ProductScheduleRanges:{qry:a+"qryPSR",set2:a+"set2PSR"},ProductScheduleFees:{qry:a+"qryPSF",set2:a+"set2PSF"},ProductDispersalAgents:{qry:a+"qryPDA",set2:a+"set2PDA"},Correspondent:{page:a+"pageCOR",qry:a+"qryCOR",qry2:a+"qry2COR",get:a+"getCOR",set:a+"setCOR",del:a+"delCOR",snapshot:a+"snapshotCOR"},CorrespondentCountry:{qry:a+"qryCCO",get:a+"getCCO",set2:a+"set2CCO",del:a+"delCCO"},CorrespondentCurrency:{qry:a+"qryCCU",get:a+"getCCU",set2:a+"set2CCU",del:a+"delCCU"},CorrespondentAgents:{qry:a+"qryAGT",page:a+"pageAGT",get:a+"getAGT",set:a+"setAGT",del:a+"delAGT"},CorrespondentAgentBranches:{qry:a+"qryABR",page:a+"pageABR",get:a+"getABR",set:a+"setABR",del:a+"delABR"},CorrespondentExchangeMap:{qry:a+"qryEXC",set2:a+"set2EXC"},CurrencyExchangeMap:{qry:a+"qryEXG",set2:a+"set2EXG"},CorrespondentExchangeBuyMap:{qry:a+"qryEXB",set2:a+"set2EXB"},ExchangeRates:{get:a+"getEXB",qry:a+"qryEXG2",set2:a+"set2EXB"},RtDefault:{qry:a+"qryDE",set2:a+"set2DE"},Profession:{qry:a+"qryPFN",page:a+"pagePFN",get:a+"getPFN",set:a+"setPFN",del:a+"delPFN",snapshot:a+"snapshotPFN"},ClientIndividual:{qry:a+"qryCLI"},SalaryRange:{qry:a+"qrySRA",page:a+"pageSRA",get:a+"getSRA",set:a+"setSRA",del:a+"delSRA"},SourceOfIncome:{qry:a+"qrySI",page:a+"pageSI",snapshot:a+"snapshotSI",get:a+"getSI",set:a+"setSI",del:a+"delSI"},CorrespondentControl:{qry:a+"qryCCL",set:a+"set2CCL"},InterfaceMaps:{qry:a+"qryIFM",get:a+"getIFM",set2:a+"set2IFM"},SourceOfIncomeType:{qry:a+"qrySIT",snapshot:a+"snapshotSIT",page:a+"pageSIT",get:a+"getSIT",set:a+"setSIT",del:a+"delSIT"},ProfessionGroups:{qry:a+"qryPFG",page:a+"pagePFG",snapshot:a+"snapshotPFG",get:a+"getPFG",set:a+"setPFG",del:a+"delPFG"},CorrespondentGroup:{qry:a+"qryCGP",page:a+"pageCGP",get:a+"getCGP",set:a+"setCGP",del:a+"delCGP"},ExtraIncome:{qry:a+"qryEI",get:a+"getEI",del:a+"delEI",page:a+"pageEI",snapshot:a+"snapshotEI",set:a+"setEI"},CountryRisk:{page:a+"pageCOU",get:a+"getCOU",set:a+"setCOU",del:a+"delCOU"},CorDispControl:{qry:a+"qryCDC",set2:a+"set2CDC"},CorrespondentDispersal:{qry:a+"qryCDM",get:a+"getCDM",del:a+"delCDM",set2:a+"set2CDM"},CorrespondentDispersalRate:{qry:a+"qryCDR",set2:a+"set2CDR"}}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=51379)}),_N_E=e.O()}]);