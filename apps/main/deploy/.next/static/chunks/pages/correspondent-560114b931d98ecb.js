(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[54447],{87470:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/correspondent",function(){return r(2194)}])},2194:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return O}});var a=r(52322),l=r(2784),t=r(62202),o=r(69387),s=r(65950),d=r(26612),c=r(29326),i=r(9522),u=r(60218),m=r(48601),p=r(5088),v=r(8661),f=r(38449),I=r(27423),h=r(253),y=r(82737),b=r(78711),x=r(53621),R=r(71987),C=r(31389),_=r(62362),g=r(19473),T=r(1251),j=r(25870),w=r(91406),N=r(19689),Z=e=>{var n;let{labels:r,editMode:o,maxAccess:c,setEditMode:i,setStore:Z,store:F}=e,{postRequest:k,getRequest:q}=(0,l.useContext)(s.$),{recordId:A}=F,{platformLabels:D}=(0,l.useContext)(g.l),P=(0,R.E)({endpointId:x.d.Correspondent.page}),V=(0,b.TA)({validateOnChange:!0,initialValues:{recordId:null,name:null,reference:null,bpId:null,cgId:null,currencyId:null,currencyRef:null,owRateTypeId:null,iwRateTypeId:null,isInactive:!1,interfaceId:null,accountId:null,nraRef:null,nraDescription:null,nraId:null,minReviewTime:null},validationSchema:m.Ry({reference:m.Z_().required(),name:m.Z_().required(),bpId:m.Z_().required(),cgId:m.Rx().required(),bpRef:m.Z_().required(),bpName:m.Z_().required()}),onSubmit:async e=>{await S(e)}}),S=async e=>{let n=(null==e?void 0:e.recordId)||"";await k({extension:x.d.Correspondent.set,record:JSON.stringify(e)}).then(e=>{n?t.ZP.success(D.Edited):(i(!0),Z(n=>({...n,recordId:e.recordId})),t.ZP.success(D.Added),E(e.recordId),V.setFieldValue("recordId",e.recordId)),P()}).catch(e=>{})};(0,l.useEffect)(()=>{A&&E(A)},[A]);let E=e=>{q({extension:x.d.Correspondent.get,parameters:"_recordId=".concat(e)}).then(e=>{V.setValues(e.record),i(!0)}).catch(e=>{})};return(0,a.jsx)(y.Z,{form:V,resourceId:d.i.Correspondent,maxAccess:c,editMode:o,children:(0,a.jsx)(C.R,{children:(0,a.jsx)(_.Q,{children:(0,a.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(p.Z,{name:"reference",label:r.reference,readOnly:o,value:V.values.reference,required:!0,onChange:V.handleChange,maxLength:"10",maxAccess:c,onClear:()=>V.setFieldValue("reference",""),error:V.touched.reference&&!!V.errors.reference})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(p.Z,{name:"name",label:r.name,value:V.values.name,required:!0,maxLength:"50",maxAccess:c,onChange:V.handleChange,onClear:()=>V.setFieldValue("name",""),error:V.touched.name&&!!V.errors.name})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(I.U,{endpointId:h.F.MasterData.snapshot,name:"bpRef",required:!0,label:r.businessPartner,valueField:"reference",displayField:"name",valueShow:"bpRef",secondValueShow:"bpName",form:V,onChange:(e,n)=>{V.setValues({...V.values,bpId:(null==n?void 0:n.recordId)||"",bpRef:(null==n?void 0:n.reference)||"",bpName:(null==n?void 0:n.name)||""})},errorCheck:"bpId",maxAccess:c})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(I.U,{endpointId:j.H.Account.snapshot,name:"accountId",label:r.accountRef,valueField:"reference",displayField:"name",valueShow:"accountRef",secondValueShow:"accountName",readOnly:o,form:V,onChange:(e,n)=>{V.setFieldValue("accountId",(null==n?void 0:n.recordId)||""),V.setFieldValue("accountRef",(null==n?void 0:n.reference)||""),V.setFieldValue("accountName",(null==n?void 0:n.name)||"")},error:V.touched.accountId&&!!V.errors.accountId,maxAccess:c})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(v.Z,{endpointId:f.r.Currency.qry,name:"currencyId",label:r.currency,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:V.values,onChange:(e,n)=>{V.setFieldValue("currencyId",null==n?void 0:n.recordId)},error:V.touched.currencyId&&!!V.errors.currencyId})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(v.Z,{endpointId:x.d.CorrespondentGroup.qry,name:"cgId",label:r.group,valueField:"recordId",required:!0,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:V.values,onChange:(e,n)=>{V.setFieldValue("cgId",null==n?void 0:n.recordId)},error:V.touched.cgId&&!!V.errors.cgId})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(v.Z,{endpointId:x.d.Interface.qry,name:"interfaceId",label:r.interface,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:V.values,onChange:(e,n)=>{V.setFieldValue("interfaceId",null==n?void 0:n.recordId)},error:V.touched.interfaceId&&!!V.errors.interfaceId})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(v.Z,{endpointId:T.q.RateType.qry,name:"owRateTypeId",label:r.owRateType,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:V.values,onChange:(e,n)=>{V.setFieldValue("owRateTypeId",null==n?void 0:n.recordId)},error:V.touched.owRateTypeId&&!!V.errors.owRateTypeId})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(v.Z,{endpointId:T.q.RateType.qry,name:"iwRateTypeId",label:r.iwRateType,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:V.values,onChange:(e,n)=>{V.setFieldValue("iwRateTypeId",null==n?void 0:n.recordId)},error:V.touched.iwRateTypeId&&!!V.errors.iwRateTypeId})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(I.U,{endpointId:f.r.NumberRange.snapshot,valueField:"reference",displayField:"description",name:"nraId",valueShow:"nraRef",secondValueShow:"nraDescription",label:r.nuRange,form:V,secondDisplayField:!0,firstValue:V.values.nraRef,secondValue:V.values.nraDescription,onChange:(e,n)=>{V.setFieldValue("nraId",(null==n?void 0:n.recordId)||null),V.setFieldValue("nraRef",(null==n?void 0:n.reference)||null),V.setFieldValue("nraDescription",(null==n?void 0:n.description)||null)},maxAccess:c})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(w.Z,{name:"minReviewTime",label:r.minReviewTime,value:V.values.minReviewTime,onChange:V.handleChange,onClear:()=>V.setFieldValue("minReviewTime","")})}),(0,a.jsx)(u.ZP,{item:!0,xs:12,children:(0,a.jsx)(N.Z,{name:"isInactive",value:null===(n=V.values)||void 0===n?void 0:n.isInactive,onChange:e=>V.setFieldValue("isInactive",e.target.checked),label:r.isInActive,maxAccess:c})})]})})})})},F=r(76399),k=r(35656),q=e=>{let{store:n,setStore:r,maxAccess:o,labels:c,expanded:i,editMode:u}=e,{recordId:p}=n,{getRequest:v,postRequest:I}=(0,l.useContext)(s.$),{height:h}=(0,k.d)(),{platformLabels:R}=(0,l.useContext)(g.l),j=(0,b.TA)({validateOnChange:!0,validationSchema:m.Ry({countries:m.IX().of(m.Ry().shape({countryId:m.Z_().required("currency  is required")})).required("Operations array is required")}),initialValues:{countries:[{id:1,corId:p||null,country:"",countryId:"",countryRef:"",countryName:"",flName:"",purcRateTypeId:null,saleRateTypeId:null,isInactive:!1}]},onSubmit:async e=>{await w(e)}}),w=async e=>{let n=null==e?void 0:e.countries,a={corId:p,correspondentCountries:n.map(e=>{let{country:n,corId:r,...a}=e;return{corId:p,...a}})};await I({extension:x.d.CorrespondentCountry.set2,record:JSON.stringify(a)}).then(e=>{r(e=>({...e,countries:n})),t.ZP.success(R.Edited)})};return(0,l.useEffect)(()=>{let e="_corId=".concat(p);p&&v({extension:x.d.CorrespondentCountry.qry,parameters:e}).then(e=>{var n;if((null==e?void 0:null===(n=e.list)||void 0===n?void 0:n.length)>0){let n=e.list;j.setValues({countries:n.map((e,n)=>{let{...r}=e;return{id:n+1,...r}})}),r(e=>({...e,countries:n}))}else j.setValues({countries:[{id:1,corId:"",countryId:"",countryRef:"",countryName:"",flName:"",purcRateTypeId:null,saleRateTypeId:null,isInactive:!1}]})})},[p]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(y.Z,{form:j,resourceId:d.i.Correspondent,maxAccess:o,isInfo:!1,editMode:u,isSavedClear:!1,isParentWindow:!1,children:(0,a.jsx)(C.R,{children:(0,a.jsx)(_.Q,{children:(0,a.jsx)(F._,{onChange:e=>j.setFieldValue("countries",e),value:j.values.countries,error:j.errors.countries,columns:[{component:"resourcecombobox",name:"countryId",label:c.country,props:{endpointId:f.r.Country.qry,valueField:"recordId",displayField:"reference",mapping:[{from:"recordId",to:"countryId"},{from:"name",to:"countryName"},{from:"reference",to:"countryRef"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}]}},{component:"textfield",label:null==c?void 0:c.name,name:"countryName",props:{readOnly:!0}},{component:"resourcecombobox",label:c.saleRateType,name:"saleRateTypeId",props:{endpointId:T.q.RateType.qry,valueField:"recordId",displayField:"name",displayFieldWidth:1.5,mapping:[{from:"name",to:"saleRateTypeName"},{from:"reference",to:"saleRateTypeRef"},{from:"recordId",to:"saleRateTypeId"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}]}},{component:"resourcecombobox",label:c.purcRateType,name:"purcRateTypeId",props:{endpointId:T.q.RateType.qry,valueField:"recordId",displayField:"name",displayFieldWidth:1.5,mapping:[{from:"name",to:"purcRateTypeName"},{from:"reference",to:"purcRateTypeRef"},{from:"recordId",to:"purcRateTypeId"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}]}},{component:"checkbox",label:c.isInActive,name:"isInactive"}],height:"".concat(i?h-280:380,"px")})})})})})},A=e=>{let{store:n,labels:r,maxAccess:o,expanded:c,editMode:i}=e,{recordId:u}=n,{getRequest:p,postRequest:v}=(0,l.useContext)(s.$),{platformLabels:I}=(0,l.useContext)(g.l),h=(0,b.TA)({validateOnChange:!0,validationSchema:m.Ry({currencies:m.IX().of(m.Ry().shape({currencyId:m.Z_().required()})).required("currencies array is required")}),initialValues:{currencies:[{id:1,corId:u,currencyId:"",currencyRef:"",currencyName:"",outward:!1,inward:!1,bankDeposit:!1,deal:!1,goc:!1,isInactive:!1,saved:!1}]},onSubmit:async e=>{await R(e)}}),R=async e=>{var n;let r=null==e?void 0:null===(n=e.currencies)||void 0===n?void 0:n.map(e=>{let{corId:n,...r}=e;return{corId:u,...r}});await v({extension:x.d.CorrespondentCurrency.set2,record:JSON.stringify({corId:u,correspondentCurrencies:r})}).then(e=>{t.ZP.success(I.Edited),e&&j()})},T=[{component:"resourcecombobox",name:"currencyId",label:r.currency,props:{endpointId:f.r.Currency.qry,valueField:"recordId",displayField:"reference",mapping:[{from:"recordId",to:"currencyId"},{from:"reference",to:"currencyRef"},{from:"name",to:"currencyName"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:3}},{component:"checkbox",name:"outward",label:r.outwards},{component:"checkbox",label:r.inwards,name:"inward"},{component:"checkbox",label:r.bankDeposit,name:"bankDeposit"},{component:"checkbox",label:r.deal,name:"deal"},{component:"checkbox",label:r.consignation,name:"goc"},{component:"checkbox",label:r.isInActive,name:"isInactive"}];function j(){let e="_corId=".concat(u);u&&p({extension:x.d.CorrespondentCurrency.qry,parameters:e}).then(e=>{var n;(null==e?void 0:null===(n=e.list)||void 0===n?void 0:n.length)>0?h.setValues({currencies:e.list.map((e,n)=>{let{...r}=e;return{id:n,saved:!0,...r}})}):h.setValues({currencies:[{id:1,corId:u,currencyId:"",currencyRef:"",currencyName:"",outward:!1,inward:!1,bankDeposit:!1,deal:!1,goc:!1,isInactive:!1,saved:!1}]})})}return(0,l.useEffect)(()=>{j()},[u]),(0,a.jsx)(y.Z,{form:h,resourceId:d.i.Correspondent,isInfo:!1,maxAccess:o,editMode:i,isSavedClear:!1,isParentWindow:!1,children:(0,a.jsx)(C.R,{children:(0,a.jsx)(_.Q,{children:(0,a.jsx)(F._,{onChange:e=>h.setFieldValue("currencies",e),value:h.values.currencies,error:h.errors.currencies,columns:T})})})})},D=e=>{let{height:n,recordId:r,labels:t,maxAccess:o,expanded:s}=e,[d,u]=(0,l.useState)(0),[m,p]=(0,l.useState)(r),[v,f]=(0,l.useState)({recordId:r||null,countries:[]}),I=[{label:t.main},{label:t.countries,disabled:!v.recordId},{label:t.currencies,disabled:!m}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Y,{tabs:I,activeTab:d,setActiveTab:u,maxAccess:o}),(0,a.jsx)(c.Z,{height:n,index:0,value:d,maxAccess:o,children:(0,a.jsx)(Z,{labels:t,setEditMode:p,setStore:f,store:v,editMode:m,maxAccess:o})}),(0,a.jsx)(c.Z,{height:n,index:1,value:d,maxAccess:o,children:(0,a.jsx)(q,{labels:t,setEditMode:p,setStore:f,maxAccess:o,store:v,expanded:s})}),(0,a.jsx)(c.Z,{height:n,index:2,value:d,maxAccess:o,children:(0,a.jsx)(A,{labels:t,setEditMode:p,setStore:f,maxAccess:o,expanded:s,store:v})})]})},P=r(21346),V=r(61802),S=r(33625),E=r(36908),O=()=>{let{getRequest:e,postRequest:n}=(0,l.useContext)(s.$),{stack:r}=(0,V.zY)(),[c,i]=(0,l.useState)(null),{platformLabels:u}=(0,l.useContext)(g.l),{query:{data:m},labels:p,paginationParameters:v,invalidate:f,filterBy:I,refetch:h,access:y}=(0,R.J)({queryFn:T,endpointId:x.d.Correspondent.page,datasetId:d.i.Correspondent,filter:{endpointId:x.d.Correspondent.snapshot,filterFn:b}});async function b(n){let{filters:r,pagination:a}=n;return r.qry?await e({extension:x.d.Correspondent.snapshot,parameters:"_filter=".concat(r.qry)}):T({_startAt:a._startAt||0,params:null==r?void 0:r.params})}async function T(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:a=50,params:l}=n,t="_startAt=".concat(r,"&_pageSize=").concat(a,"&_params=").concat(l||"");return{...await e({extension:x.d.Correspondent.page,parameters:t}),_startAt:r}}let j=[{field:"reference",headerName:p.reference,flex:1},{field:"name",headerName:p.name,flex:1},{field:"bpRef",headerName:p.businessPartner,flex:1},{field:"cgName",headerName:p.group,flex:1},{field:"currencyRef",headerName:p.currency,flex:1},{field:"interfaceName",headerName:p.interface,flex:1},{field:"isInactive",headerName:p.isInActive,type:"checkbox"}];function w(e){r({Component:D,props:{labels:p,recordId:e||null,maxAccess:y},width:900,height:660,title:p.correspondent})}return(0,a.jsxs)(C.R,{children:[(0,a.jsx)(S.g,{children:(0,a.jsx)(E.Z,{labels:p,onAdd:()=>{w("")},maxAccess:y,reportName:"RTCOR",filterBy:I})}),(0,a.jsx)(_.Q,{children:(0,a.jsx)(o.Z,{columns:j,gridData:m,rowId:["recordId"],paginationParameters:v,paginationType:"api",refetch:h,onEdit:e=>{w(null==e?void 0:e.recordId)},onDelete:e=>{n({extension:x.d.Correspondent.del,record:JSON.stringify(e)}).then(e=>{t.ZP.success(u.Deleted),f()}).catch(e=>{i(e)})},isLoading:!1,pageSize:50,maxAccess:y})}),(0,a.jsx)(P.Z,{open:c,onClose:()=>i(null),message:c})]})}},29326:function(e,n,r){"use strict";var a=r(52322);r(2784);var l=r(23925),t=r(13980),o=r.n(t),s=r(95291),d=r.n(s),c=r(65947);let i=e=>{var n,r,t;let{children:o,value:s,index:i,maxAccess:u,...m}=e,p="".concat(e.name||"tab",".").concat(i),{accessLevel:v}=null!==(t=(null!==(r=null==u?void 0:null===(n=u.record)||void 0===n?void 0:n.controls)&&void 0!==r?r:[]).find(e=>e.controlId===p))&&void 0!==t?t:{accessLevel:0};if(v===c.A1)return null;let f=s===i;return(0,a.jsx)(l.Z,{role:"tabpanel",hidden:!f,id:"simple-tabpanel-".concat(i),"aria-labelledby":"simple-tab-".concat(i),className:"".concat(d().tabPanel," ").concat(f?d().active:d().hidden),...m,children:o})};i.propTypes={children:o().node,index:o().number.isRequired,value:o().number.isRequired},n.Z=i},9522:function(e,n,r){"use strict";r.d(n,{Y:function(){return m}});var a=r(52322),l=r(23925),t=r(54582),o=r(68696),s=r(44258),d=r(2784),c=r(99266),i=r(52614),u=r.n(i);let m=e=>{var n,r,i,m,p;let{tabs:v,activeTab:f,setActiveTab:I,maxAccess:h,name:y="tab"}=e,b=(null==h?void 0:null===(r=h.record)||void 0===r?void 0:null===(n=r.controls)||void 0===n?void 0:n.filter(e=>{var n;return 4===e.accessLevel&&(null===(n=e.controlId)||void 0===n?void 0:n.startsWith("".concat(y,".")))}).map(e=>e.controlId.split(".")[1]))||[],x=null==v?void 0:null===(i=v.map((e,n)=>({...e,id:n})))||void 0===i?void 0:i.filter((e,n)=>!b.includes(String(n))),R=null===(m=x[f])||void 0===m?void 0:m.id,C=null===(p=x[f])||void 0===p?void 0:p.disabled;return(0,d.useEffect)(()=>{R>=0&&!C&&f!=R&&I(R)},[]),(0,a.jsx)(l.Z,{className:u().tabsContainer,children:(0,a.jsx)(l.Z,{className:u().tabsWrapper,children:(0,a.jsx)(t.Z,{value:f,onChange:(e,n)=>I(n),variant:"scrollable",scrollButtons:x.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==x?void 0:x.map(e=>(0,a.jsx)(o.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,a.jsxs)(l.Z,{display:"flex",alignItems:"center",children:[(0,a.jsx)("span",{children:e.label}),e.id===f&&(null==e?void 0:e.onRefetch)&&(0,a.jsx)(s.Z,{size:"small",className:u().refreshButton,onClick:n=>{n.stopPropagation(),e.onRefetch()},children:(0,a.jsx)(c.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=87470)}),_N_E=e.O()}]);