(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41044],{10186:function(e,a,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/source-of-income",function(){return r(46026)}])},46026:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return S}});var n=r(52322),t=r(2784),s=r(62202),l=r(69387),c=r(65950),o=r(53621);r(75780);var d=r(60218),i=r(48601),u=r(82737),m=r(71987),f=r(26612),b=r(8661),h=r(5088),x=r(80983),I=r(19473);function v(e){let{labels:a,maxAccess:r,recordId:l,setStore:v}=e,[_,p]=(0,t.useState)(!!l),{platformLabels:C}=(0,t.useContext)(I.l),{getRequest:N,postRequest:y}=(0,t.useContext)(c.$),Z=(0,m.E)({endpointId:o.d.SourceOfIncome.page}),{formik:g}=(0,x.c)({initialValues:{recordId:null,name:"",reference:"",flName:"",sitId:""},maxAccess:r,validateOnChange:!0,validationSchema:i.Ry({name:i.Z_().required(),reference:i.Z_().required(),sitId:i.Z_().required(),flName:i.Z_().required()}),onSubmit:async e=>{let a=e.recordId,r=await y({extension:o.d.SourceOfIncome.set,record:JSON.stringify(e)});a?s.ZP.success(C.Edited):(v({recordId:r.recordId,name:e.name}),s.ZP.success(C.Added),g.setValues({...e,recordId:r.recordId})),p(!0),Z()}});return(0,t.useEffect)(()=>{!async function(){if(l){let e=await N({extension:o.d.SourceOfIncome.get,parameters:"_recordId=".concat(l)});v({recordId:e.record.recordId,name:e.record.name}),g.setValues(e.record)}}()},[]),(0,n.jsx)(u.Z,{resourceId:f.i.SourceOfIncome,form:g,maxAccess:r,editMode:_,children:(0,n.jsxs)(d.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{name:"name",label:a.name,value:g.values.name,required:!0,maxAccess:r,maxLength:"30",onChange:g.handleChange,onClear:()=>g.setFieldValue("name",""),error:g.touched.name&&!!g.errors.name})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{name:"reference",label:a.reference,value:g.values.reference,required:!0,rows:2,maxAccess:r,onChange:g.handleChange,onClear:()=>g.setFieldValue("reference",""),error:g.touched.reference&&!!g.errors.reference})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(h.Z,{name:"flName",label:a.flName,value:g.values.flName,rows:2,required:!0,maxAccess:r,onChange:g.handleChange,onClear:()=>g.setFieldValue("flName",""),error:g.touched.flName&&!!g.errors.flName})}),(0,n.jsx)(d.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.Z,{endpointId:o.d.SourceOfIncomeType.qry,name:"sitId",label:a.incomeType,valueField:"recordId",displayField:["reference","name"],required:!0,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:g.values,onChange:(e,a)=>{g.setFieldValue("sitId",a?a.recordId:""),g.setFieldValue("sitRef",a?a.reference:""),g.setFieldValue("sitName",a?a.name:"")},error:g.touched.sitId&&!!g.errors.sitId})})]})})}var _=r(9522),p=r(29326),C=r(89119),N=e=>{let{labels:a,maxAccess:r,recordId:s,height:l}=e,[c,o]=(0,t.useState)(0),[d,i]=(0,t.useState)({recordId:s||null,name:null}),u=[{label:null==a?void 0:a.sourceOfIncome},{label:null==a?void 0:a.interface,disabled:!d.recordId}];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(_.Y,{tabs:u,activeTab:c,setActiveTab:o,maxAccess:r}),(0,n.jsx)(p.Z,{height:l,index:0,value:c,maxAccess:r,children:(0,n.jsx)(v,{labels:a,maxAccess:r,recordId:s,setStore:i})}),(0,n.jsx)(p.Z,{index:1,value:c,maxAccess:r,children:(0,n.jsx)(C.V,{height:l,labels:a,resourceId:f.i.SourceOfIncome,recordId:d.recordId,maxAccess:r,name:d.name})})]})},y=r(61802),Z=r(31389),g=r(33625),j=r(62362),T=r(36908),S=()=>{let{getRequest:e,postRequest:a}=(0,t.useContext)(c.$),{stack:r}=(0,y.zY)(),{query:{data:d},labels:i,filterBy:u,paginationParameters:b,invalidate:h,access:x,refetch:I}=(0,m.J)({queryFn:_,endpointId:o.d.SourceOfIncome.page,datasetId:f.i.SourceOfIncome,filter:{filterFn:v}});async function v(a){let{filters:r,pagination:n}=a;return(null==r?void 0:r.qry)?await e({extension:o.d.SourceOfIncome.snapshot,parameters:"_filter=".concat(r.qry)}):_({_startAt:n._startAt||0,params:null==r?void 0:r.params})}async function _(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:r=0,_pageSize:n=50,params:t}=a,s="_startAt=".concat(r,"&_pageSize=").concat(n,"&_params=").concat(t||"");return{...await e({extension:o.d.SourceOfIncome.page,parameters:s}),_startAt:r}}let p=[{field:"reference",headerName:i.reference,flex:1},{field:"name",headerName:i.name,flex:1},,{field:"flName",headerName:i.flName,flex:1},{field:"sitName",headerName:i.incomeType,flex:1}];function C(e){r({Component:N,props:{labels:i,recordId:e,maxAccess:x},width:600,height:400,title:i.sourceOfIncome})}let S=async e=>{await a({extension:o.d.SourceOfIncome.del,record:JSON.stringify(e)}),h(),s.ZP.success(platformLabels.Deleted)};return(0,n.jsxs)(Z.R,{children:[(0,n.jsx)(g.g,{children:(0,n.jsx)(T.Z,{onAdd:()=>{C()},maxAccess:x,reportName:"RTSI",filterBy:u})}),(0,n.jsx)(j.Q,{children:(0,n.jsx)(l.Z,{columns:p,gridData:d,rowId:["recordId"],onEdit:e=>{C(e.recordId)},onDelete:S,isLoading:!1,pageSize:50,refetch:I,paginationParameters:b,paginationType:"api",maxAccess:x})})]})}},29326:function(e,a,r){"use strict";var n=r(52322);r(2784);var t=r(23925),s=r(13980),l=r.n(s),c=r(95291),o=r.n(c),d=r(65947);let i=e=>{var a,r,s;let{children:l,value:c,index:i,maxAccess:u,...m}=e,f="".concat(e.name||"tab",".").concat(i),{accessLevel:b}=null!==(s=(null!==(r=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==r?r:[]).find(e=>e.controlId===f))&&void 0!==s?s:{accessLevel:0};if(b===d.A1)return null;let h=c===i;return(0,n.jsx)(t.Z,{role:"tabpanel",hidden:!h,id:"simple-tabpanel-".concat(i),"aria-labelledby":"simple-tab-".concat(i),className:"".concat(o().tabPanel," ").concat(h?o().active:o().hidden),...m,children:l})};i.propTypes={children:l().node,index:l().number.isRequired,value:l().number.isRequired},a.Z=i},9522:function(e,a,r){"use strict";r.d(a,{Y:function(){return m}});var n=r(52322),t=r(23925),s=r(54582),l=r(68696),c=r(44258),o=r(2784),d=r(99266),i=r(52614),u=r.n(i);let m=e=>{var a,r,i,m,f;let{tabs:b,activeTab:h,setActiveTab:x,maxAccess:I,name:v="tab"}=e,_=(null==I?void 0:null===(r=I.record)||void 0===r?void 0:null===(a=r.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(v,".")))}).map(e=>e.controlId.split(".")[1]))||[],p=null==b?void 0:null===(i=b.map((e,a)=>({...e,id:a})))||void 0===i?void 0:i.filter((e,a)=>!_.includes(String(a))),C=null===(m=p[h])||void 0===m?void 0:m.id,N=null===(f=p[h])||void 0===f?void 0:f.disabled;return(0,o.useEffect)(()=>{C>=0&&!N&&h!=C&&x(C)},[]),(0,n.jsx)(t.Z,{className:u().tabsContainer,children:(0,n.jsx)(t.Z,{className:u().tabsWrapper,children:(0,n.jsx)(s.Z,{value:h,onChange:(e,a)=>x(a),variant:"scrollable",scrollButtons:p.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==p?void 0:p.map(e=>(0,n.jsx)(l.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,n.jsxs)(t.Z,{display:"flex",alignItems:"center",children:[(0,n.jsx)("span",{children:e.label}),e.id===h&&(null==e?void 0:e.onRefetch)&&(0,n.jsx)(c.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,n.jsx)(d.Z,{className:u().refreshIcon})})]})},e.id))})})})}},89119:function(e,a,r){"use strict";r.d(a,{V:function(){return _}});var n=r(52322),t=r(2784),s=r(65950),l=r(49864),c=r(50023),o=r(26612),d=r(62202),i=r(76399),u=r(80983),m=r(84100),f=r(53621),b=r(80968),h=r(5088),x=r(62362),I=r(31389),v=r(54074);let _=e=>{let{recordId:a,resourceId:r,name:_}=e,{getRequest:p,postRequest:C}=(0,t.useContext)(s.$),{getAllKvsByDataset:N}=(0,t.useContext)(b.k),{labels:y,access:Z}=(0,c.Z)({datasetId:o.i.InterfaceMap,editMode:!!a}),{formik:g}=(0,u.c)({initialValues:{rows:[{id:1,recordId:a,resourceId:o.i.resourceId,interfaceId:"",interfaceName:"",reference:""}]},validateOnChange:!0,onSubmit:async e=>{let n=g.values.rows.map(e=>({recordId:a,resourceId:r,...e})),t=n.every(e=>""===e.interfaceId);(await C({extension:f.d.InterfaceMaps.set2,record:JSON.stringify({recordId:a,resourceId:r,items:t?[]:n})})).recordId&&d.ZP.success("Record Successfully")}});async function j(){return new Promise((e,a)=>{N({_dataset:m.v.ALL_INTERFACES,callback:r=>{r?e(r):a()}})})}(0,t.useEffect)(()=>{!async function(){if(a){let e=await j(),n=await p({extension:f.d.InterfaceMaps.qry,parameters:"_recordId=".concat(a,"&_resourceId=").concat(r)}),t=e.map(e=>{let a={interfaceId:e.key,interfaceName:e.value,reference:""},r=n.list.find(e=>a.interfaceId==e.interfaceId);return r&&(a.reference=r.reference),a});g.setValues({...g.values,rows:t.map((e,a)=>({...e,id:a+1}))})}}()},[a]);let T=[{component:"resourcecombobox",label:y.interface,name:"interfaceId",props:{readOnly:!0,datasetId:m.v.ALL_INTERFACES,valueField:"key",displayField:"value",displayFieldWidth:2,mapping:[{from:"key",to:"interfaceId"},{from:"value",to:"interfaceName"}]}},{component:"textfield",label:y.reference,name:"reference"}];return(0,n.jsx)(v.Z,{onSave:g.handleSubmit,maxAccess:Z,editMode:!0,children:(0,n.jsx)(I.R,{children:(0,n.jsxs)(x.Q,{children:[(0,n.jsx)(l.Z,{sx:{width:"50%"},children:(0,n.jsx)(h.Z,{label:y.name,value:_,readOnly:!0})}),(0,n.jsx)(i._,{onChange:e=>g.setFieldValue("rows",e),value:g.values.rows,error:g.errors.rows,columns:T,allowDelete:!1})]})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=10186)}),_N_E=e.O()}]);