(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[20380],{79213:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/fi-accounts",function(){return n(82139)}])},82139:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return L}});var r=n(52322),t=n(2784),s=n(62202),l=n(69387),i=n(65950),c=n(26612),d=n(29326),o=n(9522),u=n(60218),m=n(48601),h=n(5088),x=n(82737),p=n(8661),v=n(71987),f=n(25870),b=n(95982),I=n(22341),g=n(84100),y=n(80983),_=n(74898),C=n(31389),A=n(62362),j=n(19473),Z=n(19689),N=e=>{var a,n;let{labels:l,maxAccess:d,setStore:o,store:N}=e,{postRequest:P,getRequest:F}=(0,t.useContext)(i.$),{platformLabels:w}=(0,t.useContext)(j.l),{recordId:T}=N,R=(0,v.E)({endpointId:f.H.Account.page}),{formik:k}=(0,y.c)({initialValues:{recordId:null,groupId:null,groupename:"",reference:null,name:"",keywords:null,flName:null,type:null,BpRef:null,szId:null,spId:null,sgId:null,isInactive:!1,isConfidential:!1},maxAccess:d,validateOnChange:!0,validationSchema:m.Ry({name:m.Z_().required(),type:m.Z_().required(),groupId:m.Z_().required(),reference:m.Z_().required(),sgId:m.Rx().nullable().test("sgId-required-if-confidential","sgId is required when confidential",function(e){let{isConfidential:a}=this.parent;return!(a&&!e)})}),onSubmit:async e=>{await V(e)}}),V=async e=>{let a=await P({extension:f.H.Account.set,record:JSON.stringify(e)});e.recordId||(o(e=>({...e,recordId:a.recordId})),k.setFieldValue("recordId",a.recordId)),R(),s.ZP.success(e.recordId?w.Edited:w.Added)};(0,t.useEffect)(()=>{!async function(){if(T){let e=await F({extension:f.H.Account.get,parameters:"_recordId=".concat(T)});k.setValues(e.record)}}()},[]);let q=!!k.values.recordId,S=[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!q},{key:"Integration Account",condition:!0,onClick:"onClickGIA",masterSource:_.N.Account,disabled:!q}];return(0,r.jsx)(x.Z,{resourceId:c.i.Accounts,form:k,maxAccess:d,editMode:q,actions:S,children:(0,r.jsx)(C.R,{children:(0,r.jsx)(A.Q,{children:(0,r.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(u.ZP,{item:!0,xs:6,children:(0,r.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(p.Z,{endpointId:f.H.Group.qry,name:"groupId",required:!0,label:l.accountGroup,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:"name",values:k.values,onChange:(e,a)=>{a?(k.setFieldValue("groupId",null==a?void 0:a.recordId),k.setFieldValue("groupName",null==a?void 0:a.name)):(k.setFieldValue("groupId",""),k.setFieldValue("groupName",""))},error:k.touched.groupId&&!!k.errors.groupId})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(h.Z,{name:"reference",label:l.reference,value:k.values.reference,maxAccess:d,required:!0,maxLength:"10",onChange:k.handleChange,onClear:()=>k.setFieldValue("reference",""),error:k.touched.reference&&!!k.errors.reference})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(h.Z,{name:"name",label:l.name,value:k.values.name,required:!0,maxAccess:d,maxLength:"30",onChange:k.handleChange,onClear:()=>k.setFieldValue("name",""),error:k.touched.name&&!!k.errors.name})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(h.Z,{name:"keywords",label:l.keyWords,value:k.values.keywords,maxAccess:d,maxLength:"30",onChange:k.handleChange,onClear:()=>k.setFieldValue("keywords",""),error:k.touched.keywords&&!!k.errors.keywords})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(h.Z,{name:"flName",label:l.foreinLanguageName,value:k.values.flName,maxAccess:d,maxLength:"30",onChange:k.handleChange,onClear:()=>k.setFieldValue("flName",""),error:k.touched.flName&&!!k.errors.flName})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(Z.Z,{name:"isInactive",value:null===(a=k.values)||void 0===a?void 0:a.isInactive,onChange:e=>k.setFieldValue("isInactive",e.target.checked),label:l.inactive,maxAccess:d})})]})}),(0,r.jsx)(u.ZP,{item:!0,xs:6,children:(0,r.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(p.Z,{name:"type",label:l.type,datasetId:g.v.FI_GROUP_TYPE,required:!0,values:k.values,valueField:"key",displayField:"value",onChange:(e,a)=>{k.setFieldValue("type",null==a?void 0:a.key)},error:k.touched.type&&!!k.errors.type})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(h.Z,{name:"BpRef",label:l.BpRef,value:k.values.BpRef,readOnly:!0,maxAccess:d,maxLength:"30",onChange:k.handleChange,onClear:()=>k.setFieldValue("BpRef",""),error:k.touched.BpRef&&!!k.errors.BpRef})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(p.Z,{endpointId:I.P.SalesZone.qry,parameters:'_startAt=0&_pageSize=1000&_sortField="recordId"&_filter=',name:"szId",label:l.salesZone,columnsInDropDown:[{key:"name",value:"Name"}],valueField:"recordId",displayField:"name",values:k.values,onChange:(e,a)=>{a?k.setFieldValue("szId",null==a?void 0:a.recordId):k.setFieldValue("szId","")},error:k.touched.szId&&!!k.errors.szId})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(p.Z,{endpointId:I.P.SalesPerson.qry,name:"spId",label:l.salesPerson,columnsInDropDown:[{key:"name",value:"Name"}],valueField:"recordId",displayField:"name",values:k.values,onChange:(e,a)=>{a?k.setFieldValue("spId",null==a?void 0:a.recordId):k.setFieldValue("spId","")},error:k.touched.spId&&!!k.errors.spId})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(Z.Z,{name:"isConfidential",value:null===(n=k.values)||void 0===n?void 0:n.isConfidential,onChange:e=>{k.setFieldValue("isConfidential",e.target.checked),k.setFieldValue("sgId",null)},label:l.isConfidential,maxAccess:d})}),(0,r.jsx)(u.ZP,{item:!0,xs:12,children:(0,r.jsx)(p.Z,{endpointId:b.y.SecurityGroup.qry,parameters:"_startAt=0&_pageSize=1000&filter=",name:"sgId",label:l.securityGrp,values:k.values,valueField:"recordId",displayField:"name",maxAccess:d,onChange:(e,a)=>{k.setFieldValue("sgId",(null==a?void 0:a.recordId)||null)},required:k.values.isConfidential,readOnly:!k.values.isConfidential,error:k.touched.sgId&&!!k.errors.sgId})})]})})]})})})})},P=n(78711),F=n(76399),w=n(54074),T=e=>{let{setStore:a,labels:n,editMode:l,store:c,maxAccess:d}=e,{getRequest:o,postRequest:u}=(0,t.useContext)(i.$),{recordId:m}=c,h=(0,P.TA)({validateOnChange:!0,initialValues:{currencies:[{id:1,accountId:m,currencyName:"",currencyId:"",limit:""}]},onSubmit:async e=>{await x(e.currencies)}}),x=async e=>{Promise.all(e.filter(e=>{let{limit:a}=e;return a>=0}).map(e=>{let a={accountId:e.accountId,currencyName:e.currencyName,currencyId:e.currencyId,limit:e.limit||0};return u({extension:f.H.AccountCreditLimit.set,record:JSON.stringify(a)})})).then(e=>{s.ZP.success("Record Edited Successfully")}).catch(e=>{})},p=[{component:"textfield",label:n.currency,name:"currencyName",props:{readOnly:!0}},{component:"numberfield",label:n.CreditLimits,name:"limit",props:{maxLength:12,decimalScale:2}}];(0,t.useEffect)(()=>{m&&v(m)},[m]);let v=e=>{o({extension:f.H.AccountCreditLimit.qry,parameters:"_accountId=".concat(e)}).then(e=>{if(e.list.length>0){let n=e.list.map((e,a)=>({id:a,...e}));h.setValues({currencies:n}),a(e=>({...e,currencies:n}))}}).catch(e=>{})};return(0,r.jsx)(w.Z,{onSave:h.handleSubmit,maxAccess:d,editMode:l,isParentWindow:!1,children:(0,r.jsx)(C.R,{children:(0,r.jsx)(A.Q,{children:(0,r.jsx)(F._,{onChange:e=>h.setFieldValue("currencies",e),value:h.values.currencies,error:h.errors.currencies,columns:p,allowDelete:!1,allowAddNewLine:!1})})})})};n(27723);var R=e=>{let{labels:a,maxAccess:n,store:s}=e,{getRequest:d}=(0,t.useContext)(i.$),{recordId:o}=s;var u=!!o;let m=[{field:"currencyName",headerName:a.currency,flex:1},{field:"balance",headerName:a.balance,flex:1}];async function h(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:n=50}=e,r="_startAt=".concat(a,"&_pageSize=").concat(n,"&_accountId=").concat(o);return{...await d({extension:f.H.AccountCreditBalance.qry,parameters:r}),_startAt:a}}let{query:{data:x}}=(0,v.J)({enabled:u,queryFn:h,endpointId:f.H.AccountCreditBalance.qry,datasetId:c.i.Accounts});return(0,r.jsx)(C.R,{children:(0,r.jsx)(A.Q,{children:(0,r.jsx)(l.Z,{name:"accountBalance",columns:m,gridData:x,rowId:["currencyId"],isLoading:!1,maxAccess:n,pagination:!1})})})},k=e=>{let{height:a,recordId:n,labels:s,maxAccess:l,expanded:i}=e,[c,u]=(0,t.useState)(0),m=!!n,[h,x]=(0,t.useState)({recordId:n||null,currencies:null}),p=[{label:s.Accounts},{label:s.CreditLimits,disabled:!h.recordId},{label:s.AccountBalance,disabled:!h.recordId}];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Y,{tabs:p,activeTab:c,setActiveTab:u,maxAccess:l}),(0,r.jsx)(d.Z,{height:a,index:0,value:c,maxAccess:l,children:(0,r.jsx)(N,{store:h,setStore:x,labels:s,maxAccess:l,height:a,expanded:i,editMode:m})}),(0,r.jsx)(d.Z,{height:a,index:1,value:c,maxAccess:l,children:(0,r.jsx)(T,{store:h,setStore:x,labels:s,maxAccess:l,height:a,expanded:i,editMode:m})}),(0,r.jsx)(d.Z,{height:a,index:2,value:c,maxAccess:l,children:(0,r.jsx)(R,{store:h,labels:s,maxAccess:l})})]})},V=n(61802),q=n(33625),S=n(36908),L=()=>{let{getRequest:e,postRequest:a}=(0,t.useContext)(i.$),{platformLabels:n}=(0,t.useContext)(j.l),{stack:d}=(0,V.zY)(),{query:{data:o},labels:u,filterBy:m,paginationParameters:h,invalidate:x,access:p,refetch:b}=(0,v.J)({queryFn:g,endpointId:f.H.Account.page,datasetId:c.i.Accounts,filter:{filterFn:I}});async function I(a){let{filters:n,pagination:r}=a;return(null==n?void 0:n.qry)?await e({extension:f.H.Account.snapshot,parameters:"_filter=".concat(n.qry)}):g({_startAt:r._startAt||0,params:null==n?void 0:n.params})}async function g(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0,_pageSize:r=50,params:t}=a,s="_startAt=".concat(n,"&_pageSize=").concat(r,"&_params=").concat(t||"");return{...await e({extension:f.H.Account.page,parameters:s}),_startAt:n}}let y=[{field:"reference",headerName:u.reference,flex:1},{field:"name",headerName:u.name,flex:1},{field:"groupName",headerName:u.accountGroup,flex:1},{field:"typeName",headerName:u.type,flex:1}],_=async e=>{await a({extension:f.H.Account.del,record:JSON.stringify(e)}),x(),s.ZP.success(n.Deleted)};function Z(e){d({Component:k,props:{labels:u,recordId:e||null,maxAccess:p},width:600,height:450,title:u.Accounts})}return(0,r.jsxs)(C.R,{children:[(0,r.jsx)(q.g,{children:(0,r.jsx)(S.Z,{onAdd:()=>{Z()},maxAccess:p,reportName:"FIACC",filterBy:m})}),(0,r.jsx)(A.Q,{children:(0,r.jsx)(l.Z,{columns:y,gridData:o,rowId:["recordId"],paginationParameters:h,paginationType:"api",refetch:b,onEdit:e=>{Z(null==e?void 0:e.recordId)},onDelete:_,deleteConfirmationType:"strict",isLoading:!1,pageSize:50,maxAccess:p})})]})}},74898:function(e,a,n){"use strict";n.d(a,{N:function(){return r}});let r={Global:0,AccountGroup:10,Account:11,CashAccountGroup:20,CashAccount:21,ItemGroup:30,Item:31,ItemCategory:32,Site:33,ExpenseType:41,CostType:42,ProductionOverhead:51,TaxCode:12,PayrollGLGroup:61,PayrollEntitlementDeduction:62,AssetGroup:71,AssetClass:72}},29326:function(e,a,n){"use strict";var r=n(52322);n(2784);var t=n(23925),s=n(13980),l=n.n(s),i=n(95291),c=n.n(i),d=n(65947);let o=e=>{var a,n,s;let{children:l,value:i,index:o,maxAccess:u,...m}=e,h="".concat(e.name||"tab",".").concat(o),{accessLevel:x}=null!==(s=(null!==(n=null==u?void 0:null===(a=u.record)||void 0===a?void 0:a.controls)&&void 0!==n?n:[]).find(e=>e.controlId===h))&&void 0!==s?s:{accessLevel:0};if(x===d.A1)return null;let p=i===o;return(0,r.jsx)(t.Z,{role:"tabpanel",hidden:!p,id:"simple-tabpanel-".concat(o),"aria-labelledby":"simple-tab-".concat(o),className:"".concat(c().tabPanel," ").concat(p?c().active:c().hidden),...m,children:l})};o.propTypes={children:l().node,index:l().number.isRequired,value:l().number.isRequired},a.Z=o},9522:function(e,a,n){"use strict";n.d(a,{Y:function(){return m}});var r=n(52322),t=n(23925),s=n(54582),l=n(68696),i=n(44258),c=n(2784),d=n(99266),o=n(52614),u=n.n(o);let m=e=>{var a,n,o,m,h;let{tabs:x,activeTab:p,setActiveTab:v,maxAccess:f,name:b="tab"}=e,I=(null==f?void 0:null===(n=f.record)||void 0===n?void 0:null===(a=n.controls)||void 0===a?void 0:a.filter(e=>{var a;return 4===e.accessLevel&&(null===(a=e.controlId)||void 0===a?void 0:a.startsWith("".concat(b,".")))}).map(e=>e.controlId.split(".")[1]))||[],g=null==x?void 0:null===(o=x.map((e,a)=>({...e,id:a})))||void 0===o?void 0:o.filter((e,a)=>!I.includes(String(a))),y=null===(m=g[p])||void 0===m?void 0:m.id,_=null===(h=g[p])||void 0===h?void 0:h.disabled;return(0,c.useEffect)(()=>{y>=0&&!_&&p!=y&&v(y)},[]),(0,r.jsx)(t.Z,{className:u().tabsContainer,children:(0,r.jsx)(t.Z,{className:u().tabsWrapper,children:(0,r.jsx)(s.Z,{value:p,onChange:(e,a)=>v(a),variant:"scrollable",scrollButtons:g.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:u().tabsIndicator},className:u().tabs,children:null==g?void 0:g.map(e=>(0,r.jsx)(l.Z,{value:e.id,disabled:null==e?void 0:e.disabled,className:"".concat(u().tabName," ").concat(e.disabled?u().tabDisabled:""),classes:{root:u().tabRoot,selected:u().selectedTab},label:(0,r.jsxs)(t.Z,{display:"flex",alignItems:"center",children:[(0,r.jsx)("span",{children:e.label}),e.id===p&&(null==e?void 0:e.onRefetch)&&(0,r.jsx)(i.Z,{size:"small",className:u().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:(0,r.jsx)(d.Z,{className:u().refreshIcon})})]})},e.id))})})})}},95291:function(e){e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},52614:function(e){e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=79213)}),_N_E=e.O()}]);