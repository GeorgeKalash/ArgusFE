(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[78171],{77370:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/outbound-assign-driver",function(){return r(39531)}])},39531:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r(52322),s=r(2784),i=r(65950),a=r(71987),o=r(26612),l=r(62362),d=r(31389),p=r(62202),u=r(19473),c=r(30043),g=r(76399),m=r(80983),v=r(48601),T=r(39812),R=r(33625),y=r(27723),I=r(54074),f=()=>{let{getRequest:e,postRequest:t}=(0,s.useContext)(i.$),{platformLabels:r}=(0,s.useContext)(u.l),{labels:f,access:h}=(0,a.J)({datasetId:o.i.OutboundAssignDriver}),{formik:O}=(0,m.c)({maxAccess:h,initialValues:{tripList:[]},validateOnChange:!0,validationSchema:v.Ry({tripList:v.IX().of(v.Ry().shape({departureTime:v.Z_().required()}))}),onSubmit:async e=>{var n;let s=null===(n=e.tripList)||void 0===n?void 0:n.map(e=>({...e,departureTime:(0,T.ku)(null==e?void 0:e.departureTime)})),i=await t({extension:c.U.Trip.assign,record:JSON.stringify({tripList:s})});p.ZP.success(r.Edited),D(i.recordId)}});async function D(){var t,r;let n=await e({extension:c.U.Trip.unassign,parameters:""}),s=(null==n?void 0:null===(t=n.list)||void 0===t?void 0:t.length)>0?null==n?void 0:null===(r=n.list)||void 0===r?void 0:r.map((e,t)=>({...e,id:t+1,date:(0,T.a1)(null==e?void 0:e.date),departureTime:(0,T.a1)(null==e?void 0:e.departureTime)})):[];O.setFieldValue("tripList",s)}let P=[{component:"textfield",label:f.reference,name:"reference",props:{readOnly:!0}},{component:"date",name:"date",label:f.date,props:{readOnly:!0}},{component:"date",name:"departureTime",label:f.departureDate},{component:"resourcecombobox",label:f.vehicle,name:"vehicleId",props:{endpointId:c.U.Vehicle.qry,valueField:"recordId",displayField:"name",mapping:[{from:"recordId",to:"vehicleId"},{from:"name",to:"vehName"}]}},{component:"resourcecombobox",label:f.driver,name:"driverId",props:{endpointId:c.U.Driver.qry,valueField:"recordId",displayField:"name",mapping:[{from:"recordId",to:"driverId"},{from:"name",to:"driverName"}]}},{component:"textfield",label:f.notes,name:"notes",props:{readOnly:!0}}];return(0,s.useEffect)(()=>{D()},[]),(0,n.jsx)(I.Z,{onSave:O.handleSubmit,maxAccess:h,fullSize:!0,children:(0,n.jsxs)(d.R,{children:[(0,n.jsx)(R.g,{children:(0,n.jsx)(y.Z,{actions:[{key:"Refresh",condition:!0,onClick:()=>{D()}}]})}),(0,n.jsx)(l.Q,{children:(0,n.jsx)(g._,{onChange:e=>O.setFieldValue("tripList",e),value:O.values.tripList,error:O.errors.tripList,columns:P,name:"tripList",allowDelete:!1,allowAddNewLine:!1,maxAccess:h})})]})})}},30043:function(e,t,r){"use strict";r.d(t,{U:function(){return s}});let n="DE.asmx/",s={Driver:{snapshot:n+"snapshotDRV",page:n+"pageDRV",set:n+"setDRV",get:n+"getDRV",qry:n+"qryDRV",del:n+"delDRV"},Vehicle:{page:n+"pageVEH",set:n+"setVEH",get:n+"getVEH",qry:n+"qryVEH",del:n+"delVEH"},Trip:{page:n+"pageTRP",set:n+"setTRP",get:n+"getTRP",qry:n+"qryTRP",del:n+"delTRP",snapshot:n+"snapshotTRP",snapshot2:n+"snapshot2TRP",reopen:n+"reopenTRP",post:n+"postTRP",unpost:n+"unpostTRP",close:n+"closeTRP",generate:n+"generateTRP",setTRP2:n+"setTRP2",assign:n+"assignTRP",unassign:n+"unassignedTRP"},TripOrderPack2:{set2:n+"set2TRO"},TripOrder:{qry:n+"qryTRO"},Reduild:{rebuild:n+"rebuildMW"},TRP:{flag:n+"flagTRP"},ExpenseTypes:{get:n+"getET",set:n+"setET",del:n+"delET",page:n+"pageET"},DeliveriesOrders:{qry:n+"qryORD",get:n+"getORD",snapshot:n+"snapshotORD",unpost:n+"unpostORD",gen:n+"genORD",post:n+"postORD",del:n+"delORD",cancel:n+"cancelORD",flag:n+"flagORD",set2:n+"set2ORD"},Invoice:{generate:n+"generateIVC2",generateInv:n+"generateIVC",preview:n+"previewIVC"},OrderItem:{qry:n+"qryORI",get:n+"getORI"},MW:{qry:n+"qryMW2"},GenerateTrip:{root:n+"rootSZ",firstLevel:n+"firstLevelSZ",undelivered2:n+"undeliveredSO2",previewTRP:n+"previewTRP"},DeliveryLeadTime:{get:n+"getLDT",page:n+"pageLDT",set:n+"setLDT",del:n+"delLDT"},Volume:{vol:n+"volZO"},AllocatedVolume:{qry:n+"qryVEH2"},InboundTransp:{pack:n+"getPackINB",page:n+"pageINB",set2:n+"set2INB",get:n+"getINB",get2:n+"get2INB",del:n+"delINB",snapshot:n+"snapshotINB",post:n+"postINB",unpost:n+"unpostINB"},InboundOrders:{qry:n+"qryINO"}}}},function(e){e.O(0,[49774,92888,40179],function(){return e(e.s=77370)}),_N_E=e.O()}]);