(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[76173],{86179:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/aa-templates",function(){return a(41293)}])},41293:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return K}});var n=a(52322),l=a(2784),r=a(27723),o=a(33625),i=a(62362),s=a(31389),d=a(69387),c=a(71987),u=a(19473),m=a(65950),p=a(26612),y=a(61802),g=a(62202),_=a(81579),x=a(60218),h=a(48601),f=a(82737),v=a(80983),b=a(5088),T=a(8661),C=a(84100),j=a(1503),S=a(81770),A=a.n(S),I=a(19938),w=a(54074),E=a(25237),N=a.n(E);a(4760);var B=a(14441),Z=a(714),k=a(27266),D=a(98006),q=a(81405),P=a(7749),F=a(68355);let R={person:B.Z,business:Z.Z,flight:k.Z,money:D.Z,schedule:q.Z,sentiment_very_dissatisfied:P.Z,timelapse:F.Z},z=[{type:"employee",icon:R.person,tags:["emp_fullName","emp_firstName","emp_lastName","emp_birthDate","emp_nationality","emp_idRef","emp_mobile","emp_workMail","emp_hireDate","emp_department","emp_branch","emp_position","emp_employmentStatus","emp_salary","emp_salary_text"]},{type:"admin_affair",icon:R.business,tags:["pay_fromDate","pay_toDate","pay_basicSalary","pay_entitlements","pay_deductions","pay_netSalary","pay_companySS","pay_employeeSS","pay_url"]},{type:"leave",icon:R.flight,tags:["leave_startDate","leave_endDate","leave_url","leave_employeeName","leave_justification","leave_destination","leave_leaveType","leave_approveUrl","reject_url","replacement_employee"]},{type:"loan",icon:R.money,tags:["loan_date","loan_amount","loan_url"]},{type:"schedule",icon:R.schedule,tags:["ta_sched_startDate","ta_sched_endDate","ta_sched_url"]},{type:"penalty",icon:R.sentiment_very_dissatisfied,tags:["penalty_date","penalty_amount","penalty_url"]},{type:"time_variations",icon:R.timelapse,tags:["tv_timeCode","tv_date","tv_duration","tv_url"]}];var O=a(11074),V=a(34758),L=a(50969),M=a.n(L),U=a(35097);function J(e){let{group:t,openDropdown:a,setOpenDropdown:r,onItemClick:o}=e,i=a===t.type,s=(0,l.useRef)(null),d=t.icon;return(0,n.jsxs)("div",{className:M().wrapper,children:[(0,n.jsx)("button",{ref:s,className:M().button,onClick:()=>{r(i?null:t.type)},children:(0,n.jsx)(d,{fontSize:"small"})}),(0,n.jsx)(O.Z,{open:i,anchorEl:s.current,placement:"bottom-start",sx:{zIndex:e=>e.zIndex.modal+1},children:(0,n.jsx)(U.d,{onClickAway:e=>{var t;null!==(t=s.current)&&void 0!==t&&t.contains(e.target)||r(null)},children:(0,n.jsx)(V.Z,{className:M().menu,elevation:0,children:t.tags.map((e,t)=>(0,n.jsx)("div",{className:M().item,onClick:()=>o(e),children:e},t))})})})]})}var G=a(82454),Q=a.n(G);let W=N()(()=>Promise.all([a.e(53993),a.e(59305)]).then(a.t.bind(a,11303,23)).then(e=>e.Editor),{loadableGenerated:{webpack:()=>[11303]},ssr:!1});function Y(e){let{value:t="",onChange:r}=e,[o,i]=(0,l.useState)(()=>j.EditorState.createEmpty()),[s,d]=(0,l.useState)(null);(0,l.useEffect)(()=>{t&&(async()=>{let{default:e}=await Promise.all([a.e(53993),a.e(84585)]).then(a.t.bind(a,84585,23)),n=e(t);if(n){let{contentBlocks:e,entityMap:t}=n,a=j.ContentState.createFromBlockArray(e,t);i(j.EditorState.createWithContent(a))}})()},[t]);let c=e=>{let t=o.getCurrentContent(),a=o.getSelection(),n=j.Modifier.insertText(t,a," # ".concat(e," # ")),l=j.EditorState.push(o,n,"insert-characters");i(l),r&&r(l),d(null)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:Q().editorRoot,children:(0,n.jsx)(W,{editorState:o,onEditorStateChange:e=>{i(e),r&&r(e)},toolbarClassName:"toolbarClassName",wrapperClassName:"wrapperClassName",editorClassName:"editorClassName",handleReturn:e=>"not-handled",toolbar:{colorPicker:{enableBackground:!0},options:["inline","blockType","fontSize","fontFamily","list","textAlign","colorPicker","link","emoji","image","history"],image:{uploadEnabled:!0,urlEnabled:!0,previewImage:!0,uploadCallback:e=>new Promise((t,a)=>{let n=new FileReader;n.onload=e=>{t({data:{link:e.target.result}})},n.onerror=e=>a(e),n.readAsDataURL(e)})},link:{inDropdown:!1,showOpenOptionOnHover:!0},inline:{options:["bold","italic","underline","strikethrough","monospace"]},fontSize:{options:[8,9,10,11,12,14,16,18,20,24,30,36,48,60,72,96]},fontFamily:{options:["Arial","Arial Black","Comic Sans MS","Courier New","Georgia","Helvetica","Impact","Lucida Sans Unicode","Tahoma","Times New Roman","Trebuchet MS","Verdana"]}},editorStyle:{minHeight:"400px",fontSize:"16px",padding:"10px",backgroundColor:"#fff"},toolbarCustomButtons:z.map(e=>(0,n.jsx)(J,{group:e,onItemClick:c,openDropdown:s,setOpenDropdown:d},e.type))})})})}function $(e){var t;let{labels:a,maxAccess:r,recordId:o,languageId:d,window:p}=e,{getRequest:y,postRequest:f}=(0,l.useContext)(m.$),{platformLabels:S}=(0,l.useContext)(u.l),[E,N]=(0,l.useState)(()=>j.EditorState.createEmpty()),[B,Z]=(0,l.useState)(""),k=(0,c.E)({endpointId:_.r.TemplateBody.qry}),{formik:D}=(0,v.c)({initialValues:{recordId:null,teId:o,name:"",textBody:"",subject:"",languageId:null},maxAccess:r,validationSchema:h.Ry({languageId:h.Rx().required(),subject:h.Z_().required()}),onSubmit:async e=>{let t=E.getCurrentContent(),a=t.getPlainText().trim()?A()((0,j.convertToRaw)(t)):"";await f({extension:_.r.TemplateBody.set,record:JSON.stringify({...e,teId:o,textBody:a?encodeURIComponent(a):""})}),g.ZP.success(d?S.Edited:S.Added),k(),p.close()}});return(0,l.useEffect)(()=>{!async function(){if(o&&d){var e;let t=await y({extension:_.r.TemplateBody.get,parameters:"_teId=".concat(o,"&_languageId=").concat(d)}),a=(null==t?void 0:null===(e=t.record)||void 0===e?void 0:e.textBody)?function(e){if(!e)return"";if(/%u[0-9A-Fa-f]{4}/.test(e))return unescape(e);try{return decodeURIComponent(e)}catch(t){return e}}(t.record.textBody):"";if(Z(a),D.setValues({...t.record,textBody:a}),a){let e=(0,I.h4)({htmlToEntity:(e,t,a)=>{if("img"===e)return a("IMAGE","IMMUTABLE",{src:t.getAttribute("src"),alt:t.getAttribute("alt"),style:t.getAttribute("style")});if("a"===e){let e=t.textContent||"";return/^#.+#$/.test(e)?null:a("LINK","MUTABLE",{url:t.getAttribute("href")})}},htmlToBlock:(e,t)=>"img"===e?{type:"atomic",data:{}}:t.style&&t.style.textAlign?{type:"li"===e?"unordered-list-item":"p"===e?"unstyled":null,data:{"text-align":t.style.textAlign}}:null,htmlToStyle:(e,t,a)=>{if(t.style.color&&(a=a.add("color-".concat(t.style.color))),"ins"===e&&(a=a.add("UNDERLINE")),t.style.fontSize){let e=t.style.fontSize.replace("px","");a=a.add("fontsize-".concat(e))}if(t.style.fontFamily){let e=t.style.fontFamily.replace(/["']/g,"");a=a.add("fontfamily-".concat(e))}if(t.style.backgroundColor){let e=t.style.backgroundColor.replace(/\s+/g,"").replace(/;/g,"");a=a.add("bgcolor-".concat(e))}return a}})(a);N(j.EditorState.createWithContent(e))}else N(j.EditorState.createEmpty())}}()},[]),(0,n.jsx)(w.Z,{onSave:D.handleSubmit,maxAccess:r,children:(0,n.jsx)(s.R,{children:(0,n.jsx)(i.Q,{children:(0,n.jsxs)(x.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(T.Z,{datasetId:C.v.LANGUAGE,name:"languageId",label:a.language,valueField:"key",displayField:"value",values:D.values,maxAccess:r,required:!0,onChange:(e,t)=>D.setFieldValue("languageId",(null==t?void 0:t.key)||null),error:D.touched.languageId&&!!D.errors.languageId})}),(0,n.jsx)(x.ZP,{item:!0,xs:12,children:(0,n.jsx)(b.Z,{name:"subject",label:a.subject,value:null===(t=D.values)||void 0===t?void 0:t.subject,required:!0,maxAccess:r,onChange:D.handleChange,onClear:()=>D.setFieldValue("subject",""),error:D.touched.subject&&!!D.errors.subject,maxLength:30})}),(0,n.jsx)(Y,{value:B,onChange:N})]})})})})}function H(e){var t;let{labels:a,maxAccess:T,recordId:C}=e,{getRequest:j,postRequest:S}=(0,l.useContext)(m.$),{platformLabels:A}=(0,l.useContext)(u.l),{stack:I}=(0,y.zY)(),w=(0,c.E)({endpointId:_.r.AdTemplate.page}),{formik:E}=(0,v.c)({initialValues:{recordId:null,name:""},maxAccess:T,validationSchema:h.Ry({name:h.Z_().required()}),onSubmit:async e=>{let t=await S({extension:_.r.AdTemplate.set,record:JSON.stringify(e)});E.setFieldValue("recordId",t.recordId),g.ZP.success(e.recordId?A.Edited:A.Added),w()}});async function N(){return C?await j({extension:_.r.TemplateBody.qry,parameters:"_teId=".concat(C)}):{list:[]}}(0,l.useEffect)(()=>{!async function(){if(C){let e=await j({extension:_.r.AdTemplate.get,parameters:"_recordId=".concat(C)});E.setValues(e.record)}}()},[]);let B=!!E.values.recordId,{query:{data:Z},invalidate:k,refetch:D}=(0,c.J)({queryFn:N,endpointId:_.r.TemplateBody.qry,datasetId:p.i.Template}),q=[{field:"languageName",headerName:a.language,flex:1}],P=async e=>{await S({extension:_.r.TemplateBody.del,record:JSON.stringify(e)}),k(),g.ZP.success(A.Deleted)};function F(e,t){I({Component:$,props:{labels:a,recordId:e,languageId:t,maxAccess:T},width:900,height:700,title:null==a?void 0:a.TemplateBody})}return(0,n.jsx)(f.Z,{resourceId:p.i.Template,form:E,maxAccess:T,editMode:B,isParentWindow:!1,children:(0,n.jsxs)(s.R,{children:[(0,n.jsxs)(o.g,{children:[(0,n.jsx)(x.ZP,{item:!0,sx:{paddingTop:2},children:(0,n.jsx)(b.Z,{name:"name",label:a.name,value:null===(t=E.values)||void 0===t?void 0:t.name,required:!0,maxAccess:T,onChange:E.handleChange,onClear:()=>E.setFieldValue("name",""),error:E.touched.name&&!!E.errors.name,maxLength:30})}),(0,n.jsx)(r.Z,{onAdd:()=>{F(C)},maxAccess:T,disableAdd:!B})]}),(0,n.jsx)(i.Q,{children:(0,n.jsx)(d.Z,{name:"templateBodyTable",columns:q,gridData:Z,rowId:["recordId"],onEdit:e=>{F(null==e?void 0:e.teId,null==e?void 0:e.languageId)},onDelete:P,pagination:!1,maxAccess:T})})]})})}var K=()=>{let{getRequest:e,postRequest:t}=(0,l.useContext)(m.$),{platformLabels:a}=(0,l.useContext)(u.l),{stack:x}=(0,y.zY)();async function h(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:a=0,_pageSize:n=50}=t;return{...await e({extension:_.r.AdTemplate.page,parameters:"_startAt=".concat(a,"&_pageSize=").concat(n)}),_startAt:a}}let{query:{data:f},labels:v,access:b,invalidate:T,refetch:C,paginationParameters:j}=(0,c.J)({queryFn:h,endpointId:_.r.AdTemplate.page,datasetId:p.i.Template}),S=[{field:"name",headerName:v.name,flex:1}],A=async e=>{await t({extension:_.r.AdTemplate.del,record:JSON.stringify(e)}),T(),g.ZP.success(a.Deleted)};function I(e){x({Component:H,props:{labels:v,recordId:e,maxAccess:b},width:700,height:600,title:null==v?void 0:v.Template})}return(0,n.jsxs)(s.R,{children:[(0,n.jsx)(o.g,{children:(0,n.jsx)(r.Z,{onAdd:()=>{I()},maxAccess:b})}),(0,n.jsx)(i.Q,{children:(0,n.jsx)(d.Z,{name:"table",columns:S,gridData:f,rowId:["recordId"],onEdit:e=>{I(null==e?void 0:e.recordId)},onDelete:A,pageSize:50,paginationType:"api",paginationParameters:j,refetch:C,maxAccess:b})})]})}},81579:function(e,t,a){"use strict";a.d(t,{r:function(){return l}});let n="AA.asmx/",l={DocumentType:{qry:n+"qryDT"},ProcessNotification:{qry:n+"qryPN",set:n+"set2PN"},AdTemplate:{qry:n+"qryTE",page:n+"pageTE",set:n+"setTE",get:n+"getTE",del:n+"delTE"},TemplateBody:{qry:n+"qryTB",set:n+"setTB",get:n+"getTB",del:n+"delTB"}}},50969:function(e){e.exports={wrapper:"DropdownButton_wrapper__FFqEW",button:"DropdownButton_button__D9jV3",menu:"DropdownButton_menu__DeT6K",item:"DropdownButton_item__oNFQY"}},82454:function(e){e.exports={editorRoot:"TextEditor_editorRoot__wYjov"}}},function(e){e.O(0,[82434,49774,92888,40179],function(){return e(e.s=86179)}),_N_E=e.O()}]);