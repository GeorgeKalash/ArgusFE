(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[22735],{39918:function(e,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sites",function(){return n(18912)}])},18912:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return A}});var r=n(52322),t=n(2784),l=n(62202),i=n(69387),s=n(36908),d=n(65950),c=n(26612),o=n(61802),u=n(71987),m=n(65215),p=n(60218),x=n(48601),f=n(82737),v=n(80983),h=n(5088),I=n(38449),y=n(8661),g=n(66361),C=n(22341),N=n(31389),_=n(62362),Z=n(19473),j=n(19689);function w(e){var a,n;let{labels:i,recordId:s,maxAccess:o}=e,[w,S]=(0,t.useState)(!!s),{platformLabels:A}=(0,t.useContext)(Z.l),{getRequest:F,postRequest:P}=(0,t.useContext)(d.$),k=(0,u.E)({endpointId:m.$.Site.page}),{formik:q}=(0,v.c)({initialValues:{recordId:null,name:"",reference:"",plantId:"",plName:"",plId:"",costCenterId:"",siteGroupId:"",isInactive:!1,allowNegativeQty:!1},maxAccess:o,validateOnChange:!0,validationSchema:x.Ry({name:x.Z_().required(),reference:x.Z_().required(),plantId:x.Z_().required()}),onSubmit:async e=>{let a=e.recordId,n=await P({extension:m.$.Site.set,record:JSON.stringify(e)});a?l.ZP.success(A.Edited):(l.ZP.success(A.Added),q.setValues({...e,recordId:n.recordId})),S(!0),k()}});return(0,t.useEffect)(()=>{!async function(){try{if(s){let e=await F({extension:m.$.Site.get,parameters:"_recordId=".concat(s)});q.setValues(e.record)}}catch(e){}}()},[]),(0,r.jsx)(f.Z,{resourceId:c.i.Sites,form:q,height:400,maxAccess:o,editMode:w,children:(0,r.jsx)(N.R,{children:(0,r.jsx)(_.Q,{children:(0,r.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(h.Z,{name:"reference",label:i.reference,value:q.values.reference,required:!0,rows:2,maxAccess:o,onChange:q.handleChange,onClear:()=>q.setFieldValue("reference",""),error:q.touched.reference&&!!q.errors.reference})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(h.Z,{name:"name",label:i.name,value:q.values.name,required:!0,maxAccess:o,maxLength:"30",onChange:q.handleChange,onClear:()=>q.setFieldValue("name",""),error:q.touched.name&&!!q.errors.name})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(y.Z,{endpointId:I.r.Plant.qry,name:"plantId",label:i.plant,valueField:"recordId",values:q.values,required:!0,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],onChange:(e,a)=>{q.setFieldValue("plantId",(null==a?void 0:a.recordId)||"")},maxAccess:o,error:q.touched.plantId&&!!q.errors.plantId})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(y.Z,{endpointId:C.P.PriceLevel.qry,name:"plId",label:i.priceLevel,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:q.values,maxAccess:o,onChange:(e,a)=>{q.setFieldValue("plId",(null==a?void 0:a.recordId)||"")}})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(y.Z,{endpointId:g.x.CostCenter.qry,parameters:"_params=&_startAt=0&_pageSize=200",name:"costCenterId",label:i.costCenter,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:q.values,maxAccess:o,onChange:(e,a)=>{q&&q.setFieldValue("costCenterId",null==a?void 0:a.recordId)}})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(y.Z,{endpointId:m.$.SiteGroups.qry,name:"siteGroupId",label:i.siteGroup,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:q.values,maxAccess:o,onChange:(e,a)=>{q&&q.setFieldValue("siteGroupId",null==a?void 0:a.recordId)}})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(j.Z,{name:"allowNegativeQty",value:null===(a=q.values)||void 0===a?void 0:a.allowNegativeQty,onChange:e=>q.setFieldValue("allowNegativeQty",e.target.checked),label:i.anq,maxAccess:o})}),(0,r.jsx)(p.ZP,{item:!0,xs:12,children:(0,r.jsx)(j.Z,{name:"isInactive",value:null===(n=q.values)||void 0===n?void 0:n.isInactive,onChange:e=>q.setFieldValue("isInactive",e.target.checked),label:i.isInactive,maxAccess:o})})]})})})})}var S=n(33625),A=()=>{let{getRequest:e,postRequest:a}=(0,t.useContext)(d.$),{stack:n}=(0,o.zY)(),{platformLabels:p}=(0,t.useContext)(Z.l);async function x(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{_startAt:n=0,_pageSize:r=50,params:t}=a;return{...await e({extension:m.$.Site.page,parameters:"_startAt=".concat(n,"&_pageSize=").concat(r,"&_filter=&_params=").concat(t||"")}),_startAt:n}}async function f(a){let{filters:n,pagination:r}=a;return(null==n?void 0:n.qry)?await e({extension:m.$.Site.snapshot,parameters:"_filter=".concat(n.qry)}):x({_startAt:r._startAt||0,params:null==n?void 0:n.params})}let{query:{data:v},labels:h,access:I,filterBy:y,refetch:g,paginationParameters:C}=(0,u.J)({queryFn:x,endpointId:m.$.Site.page,datasetId:c.i.Sites,filter:{filterFn:f}}),j=(0,u.E)({endpointId:m.$.Site.page}),A=[{field:"reference",headerName:h.reference,flex:1},{field:"name",headerName:h.name,flex:1},,{field:"plantName",headerName:h.plant,flex:1},{field:"costCenterName",headerName:h.costCenter,flex:1},{field:"siteGroupName",headerName:h.siteGroup,flex:1},{field:"allowNegativeQty",headerName:h.anq,type:"checkbox",flex:1},{field:"isInactive",headerName:h.isInactive,type:"checkbox",flex:1}],F=async e=>{await a({extension:m.$.Site.del,record:JSON.stringify(e)}),j(),l.ZP.success(p.Deleted)};function P(e){n({Component:w,props:{labels:h,recordId:e,maxAccess:I},width:500,height:580,title:h.sites})}return(0,r.jsxs)(N.R,{children:[(0,r.jsx)(S.g,{children:(0,r.jsx)(s.Z,{onAdd:()=>{P()},maxAccess:I,reportName:"IVSI",filterBy:y,previewReport:c.i.Sites})}),(0,r.jsx)(_.Q,{children:(0,r.jsx)(i.Z,{columns:A,gridData:v,rowId:["recordId"],onEdit:e=>{P(null==e?void 0:e.recordId)},onDelete:F,refetch:g,maxAccess:I,pageSize:50,paginationParameters:C,paginationType:"api"})})]})}}},function(e){e.O(0,[92515,2494,36908,49774,92888,40179],function(){return e(e.s=39918)}),_N_E=e.O()}]);