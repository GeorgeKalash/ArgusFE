"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23352],{1685:function(e,t,r){r.d(t,{m:function(){return a}});let a=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,r){r.d(t,{H:function(){return y},G:function(){return P}});var a=r(45300),n=r(2784),i=r(96026),c=r(38449);r(26612);var o=r(65947),l=r(1685);let u=async(e,t,r)=>{try{let a=await e({extension:t,parameters:r});return t.includes("qry")?a:a.record}catch(e){return null}},s=(e,t,r,a)=>{let n=(e=JSON.parse(JSON.stringify(e))).record.controls,i=n.find(e=>"reference"===e.controlId);return i?i.accessLevel=(null==t?void 0:t.mandatory)?o.$7:o.rr:(null==t?void 0:t.mandatory)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?o.$7:o.rr}):(null==t?void 0:t.readOnly)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?o.rr:o.$7}):n=e.record.controls.filter(e=>"reference"!=e.controlId),r&&n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","dtId"),accessLevel:o.$7}),{...e,record:{...e.record,controls:n}}},d=async(e,t,r)=>{let a,n;switch(r){case"dtId":let i=(0,l.m)("userData"),o=null==i?void 0:i.userId;n="_userId=".concat(o,"&_functionId=").concat(t),a=c.r.UserFunction.get;break;case"glbSysNumberRange":n="_recordId=".concat(t),a=c.r.SystemFunction.get;break;case"DocumentType":n="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),a=c.r.DocumentType.qry;break;case"DcTypNumberRange":n="_recordId=".concat(t),a=c.r.DocumentType.get;break;case"isExternal":n="_recordId=".concat(t),a=c.r.NumberRange.get;break;default:return null}return await u(e,a,n)},b=async function(e){let t,r,a,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,l=!(arguments.length>4)||void 0===arguments[4]||arguments[4],u=arguments.length>5?arguments[5]:void 0,b=void 0===o&&i&&await d(e,i,"dtId"),m=null==b?void 0:b.dtId,P="",y=!0;if(b&&void 0===o||"nraId"===o){if(m){let r=await d(e,m,"DcTypNumberRange");t=null==r?void 0:r.nraId,y=!((null==r?void 0:r.activeStatus)<0),t||(P="Assign the document type to a number range")}if((!m||!y)&&l&&i){var f;let t=await d(e,i,"DocumentType");n=(null==t?void 0:null===(f=t.list)||void 0===f?void 0:f.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===o||void 0===o)&&i){if((!m||m)&&!t||t&&!y){let r=await d(e,i,"glbSysNumberRange");(t=null==r?void 0:r.nraId)&&n&&(n=!1),y=!0}P=t||n?"":"Assign the system Function to a number range"}o>0&&!t&&(t=o),t&&y?(r={readOnly:null==(a=await d(e,t,"isExternal"))||!a.external,mandatory:null!=a&&!!a.external},c&&(c=await s(c,r,n,u))):!t&&c&&(c=await s(c,r,n,u));let x=u?"".concat(u,".reference"):"reference";return{dtId:m,resetReference:null==r?void 0:r.readOnly,dcTypeRequired:n,reference:{fieldName:x,isEmpty:(null==a?void 0:a.external)!==void 0&&(null==a||!a.external)},errorMessage:P,maxAccess:c,selectNraId:o}};var m=r(65950);function P(e){let{functionId:t,action:r,hasDT:a}=e,{getRequest:c}=(0,n.useContext)(m.$),{stack:o}=(0,i.V)();return{proxyAction:async()=>{let e=await b(c,t,"",void 0,a);(null==e?void 0:e.errorMessage)?o({message:null==e?void 0:e.errorMessage}):await r()}}}function y(e){var t;let{functionId:r,access:c,hasDT:o,enabled:l=!0,objectName:u=""}=e,{getRequest:s}=(0,n.useContext)(m.$),{stack:d}=(0,i.V)(),[P,y]=(0,n.useState)(),f=async e=>{let t=await b(s,r,c,e,o,u);if(!t.errorMessage)return t;d({message:null==t?void 0:t.errorMessage})},x=(0,a.a)({retry:!1,staleTime:0,enabled:l,queryKey:[r,P,!!c,l],queryFn:P||"nraId"===P?()=>f(P):()=>f()});return{documentType:x.data,maxAccess:(null==x?void 0:null===(t=x.data)||void 0===t?void 0:t.maxAccess)||c,changeDT(e){y((null==e?void 0:e.nraId)||"nraId")}}}},19568:function(e,t,r){var a=r(52322),n=r(2784),i=r(69387),c=r(26612),o=r(71987),l=r(65950),u=r(31389),s=r(62362),d=r(33625),b=r(60218),m=r(5088),P=r(25870),y=r(19473),f=r(21326);let x=e=>{let{taxId:t,obj:r,window:x}=e,{getRequest:v}=(0,n.useContext)(l.$),{platformLabels:I}=(0,n.useContext)(y.l);(0,f.Z)({title:I.TaxDetails,window:x});let g=(e,t)=>{switch(e.taxBase){case 1:return(t.extendedPrice*e.amount/100).toFixed(2);case 2:return(t.qty*e.amount).toFixed(2);case 3:return(null!=t.basePrice?t.basePrice*t.qty*e.amount/100:0).toFixed(2);case 4:return(null!=t.baseLaborPrice?t.baseLaborPrice*t.qty*e.amount/100:0).toFixed(2);default:return null}},{query:{data:h},labels:p,access:w}=(0,o.J)({queryFn:N,endpointId:P.H.TaxDetailPack.qry,datasetId:c.i.TaxDetails}),L=[{field:"taxCodeRef",headerName:p.taxCodeRef,flex:1},{field:"taxCodeName",headerName:p.taxCodeName,flex:1},,{field:"taxBaseName",headerName:p.taxBaseName,flex:1},{field:"amount",headerName:p.taxAmount,flex:1,type:"number"},{field:"vatAmount",headerName:p.vatAmount,flex:1,type:"number"}];async function N(){let e=await v({extension:P.H.TaxDetailPack.qry,parameters:"_taxId=".concat(t)});return e.list=e.list.map(e=>{let t=g(e,r);return e.vatAmount=t,e}),e}return(0,a.jsxs)(u.R,{children:[(0,a.jsx)(d.g,{children:(0,a.jsxs)(b.ZP,{container:!0,xs:9,spacing:2,sx:{p:2},children:[(0,a.jsx)(b.ZP,{item:!0,xs:6,children:(0,a.jsx)(m.Z,{label:p.sku,value:r.sku,readOnly:!0})}),(0,a.jsx)(b.ZP,{item:!0,xs:5}),(0,a.jsx)(b.ZP,{item:!0,xs:6,children:(0,a.jsx)(m.Z,{label:p.itemName,value:r.itemName,readOnly:!0})})]})}),(0,a.jsx)(s.Q,{children:(0,a.jsx)(i.Z,{columns:L,gridData:h,rowId:["recordId"],isLoading:!1,maxAccess:w,pagination:!1})})]})};x.width=1e3,t.Z=x},86626:function(e,t,r){r.d(t,{Ch:function(){return I},On:function(){return l},RD:function(){return b},Xf:function(){return n},Xo:function(){return d},bT:function(){return i},bh:function(){return c},kx:function(){return s},tV:function(){return u},yO:function(){return a},zL:function(){return o}});let a=1,n=2,i=3,c=4,o=5,l=6,u=8,s=9,d=1,b=2,m=e=>{switch(e.priceType){case 1:e.basePrice=e.unitPrice-e.baseLaborPrice;break;case 2:e.basePrice=e.unitPrice/e.volume;break;case 3:e.basePrice=e.unitPrice/e.weight-e.baseLaborPrice}return e.totalWeightPerG=e.basePrice+e.baseLaborPrice,e},P=e=>(e.baseLaborPrice=e.unitPrice/(3===e.priceType?e.weight:2===e.priceType?e.volume:1)-e.basePrice,e.totalWeightPerG=e.basePrice+e.baseLaborPrice,e),y=e=>0===e.mdAmount||e.mdType!==d?(e.mdValue=e.mdAmount,(e.unitPrice-e.mdAmount+e.upo)*e.qty):(e.mdValue=e.unitPrice*e.mdAmount/100,(e.unitPrice-e.mdValue+e.upo)*e.qty),f=e=>(e.extendedPrice=y(e),e),x=e=>{let t=y(e);if(Math.abs(t-e.extendedPrice)>.01&&alert("INVOICE_LINE_PRICE_ERROR ExtendedPrice / "+e.unitPrice+"/"+e.qty+"/"+e.extendedPrice+"/"+t),2===e.priceType)0===e.volume&&alert("ITEM_VOLUME_NOT_SPECIFIED"),0!==e.baseLaborPrice&&0!==e.basePrice&&Math.abs((e.baseLaborPrice+e.basePrice)*e.volume-e.unitPrice)>.01&&alert("INVOICE_LINE_PRICE_ERROR UnitPrice-volume "+e.basePrice+"/"+e.volume+"/"+e.unitPrice);else if(3===e.priceType){if(0===e.weight&&alert("ITEM_WEIGHT_NOT_SPECIFIED"),0!==e.baseLaborPrice&&0!==e.basePrice){let t=(e.baseLaborPrice+e.basePrice)*e.weight;Math.abs(t-e.unitPrice)>.01&&alert("INVOICE_LINE_PRICE_ERROR UnitPrice-weight "+e.basePrice+"/"+e.weight+"/"+e.unitPrice+"/"+t)}}else if(0!==e.baseLaborPrice&&0!==e.basePrice){let t=e.basePrice+e.baseLaborPrice;Math.abs(t-e.unitPrice)>.01&&alert("INVOICE_LINE_PRICE_ERROR UnitPrice-quantity "+e.basePrice+"/"+e.unitPrice+"/"+t)}},v=e=>{switch(console.log(e),e.dirtyField){case s:e.baseLaborPrice=e.totalWeightPerG-e.basePrice;case u:case a:e.unitPrice=(e.basePrice+e.baseLaborPrice)*(3===e.priceType?e.weight:2===e.priceType?e.volume:1),e.totalWeightPerG=e.basePrice+e.baseLaborPrice,e=f(e);break;case i:e=f(e);break;case n:0!=e.baseLaborPrice?e=P(e):0!=e.basePrice&&(e=m(e)),e=f(e);break;case o:case l:case 7:e=f(e);break;case c:0!==e.qty&&(0===e.mdAmount?(e.unitPrice=e.extendedPrice/e.qty-e.upo,0!==e.baseLaborPrice?e=P(e):0!==e.basePrice&&(e=m(e)),e.totalWeightPerG=e.basePrice+e.baseLaborPrice):(e.mdValue=e.unitPrice+e.upo-e.extendedPrice/e.qty,e.mdType!==d?e.mdAmount=e.mdValue:e.mdAmount=0===e.unitPrice?0:100*e.mdValue/e.unitPrice));break;case 10:e=f(e);break;default:alert("I don't know such dirtyField "+e.dirtyField)}return e},I=e=>(console.log("check row ",e),2===e.priceType&&0===e.volume&&alert("item volume not defined"),x(e=v(e)),e)},18996:function(e,t,r){r.d(t,{VW:function(){return i}});let a=(e,t)=>{let r=0;switch(t.taxBase){case 1:r=0==e.tdPct?e.extendedPrice*t.amount/100:e.extendedPrice*(1-e.tdPct/100)*t.amount/100;break;case 2:r=(null==e?void 0:e.priceType)===3?t.amount*e.qty*e.weight:t.amount*e.qty;break;case 3:r=e.basePrice*e.qty*t.amount/100;break;case 4:r=e.baseLaborPrice*e.qty*t.amount/100;break;default:r=0}return r},n=e=>{let t=0;if(null!=e.taxDetails)for(let r=0;r<e.taxDetails.length;r++)t+=a(e,e.taxDetails[r]);return t},i=e=>(e.vatAmount=n(e),e)}}]);