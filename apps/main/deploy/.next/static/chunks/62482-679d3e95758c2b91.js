(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[62482],{1685:function(e,t,n){"use strict";n.d(t,{m:function(){return a}});let a=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},98345:function(e,t,n){"use strict";n.d(t,{H:function(){return p},G:function(){return f}});var a=n(45300),r=n(2784),o=n(96026),l=n(38449);n(26612);var c=n(65947),d=n(1685);let s=async(e,t,n)=>{try{let a=await e({extension:t,parameters:n});return t.includes("qry")?a:a.record}catch(e){return null}},i=(e,t,n,a)=>{let r=(e=JSON.parse(JSON.stringify(e))).record.controls,o=r.find(e=>"reference"===e.controlId);return o?o.accessLevel=(null==t?void 0:t.mandatory)?c.$7:c.rr:(null==t?void 0:t.mandatory)?r.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.mandatory)?c.$7:c.rr}):(null==t?void 0:t.readOnly)?r.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==t?void 0:t.readOnly)?c.rr:c.$7}):r=e.record.controls.filter(e=>"reference"!=e.controlId),n&&r.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","dtId"),accessLevel:c.$7}),{...e,record:{...e.record,controls:r}}},u=async(e,t,n)=>{let a,r;switch(n){case"dtId":let o=(0,d.m)("userData"),c=null==o?void 0:o.userId;r="_userId=".concat(c,"&_functionId=").concat(t),a=l.r.UserFunction.get;break;case"glbSysNumberRange":r="_recordId=".concat(t),a=l.r.SystemFunction.get;break;case"DocumentType":r="_dgId=".concat(t,"&_startAt=",0,"&_pageSize=",50),a=l.r.DocumentType.qry;break;case"DcTypNumberRange":r="_recordId=".concat(t),a=l.r.DocumentType.get;break;case"isExternal":r="_recordId=".concat(t),a=l.r.NumberRange.get;break;default:return null}return await s(e,a,r)},m=async function(e){let t,n,a,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,d=!(arguments.length>4)||void 0===arguments[4]||arguments[4],s=arguments.length>5?arguments[5]:void 0,m=void 0===c&&o&&await u(e,o,"dtId"),v=null==m?void 0:m.dtId,f="",p=!0;if(m&&void 0===c||"nraId"===c){if(v){let n=await u(e,v,"DcTypNumberRange");t=null==n?void 0:n.nraId,p=!((null==n?void 0:n.activeStatus)<0),t||(f="Assign the document type to a number range")}if((!v||!p)&&d&&o){var h;let t=await u(e,o,"DocumentType");r=(null==t?void 0:null===(h=t.list)||void 0===h?void 0:h.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===c||void 0===c)&&o){if((!v||v)&&!t||t&&!p){let n=await u(e,o,"glbSysNumberRange");(t=null==n?void 0:n.nraId)&&r&&(r=!1),p=!0}f=t||r?"":"Assign the system Function to a number range"}c>0&&!t&&(t=c),t&&p?(n={readOnly:null==(a=await u(e,t,"isExternal"))||!a.external,mandatory:null!=a&&!!a.external},l&&(l=await i(l,n,r,s))):!t&&l&&(l=await i(l,n,r,s));let g=s?"".concat(s,".reference"):"reference";return{dtId:v,resetReference:null==n?void 0:n.readOnly,dcTypeRequired:r,reference:{fieldName:g,isEmpty:(null==a?void 0:a.external)!==void 0&&(null==a||!a.external)},errorMessage:f,maxAccess:l,selectNraId:c}};var v=n(65950);function f(e){let{functionId:t,action:n,hasDT:a}=e,{getRequest:l}=(0,r.useContext)(v.$),{stack:c}=(0,o.V)();return{proxyAction:async()=>{let e=await m(l,t,"",void 0,a);(null==e?void 0:e.errorMessage)?c({message:null==e?void 0:e.errorMessage}):await n()}}}function p(e){var t;let{functionId:n,access:l,hasDT:c,enabled:d=!0,objectName:s=""}=e,{getRequest:i}=(0,r.useContext)(v.$),{stack:u}=(0,o.V)(),[f,p]=(0,r.useState)(),h=async e=>{let t=await m(i,n,l,e,c,s);if(!t.errorMessage)return t;u({message:null==t?void 0:t.errorMessage})},g=(0,a.a)({retry:!1,staleTime:0,enabled:d,queryKey:[n,f,!!l,d],queryFn:f||"nraId"===f?()=>h(f):()=>h()});return{documentType:g.data,maxAccess:(null==g?void 0:null===(t=g.data)||void 0===t?void 0:t.maxAccess)||l,changeDT(e){p((null==e?void 0:e.nraId)||"nraId")}}}},14027:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var a=n(52322),r=n(26612),o=n(60218),l=n(76399),c=n(80983),d=n(31389),s=n(62362),i=n(33625),u=n(66361),m=n(91406),v=n(2784),f=n(19473),p=n(21326),h=n(71987),g=n(54074);function y(e){var t,n;let{row:y,window:I,updateRow:b,recordId:x,readOnly:C}=e,{platformLabels:w}=(0,v.useContext)(f.l);(0,p.Z)({title:w.CostCenter,window:I});let{labels:N,access:k}=(0,h.J)({datasetId:r.i.CostCenter}),{formik:S}=(0,c.c)({maxAccess:k,validateOnChange:!0,initialValues:{costCenters:y.costCenters||[{id:1,pvId:x||0,seqNo:1,ccSeqNo:"",ccId:"",amount:""}]},onSubmit:async e=>{b({changes:{costCenters:e.costCenters.map((e,t)=>({...e,id:t+1,ccSeqNo:t+1,seqNo:y.id,pvId:x}))}}),I.close()}}),_=[{component:"resourcecombobox",label:N.costCenter,name:"ccId",props:{endpointId:u.x.CostCenter.qry,parameters:"_params=&_startAt=0&_pageSize=1000&",valueField:"recordId",displayField:"reference",displayFieldWidth:3,readOnly:C,mapping:[{from:"recordId",to:"ccId"},{from:"name",to:"ccName"},{from:"reference",to:"ccRef"},{from:"ccgName",to:"ccgName"}],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name",grid:3},{key:"ccgName",value:"Group Name"}]}},{component:"textfield",label:N.name,name:"ccName",flex:2,props:{readOnly:!0}},{component:"textfield",label:N.group,name:"ccgName",props:{readOnly:!0}},{component:"numberfield",label:N.amount,name:"amount",props:{readOnly:C}}],j=null===(n=S.values)||void 0===n?void 0:null===(t=n.costCenters)||void 0===t?void 0:t.reduce((e,t)=>{var n;return e+(parseFloat(null===(n=t.amount)||void 0===n?void 0:n.toString().replace(/,/g,""))||0)},0),F=y.amount-j,O=F>0||F<0||C;return(0,a.jsx)(g.Z,{onSave:S.handleSubmit,maxAccess:k,disabledSubmit:O,children:(0,a.jsxs)(d.R,{children:[(0,a.jsx)(i.g,{children:(0,a.jsxs)(o.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(m.Z,{name:"amount",label:N.amount,value:y.amount,maxAccess:k,readOnly:!0,onChange:S.handleChange,onClear:()=>S.setFieldValue("amount",""),error:S.touched.amount&&!!S.errors.amount})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(m.Z,{name:"amountAssigned",label:N.amountAssigned,value:j,maxAccess:k,readOnly:!0})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(m.Z,{name:"balance",label:N.balance,value:F,maxAccess:k,readOnly:!0,onChange:S.handleChange,onClear:()=>S.setFieldValue("balance",""),error:O})})]})}),(0,a.jsx)(s.Q,{children:(0,a.jsx)(l._,{onChange:e=>{S.setFieldValue("costCenters",e)},value:S.values.costCenters,error:S.errors.costCenters,columns:_,allowDelete:!C,allowAddNewLine:!C})})]})})}y.width=700,y.height=600},39704:function(e,t,n){"use strict";var a=n(52322),r=n(2784),o=n(22341),l=n(65950),c=n(85325),d=n(21326),s=n(19473),i=n(35656),u=n(24868),m=n.n(u);let v=e=>{let{functionId:t,recordId:n,window:u}=e,{getRequest:v}=(0,r.useContext)(l.$),{languageId:f}=(0,r.useContext)(c.V),{platformLabels:p}=(0,r.useContext)(s.l),h=n+"-"+t;(0,d.Z)({title:p.WorkFlow,window:u});let{width:g}=(0,i.d)(),y=g<=1024,I=g>1024&&g<=1280,b=y?10:I?12:14,x=y?75:I?85:95,C=y?15:I?20:25,w=async()=>{var e="_functionId=".concat(t,"&_recordId=").concat(n);let a=await v({extension:o.P.WorkFlow.graph,parameters:e});return null==a?void 0:a.record},N=e=>{let t=[],n=[],a="",r="";return e.objects.forEach(e=>{t.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(t=>{e.objects.forEach(e=>{let n=e.functionName.split(" ").join("\r\n");t.parentId===e.recordId&&t.parentFunctionId===e.functionId&&(a=e.reference+"\r\n"+e.date+"\r\n"+n,t.parentId),t.childId===e.recordId&&t.childFunctionId===e.functionId&&(r=e.reference+"\r\n"+e.date+"\r\n"+n,t.childId)}),""===a||""===r||n.push({from:a,to:r,value:1,labelText:""}),a="",r=""}),n};return(0,r.useEffect)(()=>{!async function(){var e=await w();if(e){let t=(e,t)=>{let n=document.createElement("script");n.type="text/javascript",n.src=e,n.async=!0,n.onload=t,document.head.appendChild(n)};t("https://cdn.amcharts.com/lib/4/core.js",()=>{t("https://cdn.amcharts.com/lib/4/charts.js",()=>{t("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let t=am4core.create(h,am4charts.SankeyDiagram),n=N(e);t.data=n,t.dataFields.fromName="from",t.dataFields.toName="to",t.dataFields.value="value",t.paddingRight=2===f?0:40,t.paddingLeft=2===f?40:0,t.tooltip.label.fontSize=b;let a=t.nodes.template;a.draggable=!1,a.inert=!0,a.clickable=!1,a.width=x,a.height=C,a.nameLabel.label.fontSize=b,a.nameLabel.locationX=2===f?.85:0,a.nameLabel.height=void 0,a.nameLabel.label.fontWeight="bold";let r=t.links.template;r.middleLine.strokeOpacity=.3,r.middleLine.stroke=am4core.color("#555"),r.middleLine.strokeWidth=5,r.middleLine.hoverable=!1,r.fillOpacity=0,r.hoverable=!0,r.hoverOnFocus=!0,r.fill=am4core.color("#A8C686"),r.isHover=!0,t.appear(1e3,100)})})})})}}()},[]),(0,a.jsx)("div",{id:h,className:m().root})};v.width=950,t.Z=v},24868:function(e){e.exports={root:"WorkFlow_root__EINm1"}}}]);