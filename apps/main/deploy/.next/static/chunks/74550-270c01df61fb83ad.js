(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[74550],{1685:function(e,d,l){"use strict";l.d(d,{m:function(){return a}});let a=e=>{let d=window.sessionStorage.getItem(e);return d?JSON.parse(d):null}},98345:function(e,d,l){"use strict";l.d(d,{H:function(){return g},G:function(){return h}});var a=l(45300),n=l(2784),r=l(96026),o=l(38449);l(26612);var i=l(65947),t=l(1685);let u=async(e,d,l)=>{try{let a=await e({extension:d,parameters:l});return d.includes("qry")?a:a.record}catch(e){return null}},s=(e,d,l,a)=>{let n=(e=JSON.parse(JSON.stringify(e))).record.controls,r=n.find(e=>"reference"===e.controlId);return r?r.accessLevel=(null==d?void 0:d.mandatory)?i.$7:i.rr:(null==d?void 0:d.mandatory)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==d?void 0:d.mandatory)?i.$7:i.rr}):(null==d?void 0:d.readOnly)?n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","reference"),accessLevel:(null==d?void 0:d.readOnly)?i.rr:i.$7}):n=e.record.controls.filter(e=>"reference"!=e.controlId),l&&n.push({sgId:0,resourceId:"",controlId:"".concat(a?a+".":"","dtId"),accessLevel:i.$7}),{...e,record:{...e.record,controls:n}}},c=async(e,d,l)=>{let a,n;switch(l){case"dtId":let r=(0,t.m)("userData"),i=null==r?void 0:r.userId;n="_userId=".concat(i,"&_functionId=").concat(d),a=o.r.UserFunction.get;break;case"glbSysNumberRange":n="_recordId=".concat(d),a=o.r.SystemFunction.get;break;case"DocumentType":n="_dgId=".concat(d,"&_startAt=",0,"&_pageSize=",50),a=o.r.DocumentType.qry;break;case"DcTypNumberRange":n="_recordId=".concat(d),a=o.r.DocumentType.get;break;case"isExternal":n="_recordId=".concat(d),a=o.r.NumberRange.get;break;default:return null}return await u(e,a,n)},v=async function(e){let d,l,a,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,t=!(arguments.length>4)||void 0===arguments[4]||arguments[4],u=arguments.length>5?arguments[5]:void 0,v=void 0===i&&r&&await c(e,r,"dtId"),m=null==v?void 0:v.dtId,h="",g=!0;if(v&&void 0===i||"nraId"===i){if(m){let l=await c(e,m,"DcTypNumberRange");d=null==l?void 0:l.nraId,g=!((null==l?void 0:l.activeStatus)<0),d||(h="Assign the document type to a number range")}if((!m||!g)&&t&&r){var y;let d=await c(e,r,"DocumentType");n=(null==d?void 0:null===(y=d.list)||void 0===y?void 0:y.filter(e=>(null==e?void 0:e.activeStatus)===1).length)>0}}if(("nraId"===i||void 0===i)&&r){if((!m||m)&&!d||d&&!g){let l=await c(e,r,"glbSysNumberRange");(d=null==l?void 0:l.nraId)&&n&&(n=!1),g=!0}h=d||n?"":"Assign the system Function to a number range"}i>0&&!d&&(d=i),d&&g?(l={readOnly:null==(a=await c(e,d,"isExternal"))||!a.external,mandatory:null!=a&&!!a.external},o&&(o=await s(o,l,n,u))):!d&&o&&(o=await s(o,l,n,u));let x=u?"".concat(u,".reference"):"reference";return{dtId:m,resetReference:null==l?void 0:l.readOnly,dcTypeRequired:n,reference:{fieldName:x,isEmpty:(null==a?void 0:a.external)!==void 0&&(null==a||!a.external)},errorMessage:h,maxAccess:o,selectNraId:i}};var m=l(65950);function h(e){let{functionId:d,action:l,hasDT:a}=e,{getRequest:o}=(0,n.useContext)(m.$),{stack:i}=(0,r.V)();return{proxyAction:async()=>{let e=await v(o,d,"",void 0,a);(null==e?void 0:e.errorMessage)?i({message:null==e?void 0:e.errorMessage}):await l()}}}function g(e){var d;let{functionId:l,access:o,hasDT:i,enabled:t=!0,objectName:u=""}=e,{getRequest:s}=(0,n.useContext)(m.$),{stack:c}=(0,r.V)(),[h,g]=(0,n.useState)(),y=async e=>{let d=await v(s,l,o,e,i,u);if(!d.errorMessage)return d;c({message:null==d?void 0:d.errorMessage})},x=(0,a.a)({retry:!1,staleTime:0,enabled:t,queryKey:[l,h,!!o,t],queryFn:h||"nraId"===h?()=>y(h):()=>y()});return{documentType:x.data,maxAccess:(null==x?void 0:null===(d=x.data)||void 0===d?void 0:d.maxAccess)||o,changeDT(e){g((null==e?void 0:e.nraId)||"nraId")}}}},74550:function(e,d,l){"use strict";l.d(d,{Z:function(){return J}});var a=l(52322),n=l(89330),r=l(39812),o=l(60218),i=l(2784),t=l(48601),u=l(82737),s=l(62202),c=l(65950),v=l(26612),m=l(5088),h=l(21581),g=l(8661),y=l(38449),x=l(7121),I=l(27423),b=l(62362),f=l(31389),p=l(91406),j=l(90587),P=l(80983),F=l(19473),w=l(98345),Z=l(69387),C=l(69627),k=l(33625),Q=l(65215),N=l(50023),R=l(71987),q=l(39704),D=l(61802),O=l(58276);function J(e){var d,l,J,V,S,_,A,M,T,L,E,W,$,z,U,H,G,K,X,Y,B,ee,ed,el,ea,en,er,eo,ei,et,eu,es,ec,ev,em,eh,eg,ey,ex,eI,eb,ef,ep,ej,eP,eF,ew,eZ,eC,ek,eQ,eN,eR,eq,eD,eO,eJ,eV,eS,e_,eA,eM,eT,eL,eE,eW,e$,ez,eU,eH,eG,eK,eX,eY,eB,e0,e2,e1,e5,e4,e6,e3,e8,e7,e9,de,dd,dl,da,dn,dr,di;let{recordId:dt,lockRecord:du}=e,{getRequest:ds,postRequest:dc}=(0,i.useContext)(c.$),{platformLabels:dv}=(0,i.useContext)(F.l),{addLockedScreen:dm}=(0,i.useContext)(O.Z),{stack:dh}=(0,D.zY)(),dg=(0,R.E)({endpointId:j.u.Damage.page}),{labels:dy,access:dx}=(0,N.Z)({endpointId:j.u.Damage.page,datasetId:v.i.Damages}),{documentType:dI,maxAccess:db,changeDT:df}=(0,w.H)({functionId:x.J.Damage,access:dx,enabled:!dt,objectName:"header"}),{formik:dp}=(0,P.c)({maxAccess:db,documentType:{key:"header.dtId",value:null==dI?void 0:dI.dtId},initialValues:{recordId:dt||null,header:{recordId:dt||null,dtId:null,reference:"",date:new Date,plantId:null,laborId:null,notes:"",status:1,jobId:null,seqNo:0,workCenterId:null,maxPcs:50,jobQty:0,jobPcs:0,damageRate:0,damagedQty:0,damagedPcs:0,netJobQty:0,netJobPcs:0,metalQty:0,nonMetalQty:0,generatedJobRef:"",routingId:null,routingName:""},items:[]},validateOnChange:!0,validationSchema:t.Ry({header:t.Ry({plantId:t.Z_().required(),jobId:t.Z_().required(),date:t.Z_().required(),laborId:t.Rx().required(),damageRate:t.Rx().required(),jobQty:t.Rx().required(),jobPcs:t.Rx().required(),netJobQty:t.Rx().required(),netJobPcs:t.Rx().required(),metalQty:t.Rx().required().min(0),nonMetalQty:t.Rx().required().min(0),routingId:t.Rx().nullable().when("genJobFromDamage",{is:!0,then:()=>t.Rx().required(),otherwise:()=>t.Rx().nullable()}),damagedPcs:t.Vo((e,d)=>{let{parent:l}=d;return t.Rx().min(1).max(l.maxPcs,e=>{let{max:d}=e;return"Must be less than or equal to ".concat(d)}).nullable(!0)}),damagedQty:t.Rx().required().test("max-jobQty","Qty cannot be greater than Job Qty",function(e){return null==e||e<=this.parent.jobQty})})}),onSubmit:async e=>{var d,l;let a={header:{...dp.values.header,date:(0,r.ku)(e.header.date),damageRate:e.header.damageRate||0,qty:e.header.qty||0},items:(null==dp?void 0:null===(l=dp.values)||void 0===l?void 0:null===(d=l.items)||void 0===d?void 0:d.map(e=>{let{id:d,...l}=e;return{seqNo:d,...l}}))||[]},n=await dc({extension:j.u.Damage.set2,record:JSON.stringify(a)});await dj(n.recordId),s.ZP.success(dP?dv.Edited:dv.Added),dg()}});async function dj(e){await ds({extension:j.u.Damage.get2,parameters:"_recordId=".concat(e)}).then(async e=>{var d,l,a,n,o,i,t,u,s,c,m,h,g,y,x,I,b,f;let p=await dO(null==e?void 0:null===(l=e.record)||void 0===l?void 0:null===(d=l.header)||void 0===d?void 0:d.dtId);dp.setValues({recordId:(null==e?void 0:null===(n=e.record)||void 0===n?void 0:null===(a=n.header)||void 0===a?void 0:a.recordId)||null,header:{...null==e?void 0:null===(o=e.record)||void 0===o?void 0:o.header,date:(0,r.a1)(null==e?void 0:null===(t=e.record)||void 0===t?void 0:null===(i=t.header)||void 0===i?void 0:i.date),maxPcs:null==e?void 0:null===(s=e.record)||void 0===s?void 0:null===(u=s.header)||void 0===u?void 0:u.jobPcs,workCenterName:null==e?void 0:null===(m=e.record)||void 0===m?void 0:null===(c=m.header)||void 0===c?void 0:c.wcName,workCenterRef:null==e?void 0:null===(g=e.record)||void 0===g?void 0:null===(h=g.header)||void 0===h?void 0:h.wcRef,genJobFromDamage:p},items:(null==e?void 0:null===(y=e.record)||void 0===y?void 0:y.items)||[]}),dp.values.recordId||du({recordId:null==e?void 0:null===(I=e.record)||void 0===I?void 0:null===(x=I.header)||void 0===x?void 0:x.recordId,reference:null==e?void 0:null===(f=e.record)||void 0===f?void 0:null===(b=f.header)||void 0===b?void 0:b.reference,resourceId:v.i.Damages,onSuccess:()=>{var d,l,a,n;dm({resourceId:v.i.Damages,recordId:null==e?void 0:null===(l=e.record)||void 0===l?void 0:null===(d=l.header)||void 0===d?void 0:d.recordId,reference:null==e?void 0:null===(n=e.record)||void 0===n?void 0:null===(a=n.header)||void 0===a?void 0:a.reference})}})})}let dP=!!dp.values.header.recordId,dF=3===dp.values.header.status,dw=[{key:"Locked",condition:dF,disabled:!dP||dF},{key:"Unlocked",condition:!dF,onClick:async()=>{await dc({extension:j.u.Damage.post,record:JSON.stringify(dp.values.header)}),s.ZP.success(dv.Posted),dg(),await dj(dp.values.recordId)},disabled:!dP||dF},{key:"WorkFlow",condition:!0,onClick:async function(){dh({Component:q.Z,props:{functionId:x.J.Damage,recordId:dp.values.recordId}})},disabled:!dP}];(0,i.useEffect)(()=>{dt&&dj(dt)},[]);let dZ=[{field:"sku",headerName:dy.sku,flex:1},{field:"itemName",headerName:dy.itemName,flex:1},{field:"qty",headerName:dy.qty,flex:1},{field:"damageQty",headerName:dy.damageQty,flex:1}],dC=async()=>{if(!dp.values.header.jobId&&!dp.values.header.damageRate)return;let e=await ds({extension:j.u.Damage.preview,parameters:"_jobId=".concat(dp.values.header.jobId||0,"&_damagedQty=").concat(dp.values.header.damagedQty||0,"&_damagedPcs=").concat(dp.values.header.damagedPcs||0,"&_metalQty=").concat(dp.values.header.metalQty||0,"&_nonMetalQty=").concat(dp.values.header.nonMetalQty||0)});dp.setFieldValue("items",(null==e?void 0:e.list)||[])},{jobQty:dk=0,damagedQty:dQ=0,jobPcs:dN=0,damagedPcs:dR=0}=dp.values.header;async function dq(e){if(!e)return;let d=await ds({extension:j.u.JobMaterial.qry,parameters:"_jobId=".concat(e,"&_seqNo=0")}),l=(null==d?void 0:d.list)||[];return{metalQty:l.filter(e=>!!e.isMetal).reduce((e,d)=>e+(Number(d.qty)||0),0),nonMetalQty:l.filter(e=>!e.isMetal).reduce((e,d)=>e+(Number(d.qty)||0),0)}}let dD=(null==dp?void 0:null===(l=dp.values)||void 0===l?void 0:null===(d=l.items)||void 0===d?void 0:d.length)>0;async function dO(e){if(e){var d,l;let a=await ds({extension:j.u.DocumentTypeDefault.get,parameters:"_dtId=".concat(e)});return dp.setFieldValue("header.genJobFromDamage",null==a?void 0:null===(d=a.record)||void 0===d?void 0:d.genJobFromDamage),(null==a?void 0:null===(l=a.record)||void 0===l?void 0:l.genJobFromDamage)||!1}dp.setFieldValue("header.genJobFromDamage",!1)}let dJ=async e=>{var d,l;if(!e)return;let a=await ds({extension:j.u.RoutingSequence.qry,parameters:"_routingId=".concat(e)});return(null==a?void 0:null===(l=a.list)||void 0===l?void 0:null===(d=l[0])||void 0===d?void 0:d.seqNo)||null};return(0,a.jsx)(u.Z,{resourceId:v.i.Damages,functionId:x.J.Damage,form:dp,maxAccess:db,previewReport:dP,isPosted:dF,actions:dw,editMode:dP,disabledSubmit:0!=dp.values.header.damagedQty&&!dD||dF,disabledSavedClear:0!=dp.values.header.damagedQty&&!dD||dF,isParentWindow:!1,children:(0,a.jsxs)(f.R,{children:[(0,a.jsx)(k.g,{children:(0,a.jsxs)(o.ZP,{container:!0,spacing:2,paddingTop:1,children:[(0,a.jsx)(o.ZP,{item:!0,xs:3,children:(0,a.jsxs)(o.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(g.Z,{endpointId:y.r.DocumentType.qry,parameters:"_startAt=0&_pageSize=1000&_dgId=".concat(x.J.Damage),name:"header.dtId",label:dy.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:dp.values.header.jobId||dP,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:2,values:dp.values.header,maxAccess:db,onChange:async(e,d)=>{await df(d),await dO(null==d?void 0:d.recordId),dp.setFieldValue("header.dtId",(null==d?void 0:d.recordId)||null)},error:(null==dp?void 0:null===(V=dp.touched)||void 0===V?void 0:null===(J=V.header)||void 0===J?void 0:J.dtId)&&!!(null==dp?void 0:null===(_=dp.errors)||void 0===_?void 0:null===(S=_.header)||void 0===S?void 0:S.dtId)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(m.Z,{name:"header.reference",label:dy.reference,value:null==dp?void 0:null===(M=dp.values)||void 0===M?void 0:null===(A=M.header)||void 0===A?void 0:A.reference,maxAccess:!dP&&db,readOnly:dP,onChange:dp.handleChange,onClear:()=>dp.setFieldValue("header.reference",""),error:(null==dp?void 0:null===(L=dp.touched)||void 0===L?void 0:null===(T=L.header)||void 0===T?void 0:T.reference)&&!!(null==dp?void 0:null===(W=dp.errors)||void 0===W?void 0:null===(E=W.header)||void 0===E?void 0:E.reference)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(n.Z,{name:"header.date",required:!0,label:dy.date,value:null==dp?void 0:null===(z=dp.values)||void 0===z?void 0:null===($=z.header)||void 0===$?void 0:$.date,onChange:dp.setFieldValue,readOnly:dP,maxAccess:db,onClear:()=>dp.setFieldValue("header.date",null),error:(null==dp?void 0:null===(H=dp.touched)||void 0===H?void 0:null===(U=H.header)||void 0===U?void 0:U.date)&&!!(null==dp?void 0:null===(K=dp.errors)||void 0===K?void 0:null===(G=K.header)||void 0===G?void 0:G.date)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(g.Z,{endpointId:y.r.Plant.qry,name:"header.plantId",required:!0,readOnly:dF,label:dy.plant,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:1.5,values:dp.values.header,valueField:"recordId",displayField:["reference","name"],maxAccess:db,onChange:(e,d)=>{dp.setFieldValue("header.plantId",(null==d?void 0:d.recordId)||null)},error:(null==dp?void 0:null===(Y=dp.touched)||void 0===Y?void 0:null===(X=Y.header)||void 0===X?void 0:X.plantId)&&!!(null==dp?void 0:null===(ee=dp.errors)||void 0===ee?void 0:null===(B=ee.header)||void 0===B?void 0:B.plantId)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsxs)(o.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(o.ZP,{item:!0,xs:6,children:(0,a.jsx)(C.Z,{onClick:dC,image:"preview.png",tooltipText:dv.Preview,disabled:0==dp.values.header.damagedQty||dF})}),(0,a.jsx)(o.ZP,{item:!0,xs:6,children:(0,a.jsx)(p.Z,{name:"header.routingSeqNo",label:dy.routingSeqNo,value:null==dp?void 0:null===(el=dp.values)||void 0===el?void 0:null===(ed=el.header)||void 0===ed?void 0:ed.routingSeqNo,maxAccess:db,readOnly:!0})})]})})]})}),(0,a.jsx)(o.ZP,{item:!0,xs:3,children:(0,a.jsxs)(o.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(I.U,{endpointId:j.u.MFJobOrder.snapshot,filter:{status:4},valueField:"reference",displayField:"reference",secondDisplayField:!1,name:"header.jobId",label:dy.jobOrder,form:dp,formObject:dp.values.header,required:!0,readOnly:dD||dP,displayFieldWidth:2,valueShow:"jobRef",maxAccess:db,editMode:dP,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"itemName",value:"Item Name"},{key:"description",value:"Description"}],onChange:async(e,d)=>{let l=await dq(null==d?void 0:d.recordId);dp.setValues({header:{...dp.values.header,jobId:(null==d?void 0:d.recordId)||null,jobRef:(null==d?void 0:d.reference)||"",jobQty:(null==d?void 0:d.qty)||0,jobPcs:(null==d?void 0:d.pcs)||0,sku:(null==d?void 0:d.sku)||"",designRef:(null==d?void 0:d.designRef)||"",designName:(null==d?void 0:d.designName)||"",itemName:(null==d?void 0:d.itemName)||"",workCenterName:(null==d?void 0:d.wcName)||"",workCenterId:(null==d?void 0:d.workCenterId)||null,maxPcs:(null==d?void 0:d.pcs)||0,damageRate:dp.values.qty/(null==d?void 0:d.qty)*100||0,...dp.values.header.genJobFromDamage?{}:{routingName:(null==d?void 0:d.routingName)||"",routingId:(null==d?void 0:d.routingId)||null,routingRef:(null==d?void 0:d.routingRef)||"",routingSeqNo:(null==d?void 0:d.routingSeqNo)||null},metalQty:(null==l?void 0:l.metalQty)||0,nonMetalQty:(null==l?void 0:l.nonMetalQty)||0}})},errorCheck:"header.jobId"})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(I.U,{endpointId:Q.$.Item.snapshot,name:"header.itemId",label:dy.sku,valueField:"recordId",displayField:"name",valueShow:"sku",secondValueShow:"itemName",formObject:dp.values.header,readOnly:!0,maxAccess:db})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(I.U,{endpointId:j.u.Design.snapshot,name:"header.designId",label:dy.designRef,valueField:"recordId",displayField:"name",valueShow:"designRef",secondValueShow:"designName",formObject:dp.values.header,readOnly:!0,maxAccess:db})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(m.Z,{name:"header.workCenterName",label:dy.workCenter,value:null==dp?void 0:null===(en=dp.values)||void 0===en?void 0:null===(ea=en.header)||void 0===ea?void 0:ea.workCenterName,maxAccess:db,readOnly:!0})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(I.U,{endpointId:j.u.Routing.snapshot,valueField:"reference",displayField:"name",name:"header.routingId",label:dy.routing,formObject:dp.values.header,form:dp,minChars:2,firstFieldWidth:5,firstValue:dp.values.header.routingRef,secondValue:dp.values.header.routingName,errorCheck:"header.routingId",maxAccess:db,displayFieldWidth:2,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:dp.values.header.genJobFromDamage,readOnly:!dp.values.header.genJobFromDamage||dF,onChange:async(e,d)=>{let l=await dJ(null==d?void 0:d.recordId);dp.setFieldValue("header.routingSeqNo",l||null),dp.setFieldValue("header.routingRef",(null==d?void 0:d.reference)||null),dp.setFieldValue("header.routingName",(null==d?void 0:d.name)||null),dp.setFieldValue("header.routingId",(null==d?void 0:d.recordId)||null)}})})]})}),(0,a.jsx)(o.ZP,{item:!0,xs:3,children:(0,a.jsxs)(o.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(p.Z,{name:"header.jobQty",label:dy.jobQty,value:null===(eo=dp.values)||void 0===eo?void 0:null===(er=eo.header)||void 0===er?void 0:er.jobQty,onChange:dp.handleChange,onClear:()=>dp.setFieldValue("header.jobQty",0),required:!0,readOnly:!0,maxAccess:db,error:(null==dp?void 0:null===(et=dp.touched)||void 0===et?void 0:null===(ei=et.header)||void 0===ei?void 0:ei.jobQty)&&!!(null==dp?void 0:null===(es=dp.errors)||void 0===es?void 0:null===(eu=es.header)||void 0===eu?void 0:eu.jobQty)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(p.Z,{name:"header.jobPcs",readOnly:!0,label:dy.jobPcs,value:null===(ev=dp.values)||void 0===ev?void 0:null===(ec=ev.header)||void 0===ec?void 0:ec.jobPcs,onChange:dp.handleChange,onClear:()=>dp.setFieldValue("header.jobPcs",0),required:!0,maxAccess:db,error:(null==dp?void 0:null===(eh=dp.touched)||void 0===eh?void 0:null===(em=eh.header)||void 0===em?void 0:em.jobPcs)&&!!(null==dp?void 0:null===(ey=dp.errors)||void 0===ey?void 0:null===(eg=ey.header)||void 0===eg?void 0:eg.jobPcs)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(p.Z,{name:"header.damagedQty",label:dy.damagedQty,value:null===(eI=dp.values)||void 0===eI?void 0:null===(ex=eI.header)||void 0===ex?void 0:ex.damagedQty,onChange:e=>{var d,l;dp.setFieldValue("header.damageRate",e.target.value/(null==dp?void 0:null===(l=dp.values)||void 0===l?void 0:null===(d=l.header)||void 0===d?void 0:d.jobQty)*100||0),dp.setFieldValue("header.damagedQty",e.target.value)},maxLength:11,decimalScale:2,onClear:()=>{dp.setFieldValue("header.damageRate",null),dp.setFieldValue("header.damagedQty",null)},maxAccess:db,readOnly:dD||dF,required:!0,error:(null==dp?void 0:null===(ef=dp.touched)||void 0===ef?void 0:null===(eb=ef.header)||void 0===eb?void 0:eb.damagedQty)&&!!(null==dp?void 0:null===(ej=dp.errors)||void 0===ej?void 0:null===(ep=ej.header)||void 0===ep?void 0:ep.damagedQty)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(p.Z,{name:"header.damagedPcs",readOnly:dD||dF,label:dy.damagedPcs,value:null===(eF=dp.values)||void 0===eF?void 0:null===(eP=eF.header)||void 0===eP?void 0:eP.damagedPcs,decimalScale:0,onChange:dp.handleChange,onClear:()=>dp.setFieldValue("header.damagedPcs",0),required:!0,maxAccess:db,error:(null==dp?void 0:null===(eZ=dp.touched)||void 0===eZ?void 0:null===(ew=eZ.header)||void 0===ew?void 0:ew.damagedPcs)&&!!(null==dp?void 0:null===(ek=dp.errors)||void 0===ek?void 0:null===(eC=ek.header)||void 0===eC?void 0:eC.damagedPcs)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(g.Z,{endpointId:j.u.Labor.qry,parameters:"_startAt=0&_pageSize=200&_params=",name:"header.laborId",label:dy.labor,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:2,required:!0,readOnly:dF,values:dp.values.header,onChange:(e,d)=>{dp.setFieldValue("header.laborId",(null==d?void 0:d.recordId)||null)},error:(null==dp?void 0:null===(eN=dp.touched)||void 0===eN?void 0:null===(eQ=eN.header)||void 0===eQ?void 0:eQ.laborId)&&!!(null==dp?void 0:null===(eq=dp.errors)||void 0===eq?void 0:null===(eR=eq.header)||void 0===eR?void 0:eR.laborId)})})]})}),(0,a.jsx)(o.ZP,{item:!0,xs:3,children:(0,a.jsxs)(o.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsxs)(o.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(o.ZP,{item:!0,xs:6,children:(0,a.jsx)(p.Z,{name:"header.metalQty",label:dy.metalQty,value:null===(eO=dp.values)||void 0===eO?void 0:null===(eD=eO.header)||void 0===eD?void 0:eD.metalQty,onChange:dp.handleChange,onClear:()=>dp.setFieldValue("header.metalQty",null),maxAccess:db,required:!0,readOnly:!0,error:(null==dp?void 0:null===(eV=dp.touched)||void 0===eV?void 0:null===(eJ=eV.header)||void 0===eJ?void 0:eJ.metalQty)&&!!(null==dp?void 0:null===(e_=dp.errors)||void 0===e_?void 0:null===(eS=e_.header)||void 0===eS?void 0:eS.metalQty)})}),(0,a.jsx)(o.ZP,{item:!0,xs:6,children:(0,a.jsx)(p.Z,{name:"header.nonMetalQty",label:dy.nonMetalQty,value:null===(eM=dp.values)||void 0===eM?void 0:null===(eA=eM.header)||void 0===eA?void 0:eA.nonMetalQty,onChange:dp.handleChange,readOnly:!0,onClear:()=>dp.setFieldValue("header.nonMetalQty",null),maxAccess:db,required:!0,error:(null==dp?void 0:null===(eL=dp.touched)||void 0===eL?void 0:null===(eT=eL.header)||void 0===eT?void 0:eT.nonMetalQty)&&!!(null==dp?void 0:null===(eW=dp.errors)||void 0===eW?void 0:null===(eE=eW.header)||void 0===eE?void 0:eE.nonMetalQty)})})]})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsxs)(o.ZP,{container:!0,spacing:2,children:[(0,a.jsx)(o.ZP,{item:!0,xs:6,children:(0,a.jsx)(p.Z,{name:"header.netJobQty",label:dy.netJobQty,value:dk-dQ,onChange:dp.handleChange,onClear:()=>dp.setFieldValue("header.netJobQty",null),maxAccess:db,readOnly:!0,required:!0,error:(null==dp?void 0:null===(ez=dp.touched)||void 0===ez?void 0:null===(e$=ez.header)||void 0===e$?void 0:e$.netJobQty)&&!!(null==dp?void 0:null===(eH=dp.errors)||void 0===eH?void 0:null===(eU=eH.header)||void 0===eU?void 0:eU.netJobQty)})}),(0,a.jsx)(o.ZP,{item:!0,xs:6,children:(0,a.jsx)(p.Z,{name:"header.netJobPcs",label:dy.netJobPcs,value:dN-dR,onChange:dp.handleChange,onClear:()=>dp.setFieldValue("header.netJobPcs",null),maxAccess:db,readOnly:!0,required:!0,error:(null==dp?void 0:null===(eK=dp.touched)||void 0===eK?void 0:null===(eG=eK.header)||void 0===eG?void 0:eG.netJobPcs)&&!!(null==dp?void 0:null===(eY=dp.errors)||void 0===eY?void 0:null===(eX=eY.header)||void 0===eX?void 0:eX.netJobPcs)})})]})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(m.Z,{name:"header.generatedJobRef",label:dy.generatedJobRef,value:null===(e0=dp.values)||void 0===e0?void 0:null===(eB=e0.header)||void 0===eB?void 0:eB.generatedJobRef,maxAccess:db,onChange:dp.handleChange,readOnly:!0,onClear:()=>dp.setFieldValue("header.generatedJobRef",""),error:(null===(e1=dp.touched)||void 0===e1?void 0:null===(e2=e1.header)||void 0===e2?void 0:e2.generatedJobRef)&&!!(null===(e4=dp.errors)||void 0===e4?void 0:null===(e5=e4.header)||void 0===e5?void 0:e5.generatedJobRef)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(g.Z,{endpointId:j.u.DamageReason.qry,name:"header.reasonId",label:dy.damageReason,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:dF,values:dp.values.header,maxAccess:db,onChange:(e,d)=>{dp.setFieldValue("header.reasonId",(null==d?void 0:d.recordId)||null)},error:(null==dp?void 0:null===(e3=dp.touched)||void 0===e3?void 0:null===(e6=e3.header)||void 0===e6?void 0:e6.reasonId)&&(null==dp?void 0:null===(e7=dp.errors)||void 0===e7?void 0:null===(e8=e7.header)||void 0===e8?void 0:e8.reasonId)})}),(0,a.jsx)(o.ZP,{item:!0,xs:12,children:(0,a.jsx)(g.Z,{endpointId:j.u.DamageCategory.qry,name:"header.categoryId",label:dy.damageCategory,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:dp.values.header,maxAccess:db,readOnly:dF,onChange:(e,d)=>{dp.setFieldValue("header.categoryId",(null==d?void 0:d.recordId)||null)},error:(null==dp?void 0:null===(de=dp.touched)||void 0===de?void 0:null===(e9=de.header)||void 0===e9?void 0:e9.categoryId)&&(null==dp?void 0:null===(dl=dp.errors)||void 0===dl?void 0:null===(dd=dl.header)||void 0===dd?void 0:dd.categoryId)})})]})})]})}),(0,a.jsx)(b.Q,{children:(0,a.jsx)(Z.Z,{name:"damageTable",columns:dZ,gridData:{list:dp.values.items},rowId:["recordId"],pagination:!1,maxAccess:dx})}),(0,a.jsx)(k.g,{children:(0,a.jsx)(o.ZP,{container:!0,spacing:2,paddingTop:1,children:(0,a.jsx)(o.ZP,{item:!0,xs:4,children:(0,a.jsx)(h.Z,{name:"header.notes",label:dy.remarks,value:dp.values.header.notes,rows:4,editMode:dP,readOnly:dF,maxAccess:db,onChange:e=>dp.setFieldValue("header.notes",e.target.value),onClear:()=>dp.setFieldValue("header.notes",""),error:(null==dp?void 0:null===(dn=dp.touched)||void 0===dn?void 0:null===(da=dn.header)||void 0===da?void 0:da.notes)&&!!(null===(di=dp.errors)||void 0===di?void 0:null===(dr=di.header)||void 0===dr?void 0:dr.notes)})})})})]})})}},39704:function(e,d,l){"use strict";var a=l(52322),n=l(2784),r=l(22341),o=l(65950),i=l(85325),t=l(21326),u=l(19473),s=l(35656),c=l(24868),v=l.n(c);let m=e=>{let{functionId:d,recordId:l,window:c}=e,{getRequest:m}=(0,n.useContext)(o.$),{languageId:h}=(0,n.useContext)(i.V),{platformLabels:g}=(0,n.useContext)(u.l),y=l+"-"+d;(0,t.Z)({title:g.WorkFlow,window:c});let{width:x}=(0,s.d)(),I=x<=1024,b=x>1024&&x<=1280,f=I?10:b?12:14,p=I?75:b?85:95,j=I?15:b?20:25,P=async()=>{var e="_functionId=".concat(d,"&_recordId=").concat(l);let a=await m({extension:r.P.WorkFlow.graph,parameters:e});return null==a?void 0:a.record},F=e=>{let d=[],l=[],a="",n="";return e.objects.forEach(e=>{d.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(d=>{e.objects.forEach(e=>{let l=e.functionName.split(" ").join("\r\n");d.parentId===e.recordId&&d.parentFunctionId===e.functionId&&(a=e.reference+"\r\n"+e.date+"\r\n"+l,d.parentId),d.childId===e.recordId&&d.childFunctionId===e.functionId&&(n=e.reference+"\r\n"+e.date+"\r\n"+l,d.childId)}),""===a||""===n||l.push({from:a,to:n,value:1,labelText:""}),a="",n=""}),l};return(0,n.useEffect)(()=>{!async function(){var e=await P();if(e){let d=(e,d)=>{let l=document.createElement("script");l.type="text/javascript",l.src=e,l.async=!0,l.onload=d,document.head.appendChild(l)};d("https://cdn.amcharts.com/lib/4/core.js",()=>{d("https://cdn.amcharts.com/lib/4/charts.js",()=>{d("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let d=am4core.create(y,am4charts.SankeyDiagram),l=F(e);d.data=l,d.dataFields.fromName="from",d.dataFields.toName="to",d.dataFields.value="value",d.paddingRight=2===h?0:40,d.paddingLeft=2===h?40:0,d.tooltip.label.fontSize=f;let a=d.nodes.template;a.draggable=!1,a.inert=!0,a.clickable=!1,a.width=p,a.height=j,a.nameLabel.label.fontSize=f,a.nameLabel.locationX=2===h?.85:0,a.nameLabel.height=void 0,a.nameLabel.label.fontWeight="bold";let n=d.links.template;n.middleLine.strokeOpacity=.3,n.middleLine.stroke=am4core.color("#555"),n.middleLine.strokeWidth=5,n.middleLine.hoverable=!1,n.fillOpacity=0,n.hoverable=!0,n.hoverOnFocus=!0,n.fill=am4core.color("#A8C686"),n.isHover=!0,d.appear(1e3,100)})})})})}}()},[]),(0,a.jsx)("div",{id:y,className:v().root})};m.width=950,d.Z=m},24868:function(e){e.exports={root:"WorkFlow_root__EINm1"}}}]);