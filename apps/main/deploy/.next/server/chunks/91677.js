exports.id=91677,exports.ids=[91677],exports.modules={44982:e=>{e.exports={container:"ImageUpload_container__I2BWx",previewBox:"ImageUpload_previewBox__JogCN",previewImage:"ImageUpload_previewImage___eqQX",bottomSection:"ImageUpload_bottomSection__jpph8"}},51613:e=>{e.exports={tabPanel:"CustomTabPanel_tabPanel__80Dfu",active:"CustomTabPanel_active___6Uvb",hidden:"CustomTabPanel_hidden__y9566"}},75716:e=>{e.exports={customTabPanel:"CustomTabs_customTabPanel__Ztocv",hidden:"CustomTabs_hidden__lZpM7",tabsContainer:"CustomTabs_tabsContainer__28Syi",tabsWrapper:"CustomTabs_tabsWrapper__mlxxj",tabs:"CustomTabs_tabs__25pli",tabName:"CustomTabs_tabName__XzMCn",tabRoot:"CustomTabs_tabRoot__WVR1E",tabDisabled:"CustomTabs_tabDisabled__VauYR",selectedTab:"CustomTabs_selectedTab__sZzwF",tabsIndicator:"CustomTabs_tabsIndicator__89Lek",refreshButton:"CustomTabs_refreshButton__P2mzl",refreshIcon:"CustomTabs_refreshIcon__ADVWF"}},27960:(e,a,r)=>{"use strict";r.a(e,async(e,t)=>{try{r.d(a,{Z:()=>F});var s=r(20997),l=r(99155),d=r.n(l),n=r(16689),i=r(75609),o=r(80582),c=r(86201),u=r(29352),m=r(6416),x=r(79660),h=r(71278),p=r(95965),b=r(23385),y=r(18611),I=r(60520),f=r(59636),j=r(97969),v=r(38509),g=r(68728),w=r(65980),C=r(44619),k=r(27736),N=r(42020),_=r(15051),A=r(54242),O=r(91184),Z=r(86794),q=e([o,c,u,h,I,v,_,Z]);function F({labels:e,access:a,recordId:r,wsId:t,values:l,isPosted:q}){let{getRequest:F,postRequest:R}=(0,n.useContext)(u.$),{platformLabels:$,defaultsData:P}=(0,n.useContext)(I.l),T=g.J.IssueOfMaterial,D=m.i.IssueOfMaterials,V=e=>P.list.find(a=>a.key===e)?.value||0,Q=e=>V(`ivtDimension${P.list.find(a=>a.key===e)?.value}`),S=["mfimd1","mfimd2"],W=S.map(e=>Number(V(e))),{documentType:M,maxAccess:J,changeDT:B}=(0,Z.H)({functionId:T,access:a,enabled:!r}),L=(0,v.E)({endpointId:f.u.WorksheetMaterials.qry}),{formik:E}=(0,p.c)({documentType:{key:"header.dtId",value:M?.dtId},initialValues:{recordId:r,header:{jobId:l.jobId,notes:"",siteId:l.siteId,status:1,worksheetId:t,dtId:null,currencyId:null,operationId:null,type:null,reference:"",wsJobRef:l.reference,joJobRef:l.jobRef,date:l.date,pgItemName:l.pgItemName,laborName:l.laborName,wipQty:l.wipQty||0,wipPcs:l.wipPcs||0},items:[{id:1,imaId:r||0,worksheetId:t,seqNo:1,itemId:null,sku:"",itemName:"",unitCost:0,trackBy:0,qty:0,pcs:0}]},maxAccess:J,validateOnChange:!0,validationSchema:i.object({header:i.object({operationId:i.number().required(),type:i.number().required()}),items:i.array().of(i.object({sku:i.string().required(),itemName:i.string().required(),qty:i.number().required()}))}),onSubmit:async e=>{let a={...e,jobId:l.jobId,siteId:l.siteId,date:l.date,items:e?.items?.map((e,a)=>({...e,imaId:r||0,unitCost:e.unitCost||0,seqNo:a+1}))},t=await R({extension:f.u.WorksheetMaterials.set2,record:JSON.stringify(a)}),s=[];for(let e of a.items){let{seqNo:a}=e;W.forEach((r,l)=>{let d=`dim${l+1}Id`,n=`dimensionName${l+1}`;e[d]&&s.push({imaId:t.recordId,seqNo:a,dimension:r,dimensionName:e[n],id:e[d]})})}for(let e of s)await R({extension:f.u.IssueOfMaterialDimension.set,record:JSON.stringify(e)});c.default.success(e.recordId?$.Edited:$.Added),L(),await z(t.recordId)}}),z=async e=>{if(!e)return;let a=await F({extension:f.u.WorksheetMaterials.pack,parameters:`_recordId=${e}`}),r=a?.record?.header||{},t=a?.record?.items||[],s=await Promise.all(t.map(async(e,r)=>{let t=((a?.record?.dimensions||[]).filter(a=>a?.seqNo===e?.seqNo)||[]).sort((e,a)=>e.dimension-a.dimension),s={};return t.forEach(e=>{let a=W.findIndex(a=>a===e.dimension);if(-1!==a){let r=a+1;s[`dim${r}Id`]=e.id,s[`dimensionName${r}`]=e.dimensionName}}),{id:r+1,...e,...s}}));l&&E.setValues({recordId:e,header:{...E.values.header,...r,siteId:l.siteId,wsJobRef:l.reference,joJobRef:l.jobRef,date:l.date,pgItemName:l.pgItemName,laborName:l.laborName,wipQty:l.wipQty,wipPcs:l.wipPcs,jobId:l.jobId},items:s})};async function U(e,a){if(1==e){let e=await F({extension:f.u.DesignRawMaterial.qry2,parameters:`_jobId=${l.jobId}&_operationId=${a}&_pcs=${l.wipPcs}`});E.setFieldValue("items",e?.list?.map(({...e},a)=>({id:a+1,...e,pcs:e.pcs||0,qty:e.qty||0}))||E.values.items)}}let Y=!!E?.values?.header?.recordId,G=E.values?.items?.reduce((e,a)=>e+(parseFloat(a.qty)||0),0)??0,H=E.values?.items?.reduce((e,a)=>e+(parseFloat(a.pcs)||0),0)??0,X=E.values.items?.reduce((e,{designQty:a=0})=>e+(Number(a)||0),0)??0,K=E.values.items?.reduce((e,{designPcs:a=0})=>e+(Number(a)||0),0)??0,ee=W.map((e,a)=>e?{component:"resourcecombobox",label:Q(S[a]),name:`dimensionName${a+1}`,props:{endpointId:A.$.Dimension.qry,dynamicParams:`_dimension=${e}`,valueField:"id",displayField:"name",mapping:[{from:"id",to:`dim${a+1}Id`},{from:"name",to:`dimensionName${a+1}`}],displayFieldWidth:2}}:null).filter(Boolean);return s.jsx(o.Z,{resourceId:D,form:E,maxAccess:J,editMode:Y,disabledSubmit:q,children:(0,s.jsxs)(y.R,{children:[s.jsx(N.g,{children:(0,s.jsxs)(d(),{container:!0,spacing:2,children:[s.jsx(d(),{item:!0,xs:4,children:s.jsx(h.Z,{endpointId:x.r.DocumentType.qry,parameters:`_startAt=0&_pageSize=1000&_dgId=${T}`,name:"dtId",label:e.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:E.values.header,maxAccess:J,onChange:(e,a)=>{E.setFieldValue("header.dtId",a?.recordId||""),B(a)},readOnly:Y,error:E.touched.header?.dtId&&!!E.errors.dtId})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(C.Z,{name:"wsJobRef",label:e.wsJobRef,value:E.values.header.wsJobRef,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(C.Z,{name:"laborName",label:e.labor,value:E.values.header.laborName,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(C.Z,{name:"reference",label:e.reference,value:E.values.header.reference,rows:2,maxAccess:J,onChange:E.handleChange,readOnly:Y,onClear:()=>E.setFieldValue("header.reference",""),error:E.touched.header?.reference&&!!E.errors.reference})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(C.Z,{name:"joJobRef",label:e.joJobRef,value:E.values.header.joJobRef,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(C.Z,{name:"wipQty",label:e.wsQty,value:E.values.header.wipQty,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(h.Z,{endpointId:f.u.Operation.qry,parameters:`_workCenterId=${l.workCenterId}&_startAt=0&_pageSize=100&`,name:"operationId",label:e.operation,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:!0,valueField:"recordId",displayField:["reference","name"],values:E.values.header,maxAccess:J,readOnly:q,onChange:(e,a)=>{E.setFieldValue("header.operationId",a?.recordId||null),a?.recordId&&E.values.header.type&&U(E.values.header.type,a?.recordId)},error:E.touched.header?.operationId&&!!E.errors.header?.operationId})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(k.Z,{name:"date",label:e.date,value:E.values.header.date,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(C.Z,{name:"wipPcs",label:e.wsPcs,value:E.values.header.wipPcs,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(h.Z,{datasetId:j.v.MF_IOM_TYPE,name:"type",label:e.type,valueField:"key",displayField:"value",values:E.values.header,required:!0,readOnly:Y,maxAccess:J,onChange:(e,a)=>{E.setFieldValue("header.type",a?.key||null),a?.key&&E.values.header.operationId&&U(a?.key,E.values.header.operationId)},error:E.touched.header?.type&&!!E.errors.header?.type})}),s.jsx(d(),{item:!0,xs:4,children:s.jsx(C.Z,{name:"pgItemName",label:e.pgItem,value:E.values.header.pgItemName,readOnly:!0,maxAccess:J})})]})}),s.jsx(b.Q,{children:s.jsx(_._,{onChange:e=>E.setFieldValue("items",e),name:"items",value:E.values.items,error:E.errors.items,maxAccess:a,columns:[{component:"resourcelookup",label:e.sku,name:"sku",props:{endpointId:A.$.Materials.snapshot,valueField:"recordId",displayField:"sku",mandatory:!0,displayFieldWidth:3,mapping:[{from:"recordId",to:"itemId"},{from:"sku",to:"sku"},{from:"name",to:"itemName"}],columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"}]},async onChange({row:{update:e,newRow:a}}){if(a?.itemId){let r=await F({extension:A.$.CurrentCost.get,parameters:`_itemId=${a?.itemId}`}),t=await F({extension:A.$.ItemProduction.get,parameters:`_recordId=${a?.itemId}`});e({unitCost:r?.record?.unitCost||0,rmCategoryName:t?.record?.rmcName})}}},{component:"textfield",label:e.item,name:"itemName",props:{readOnly:!0}},{component:"textfield",label:e.rawCategory,name:"rmCategoryName",props:{readOnly:!0}},{component:"numberfield",label:e.lot,name:"lotCategoryId",props:{readOnly:!0}},{component:"numberfield",label:e.expectedQty,name:"designQty",props:{readOnly:!0}},{component:"numberfield",label:e.expectedPcs,name:"designPcs",props:{readOnly:!0}},...ee,{component:"numberfield",label:e.quantity,name:"qty",props:{maxLength:10}},{component:"numberfield",label:e.pieces,name:"pcs",props:{decimalScale:0}}],disabled:q,allowDelete:!q,allowAddNewLine:!q})}),s.jsx(N.g,{children:(0,s.jsxs)(d(),{container:!0,spacing:2,children:[s.jsx(d(),{item:!0,xs:3,children:s.jsx(w.Z,{name:"notes",label:e.notes,value:E.values.header.notes,rows:2,maxLength:"100",editMode:Y,readOnly:q,maxAccess:J,onChange:e=>E.setFieldValue("header.notes",e.target.value),onClear:()=>E.setFieldValue("header.notes","")})}),s.jsx(d(),{item:!0,xs:1}),s.jsx(d(),{item:!0,xs:2,children:s.jsx(O.Z,{name:"totalExpQty",label:e.totalExpQty,value:X,readOnly:!0})}),s.jsx(d(),{item:!0,xs:2,children:s.jsx(O.Z,{name:"totalExpPcs",label:e.totalExpPcs,value:K,readOnly:!0})}),s.jsx(d(),{item:!0,xs:2,children:s.jsx(O.Z,{name:"totalQty",label:e.totalQty,value:G,readOnly:!0})}),s.jsx(d(),{item:!0,xs:2,children:s.jsx(O.Z,{name:"totalPcs",label:e.totalPcs,value:H,readOnly:!0})})]})})]})})}[o,c,u,h,I,v,_,Z]=q.then?(await q)():q,t()}catch(e){t(e)}})},82404:(e,a,r)=>{"use strict";r.a(e,async(e,t)=>{try{r.d(a,{Z:()=>k});var s=r(20997),l=r(16689),d=r(29352),n=r(59636),i=r(86201),o=r(40711),c=r(18611),u=r(23385),m=r(42020),x=r(60520),h=r(24644),p=r(677),b=r(38509),y=r(6416),I=r(27960),f=r(86794),j=r(68728),v=r(99155),g=r.n(v),w=r(91184),C=e([d,i,o,x,h,p,b,I,f]);[d,i,o,x,h,p,b,I,f]=C.then?(await C)():C;let k=({store:e})=>{let{platformLabels:a}=(0,l.useContext)(x.l),{recordId:r,isPosted:t,values:v}=e,{getRequest:C,postRequest:k}=(0,l.useContext)(d.$),{stack:N}=(0,p.zY)(),{query:{data:_},invalidate:A,labels:O,access:Z}=(0,b.J)({queryFn:F,endpointId:n.u.WorksheetMaterials.qry,datasetId:y.i.IssueOfMaterials,enabled:!!r}),q=[{field:"reference",headerName:O.reference,flex:1},{field:"date",headerName:O.date,flex:1,type:"date"},{field:"typeName",headerName:O.type,flex:1},{field:"operationName",headerName:O.operation,flex:1},{field:"qty",headerName:O.qty,flex:1,type:{field:"number",decimal:2}},{field:"notes",headerName:O.notes,flex:1}];async function F(){return await C({extension:n.u.WorksheetMaterials.qry,parameters:`_worksheetId=${r}`})}let R=async e=>{await k({extension:n.u.WorksheetMaterials.del,record:JSON.stringify(e)}),A(),i.default.success(a.Deleted)},{proxyAction:$}=(0,f.G)({functionId:j.J.IssueOfMaterial,action:P});function P(e){N({Component:I.Z,props:{labels:O,recordId:e?.recordId,wsId:r,isPosted:t,access:Z,values:v},width:1200,height:700,title:O.issueOfMaterials})}let T=async()=>{await $()},D=_?.list?.reduce((e,a)=>{let r=parseFloat(a?.qty?.toString().replace(/,/g,""))||0;return e+r},0);return(0,s.jsxs)(c.R,{children:[s.jsx(m.g,{children:s.jsx(h.Z,{maxAccess:Z,labels:O,onAdd:T,disableAdd:t})}),s.jsx(u.Q,{children:s.jsx(o.Z,{name:"MaterialsTable",columns:q,gridData:_,rowId:["recordId"],isLoading:!1,onDelete:t?null:R,onEdit:e=>{P(e)},maxAccess:Z,pagination:!1})}),s.jsx(m.g,{children:s.jsx(g(),{container:!0,padding:4,children:s.jsx(g(),{item:!0,xs:2,children:s.jsx(w.Z,{name:"totalQty",label:O.totalQty,value:D,readOnly:!0})})})})]})};t()}catch(e){t(e)}})},46900:(e,a,r)=>{"use strict";r.a(e,async(e,t)=>{try{r.d(a,{Z:()=>I});var s=r(20997),l=r(99155),d=r.n(l),n=r(16689),i=r(29352),o=r(38509),c=r(6416),u=r(18611),m=r(23385),x=r(59636),h=r(91184),p=r(42020),b=r(40711),y=e([i,o,b]);function I({store:e,labels:a,access:r}){let{getRequest:t}=(0,n.useContext)(i.$),{recordId:l}=e,y=c.i.Worksheet,{query:{data:I}}=(0,o.J)({queryFn:f,endpointId:x.u.Worksheet.summary,datasetId:y,params:{disabledReqParams:!0,maxAccess:r},enabled:!!l});async function f(){return await t({extension:x.u.Worksheet.summary,parameters:`_worksheetId=${l}`})}let j=I?I.list.reduce((e,a)=>e+a?.issued_qty,0):0,v=I?I.list.reduce((e,a)=>e+a?.lost_qty,0):0,g=I?I.list.reduce((e,a)=>e+a?.returned_qty,0):0,w=I?I.list.reduce((e,a)=>e+a?.consumed_qty,0):0;return(0,s.jsxs)(u.R,{children:[s.jsx(m.Q,{children:s.jsx(b.Z,{name:"operationTable",gridData:I,maxAccess:r,columns:[{field:"operationRef",headerName:a.operationRef,flex:1},{field:"operationName",headerName:a.operationName,flex:2},{field:"categoryName",headerName:a.category,flex:2},{field:"issued_qty",headerName:a.issued,type:"number",flex:1},{field:"returned_qty",headerName:a.returned,type:"number",flex:1},{field:"lost_qty",headerName:a.loss,type:"number",flex:1},{field:"consumed_qty",headerName:a.consumed,type:"number",flex:1}],rowId:["operationId"],pagination:!1})}),s.jsx(p.g,{children:(0,s.jsxs)(d(),{container:!0,spacing:1,sx:{pt:2},children:[s.jsx(d(),{item:!0,xs:6.8}),s.jsx(d(),{item:!0,xs:5,children:(0,s.jsxs)(d(),{container:!0,spacing:2,children:[s.jsx(d(),{item:!0,xs:3,children:s.jsx(h.Z,{name:"totalIssued",value:j,label:a.totalIssued,readOnly:!0})}),s.jsx(d(),{item:!0,xs:3,children:s.jsx(h.Z,{name:"totalLoss",label:a.totalLoss,value:v,readOnly:!0})}),s.jsx(d(),{item:!0,xs:3,children:s.jsx(h.Z,{name:"totalReturned",label:a.totalReturned,value:g,readOnly:!0})}),s.jsx(d(),{item:!0,xs:3,children:s.jsx(h.Z,{name:"totalConsumed",label:a.totalConsumed,value:w,readOnly:!0})}),s.jsx(d(),{item:!0,xs:.2})]})})]})})]})}[i,o,b]=y.then?(await y)():y,t()}catch(e){t(e)}})},43557:(e,a,r)=>{"use strict";r.a(e,async(e,t)=>{try{r.d(a,{Z:()=>P});var s=r(20997),l=r(99155),d=r.n(l),n=r(16689),i=r(75609),o=r(80582),c=r(86201),u=r(29352),m=r(38509),x=r(6416),h=r(528),p=r(95965),b=r(44619),y=r(71278),I=r(18611),f=r(60520),j=r(54242),v=r(59636),g=r(61274);r(79660);var w=r(91184),C=r(27736),k=r(76788),N=r(42020),_=r(65980),A=r(86794),O=r(79390),Z=r(68728),q=r(18489),F=r(677),R=r(70638),$=e([o,c,u,m,h,y,f,g,A,q,F,R]);function P({labels:e,maxAccess:a,setStore:r,store:t,joInvalidate:l}){let{platformLabels:$}=(0,n.useContext)(f.l),{getRequest:P,postRequest:T}=(0,n.useContext)(u.$),{recordId:D}=t,{stack:V}=(0,F.zY)(),Q=Z.J.Worksheet,S=x.i.Worksheet,W=!!D,{documentType:M,access:J,changeDT:B}=(0,A.H)({functionId:Q,access:a,enabled:!D}),L=(0,m.E)({endpointId:v.u.Worksheet.page}),{formik:E}=(0,p.c)({documentType:{key:"dtId",value:M?.dtId},initialValues:{recordId:null,seqNo:1,dtId:null,reference:"",designRef:"",status:1,releaseStatus:null,date:new Date,jobId:null,workCenterId:null,laborId:null,siteId:null,notes:"",qty:0,routingId:null,wipQty:0,rmQty:0,wipPcs:0,duration:0,jobQty:0,jobPcs:0,startTime:null,endTime:null,wgtBefore:null,wgtAfter:null,eopQty:0,damagedPcs:null,shiftId:null,category:"",pgItemName:"",itemCategoryName:""},maxAccess:J,validationSchema:i.object({jobId:i.number().required(),workCenterId:i.number().required(),laborId:i.number().required(),wipQty:i.number().required(),siteId:i.number().required(),qty:i.number().required(),jobQty:i.number().required()}),onSubmit:async e=>{let a={...e,date:(0,O.ku)(e?.date),startTime:(0,O.ku)(new Date),endTime:(0,O.ku)(new Date)};await T({extension:v.u.Worksheet.set,record:JSON.stringify({...a})}).then(async t=>{e.recordId||r(e=>({...e,recordId:t?.recordId,isPosted:t?.status==3,values:a})),z(t.recordId),c.default.success(e.recordId?$.Edited:$.Added),l?l():L()})}}),z=async e=>{await P({extension:v.u.Worksheet.get,parameters:`_recordId=${e||E.values.recordId}`}).then(async e=>{let a=await P({extension:v.u.WorkCenter.get,parameters:`_recordId=${e?.record?.workCenterId}`});E.setValues({...e?.record,date:(0,O.a1)(e?.record?.date),startTime:(0,O.a1)(e?.record?.startTime),endTime:(0,O.a1)(e?.record?.endTime),siteId:a?.record?.siteId}),r(r=>({...r,isPosted:e?.record?.status==3,values:{...e?.record,siteId:a?.record?.siteId,date:(0,O.a1)(e?.record?.date)}}))})},U=3===E.values.status,Y=async()=>{V({Component:R.Z,props:{functionId:Q,recordId:E.values.recordId}})},G=async()=>{let e={...E.values,date:(0,O.ku)(E?.values?.date)||null};await T({extension:v.u.Worksheet.post,record:JSON.stringify(e)}).then(async()=>{await z(),l?l():L(),c.default.success($.Posted)})},H=[{key:"WorkFlow",condition:!0,onClick:Y,disabled:!W||U},{key:"Unlocked",condition:!U,onClick:G,disabled:!W},{key:"Locked",condition:U,disabled:!0},{key:"IV",condition:!0,onClick:"onInventoryTransaction",disabled:!W||!U},{key:"GL",condition:!0,onClick:"onClickGL",datasetId:x.i.GLWorksheet,disabled:!W},{key:"Damage",condition:!0,onClick:()=>{V({Component:q.Z,props:{jobId:E?.values?.jobId},width:1e3,height:700,title:e.Damage})},disabled:!W}],X=async e=>{if(e){let a=await P({extension:v.u.DocumentTypeDefault.get,parameters:`_dtId=${e}`}),r=a.record&&await P({extension:v.u.WorkCenter.get,parameters:`_recordId=${a?.record?.workCenterId}`});E.setFieldValue("dtId",e||null),E.setFieldValue("siteName",r?.record?.siteName||""),E.setFieldValue("siteId",r?.record?.siteId||null),E.setFieldValue("workCenterId",a?.record?.workCenterId||null)}else E.setFieldValue("dtId",null),E.setFieldValue("siteId",null),E.setFieldValue("siteName",""),E.setFieldValue("laborId",null),E.setFieldValue("workCenterId",null)};return s.jsx(o.Z,{resourceId:S,functionId:Q,form:E,maxAccess:J,editMode:W,actions:H,previewReport:!0,disabledSubmit:U,children:s.jsx(I.R,{children:s.jsx(N.g,{children:(0,s.jsxs)(d(),{container:!0,children:[s.jsx(d(),{item:!0,xs:8,children:(0,s.jsxs)(d(),{container:!0,spacing:2,children:[s.jsx(d(),{item:!0,xs:12,children:s.jsx(y.Z,{endpointId:v.u.Worksheet.pack,reducer:e=>e?.record?.documentTypes,name:"dtId",label:e.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:E.values,maxAccess:J,onChange:async(e,a)=>{await X(a?.recordId),E.setFieldValue("dtId",a?.recordId||null),B(a)},readOnly:W,error:E.touched.dtId&&!!E.errors.dtId})}),s.jsx(d(),{item:!0,xs:6,children:(0,s.jsxs)(d(),{container:!0,spacing:2,children:[s.jsx(d(),{item:!0,xs:12,children:s.jsx(b.Z,{name:"reference",label:e.reference,value:E.values.reference,readOnly:W,maxLength:"15",maxAccess:!W&&J,onChange:E.handleChange,onClear:()=>E.setFieldValue("reference",""),error:E.touched.reference&&!!E.errors.reference})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(g.U,{endpointId:v.u.MFJobOrder.snapshot2,parameters:{_workCenterId:E.values.workCenterId},name:"jobRef",label:e.jobRef,valueField:"jobRef",displayField:"jobRef",valueShow:"jobRef",columnsInDropDown:[{key:"jobRef",value:"Job Order"},{key:"designRef",value:"Design Ref"}],readOnly:!E?.values?.workCenterId||U||W,required:!0,secondDisplayField:!1,form:E,onChange:async(e,a)=>{if(!a?.jobId)return;let r=await P({extension:v.u.MFJobOrder.get,parameters:`_recordId=${a?.jobId}`});if(E.setValues({...E.values,jobId:a?.jobId||null,jobRef:a?.jobRef||"",routingId:r?.record?.routingId||null,designRef:r?.record?.designRef||"",pgItemName:r?.record?.itemName||"",pgItemId:r?.record?.itemId||null,category:r?.record?.categoryName||"",jobQty:a?.qty||0,jobPcs:a?.pcs||0,wipQty:a?.qty||0,wipPcs:a?.pcs||0,seqNo:r?.record?.routingSeqNo||1,laborId:null,laborRef:"",laborName:""}),r?.record?.itemId){let e=await P({extension:j.$.Item.get,parameters:`_recordId=${r?.record?.itemId}`});E.setFieldValue("itemCategoryName",e?.record?.categoryName||null)}},errorCheck:"jobId",maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(y.Z,{endpointId:v.u.Worksheet.pack,reducer:e=>e?.record?.workCenters,name:"workCenterId",label:e.workCenter,readOnly:!0,valueField:"recordId",displayField:["reference","name"],values:E.values,required:!0,maxAccess:J,error:E.touched.workCenterId&&E.errors.workCenterId})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(y.Z,{endpointId:E.values.workCenterId&&v.u.Labor.qry2,parameters:`_workCenterId=${E.values.workCenterId}`,name:"laborId",label:e.labor,required:!0,maxAccess:J,readOnly:!E.values.workCenterId||U,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:E.values,onChange:(e,a)=>{E.setFieldValue("laborId",a?.recordId||null)},error:E.touched.laborId&&!!E.errors.laborId})}),s.jsx(d(),{item:!0,xs:6,children:s.jsx(w.Z,{name:"wipQty",required:!0,readOnly:U||W,label:e.qty,value:E?.values?.wipQty,maxAccess:J,onChange:E.handleChange,onClear:()=>E.setFieldValue("wipQty",0),error:E.touched.wipQty&&!!E.errors.wipQty,decimalScale:3})}),s.jsx(d(),{item:!0,xs:6,children:s.jsx(w.Z,{name:"wipPcs",readOnly:U||W,label:e.pcs,value:E?.values?.wipPcs,maxAccess:J,onChange:E.handleChange,onClear:()=>E.setFieldValue("wipPcs",0),error:E.touched.wipPcs&&!!E.errors.wipPcs,decimalScale:3})}),s.jsx(d(),{item:!0,xs:6,children:s.jsx(w.Z,{name:"rmQty",readOnly:!0,label:e.rmQty,value:E?.values?.rmQty,maxAccess:J})}),s.jsx(d(),{item:!0,xs:6,children:s.jsx(w.Z,{name:"damagedPcs",readOnly:!0,label:e.damagedPcs,value:E?.values?.damagedPcs,maxAccess:J})}),s.jsx(d(),{item:!0,xs:6,children:s.jsx(w.Z,{name:"eopQty",readOnly:!0,label:e.eopQty,value:E?.values?.eopQty,maxAccess:J})}),s.jsx(d(),{item:!0,xs:6,children:s.jsx(w.Z,{name:"endPcs",readOnly:!0,label:e.endPcs,value:(E?.values?.wipPcs||0)-(E?.values?.damagedPcs||0),maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(_.Z,{name:"notes",readOnly:U,label:e.notes,value:E.values.notes,rows:3,maxLength:"100",editMode:W,maxAccess:J,onChange:e=>E.setFieldValue("notes",e.target.value),onClear:()=>E.setFieldValue("notes","")})})]})}),s.jsx(d(),{item:!0,xs:6,children:(0,s.jsxs)(d(),{container:!0,spacing:2,children:[s.jsx(d(),{item:!0,xs:12,children:s.jsx(b.Z,{name:"pgItemName",label:e.pgItem,value:E.values.pgItemName,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(b.Z,{name:"itemCategoryName",label:e.itemCategory,value:E.values.itemCategoryName,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(b.Z,{name:"category",label:e.jobCategory,value:E.values.category,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(y.Z,{endpointId:v.u.Worksheet.pack,reducer:e=>e?.record?.sites,name:"siteId",label:e.site,required:!0,readOnly:!0,values:E.values,displayField:"name",maxAccess:J,error:E.touched.siteId&&!!E.errors.siteId})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(b.Z,{name:"designRef",label:e.designRef,value:E.values.designRef,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(w.Z,{name:"jobQty",label:e.jobQty,value:E.values.jobQty,required:!0,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(w.Z,{name:"jobPcs",label:e.jobPcs,value:E.values.jobPcs,readOnly:!0,maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(w.Z,{name:"wgtBefore",readOnly:U,label:e.wgtBefore,value:E?.values?.wgtBefore,maxAccess:J,onChange:E.handleChange,onClear:()=>E.setFieldValue("wgtBefore",""),error:E.touched.wgtBefore&&!!E.errors.wgtBefore,decimalScale:3})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(w.Z,{name:"wgtAfter",readOnly:U,label:e.wgtAfter,value:E?.values?.wgtAfter,maxAccess:J,onChange:E.handleChange,onClear:()=>E.setFieldValue("wgtAfter",""),error:E.touched.wgtAfter&&!!E.errors.wgtAfter,decimalScale:3})})]})})]})}),s.jsx(d(),{item:!0,xs:4,children:(0,s.jsxs)(d(),{container:!0,spacing:2,children:[s.jsx(d(),{item:!0,xs:12,children:s.jsx(h.Z,{resourceId:x.i.MFJobOrders,seqNo:0,recordId:E.values.jobId,customWidth:320,customHeight:190,isAbsolutePath:!0,disabled:!0})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(C.Z,{name:"date",readOnly:!0,label:e.date,value:E.values.date,maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(k.Z,{name:"startTime",readOnly:!0,label:e.startTime,value:E.values?.startTime,maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(k.Z,{name:"endTime",readOnly:!0,label:e.endTime,value:E.values?.endTime,maxAccess:J})}),s.jsx(d(),{item:!0,xs:12,children:s.jsx(y.Z,{endpointId:v.u.Worksheet.pack,reducer:e=>e?.record?.shifts,name:"shiftId",label:e.shift,maxAccess:J,readOnly:U,valueField:"recordId",displayField:"name",values:E.values,onChange:(e,a)=>{E.setFieldValue("shiftId",a?.recordId||null)},error:E.touched.shiftId&&!!E.errors.shiftId})})]})})]})})})})}[o,c,u,m,h,y,f,g,A,q,F,R]=$.then?(await $)():$,t()}catch(e){t(e)}})},91677:(e,a,r)=>{"use strict";r.a(e,async(e,t)=>{try{r.d(a,{Z:()=>b});var s=r(20997),l=r(34698),d=r(21061),n=r(16689),i=r(43557),o=r(82404),c=r(46900),u=r(96119),m=r(6416),x=r(38782),h=e([i,o,c,x]);[i,o,c,x]=h.then?(await h)():h;let p=({recordId:e,window:a,joInvalidate:r})=>{let[t,h]=(0,n.useState)(0),[p,b]=(0,n.useState)({recordId:e,isPosted:!1,values:null}),{labels:y,access:I}=(0,x.Z)({datasetId:m.i.Worksheet,editMode:!!e});(0,u.Z)({title:y.Worksheet,window:a});let f=[{label:y.Worksheet},{label:y.issueOfMaterials,disabled:!p.recordId},{label:y.Summary,disabled:!p.recordId}];return(0,s.jsxs)(s.Fragment,{children:[s.jsx(d.Y,{tabs:f,activeTab:t,setActiveTab:h,maxAccess:I}),s.jsx(l.Z,{index:0,value:t,maxAccess:I,children:s.jsx(i.Z,{labels:y,setStore:b,store:p,maxAccess:I,window:a,joInvalidate:r})}),s.jsx(l.Z,{index:1,value:t,maxAccess:I,children:s.jsx(o.Z,{store:p})}),s.jsx(l.Z,{index:2,value:t,maxAccess:I,children:s.jsx(c.Z,{store:p,labels:y,maxAccess:I})})]})};p.width=1200,p.height=650;let b=p;t()}catch(e){t(e)}})},528:(e,a,r)=>{"use strict";r.a(e,async(e,t)=>{try{r.d(a,{Z:()=>y});var s=r(20997),l=r(30343),d=r.n(l),n=r(16689),i=r(95965),o=r(29352),c=r(79660),u=r(60520),m=r(20562),x=r(44982),h=r.n(x),p=r(70755),b=e([o,u]);[o,u]=b.then?(await b)():b;let y=(0,n.forwardRef)(({resourceId:e,error:a,seqNo:t,recordId:l,width:x=140,height:b=140,customWidth:y,customHeight:I,disabled:f=!1,isAbsolutePath:j=!1,parentImage:v},g)=>{let w=(0,n.useRef)(null),C=(0,n.useRef)(null),k=(0,n.useRef)({}),{getRequest:N,postRequest:_}=(0,n.useContext)(o.$),{platformLabels:A}=(0,n.useContext)(u.l),[O,Z]=(0,n.useState)(""),q=v?.recordId,F=v?.resourceId,{formik:R}=(0,i.c)({initialValues:{}}),{width:$}=(0,m.d)(),P=$>=1680?1:$>=1600?.9:$<=1024?.7:.7+($-1024)/576*.22000000000000008;(0,n.useImperativeHandle)(g,()=>({submit:T}));let T=()=>{if(f)return;let a=g?.current?.value||l;if(j){if(R.values?.file?.name||R.values.url){let r={...R.values,fileName:R.values.file?.name||R.values.url,resourceId:e,recordId:a};return _({extension:c.r.Attachment.set2,record:JSON.stringify(r),file:R.values?.file}).then(()=>V(a))}return!O&&k.current?.fileName&&!R.values?.fileName?_({extension:c.r.Attachment.del,record:JSON.stringify(k.current)}).then(()=>V(a)):void 0}if(R.values?.file){let e={...R.values,recordId:a};return _({extension:c.r.Attachment.set,record:JSON.stringify(e),file:R.values?.file}).then(()=>V(a))}if(!O&&k.current?.url&&!R.values?.url)return _({extension:c.r.Attachment.del,record:JSON.stringify(k.current),file:k.current?.url}).then(()=>V(a))},D=()=>{Z(""),R.setValues({})},V=async a=>{let r=a||l;if(!e)return;if(j&&r){let a=await N({extension:c.r.Attachment.get2,parameters:`_resourceId=${e}&_seqNo=${t}&_recordId=${r}`}),s=a?.record||{};R.setValues({...s,resourceId:e}),k.current={...s,resourceId:e},Z(s?.fileName?`${s.fileName}?t=${Date.now()}`:"");return}let s=F||e,d=q||r;if(!d)return;let n=await N({extension:c.r.Attachment.get,parameters:`_resourceId=${s}&_seqNo=${t}&_recordId=${d}`}),i=n?.record||{};R.setValues({...i,resourceId:s}),k.current={...i,resourceId:s},Z(i?.url?`${i.url}?t=${Date.now()}`:"")};return(0,n.useEffect)(()=>{q||l?V():D()},[q,l]),(0,s.jsxs)(d(),{className:h().container,children:[s.jsx(d(),{className:h().previewBox,style:{width:"100%",maxWidth:(y||x)*P,height:(I||b)*P},onClick:()=>{f||w.current.click()},children:s.jsx("img",{src:O||r(13063).default.src,alt:"",className:h().previewImage,style:{border:a?"2px solid #F44336":"none"},onError:e=>{e.currentTarget.src=r(13063).default.src}})}),(0,s.jsxs)(d(),{className:h().bottomSection,children:[s.jsx("input",{hidden:!0,type:"file",accept:"image/png, image/jpeg, image/jpg",ref:w,onChange:a=>{let r=a?.target?.files?.[0];if(!r)return;if(Math.round(r.size/1024)>500){alert(A.MaxFileSize);return}let t=new Date(r.lastModifiedDate),s=`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear()}`;R.setValues({resourceId:e,recordId:l,seqNo:0,fileName:r.name,folderId:null,folderName:null,date:s,url:null,file:r});let d=new FileReader;C.current=d,d.onloadend=e=>Z(e.target.result),d.readAsDataURL(r)},disabled:f}),s.jsx(p.Z,{onClick:D,image:"clear.png",tooltipText:A.Clear,color:"#F44336",border:"none",disabled:f})]})]})});t()}catch(e){t(e)}})},34698:(e,a,r)=>{"use strict";r.d(a,{Z:()=>m});var t=r(20997);r(16689);var s=r(30343),l=r.n(s),d=r(580),n=r.n(d),i=r(51613),o=r.n(i),c=r(82204);let u=e=>{let{children:a,value:r,index:s,maxAccess:d,...n}=e,i=`${e.name||"tab"}.${s}`,{accessLevel:u}=(d?.record?.controls??[]).find(e=>e.controlId===i)??{accessLevel:0};if(u===c.A1)return null;let m=r===s;return t.jsx(l(),{role:"tabpanel",hidden:!m,id:`simple-tabpanel-${s}`,"aria-labelledby":`simple-tab-${s}`,className:`${o().tabPanel} ${m?o().active:o().hidden}`,...n,children:a})};u.propTypes={children:n().node,index:n().number.isRequired,value:n().number.isRequired};let m=u},21061:(e,a,r)=>{"use strict";r.d(a,{Y:()=>b});var t=r(20997),s=r(30343),l=r.n(s),d=r(66800),n=r.n(d),i=r(68514),o=r.n(i),c=r(92189),u=r.n(c),m=r(16689),x=r(49822),h=r(75716),p=r.n(h);let b=({tabs:e,activeTab:a,setActiveTab:r,maxAccess:s,name:d="tab"})=>{let i=s?.record?.controls?.filter(e=>4===e.accessLevel&&e.controlId?.startsWith(`${d}.`)).map(e=>e.controlId.split(".")[1])||[],c=e?.map((e,a)=>({...e,id:a}))?.filter((e,a)=>!i.includes(String(a))),h=c[a]?.id,b=c[a]?.disabled;return(0,m.useEffect)(()=>{h>=0&&!b&&a!=h&&r(h)},[]),t.jsx(l(),{className:p().tabsContainer,children:t.jsx(l(),{className:p().tabsWrapper,children:t.jsx(n(),{value:a,onChange:(e,a)=>r(a),variant:"scrollable",scrollButtons:c.length>3?"auto":"off","aria-label":"scrollable tabs",classes:{indicator:p().tabsIndicator},className:p().tabs,children:c?.map(e=>t.jsx(o(),{value:e.id,disabled:e?.disabled,className:`${p().tabName} ${e.disabled?p().tabDisabled:""}`,classes:{root:p().tabRoot,selected:p().selectedTab},label:t.jsxs(l(),{display:"flex",alignItems:"center",children:[t.jsx("span",{children:e.label}),e.id===a&&e?.onRefetch&&t.jsx(u(),{size:"small",className:p().refreshButton,onClick:a=>{a.stopPropagation(),e.onRefetch()},children:t.jsx(x.Z,{className:p().refreshIcon})})]})},e.id))})})})}}};