exports.id=81896,exports.ids=[81896],exports.modules={3:e=>{e.exports={root:"WorkFlow_root__EINm1"}},70208:(e,a,t)=>{"use strict";t.a(e,async(e,d)=>{try{t.d(a,{Z:()=>w});var l=t(20997),n=t(40711),s=t(99155),r=t.n(s),i=t(95965),c=t(71278),o=t(18611),u=t(23385),m=t(16689),h=t(29352),I=t(79660),p=t(97996),y=t(42020),x=t(61274),g=t(44619),f=t(60520),v=t(96119),b=t(18687),A=t(70755),F=t(38509),j=t(6416),C=e([n,c,h,x,f,b,F]);function w({labels:e,shipment:a=!1,bill:t=!1,deliveryOrder:d=!1,form:s,handleAddressValues:C,checkedAddressId:w,window:T}){let{getRequest:k}=(0,m.useContext)(h.$),{platformLabels:V}=(0,m.useContext)(f.l);(0,v.Z)({title:V.AddressFilter,window:T});let{formik:S}=(0,i.c)({initialValues:{search:"",cityId:null,countryId:null},validateOnChange:!0,onSubmit:async()=>{let e=Z?.list?.find(e=>e.checked);if(!e?.addressId){C({shipAddress:"",BillAddress:"",address:""}),T.close();return}if(a||t||d){let l=await N(e?.addressId);a&&C({shipAddress:l,shipAddressId:e?.addressId,shipToAddressId:e?.addressId}),t&&C({billAddress:l,billAddressId:e?.addressId,billToAddressId:e?.addressId}),d&&C({address:l,addressId:e?.addressId})}T.close()}});async function N(e){if(!e)return;let a=await k({extension:I.r.Address.format,parameters:`_addressId=${e}`});return a?.record?.formattedAddress.replace(/(\r\n|\r|\n)+/g,"\r\n")}let $=async(e={})=>{let{_startAt:a=0,_pageSize:t=50}=e,d=!!S.values.search&&!!S.values.countryId&&!!S.values.cityId&&!!s.clientId,l=await k({extension:d?p.P.FilterAddress.snapshot:p.P.Address.page,parameters:d?`_countryId=${S.values.countryId}&_cityId=${S.values.cityId}&_clientId=${s.clientId}&_filter=${S.values.search}`:`_startAt=${a}&_pageSize=${t}&_params=1|${s.clientId}`}),n=l?.list?.map(e=>({addressId:e.addressId||e.recordId,address:e.formattedAddress??`${e.name||""}, ${e.street1||""}, ${e.street2||""}, ${e.city||""}, ${e.phone||""},${e.phone2||""},${e.email1||""}`,checked:(e.addressId||e.recordId)===w}))||[];return{list:n,_startAt:a,count:n.length}},{query:{data:Z},paginationParameters:D,refetch:P}=(0,F.J)({queryFn:$,endpointId:p.P.Address.page,datasetId:j.i.Address});return l.jsx(b.Z,{onSave:S.handleSubmit,children:(0,l.jsxs)(o.R,{children:[l.jsx(y.g,{children:(0,l.jsxs)(r(),{container:!0,spacing:2,children:[l.jsx(r(),{item:!0,xs:12,children:l.jsx(c.Z,{endpointId:I.r.Country.qry,name:"countryId",label:e.country,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:S.values,onChange:(e,a)=>{S.setFieldValue("cityId",""),S.setFieldValue("countryId",a?.recordId||null)}})}),l.jsx(r(),{item:!0,xs:12,children:l.jsx(x.U,{endpointId:I.r.City.snapshot,parameters:{_countryId:S.values.countryId,_stateId:0},valueField:"name",displayField:"name",name:"city",label:e.city,form:S,secondDisplayField:!1,onChange:(e,a)=>{S.setFieldValue("cityId",a?.recordId||null),S.setFieldValue("city",a?.name||null)}})}),l.jsx(r(),{item:!0,xs:6,children:l.jsx(g.Z,{name:"search",value:S.values.search,label:e.search,onClear:()=>{S.setFieldValue("search","")},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation())},onChange:S.handleChange})}),l.jsx(r(),{item:!0,xs:2,children:l.jsx(A.Z,{label:e.apply,onClick:P,disabled:!(S.values.countryId&&S.values.cityId)})})]})}),l.jsx(u.Q,{children:l.jsx(n.Z,{name:"addressFilterTable",columns:[{field:"address",headerName:"",flex:6}],gridData:Z,rowId:["addressId"],pageSize:50,paginationType:"api",paginationParameters:D,checkTitle:"",checkboxFlex:1,rowSelection:"single",showCheckboxColumn:!0,viewCheckButtons:!0})})]})})}[n,c,h,x,f,b,F]=C.then?(await C)():C,w.width=950,w.height=600,d()}catch(e){d(e)}})},9737:(e,a,t)=>{"use strict";t.a(e,async(e,d)=>{try{t.d(a,{Z:()=>w});var l=t(20997),n=t(99155),s=t.n(n),r=t(6416),i=t(71278),c=t(38509),o=t(18611),u=t(80582),m=t(75609),h=t(44619),I=t(27736),p=t(65980),y=t(61274),x=t(66198),g=t(97996),f=t(67906),v=t(95965),b=t(70305),A=t(60520),F=t(96119),j=t(16689),C=e([i,c,u,y,b,A]);function w({formValues:e,onSubmit:a,window:t}){let{stack:d}=(0,b.V)(),{platformLabels:n}=(0,j.useContext)(A.l);(0,F.Z)({title:n.ChangeClient,window:t});let{labels:C,access:w}=(0,c.J)({datasetId:r.i.ChangeClient}),{formik:T}=(0,v.c)({maxAccess:w,initialValues:{changeToId:null,changeToRef:"",changeToName:"",changeBillAddressId:null,changeBill:"",changeSzId:null},validateOnChange:!0,validationSchema:m.object({changeToId:m.string().required()}),onSubmit:async e=>{if(e.changeToId){let d={clientId:e.changeToId,clientName:e.changeToName,clientRef:e.changeToRef,billAddressId:e.changeBillAddressId,billAddress:e.changeBill,szId:e.changeSzId};a(d),t.close()}}});return l.jsx(u.Z,{resourceId:r.i.ChangeClient,form:T,isInfo:!1,isCleared:!1,maxAccess:w,children:l.jsx(o.R,{children:(0,l.jsxs)(s(),{container:!0,spacing:2,children:[l.jsx(s(),{item:!0,xs:12,children:l.jsx(h.Z,{name:"reference",label:C.reference,value:e?.reference,readOnly:!0})}),l.jsx(s(),{item:!0,xs:12,children:l.jsx(I.Z,{name:"date",label:C.date,value:e?.date,readOnly:!0})}),l.jsx(s(),{item:!0,xs:12,children:l.jsx(p.Z,{name:"billAddress",label:C.billAddress,value:e?.billAddress,rows:3,maxLength:"100",readOnly:!0})}),l.jsx(s(),{item:!0,xs:12,children:l.jsx(i.Z,{endpointId:g.P.PriceLevel.qry,name:"plId",label:C.priceLevel,readOnly:!0,valueField:"recordId",displayField:["reference","name"],values:e})}),l.jsx(s(),{item:!0,xs:9,children:l.jsx(f.Z,{name:"isVattable",value:e?.isVattable,label:C.vat,disabled:!0})}),l.jsx(s(),{item:!0,xs:12,children:l.jsx(i.Z,{endpointId:x.H.TaxSchedules.qry,name:"taxId",label:C.taxSchedule,valueField:"recordId",displayField:["reference","name"],readOnly:!0,values:e})}),l.jsx(s(),{item:!0,xs:12,children:l.jsx(y.U,{endpointId:g.P.Client.snapshot,valueField:"reference",displayField:"name",secondFieldLabel:C.name,name:"clientId",label:C.client,form:{values:e},readOnly:!0,displayFieldWidth:4,valueShow:"clientRef",secondValueShow:"clientName"})}),l.jsx(s(),{item:!0,xs:12,children:l.jsx(y.U,{endpointId:g.P.Client.snapshot,filter:{isInactive:!1},valueField:"reference",displayField:"name",secondFieldLabel:C.name,name:"changeToId",label:C.changeTo,form:T,displayFieldWidth:3,valueShow:"changeToRef",secondValueShow:"changeToName",maxAccess:w,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"},{key:"flName",value:"FlName"},{key:"keywords",value:"Keywords"},{key:"cgName",value:"Client Group"}],required:!0,onChange:(a,t)=>{let l=t?e?.plId!=t?.plId?(d({message:C.mismatchPrice}),!1):e?.isVattable!=t?.isSubjectToVAT?(d({message:C.mismatchVat}),!1):e?.taxId!=t?.taxId?(d({message:C.mismatchTax}),!1):!((e?.maxDiscount||0)<(t?.maxDiscount||0))||(d({message:C.mismatchDiscount}),!1):null;T.setFieldValue("changeToId",l?t?.recordId:null),T.setFieldValue("changeToName",l?t?.name:""),T.setFieldValue("changeToRef",l?t?.reference:null),T.setFieldValue("changeBillId",l?t?.billAddressId:null),T.setFieldValue("changeBill",l?t?.billAddress:""),T.setFieldValue("changeSzId",l?t?.szId:null)},errorCheck:"changeToId"})})]})})})}[i,c,u,y,b,A]=C.then?(await C)():C,w.width=500,w.height=570,d()}catch(e){d(e)}})},70638:(e,a,t)=>{"use strict";t.a(e,async(e,d)=>{try{t.d(a,{Z:()=>y});var l=t(20997),n=t(16689),s=t(97996),r=t(29352),i=t(73846),c=t(96119),o=t(60520),u=t(20562),m=t(3),h=t.n(m),I=e([r,i,o]);[r,i,o]=I.then?(await I)():I;let p=({functionId:e,recordId:a,window:t})=>{let{getRequest:d}=(0,n.useContext)(r.$),{languageId:m}=(0,n.useContext)(i.V),{platformLabels:I}=(0,n.useContext)(o.l),p=a+"-"+e;(0,c.Z)({title:I.WorkFlow,window:t});let{width:y}=(0,u.d)(),x=y<=1024,g=y>1024&&y<=1280,f=x?10:g?12:14,v=x?75:g?85:95,b=x?15:g?20:25,A=async()=>{var t=`_functionId=${e}&_recordId=${a}`;let l=await d({extension:s.P.WorkFlow.graph,parameters:t});return l?.record},F=e=>{let a=[],t=[],d="",l="";return e.objects.forEach(e=>{a.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(a=>{e.objects.forEach(e=>{let t=e.functionName.split(" ").join("\r\n");a.parentId===e.recordId&&a.parentFunctionId===e.functionId&&(d=e.reference+"\r\n"+e.date+"\r\n"+t,a.parentId),a.childId===e.recordId&&a.childFunctionId===e.functionId&&(l=e.reference+"\r\n"+e.date+"\r\n"+t,a.childId)}),""===d||""===l||t.push({from:d,to:l,value:1,labelText:""}),d="",l=""}),t};return(0,n.useEffect)(()=>{!async function(){var e=await A();if(e){let a=(e,a)=>{let t=document.createElement("script");t.type="text/javascript",t.src=e,t.async=!0,t.onload=a,document.head.appendChild(t)};a("https://cdn.amcharts.com/lib/4/core.js",()=>{a("https://cdn.amcharts.com/lib/4/charts.js",()=>{a("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let a=am4core.create(p,am4charts.SankeyDiagram),t=F(e);a.data=t,a.dataFields.fromName="from",a.dataFields.toName="to",a.dataFields.value="value",a.paddingRight=2===m?0:40,a.paddingLeft=2===m?40:0,a.tooltip.label.fontSize=f;let d=a.nodes.template;d.draggable=!1,d.inert=!0,d.clickable=!1,d.width=v,d.height=b,d.nameLabel.label.fontSize=f,d.nameLabel.locationX=2===m?.85:0,d.nameLabel.height=void 0,d.nameLabel.label.fontWeight="bold";let l=a.links.template;l.middleLine.strokeOpacity=.3,l.middleLine.stroke=am4core.color("#555"),l.middleLine.strokeWidth=5,l.middleLine.hoverable=!1,l.fillOpacity=0,l.hoverable=!0,l.hoverOnFocus=!0,l.fill=am4core.color("#A8C686"),l.isHover=!0,a.appear(1e3,100)})})})})}}()},[]),l.jsx("div",{id:p,className:h().root})};p.width=950;let y=p;d()}catch(e){d(e)}})},42614:(e,a,t)=>{"use strict";t.d(a,{ER:()=>d,Ot:()=>c,Ww:()=>i,Yi:()=>s,a$:()=>l});let d=1,l=2,n=e=>{if(!0===e.tdPct){e.tdAmount>100?1===e.typeChange?e.tdAmount=0:e.tdAmount=e.currentDiscount:e.currentDiscount=e.tdAmount,e.hiddenTdPct=e.tdAmount;let a=e.subtotal*e.tdAmount/100;e.hiddenTdAmount=a,e.tdType=l}else if(e.tdAmount>e.subtotal)1===e.typeChange?e.tdAmount=0:e.tdAmount=e.currentDiscount;else{e.currentDiscount=e.tdAmount;let a=0===e.subtotal?0:100*e.tdAmount/e.subtotal;e.hiddenTdPct=a,e.hiddenTdAmount=e.tdAmount,e.tdType=d}return e},s=e=>e=n(e),r=(e,a)=>(e.forEach(e=>{a.totalQty+=parseFloat(e.qty),a.totalWeight+=e.qty*e.weight,a.totalVolume+=e.qty*e.volume,a.totalUpo+=e.upo,a.sumVat+=e.vatAmount}),a.net=a.sumExtended+a.sumVat+(a?.miscAmount||0)-(a?.tdAmount||0),a),i=e=>e.reduce((e,a)=>e+(Number(a.extendedPrice)||0),0),c=(e,a)=>a=r(e,a)}};