exports.id=71310,exports.ids=[71310],exports.modules={3:e=>{e.exports={root:"WorkFlow_root__EINm1"}},8041:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r={src:"/_next/static/media/imgSerials.d1ee59bb.png",height:17,width:23,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAGCAMAAADJ2y/JAAAAIVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABt0UjBAAAAC3RSTlMCZzsmQ6RbWbaSTwNdgTwAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAArSURBVHicY2BiZ2BgYOBiZmBmYmRjZGRhYGBg4eBkZWVDYjAzMbKDpWCKARB/AJwjPQgCAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:6}},68624:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var r=a(79660);a(6416);var n=a(82204),s=a(75281);let l=async(e,t,a)=>{try{let r=await e({extension:t,parameters:a});return t.includes("qry")?r:r.record}catch(e){return null}},i=(e,t,a,r)=>{let s=(e=JSON.parse(JSON.stringify(e))).record.controls,l=s.find(e=>"reference"===e.controlId);return l?l.accessLevel=t?.mandatory?n.$7:n.rr:t?.mandatory?s.push({sgId:0,resourceId:"",controlId:`${r?r+".":""}reference`,accessLevel:t?.mandatory?n.$7:n.rr}):t?.readOnly?s.push({sgId:0,resourceId:"",controlId:`${r?r+".":""}reference`,accessLevel:t?.readOnly?n.rr:n.$7}):s=e.record.controls.filter(e=>"reference"!=e.controlId),a&&s.push({sgId:0,resourceId:"",controlId:`${r?r+".":""}dtId`,accessLevel:n.$7}),{...e,record:{...e.record,controls:s}}},d=async(e,t,a)=>{let n,i;switch(a){case"dtId":let d=(0,s.m)("userData"),o=d?.userId;i=`_userId=${o}&_functionId=${t}`,n=r.r.UserFunction.get;break;case"glbSysNumberRange":i=`_recordId=${t}`,n=r.r.SystemFunction.get;break;case"DocumentType":i=`_dgId=${t}&_startAt=0&_pageSize=50`,n=r.r.DocumentType.qry;break;case"DcTypNumberRange":i=`_recordId=${t}`,n=r.r.DocumentType.get;break;case"isExternal":i=`_recordId=${t}`,n=r.r.NumberRange.get;break;default:return null}return await l(e,n,i)},o=async(e,t,a,r,n=!0,s)=>{let l,o,c,u;let m=void 0===r&&t&&await d(e,t,"dtId"),f=m?.dtId,I="",p=!0;if(m&&void 0===r||"nraId"===r){if(f){let t=await d(e,f,"DcTypNumberRange");l=t?.nraId,p=!(t?.activeStatus<0),l||(I="Assign the document type to a number range")}if((!f||!p)&&n&&t){let a=await d(e,t,"DocumentType");u=a?.list?.filter(e=>e?.activeStatus===1).length>0}}if(("nraId"===r||void 0===r)&&t){if((!f||f)&&!l||l&&!p){let a=await d(e,t,"glbSysNumberRange");(l=a?.nraId)&&u&&(u=!1),p=!0}I=l||u?"":"Assign the system Function to a number range"}r>0&&!l&&(l=r),l&&p?(c=await d(e,l,"isExternal"),o={readOnly:!c?.external,mandatory:!!c?.external},a&&(a=await i(a,o,u,s))):!l&&a&&(a=await i(a,o,u,s));let y=s?`${s}.reference`:"reference";return{dtId:f,resetReference:o?.readOnly,dcTypeRequired:u,reference:{fieldName:y,isEmpty:!(c?.external===void 0||c?.external)},errorMessage:I,maxAccess:a,selectNraId:r}}},75281:(e,t,a)=>{"use strict";a.d(t,{m:()=>r});let r=e=>{let t=window.sessionStorage.getItem(e);return t?JSON.parse(t):null}},86794:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{G:()=>c,H:()=>u});var n=a(49752),s=a(16689),l=a(70305),i=a(68624),d=a(29352),o=e([n,l,d]);function c({functionId:e,action:t,hasDT:a}){let{getRequest:r}=(0,s.useContext)(d.$),{stack:n}=(0,l.V)();return{proxyAction:async()=>{let s=await (0,i.Z)(r,e,"",void 0,a);s?.errorMessage?n({message:s?.errorMessage}):await t()}}}function u({functionId:e,access:t,hasDT:a,enabled:r=!0,objectName:o=""}){let{getRequest:c}=(0,s.useContext)(d.$),{stack:u}=(0,l.V)(),[m,f]=(0,s.useState)(),I=async r=>{let n=await (0,i.Z)(c,e,t,r,a,o);if(!n.errorMessage)return n;u({message:n?.errorMessage})},p=(0,n.useQuery)({retry:!1,staleTime:0,enabled:r,queryKey:[e,m,!!t,r],queryFn:m||"nraId"===m?()=>I(m):()=>I()});return{documentType:p.data,maxAccess:p?.data?.maxAccess||t,changeDT(e){f(e?.nraId||"nraId")}}}[n,l,d]=o.then?(await o)():o,r()}catch(e){r(e)}})},71310:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{Z:()=>G});var n=a(20997),s=a(99155),l=a.n(s),i=a(16689),d=a(75609),o=a(80582),c=a(86201),u=a(15051),m=a(29352),f=a(38509),I=a(6416),p=a(44619),y=a(95965),h=a(60520),x=a(18611),v=a(23385),g=a(27736),A=a(71278),w=a(79660),b=a(68728),k=a(65980),C=a(86794),j=a(79390),S=a(70638),N=a(677),F=a(54242),D=a(13704),O=a(42020),T=a(37557),q=a(70305),$=a(26176),Z=a(49466),V=a(96119),R=a(38782),M=a(46841),_=e([o,c,u,m,f,h,A,C,S,N,q,Z,R,M]);function G({recordId:e,window:t}){let{getRequest:r,postRequest:s}=(0,i.useContext)(m.$),{platformLabels:_,userDefaultsData:G}=(0,i.useContext)(h.l),{stack:J}=(0,N.zY)(),{stack:L}=(0,q.V)(),W=(0,i.useRef)([]),[B,Q]=(0,i.useState)([]),E=(0,i.useRef)([]),{labels:P,access:U}=(0,R.Z)({datasetId:I.i.MaterialsTransfer,editMode:!!e});(0,V.Z)({title:P.MaterialsTransfer,window:t});let{documentType:H,maxAccess:Y,changeDT:z}=(0,C.H)({functionId:b.J.MaterialTransfer,access:U,enabled:!e}),K=G?.list?.find(({key:e})=>"siteId"===e),X=parseInt(G?.list?.find(e=>"plantId"===e.key)?.value),ee={recordId:null,functionId:b.J.MaterialTransfer,reference:"",dtId:null,oDocId:"",date:new Date,closedDate:null,receivedDate:null,fromSiteId:parseInt(K?.value||null),toSiteId:null,notes:"",status:1,plantId:X,printStatus:null,qty:null,pcs:null,isVerified:!1,wip:1,carrierId:null,plId:null,transfers:[{id:1,transferId:e||0,seqNo:1,sku:"",itemName:null,itemId:null,qty:null,componentSeqNo:0,qtyInBase:0,muId:null,muQty:"",muRef:"",weight:null,unitCost:0,msId:null,trackBy:null,lotCategoryId:null,metalId:null,metalRef:"",totalCost:0,priceType:null}],serials:[]},et=(0,f.E)({endpointId:F.$.MaterialsTransfer.page});async function ea(e,t,a,r){let n={recordId:e,functionId:b.J.MaterialTransfer,notificationGroupId:a.values.notificationGroupId,date:a.values.date,reference:t,status:r};await s({extension:$.y.Notification.set,record:JSON.stringify(n)})}let{formik:er}=(0,y.c)({initialValues:ee,maxAccess:Y,documentType:{key:"dtId",value:H?.dtId},validateOnChange:!0,validationSchema:d.object({date:d.date().required(),fromSiteId:d.string().required(),toSiteId:d.string().required(),transfers:d.array().of(d.object().shape({sku:d.string().required(),qty:d.string().required()})).required()}),onSubmit:async e=>{let t={...e};delete t.transfers,delete t.serials,t.date=t.date?(0,j.ku)(t.date):null,t.closedDate=t.closedDate?(0,j.ku)(t.closedDate):null,t.receivedDate=t.receivedDate?(0,j.ku)(t.receivedDate):null;let a=[],r=er.values.transfers.map((e,t)=>{let{serials:r,...n}=e;if(r){let n=r.map((a,r)=>({...a,seqNo:t+1,id:r,srlSeqNo:0,componentSeqNo:0,itemId:e?.itemId,transferId:er.values.recordId||0}));a.push(...n)}return{...n,seqNo:t+1,transferId:er.values.recordId||0,unitCost:parseFloat(e.unitCost),totalCost:parseFloat(e.totalCost)}});if(e.fromSiteId===e.toSiteId){L({message:P.errorMessage});return}let n=await s({extension:F.$.MaterialsTransfer.set2,record:JSON.stringify({header:t,items:r,serials:a,lots:[]})});if(e.recordId){if(er.values.notificationGroupId)ea(n.recordId,er.values.reference,er,1);else if(!er.values.notificationGroupId&&n.recordId){let e={recordId:n.recordId,functionId:b.J.MaterialTransfer,notificationGroupId:0};await s({extension:$.y.Notification.del,record:JSON.stringify(e)})}}c.default.success(e.recordId?_.Edited:_.Added),eg(n.recordId,!0),et()}}),en=3===er.values.status,es=2===er.values.wip,el=!!er.values.recordId,ei=async e=>{let t=await r({extension:F.$.Physical.get,parameters:`_itemId=${e}`});return{weight:t?.record?.weight??0,metalId:t?.record?.metalId,metalRef:t?.record?.metalRef}},ed=async e=>{let t=await r({extension:F.$.CurrentCost.get,parameters:"_itemId="+e});return t?.record?.currentCost};function eo(e){return(console.log(e),1===e.priceType)?(Math.round(e.qty*e.unitCost*100)/100).toFixed(2):2===e.priceType?(Math.round(e.qty*e.unitCost*e.volume*100)/100).toFixed(2):3===e.priceType?(Math.round(e.qty*e.unitCost*e.weight*100)/100).toFixed(2):0}async function ec(e){if(e)return await r({extension:F.$.DocumentTypeDefaults.get,parameters:`_dtId=${e}`})}async function eu(e){if(e){let t=await ec(e);er.setFieldValue("toSiteId",t?.record?.toSiteId||null),er.setFieldValue("fromSiteId",t?.record?.siteId?t?.record?.siteId:K||null),er.setFieldValue("carrierId",t?.record?.carrierId),er.setFieldValue("plantId",t?.record?.plantId||X)}}let{totalQty:em,totalCost:ef,totalWeight:eI}=er?.values?.transfers?.reduce((e,t)=>{let a=parseFloat(t?.qty)||0,r=parseFloat(t?.totalCost)||0,n=parseFloat(t?.weight)||0;return{totalQty:e?.totalQty+a,totalCost:(Math.round((parseFloat(e?.totalCost)+r)*100)/100).toFixed(2),totalWeight:e?.totalWeight+n}},{totalQty:0,totalCost:0,totalWeight:0});async function ep(e){let t=await r({extension:F.$.Item.get,parameters:`_recordId=${e}`});return t?.record}async function ey(e){if(!e)return;let t=er.values.transfers?.find(t=>parseInt(t.itemId)===e)?.msId,a=B?.filter(e=>e.msId===t)||[];W.current=a}let eh=e=>1===e.trackBy?{imgSrc:a(8041).Z.src,hidden:!1}:{imgSrc:"",hidden:!0},ex=[{component:"resourcelookup",label:P.sku,name:"sku",link:{enabled:!0,popup:e=>J({Component:M.Z,props:{itemId:e?.itemId,plId:er.values?.plId}})},props:{endpointId:F.$.Item.snapshot,valueField:"sku",displayField:"sku",mandatory:!0,readOnly:es,displayFieldWidth:4,mapping:[{from:"recordId",to:"itemId"},{from:"msId",to:"msId"},{from:"trackBy",to:"trackBy"},{from:"lotCategoryId",to:"lotCategoryId"},{from:"priceType",to:"priceType"},{from:"sku",to:"sku"},{from:"name",to:"itemName"},{from:"isInactive",to:"isInactive"}],columnsInDropDown:[{key:"sku",value:"SKU"},{key:"name",value:"Name"},{key:"flName",value:"flName"}]},propsReducer:({row:e,props:t})=>({...t,imgSrc:eh(e)}),async onChange({row:{update:e,newRow:t}}){let a=()=>{e({...er.initialValues.transfers[0],id:t.id})};if(!t?.itemId)return a();if(t.isInactive){a(),L({message:P.inactiveItem});return}if(t?.itemId){let{weight:a,metalId:r,metalRef:n}=await ei(t?.itemId),s=await ed(t?.itemId)??0,l=eo(t),i=await ep(t.itemId);ey(t?.itemId);let d=B?.filter(e=>e.msId===i?.msId);e({weight:a,unitCost:s,totalCost:l,msId:i?.msId,muRef:d?.[0]?.reference,muId:d?.[0]?.recordId,metalId:r,metalRef:n})}}},{component:"textfield",label:P.itemName,name:"itemName",props:{readOnly:!0}},{component:"textfield",label:P.metalRef,name:"metalRef",props:{readOnly:!0}},{component:"resourcecombobox",label:P.muId,name:"muRef",props:{store:W?.current,displayField:"reference",valueField:"recordId",readOnly:es,mapping:[{from:"reference",to:"muRef"},{from:"qty",to:"muQty"},{from:"recordId",to:"muId"}]},async onChange({row:{update:e,newRow:t}}){let a=W?.current.filter(e=>e.recordId===t?.muId),r=(t?.qty*a?.muQty)??0;e({qtyInBase:r,muQty:t?.muQty})},propsReducer:({row:e,props:t})=>({...t,store:W?.current})},{component:"numberfield",label:P.weight,name:"weight",props:{readOnly:!0}},{component:"numberfield",label:P.qty,name:"qty",props:{readOnly:es},async onChange({row:{update:e,newRow:t}}){if(t){let a=eo(t),r=(t?.qty*t?.muQty)??0;e({totalCost:a,qtyInBase:r})}}},{component:"numberfield",label:P.unitCost,name:"unitCost",props:{readOnly:!0}},{component:"numberfield",label:P.totalCost,name:"totalCost",props:{readOnly:!0}},{component:"button",name:"serials",label:_.serials,props:{onCondition:eh},onClick:(e,t,a,r)=>{t?.trackBy===1&&J({Component:Z.u,props:{labels:P,row:t,disabled:en||es,siteId:er?.values?.fromSiteId,maxAccess:U,checkForSiteId:!0,updateRow:r}})}}];async function ev(e){let t=await r({extension:F.$.MaterialsTransfer.get,parameters:`_recordId=${e}`});return t.record.date=(0,j.a1)(t?.record?.date),t.record.closedDate=(0,j.a1)(t?.record?.closedDate),t.record.receivedDate=(0,j.a1)(t?.record?.receivedDate),t}async function eg(e,t){let a=await ev(e);er.values.notificationGroupId&&ea(e,a.record.reference,er,1);let r=await eS(e,t),n=await Promise.all(r.list.map(async e=>({...e,id:e.seqNo,totalCost:eo(e),serials:E?.current?.list?.filter(t=>t.seqNo==e.seqNo)?.map((e,t)=>({...e,id:t})),unitCost:e.unitCost??0})));er.setValues({...a.record,recordId:e,transfers:n,notificationGroupId:er.values.notificationGroupId})}let eA=async e=>{await s({extension:F.$.MaterialsTransfer.close,record:JSON.stringify({recordId:e})}),c.default.success(_.Closed),et(),await eg(er.values.recordId)};async function ew(){let e={...er.values};delete e.transfers,delete e.notificationGroupId,e.date=e.date?(0,j.ku)(e.date):null,e.closedDate=e.closedDate?(0,j.ku)(e.closedDate):null,e.receivedDate=e.receivedDate?(0,j.ku)(e.receivedDate):null,await s({extension:F.$.MaterialsTransfer.reopen,record:JSON.stringify(e)}),c.default.success(_.Reopened),et(),await eg(er.values.recordId)}let eb=async()=>{J({Component:S.Z,props:{functionId:b.J.MaterialTransfer,recordId:er.values.recordId}})},ek=async()=>{let e={...er.values};if(delete e.transfers,delete e.notificationGroupId,e.date=e.date?(0,j.ku)(e.date):null,e.closedDate=e.closedDate?(0,j.ku)(e.closedDate):null,e.receivedDate=e.receivedDate?(0,j.ku)(e.receivedDate):null,await s({extension:F.$.MaterialsTransfer.post,record:JSON.stringify(e)}),er.values.notificationGroupId)ea(er.values.recordId,er.values.reference,er,3);else if(!er.values.notificationGroupId){let e={recordId:er.values.recordId,functionId:b.J.MaterialTransfer,notificationGroupId:0};await s({extension:$.y.Notification.del,record:JSON.stringify(e)})}c.default.success(_.Posted),et(),await eg(er.values.recordId)},eC=async()=>{let e={...er.values};delete e.transfers,delete e.notificationGroupId,e.date=e.date?(0,j.ku)(e.date):null,e.closedDate=e.closedDate?(0,j.ku)(e.closedDate):null,e.receivedDate=e.receivedDate?(0,j.ku)(e.receivedDate):null,await s({extension:F.$.MaterialsTransfer.unpost,record:JSON.stringify(e)}),c.default.success(_.Unposted),et(),await eg(er.values.recordId)},ej=[{key:"RecordRemarks",condition:!0,onClick:"onRecordRemarks",disabled:!el},{key:"GL",condition:!0,onClick:"onClickGL",datasetId:I.i.GLMaterialsTransfer,disabled:!el},{key:"IV",condition:!0,onClick:"onInventoryTransaction",disabled:!el||!en},{key:"Locked",condition:en,onClick:"onUnpostConfirmation",onSuccess:eC,disabled:!el||!es||er.values.isVerified},{key:"Unlocked",condition:!en,onClick:ek,disabled:!el||!es||er.values.isVerified},{key:"Close",condition:!es,onClick:()=>eA(er.values.recordId),disabled:es||!el||en},{key:"Reopen",condition:es,onClick:ew,disabled:!es||!el||en},{key:"WorkFlow",condition:!0,onClick:eb,disabled:!el}];async function eS(e,t){let a=await r({extension:F.$.MaterialsTransferItems.qry,parameters:`_transferId=${e}&_functionId=${b.J.MaterialTransfer}`});if(a?.list&&t){let t=await eN(e);t?.count&&(E.current=t)}return a}async function eN(e){return await r({extension:F.$.MaterialTransferSerial.qry,parameters:`_transferId=${e}&_seqNo=0&_componentSeqNo=0`})}async function eF(){let e={printStatus:2,recordId:er.values.recordId};await s({extension:F.$.MaterialsTransfer.print,record:JSON.stringify(e)}),et()}return n.jsx(o.Z,{resourceId:I.i.MaterialsTransfer,form:er,maxAccess:Y,editMode:el,previewReport:el,previewBtnClicked:eF,actions:ej,functionId:b.J.MaterialTransfer,disabledSubmit:en||es,children:(0,n.jsxs)(x.R,{children:[(0,n.jsxs)(v.Q,{children:[(0,n.jsxs)(l(),{container:!0,spacing:2,children:[(0,n.jsxs)(l(),{item:!0,xs:8,marginTop:1,children:[(0,n.jsxs)(l(),{container:!0,spacing:2,children:[n.jsx(l(),{item:!0,xs:6,children:n.jsx(A.Z,{endpointId:w.r.DocumentType.qry,parameters:`_dgId=${b.J.MaterialTransfer}&_startAt=0&_pageSize=1000`,filter:el?void 0:e=>1===e.activeStatus,name:"dtId",label:P.documentType,readOnly:en||es||el,valueField:"recordId",displayField:"name",values:er?.values,onChange:async(e,t)=>{eu(t?.recordId),er.setFieldValue("dtId",t?.recordId||""),z(t)},error:er.touched.dtId&&!!er.errors.dtId,maxAccess:Y})}),n.jsx(l(),{item:!0,xs:6,children:n.jsx(g.Z,{name:"closedDate",label:P.shippingDate,value:er?.values?.closedDate,onChange:er.setFieldValue,onClear:()=>er.setFieldValue("closedDate",""),readOnly:en||es,error:er.touched.date&&!!er.errors.closedDate,maxAccess:Y})})]}),(0,n.jsxs)(l(),{container:!0,spacing:2,marginTop:.5,children:[n.jsx(l(),{item:!0,xs:6,children:n.jsx(p.Z,{name:"reference",label:P.reference,value:er?.values?.reference,readOnly:en||es||el,maxAccess:!el&&Y,onChange:er.handleChange,onClear:()=>er.setFieldValue("reference",""),error:er.touched.reference&&!!er.errors.reference})}),n.jsx(l(),{item:!0,xs:6,children:n.jsx(g.Z,{name:"receivedDate",label:P.receivedDate,value:er?.values?.receivedDate,onChange:er?.setFieldValue,onClear:()=>er.setFieldValue("receivedDate",""),readOnly:en||es,error:er.touched.receivedDate&&!!er.errors.receivedDate,maxAccess:Y})})]}),(0,n.jsxs)(l(),{container:!0,spacing:2,marginTop:.5,children:[n.jsx(l(),{item:!0,xs:6,children:n.jsx(g.Z,{name:"date",label:P.date,value:er?.values?.date,required:!0,onChange:er.setFieldValue,onClear:()=>er.setFieldValue("date",""),readOnly:en||es,error:er.touched.date&&!!er.errors.date,maxAccess:Y})}),n.jsx(l(),{item:!0,xs:6,children:n.jsx(A.Z,{endpointId:F.$.Site.qry,name:"fromSiteId",readOnly:en||es||er?.values?.transfers?.some(e=>e.sku),label:P.fromSite,values:er.values,displayField:["reference","name"],valueField:"recordId",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:1,required:!0,maxAccess:Y,onChange:(e,t)=>{er.setFieldValue("fromSiteId",t?.recordId||null)},error:er.touched.fromSiteId&&!!er.errors.fromSiteId})})]}),(0,n.jsxs)(l(),{container:!0,spacing:2,marginTop:.5,children:[n.jsx(l(),{item:!0,xs:6,children:n.jsx(A.Z,{endpointId:D.p.LoCarrier.qry,name:"carrierId",label:P.carrier,values:er?.values,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:en||es,maxAccess:Y,onChange:(e,t)=>{er.setFieldValue("carrierId",t?t.recordId:"")},error:er.touched.carrierId&&!!er.errors.carrierId})}),n.jsx(l(),{item:!0,xs:6,children:n.jsx(A.Z,{endpointId:F.$.Site.qry,name:"toSiteId",readOnly:en||es,label:P.toSite,values:er?.values,displayField:["reference","name"],valueField:"recordId",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:1,required:!0,maxAccess:Y,onChange:(e,t)=>{er.setFieldValue("toSiteId",t?.recordId||null),er.setFieldValue("plId",t?.plId||null),t?.plId&&er.setFieldValue("details",!0)},error:er.touched.toSiteId&&!!er.errors.toSiteId})})]})]}),(0,n.jsxs)(l(),{container:!0,xs:4,spacing:2,style:{marginTop:0},children:[n.jsx(l(),{item:!0,xs:12,marginLeft:2,children:n.jsx(k.Z,{name:"notes",label:P.notes,value:er?.values?.notes,readOnly:en||es,maxLength:"200",maxAccess:Y,onChange:er.handleChange,onClear:()=>er.setFieldValue("notes",""),error:er.touched.notes&&!!er.errors.notes})}),n.jsx(l(),{item:!0,xs:12,marginLeft:2,children:n.jsx(A.Z,{endpointId:w.r.Plant.qry,name:"plantId",label:P.plant,readOnly:en||es,valueField:"recordId",displayField:"name",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:er?.values,maxAccess:Y,onClear:()=>er.setFieldValue("plantId",""),onChange:(e,t)=>{er.setFieldValue("plantId",t?.recordId||null)},error:er.touched.plantId&&!!er.errors.plantId})})]})]}),n.jsx(u._,{onChange:e=>{let t=e?.map(e=>({...e,qtyInBase:0}));er?.setFieldValue("transfers",t)},onSelectionChange:(e,t,a)=>{"muRef"==a&&ey(e?.itemId)},name:"transfers",maxAccess:Y,value:er?.values?.transfers,error:er?.errors?.transfers,columns:ex,allowDelete:!es})]}),n.jsx(O.g,{children:(0,n.jsxs)(l(),{container:!0,direction:"row",wrap:"nowrap",sx:{justifyContent:"space-between"},children:[(0,n.jsxs)(l(),{container:!0,xs:3,direction:"column",wrap:"nowrap",sx:{pt:5,justifyContent:"flex-start"},children:[n.jsx(l(),{item:!0,xs:3,children:n.jsx(p.Z,{name:"totalQty",maxAccess:Y,value:(0,T.bj)(Number(em).toFixed(2)),label:P.totalQty,readOnly:!0})}),n.jsx(l(),{item:!0,xs:3,sx:{mt:2},children:n.jsx(p.Z,{name:"totalCost",maxAccess:Y,value:(0,T.bj)(Number(ef).toFixed(2)),label:P.totalCost,readOnly:!0})}),n.jsx(l(),{item:!0,xs:3,sx:{mt:2},children:n.jsx(p.Z,{name:"totalWeight",maxAccess:Y,value:(0,T.bj)(Number(eI).toFixed(2)),label:P.totalWeight,readOnly:!0})})]}),n.jsx(l(),{item:!0,xs:6,sx:{pl:3,mt:4},children:n.jsx(A.Z,{endpointId:$.y.NotificationGroup.qry,name:"notificationGroupId",readOnly:en||es,label:P.notify,values:er?.values,displayField:"name",maxAccess:Y,onChange:(e,t)=>{er.setFieldValue("notificationGroupId",t?.recordId)},error:er.touched.notificationGroupId&&!!er.errors.notificationGroupId})})]})})]})})}[o,c,u,m,f,h,A,C,S,N,q,Z,R,M]=_.then?(await _)():_,G.width=1e3,G.height=680,r()}catch(e){r(e)}})},46841:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{Z:()=>h});var n=a(20997),s=a(99155),l=a.n(s),i=a(16689),d=a(29352),o=a(44619),c=a(95965),u=a(18611),m=a(23385);a(54242);var f=a(6416),I=a(38782),p=a(96119),y=e([d,I]);function h({plId:e,itemId:t,window:a}){let{getRequest:r}=(0,i.useContext)(d.$),{labels:s,access:y}=(0,I.Z)({datasetId:f.i.ItemDetails});(0,p.Z)({title:s.itemQuickView,window:a});let{formik:h}=(0,c.c)({maxAccess:y,initialValues:{recordId:t,sku:"",name:"",weight:null,volume:null,qtyOnHand:null,currentCost:null,defaultSalePrice:null}});return n.jsx(u.R,{children:n.jsx(m.Q,{children:(0,n.jsxs)(l(),{container:!0,spacing:3,p:2,children:[n.jsx(l(),{item:!0,xs:12,children:n.jsx(o.Z,{name:"sku",value:h?.values?.sku,label:s.sku,readOnly:!0,maxAccess:y})}),n.jsx(l(),{item:!0,xs:12,children:n.jsx(o.Z,{name:"name",value:h?.values?.name,label:s.name,readOnly:!0,maxAccess:y})}),n.jsx(l(),{item:!0,xs:12,children:n.jsx(o.Z,{name:"weight",value:h?.values?.weight,label:s.weight,readOnly:!0,maxAccess:y})}),n.jsx(l(),{item:!0,xs:12,children:n.jsx(o.Z,{name:"volume",value:h?.values?.volume,label:s.volume,readOnly:!0,maxAccess:y})}),n.jsx(l(),{item:!0,xs:12,children:n.jsx(o.Z,{name:"qtyOnHand",value:h?.values?.qtyOnHand,label:s.qtyOnHand,readOnly:!0,maxAccess:y})}),n.jsx(l(),{item:!0,xs:12,children:n.jsx(o.Z,{name:"currentCost",value:h?.values?.currentCost,label:s.currentCost,readOnly:!0,maxAccess:y})}),n.jsx(l(),{item:!0,xs:12,children:n.jsx(o.Z,{name:"defaultSalePrice",value:h?.values?.defaultSalePrice,label:s.defaultSalePrice,readOnly:!0,maxAccess:y})})]})})})}[d,I]=y.then?(await y)():y,h.width=700,h.height=500,r()}catch(e){r(e)}})},49466:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{u:()=>S});var n=a(20997),s=a(18611),l=a(23385),i=a(6416),d=a(99155),o=a.n(d),c=a(71278),u=a(95965),m=a(75609),f=a(38509),I=a(16689),p=a(29352),y=a(91184),h=a(61274),x=a(54242),v=a(15051),g=a(42020),A=a(70305),w=a(60520),b=a(60349),k=a(96119),C=a(18687),j=e([c,f,p,h,v,A,w,C]);[c,f,p,h,v,A,w,C]=j.then?(await j)():j;let S=({row:e,siteId:t,checkForSiteId:a,window:r,updateRow:d,disabled:j})=>{let{getRequest:S}=(0,I.useContext)(p.$),{stack:N}=(0,A.V)(),{platformLabels:F,systemChecks:D}=(0,I.useContext)(w.l),O=D.some(e=>e.checkId===b.F.ALLOW_INVENTORY_NEGATIVE_QTY),T=D?.find(e=>e.checkId===b.F.POS_JUMP_TO_NEXT_LINE)?.value||!1,{labels:q,maxAccess:$}=(0,f.J)({datasetId:i.i.Serial});(0,k.Z)({title:F.serials,window:r});let{formik:Z}=(0,u.c)({maxAccess:$,initialValues:{sku:e?.sku,itemName:e?.itemName,itemId:e?.itemId,siteId:t,totalWeight:e?.qty||0,pieces:null,items:e?.serials||[]},validateOnChange:!0,validationSchema:m.object({items:m.array().of(m.object({srlNo:m.string().test(function(e){return this.options.from[1]?.value?.items?.length===1||!!e})}))}),onSubmit:async t=>{let a=t.items.filter(e=>e?.srlNo).map((t,a)=>({...t,id:a+1,srlSeqNo:a+1,srlNo:t.srlNo,seqNo:e.id}));d({changes:{serials:a,...e?.hasOwnProperty("serialCount")&&{serialCount:a?.length||0}}}),r.close()}}),V=Z.values.items.reduce((e,t)=>{let a=parseFloat(t.weight)||0;return e+a},0),R=Z.values.totalWeight-V||0,M=[{component:"textfield",name:"srlNo",label:q.serialNo,jumpToNextLine:T,updateOn:"blur",onChange:async({row:{update:e,newRow:t,oldRow:a,addRow:r}})=>{t.srlNo!==a?.srlNo&&await J(t,e,r)}},{component:"numberfield",name:"weight",label:q.weight,props:{readOnly:!0}}],_=e=>{let t=Z.values.items.map(t=>t.id===e?{...t,srlNo:"",weight:""}:t);Z.setFieldValue("items",t)},G=e=>{let t=Z.values.items.filter(t=>t.id!==e);0===t.length&&(t=[{id:0,srlNo:"",weight:""}]),Z.setFieldValue("items",t)},J=async(t,r,n)=>{let{srlNo:s,id:l}=t;if(s){let i=await S({extension:x.$.Serial.get,parameters:`_srlNo=${s}`});i.record?i?.record?.itemId!==e?.itemId?(N({message:F.serialDoesNotBelongItem}),_(l)):a&&!O&&Z.values.siteId?(await S({extension:x.$.AvailabilitySerial.get,parameters:`_srlNo=${s}&_siteId=${Z.values.siteId}`})).record?(r({weight:i.record.weight}),n({fieldName:"srlNo",changes:{id:t.id,srlNo:t.srlNo,weight:i.record.weight}})):(N({message:q.invalidSerial}),_(l)):(r({weight:i.record.weight}),n({fieldName:"srlNo",changes:{id:t.id,srlNo:t.srlNo,weight:i.record.weight}})):(N({message:F.unknownSerial}),G(l))}},L=[{key:"Ok",condition:!0,onClick:()=>Z.handleSubmit(),disabled:j}];return n.jsx(C.Z,{onSave:Z.handleSubmit,isSaved:!1,actions:L,maxAccess:$,children:(0,n.jsxs)(s.R,{children:[n.jsx(g.g,{children:(0,n.jsxs)(o(),{container:!0,spacing:2,children:[n.jsx(o(),{item:!0,xs:12,children:n.jsx(h.U,{endpointId:x.$.Item.snapshot,name:"itemId",label:q?.sku,valueField:"recordId",displayField:"sku",valueShow:"sku",secondValueShow:"itemName",form:Z,readOnly:!0})}),n.jsx(o(),{item:!0,xs:12,children:n.jsx(c.Z,{endpointId:x.$.Site.qry,name:"siteId",label:q.site,values:Z.values,valueField:"recordId",displayField:["reference","name"],maxAccess:$,readOnly:!0})}),n.jsx(o(),{item:!0,xs:12,children:n.jsx(y.Z,{name:"totalWeight",label:q.totalWeight,maxAccess:$,value:Z.values.totalWeight,readOnly:!0})}),n.jsx(o(),{item:!0,xs:12,children:n.jsx(y.Z,{name:"weightAssigned",label:q.weightAssigned,maxAccess:$,value:V,readOnly:!0})}),n.jsx(o(),{item:!0,xs:12,children:n.jsx(y.Z,{name:"balanceWeight",label:q.balanceWeight,maxAccess:$,value:R,readOnly:!0})}),n.jsx(o(),{item:!0,xs:12,children:n.jsx(y.Z,{name:"pieces",label:q.pieces,maxAccess:$,value:Z?.values?.items?.filter(e=>void 0!==e.srlNo)?.length,readOnly:!0})})]})}),n.jsx(l.Q,{children:n.jsx(v._,{onChange:e=>Z.setFieldValue("items",e),value:Z.values?.items,error:Z.errors?.items,name:"items",columns:M,maxAccess:$,disabled:j,allowDelete:!j,allowAddNewLine:!j})})]})})};S.width=500,S.height=700,r()}catch(e){r(e)}})},70638:(e,t,a)=>{"use strict";a.a(e,async(e,r)=>{try{a.d(t,{Z:()=>y});var n=a(20997),s=a(16689),l=a(97996),i=a(29352),d=a(73846),o=a(96119),c=a(60520),u=a(20562),m=a(3),f=a.n(m),I=e([i,d,c]);[i,d,c]=I.then?(await I)():I;let p=({functionId:e,recordId:t,window:a})=>{let{getRequest:r}=(0,s.useContext)(i.$),{languageId:m}=(0,s.useContext)(d.V),{platformLabels:I}=(0,s.useContext)(c.l),p=t+"-"+e;(0,o.Z)({title:I.WorkFlow,window:a});let{width:y}=(0,u.d)(),h=y<=1024,x=y>1024&&y<=1280,v=h?10:x?12:14,g=h?75:x?85:95,A=h?15:x?20:25,w=async()=>{var a=`_functionId=${e}&_recordId=${t}`;let n=await r({extension:l.P.WorkFlow.graph,parameters:a});return n?.record},b=e=>{let t=[],a=[],r="",n="";return e.objects.forEach(e=>{t.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(t=>{e.objects.forEach(e=>{let a=e.functionName.split(" ").join("\r\n");t.parentId===e.recordId&&t.parentFunctionId===e.functionId&&(r=e.reference+"\r\n"+e.date+"\r\n"+a,t.parentId),t.childId===e.recordId&&t.childFunctionId===e.functionId&&(n=e.reference+"\r\n"+e.date+"\r\n"+a,t.childId)}),""===r||""===n||a.push({from:r,to:n,value:1,labelText:""}),r="",n=""}),a};return(0,s.useEffect)(()=>{!async function(){var e=await w();if(e){let t=(e,t)=>{let a=document.createElement("script");a.type="text/javascript",a.src=e,a.async=!0,a.onload=t,document.head.appendChild(a)};t("https://cdn.amcharts.com/lib/4/core.js",()=>{t("https://cdn.amcharts.com/lib/4/charts.js",()=>{t("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let t=am4core.create(p,am4charts.SankeyDiagram),a=b(e);t.data=a,t.dataFields.fromName="from",t.dataFields.toName="to",t.dataFields.value="value",t.paddingRight=2===m?0:40,t.paddingLeft=2===m?40:0,t.tooltip.label.fontSize=v;let r=t.nodes.template;r.draggable=!1,r.inert=!0,r.clickable=!1,r.width=g,r.height=A,r.nameLabel.label.fontSize=v,r.nameLabel.locationX=2===m?.85:0,r.nameLabel.height=void 0,r.nameLabel.label.fontWeight="bold";let n=t.links.template;n.middleLine.strokeOpacity=.3,n.middleLine.stroke=am4core.color("#555"),n.middleLine.strokeWidth=5,n.middleLine.hoverable=!1,n.fillOpacity=0,n.hoverable=!0,n.hoverOnFocus=!0,n.fill=am4core.color("#A8C686"),n.isHover=!0,t.appear(1e3,100)})})})})}}()},[]),n.jsx("div",{id:p,className:f().root})};p.width=950;let y=p;r()}catch(e){r(e)}})}};