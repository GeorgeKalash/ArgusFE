"use strict";exports.id=99002,exports.ids=[99002],exports.modules={68624:(e,r,t)=>{t.d(r,{Z:()=>l});var a=t(79660);t(6416);var i=t(82204),c=t(75281);let s=async(e,r,t)=>{try{let a=await e({extension:r,parameters:t});return r.includes("qry")?a:a.record}catch(e){return null}},n=(e,r,t,a)=>{let c=(e=JSON.parse(JSON.stringify(e))).record.controls,s=c.find(e=>"reference"===e.controlId);return s?s.accessLevel=r?.mandatory?i.$7:i.rr:r?.mandatory?c.push({sgId:0,resourceId:"",controlId:`${a?a+".":""}reference`,accessLevel:r?.mandatory?i.$7:i.rr}):r?.readOnly?c.push({sgId:0,resourceId:"",controlId:`${a?a+".":""}reference`,accessLevel:r?.readOnly?i.rr:i.$7}):c=e.record.controls.filter(e=>"reference"!=e.controlId),t&&c.push({sgId:0,resourceId:"",controlId:`${a?a+".":""}dtId`,accessLevel:i.$7}),{...e,record:{...e.record,controls:c}}},d=async(e,r,t)=>{let i,n;switch(t){case"dtId":let d=(0,c.m)("userData"),l=d?.userId;n=`_userId=${l}&_functionId=${r}`,i=a.r.UserFunction.get;break;case"glbSysNumberRange":n=`_recordId=${r}`,i=a.r.SystemFunction.get;break;case"DocumentType":n=`_dgId=${r}&_startAt=0&_pageSize=50`,i=a.r.DocumentType.qry;break;case"DcTypNumberRange":n=`_recordId=${r}`,i=a.r.DocumentType.get;break;case"isExternal":n=`_recordId=${r}`,i=a.r.NumberRange.get;break;default:return null}return await s(e,i,n)},l=async(e,r,t,a,i=!0,c)=>{let s,l,o,u;let b=void 0===a&&r&&await d(e,r,"dtId"),m=b?.dtId,P="",y=!0;if(b&&void 0===a||"nraId"===a){if(m){let r=await d(e,m,"DcTypNumberRange");s=r?.nraId,y=!(r?.activeStatus<0),s||(P="Assign the document type to a number range")}if((!m||!y)&&i&&r){let t=await d(e,r,"DocumentType");u=t?.list?.filter(e=>e?.activeStatus===1).length>0}}if(("nraId"===a||void 0===a)&&r){if((!m||m)&&!s||s&&!y){let t=await d(e,r,"glbSysNumberRange");(s=t?.nraId)&&u&&(u=!1),y=!0}P=s||u?"":"Assign the system Function to a number range"}a>0&&!s&&(s=a),s&&y?(o=await d(e,s,"isExternal"),l={readOnly:!o?.external,mandatory:!!o?.external},t&&(t=await n(t,l,u,c))):!s&&t&&(t=await n(t,l,u,c));let x=c?`${c}.reference`:"reference";return{dtId:m,resetReference:l?.readOnly,dcTypeRequired:u,reference:{fieldName:x,isEmpty:!(o?.external===void 0||o?.external)},errorMessage:P,maxAccess:t,selectNraId:a}}},75281:(e,r,t)=>{t.d(r,{m:()=>a});let a=e=>{let r=window.sessionStorage.getItem(e);return r?JSON.parse(r):null}},86794:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.d(r,{G:()=>o,H:()=>u});var i=t(49752),c=t(16689),s=t(70305),n=t(68624),d=t(29352),l=e([i,s,d]);function o({functionId:e,action:r,hasDT:t}){let{getRequest:a}=(0,c.useContext)(d.$),{stack:i}=(0,s.V)();return{proxyAction:async()=>{let c=await (0,n.Z)(a,e,"",void 0,t);c?.errorMessage?i({message:c?.errorMessage}):await r()}}}function u({functionId:e,access:r,hasDT:t,enabled:a=!0,objectName:l=""}){let{getRequest:o}=(0,c.useContext)(d.$),{stack:u}=(0,s.V)(),[b,m]=(0,c.useState)(),P=async a=>{let i=await (0,n.Z)(o,e,r,a,t,l);if(!i.errorMessage)return i;u({message:i?.errorMessage})},y=(0,i.useQuery)({retry:!1,staleTime:0,enabled:a,queryKey:[e,b,!!r,a],queryFn:b||"nraId"===b?()=>P(b):()=>P()});return{documentType:y.data,maxAccess:y?.data?.maxAccess||r,changeDT(e){m(e?.nraId||"nraId")}}}[i,s,d]=l.then?(await l)():l,a()}catch(e){a(e)}})},24356:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.d(r,{Z:()=>f});var i=t(20997),c=t(16689),s=t(40711),n=t(6416),d=t(38509),l=t(29352),o=t(18611),u=t(23385),b=t(42020),m=t(99155),P=t.n(m),y=t(44619),x=t(66198),I=t(60520),g=t(96119),h=e([s,d,l,I]);[s,d,l,I]=h.then?(await h)():h;let p=e=>{let{taxId:r,obj:t,window:a}=e,{getRequest:m}=(0,c.useContext)(l.$),{platformLabels:h}=(0,c.useContext)(I.l);(0,g.Z)({title:h.TaxDetails,window:a});let p=(e,r)=>{switch(e.taxBase){case 1:return(r.extendedPrice*e.amount/100).toFixed(2);case 2:return(r.qty*e.amount).toFixed(2);case 3:return(null!=r.basePrice?r.basePrice*r.qty*e.amount/100:0).toFixed(2);case 4:return(null!=r.baseLaborPrice?r.baseLaborPrice*r.qty*e.amount/100:0).toFixed(2);default:return null}},{query:{data:f},labels:w,access:L}=(0,d.J)({queryFn:T,endpointId:x.H.TaxDetailPack.qry,datasetId:n.i.TaxDetails}),v=[{field:"taxCodeRef",headerName:w.taxCodeRef,flex:1},{field:"taxCodeName",headerName:w.taxCodeName,flex:1},,{field:"taxBaseName",headerName:w.taxBaseName,flex:1},{field:"amount",headerName:w.taxAmount,flex:1,type:"number"},{field:"vatAmount",headerName:w.vatAmount,flex:1,type:"number"}];async function T(){let e=await m({extension:x.H.TaxDetailPack.qry,parameters:`_taxId=${r}`});return e.list=e.list.map(e=>{let r=p(e,t);return e.vatAmount=r,e}),e}return(0,i.jsxs)(o.R,{children:[i.jsx(b.g,{children:(0,i.jsxs)(P(),{container:!0,xs:9,spacing:2,sx:{p:2},children:[i.jsx(P(),{item:!0,xs:6,children:i.jsx(y.Z,{label:w.sku,value:t.sku,readOnly:!0})}),i.jsx(P(),{item:!0,xs:5}),i.jsx(P(),{item:!0,xs:6,children:i.jsx(y.Z,{label:w.itemName,value:t.itemName,readOnly:!0})})]})}),i.jsx(u.Q,{children:i.jsx(s.Z,{columns:v,gridData:f,rowId:["recordId"],isLoading:!1,maxAccess:L,pagination:!1})})]})};p.width=1e3;let f=p;a()}catch(e){a(e)}})},82173:(e,r,t)=>{t.d(r,{Ch:()=>h,On:()=>d,RD:()=>b,Xf:()=>i,Xo:()=>u,bT:()=>c,bh:()=>s,kx:()=>o,tV:()=>l,yO:()=>a,zL:()=>n});let a=1,i=2,c=3,s=4,n=5,d=6,l=8,o=9,u=1,b=2,m=e=>{switch(e.priceType){case 1:e.basePrice=e.unitPrice-e.baseLaborPrice;break;case 2:e.basePrice=e.unitPrice/e.volume;break;case 3:e.basePrice=e.unitPrice/e.weight-e.baseLaborPrice}return e.totalWeightPerG=e.basePrice+e.baseLaborPrice,e},P=e=>(e.baseLaborPrice=e.unitPrice/(3===e.priceType?e.weight:2===e.priceType?e.volume:1)-e.basePrice,e.totalWeightPerG=e.basePrice+e.baseLaborPrice,e),y=e=>0===e.mdAmount||e.mdType!==u?(e.mdValue=e.mdAmount,(e.unitPrice-e.mdAmount+e.upo)*e.qty):(e.mdValue=e.unitPrice*e.mdAmount/100,(e.unitPrice-e.mdValue+e.upo)*e.qty),x=e=>(e.extendedPrice=y(e),e),I=e=>{let r=y(e);if(Math.abs(r-e.extendedPrice)>.01&&alert("INVOICE_LINE_PRICE_ERROR ExtendedPrice / "+e.unitPrice+"/"+e.qty+"/"+e.extendedPrice+"/"+r),2===e.priceType)0===e.volume&&alert("ITEM_VOLUME_NOT_SPECIFIED"),0!==e.baseLaborPrice&&0!==e.basePrice&&Math.abs((e.baseLaborPrice+e.basePrice)*e.volume-e.unitPrice)>.01&&alert("INVOICE_LINE_PRICE_ERROR UnitPrice-volume "+e.basePrice+"/"+e.volume+"/"+e.unitPrice);else if(3===e.priceType){if(0===e.weight&&alert("ITEM_WEIGHT_NOT_SPECIFIED"),0!==e.baseLaborPrice&&0!==e.basePrice){let r=(e.baseLaborPrice+e.basePrice)*e.weight;Math.abs(r-e.unitPrice)>.01&&alert("INVOICE_LINE_PRICE_ERROR UnitPrice-weight "+e.basePrice+"/"+e.weight+"/"+e.unitPrice+"/"+r)}}else if(0!==e.baseLaborPrice&&0!==e.basePrice){let r=e.basePrice+e.baseLaborPrice;Math.abs(r-e.unitPrice)>.01&&alert("INVOICE_LINE_PRICE_ERROR UnitPrice-quantity "+e.basePrice+"/"+e.unitPrice+"/"+r)}},g=e=>{switch(console.log(e),e.dirtyField){case o:e.baseLaborPrice=e.totalWeightPerG-e.basePrice;case l:case a:e.unitPrice=(e.basePrice+e.baseLaborPrice)*(3===e.priceType?e.weight:2===e.priceType?e.volume:1),e.totalWeightPerG=e.basePrice+e.baseLaborPrice,e=x(e);break;case c:e=x(e);break;case i:0!=e.baseLaborPrice?e=P(e):0!=e.basePrice&&(e=m(e)),e=x(e);break;case n:case d:case 7:e=x(e);break;case s:0!==e.qty&&(0===e.mdAmount?(e.unitPrice=e.extendedPrice/e.qty-e.upo,0!==e.baseLaborPrice?e=P(e):0!==e.basePrice&&(e=m(e)),e.totalWeightPerG=e.basePrice+e.baseLaborPrice):(e.mdValue=e.unitPrice+e.upo-e.extendedPrice/e.qty,e.mdType!==u?e.mdAmount=e.mdValue:e.mdAmount=0===e.unitPrice?0:100*e.mdValue/e.unitPrice));break;case 10:e=x(e);break;default:alert("I don't know such dirtyField "+e.dirtyField)}return e},h=e=>(console.log("check row ",e),2===e.priceType&&0===e.volume&&alert("item volume not defined"),I(e=g(e)),e)},57629:(e,r,t)=>{t.d(r,{VW:()=>c});let a=(e,r)=>{let t=0;switch(r.taxBase){case 1:t=0==e.tdPct?e.extendedPrice*r.amount/100:e.extendedPrice*(1-e.tdPct/100)*r.amount/100;break;case 2:t=e?.priceType===3?r.amount*e.qty*e.weight:r.amount*e.qty;break;case 3:t=e.basePrice*e.qty*r.amount/100;break;case 4:t=e.baseLaborPrice*e.qty*r.amount/100;break;default:t=0}return t},i=e=>{let r=0;if(null!=e.taxDetails)for(let t=0;t<e.taxDetails.length;t++)r+=a(e,e.taxDetails[t]);return r},c=e=>(e.vatAmount=i(e),e)}};