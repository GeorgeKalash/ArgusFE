exports.id=18489,exports.ids=[18489],exports.modules={3:e=>{e.exports={root:"WorkFlow_root__EINm1"}},68624:(e,a,r)=>{"use strict";r.d(a,{Z:()=>i});var d=r(79660);r(6416);var t=r(82204),n=r(75281);let l=async(e,a,r)=>{try{let d=await e({extension:a,parameters:r});return a.includes("qry")?d:d.record}catch(e){return null}},s=(e,a,r,d)=>{let n=(e=JSON.parse(JSON.stringify(e))).record.controls,l=n.find(e=>"reference"===e.controlId);return l?l.accessLevel=a?.mandatory?t.$7:t.rr:a?.mandatory?n.push({sgId:0,resourceId:"",controlId:`${d?d+".":""}reference`,accessLevel:a?.mandatory?t.$7:t.rr}):a?.readOnly?n.push({sgId:0,resourceId:"",controlId:`${d?d+".":""}reference`,accessLevel:a?.readOnly?t.rr:t.$7}):n=e.record.controls.filter(e=>"reference"!=e.controlId),r&&n.push({sgId:0,resourceId:"",controlId:`${d?d+".":""}dtId`,accessLevel:t.$7}),{...e,record:{...e.record,controls:n}}},o=async(e,a,r)=>{let t,s;switch(r){case"dtId":let o=(0,n.m)("userData"),i=o?.userId;s=`_userId=${i}&_functionId=${a}`,t=d.r.UserFunction.get;break;case"glbSysNumberRange":s=`_recordId=${a}`,t=d.r.SystemFunction.get;break;case"DocumentType":s=`_dgId=${a}&_startAt=0&_pageSize=50`,t=d.r.DocumentType.qry;break;case"DcTypNumberRange":s=`_recordId=${a}`,t=d.r.DocumentType.get;break;case"isExternal":s=`_recordId=${a}`,t=d.r.NumberRange.get;break;default:return null}return await l(e,t,s)},i=async(e,a,r,d,t=!0,n)=>{let l,i,c,u;let m=void 0===d&&a&&await o(e,a,"dtId"),h=m?.dtId,g="",y=!0;if(m&&void 0===d||"nraId"===d){if(h){let a=await o(e,h,"DcTypNumberRange");l=a?.nraId,y=!(a?.activeStatus<0),l||(g="Assign the document type to a number range")}if((!h||!y)&&t&&a){let r=await o(e,a,"DocumentType");u=r?.list?.filter(e=>e?.activeStatus===1).length>0}}if(("nraId"===d||void 0===d)&&a){if((!h||h)&&!l||l&&!y){let r=await o(e,a,"glbSysNumberRange");(l=r?.nraId)&&u&&(u=!1),y=!0}g=l||u?"":"Assign the system Function to a number range"}d>0&&!l&&(l=d),l&&y?(c=await o(e,l,"isExternal"),i={readOnly:!c?.external,mandatory:!!c?.external},r&&(r=await s(r,i,u,n))):!l&&r&&(r=await s(r,i,u,n));let x=n?`${n}.reference`:"reference";return{dtId:h,resetReference:i?.readOnly,dcTypeRequired:u,reference:{fieldName:x,isEmpty:!(c?.external===void 0||c?.external)},errorMessage:g,maxAccess:r,selectNraId:d}}},75281:(e,a,r)=>{"use strict";r.d(a,{m:()=>d});let d=e=>{let a=window.sessionStorage.getItem(e);return a?JSON.parse(a):null}},86794:(e,a,r)=>{"use strict";r.a(e,async(e,d)=>{try{r.d(a,{G:()=>c,H:()=>u});var t=r(49752),n=r(16689),l=r(70305),s=r(68624),o=r(29352),i=e([t,l,o]);function c({functionId:e,action:a,hasDT:r}){let{getRequest:d}=(0,n.useContext)(o.$),{stack:t}=(0,l.V)();return{proxyAction:async()=>{let n=await (0,s.Z)(d,e,"",void 0,r);n?.errorMessage?t({message:n?.errorMessage}):await a()}}}function u({functionId:e,access:a,hasDT:r,enabled:d=!0,objectName:i=""}){let{getRequest:c}=(0,n.useContext)(o.$),{stack:u}=(0,l.V)(),[m,h]=(0,n.useState)(),g=async d=>{let t=await (0,s.Z)(c,e,a,d,r,i);if(!t.errorMessage)return t;u({message:t?.errorMessage})},y=(0,t.useQuery)({retry:!1,staleTime:0,enabled:d,queryKey:[e,m,!!a,d],queryFn:m||"nraId"===m?()=>g(m):()=>g()});return{documentType:y.data,maxAccess:y?.data?.maxAccess||a,changeDT(e){h(e?.nraId||"nraId")}}}[t,l,o]=i.then?(await i)():i,d()}catch(e){d(e)}})},18489:(e,a,r)=>{"use strict";r.a(e,async(e,d)=>{try{r.d(a,{Z:()=>$});var t=r(20997),n=r(27736),l=r(79390),s=r(99155),o=r.n(s),i=r(16689),c=r(75609),u=r(80582),m=r(86201),h=r(29352),g=r(6416),y=r(44619),x=r(65980),b=r(71278),I=r(79660),f=r(68728),v=r(61274),p=r(23385),j=r(18611),F=r(91184),w=r(59636),C=r(95965),Q=r(60520),k=r(86794),N=r(40711),q=r(70755),D=r(42020),R=r(54242),O=r(38782),J=r(38509),V=r(70638),P=r(677),S=r(12048),A=e([u,m,h,b,v,Q,k,N,O,J,V,P]);function $({recordId:e,lockRecord:a}){let{getRequest:r,postRequest:d}=(0,i.useContext)(h.$),{platformLabels:s}=(0,i.useContext)(Q.l),{addLockedScreen:A}=(0,i.useContext)(S.Z),{stack:$}=(0,P.zY)(),Z=(0,J.E)({endpointId:w.u.Damage.page}),{labels:_,access:M}=(0,O.Z)({endpointId:w.u.Damage.page,datasetId:g.i.Damages}),{documentType:T,maxAccess:L,changeDT:W}=(0,k.H)({functionId:f.J.Damage,access:M,enabled:!e,objectName:"header"}),{formik:E}=(0,C.c)({maxAccess:L,documentType:{key:"header.dtId",value:T?.dtId},initialValues:{recordId:e||null,header:{recordId:e||null,dtId:null,reference:"",date:new Date,plantId:null,laborId:null,notes:"",status:1,jobId:null,seqNo:0,workCenterId:null,maxPcs:50,jobQty:0,jobPcs:0,damageRate:0,damagedQty:0,damagedPcs:0,netJobQty:0,netJobPcs:0,metalQty:0,nonMetalQty:0,generatedJobRef:"",routingId:null,routingName:""},items:[]},validateOnChange:!0,validationSchema:c.object({header:c.object({plantId:c.string().required(),jobId:c.string().required(),date:c.string().required(),laborId:c.number().required(),damageRate:c.number().required(),jobQty:c.number().required(),jobPcs:c.number().required(),netJobQty:c.number().required(),netJobPcs:c.number().required(),metalQty:c.number().required().min(0),nonMetalQty:c.number().required().min(0),routingId:c.number().nullable().when("genJobFromDamage",{is:!0,then:()=>c.number().required(),otherwise:()=>c.number().nullable()}),damagedPcs:c.lazy((e,{parent:a})=>c.number().min(1).max(a.maxPcs,({max:e})=>`Must be less than or equal to ${e}`).nullable(!0)),damagedQty:c.number().required().test("max-jobQty","Qty cannot be greater than Job Qty",function(e){return null==e||e<=this.parent.jobQty})})}),onSubmit:async e=>{let a={header:{...E.values.header,date:(0,l.ku)(e.header.date),damageRate:e.header.damageRate||0,qty:e.header.qty||0},items:E?.values?.items?.map(({id:e,...a})=>({seqNo:e,...a}))||[]},r=await d({extension:w.u.Damage.set2,record:JSON.stringify(a)});await z(r.recordId),m.default.success(U?s.Edited:s.Added),Z()}});async function z(e){await r({extension:w.u.Damage.get2,parameters:`_recordId=${e}`}).then(async e=>{let r=await el(e?.record?.header?.dtId);E.setValues({recordId:e?.record?.header?.recordId||null,header:{...e?.record?.header,date:(0,l.a1)(e?.record?.header?.date),maxPcs:e?.record?.header?.jobPcs,workCenterName:e?.record?.header?.wcName,workCenterRef:e?.record?.header?.wcRef,genJobFromDamage:r},items:e?.record?.items||[]}),E.values.recordId||a({recordId:e?.record?.header?.recordId,reference:e?.record?.header?.reference,resourceId:g.i.Damages,onSuccess:()=>{A({resourceId:g.i.Damages,recordId:e?.record?.header?.recordId,reference:e?.record?.header?.reference})}})})}let U=!!E.values.header.recordId,H=3===E.values.header.status,G=async()=>{await d({extension:w.u.Damage.post,record:JSON.stringify(E.values.header)}),m.default.success(s.Posted),Z(),await z(E.values.recordId)};async function K(){$({Component:V.Z,props:{functionId:f.J.Damage,recordId:E.values.recordId}})}let X=[{key:"Locked",condition:H,disabled:!U||H},{key:"Unlocked",condition:!H,onClick:G,disabled:!U||H},{key:"WorkFlow",condition:!0,onClick:K,disabled:!U}],Y=[{field:"sku",headerName:_.sku,flex:1},{field:"itemName",headerName:_.itemName,flex:1},{field:"qty",headerName:_.qty,flex:1},{field:"damageQty",headerName:_.damageQty,flex:1}],B=async()=>{if(!E.values.header.jobId&&!E.values.header.damageRate)return;let e=await r({extension:w.u.Damage.preview,parameters:`_jobId=${E.values.header.jobId||0}&_damagedQty=${E.values.header.damagedQty||0}&_damagedPcs=${E.values.header.damagedPcs||0}&_metalQty=${E.values.header.metalQty||0}&_nonMetalQty=${E.values.header.nonMetalQty||0}`});E.setFieldValue("items",e?.list||[])},{jobQty:ee=0,damagedQty:ea=0,jobPcs:er=0,damagedPcs:ed=0}=E.values.header;async function et(e){if(!e)return;let a=await r({extension:w.u.JobMaterial.qry,parameters:`_jobId=${e}&_seqNo=0`}),d=a?.list||[],t=d.filter(e=>!!e.isMetal).reduce((e,a)=>e+(Number(a.qty)||0),0),n=d.filter(e=>!e.isMetal).reduce((e,a)=>e+(Number(a.qty)||0),0);return{metalQty:t,nonMetalQty:n}}let en=E?.values?.items?.length>0;async function el(e){if(e){let a=await r({extension:w.u.DocumentTypeDefault.get,parameters:`_dtId=${e}`});return E.setFieldValue("header.genJobFromDamage",a?.record?.genJobFromDamage),a?.record?.genJobFromDamage||!1}E.setFieldValue("header.genJobFromDamage",!1)}let es=async e=>{if(!e)return;let a=await r({extension:w.u.RoutingSequence.qry,parameters:`_routingId=${e}`});return a?.list?.[0]?.seqNo||null};return t.jsx(u.Z,{resourceId:g.i.Damages,functionId:f.J.Damage,form:E,maxAccess:L,previewReport:U,isPosted:H,actions:X,editMode:U,disabledSubmit:0!=E.values.header.damagedQty&&!en||H,disabledSavedClear:0!=E.values.header.damagedQty&&!en||H,isParentWindow:!1,children:(0,t.jsxs)(j.R,{children:[t.jsx(D.g,{children:(0,t.jsxs)(o(),{container:!0,spacing:2,paddingTop:1,children:[t.jsx(o(),{item:!0,xs:3,children:(0,t.jsxs)(o(),{container:!0,spacing:2,children:[t.jsx(o(),{item:!0,xs:12,children:t.jsx(b.Z,{endpointId:I.r.DocumentType.qry,parameters:`_startAt=0&_pageSize=1000&_dgId=${f.J.Damage}`,name:"header.dtId",label:_.documentType,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:E.values.header.jobId||U,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:2,values:E.values.header,maxAccess:L,onChange:async(e,a)=>{await W(a),await el(a?.recordId),E.setFieldValue("header.dtId",a?.recordId||null)},error:E?.touched?.header?.dtId&&!!E?.errors?.header?.dtId})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(y.Z,{name:"header.reference",label:_.reference,value:E?.values?.header?.reference,maxAccess:!U&&L,readOnly:U,onChange:E.handleChange,onClear:()=>E.setFieldValue("header.reference",""),error:E?.touched?.header?.reference&&!!E?.errors?.header?.reference})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(n.Z,{name:"header.date",required:!0,label:_.date,value:E?.values?.header?.date,onChange:E.setFieldValue,readOnly:U,maxAccess:L,onClear:()=>E.setFieldValue("header.date",null),error:E?.touched?.header?.date&&!!E?.errors?.header?.date})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(b.Z,{endpointId:I.r.Plant.qry,name:"header.plantId",required:!0,readOnly:H,label:_.plant,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:1.5,values:E.values.header,valueField:"recordId",displayField:["reference","name"],maxAccess:L,onChange:(e,a)=>{E.setFieldValue("header.plantId",a?.recordId||null)},error:E?.touched?.header?.plantId&&!!E?.errors?.header?.plantId})}),t.jsx(o(),{item:!0,xs:12,children:(0,t.jsxs)(o(),{container:!0,spacing:2,children:[t.jsx(o(),{item:!0,xs:6,children:t.jsx(q.Z,{onClick:B,image:"preview.png",tooltipText:s.Preview,disabled:0==E.values.header.damagedQty||H})}),t.jsx(o(),{item:!0,xs:6,children:t.jsx(F.Z,{name:"header.routingSeqNo",label:_.routingSeqNo,value:E?.values?.header?.routingSeqNo,maxAccess:L,readOnly:!0})})]})})]})}),t.jsx(o(),{item:!0,xs:3,children:(0,t.jsxs)(o(),{container:!0,spacing:2,children:[t.jsx(o(),{item:!0,xs:12,children:t.jsx(v.U,{endpointId:w.u.MFJobOrder.snapshot,filter:{status:4},valueField:"reference",displayField:"reference",secondDisplayField:!1,name:"header.jobId",label:_.jobOrder,form:E,formObject:E.values.header,required:!0,readOnly:en||U,displayFieldWidth:2,valueShow:"jobRef",maxAccess:L,editMode:U,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"itemName",value:"Item Name"},{key:"description",value:"Description"}],onChange:async(e,a)=>{let r=await et(a?.recordId);E.setValues({header:{...E.values.header,jobId:a?.recordId||null,jobRef:a?.reference||"",jobQty:a?.qty||0,jobPcs:a?.pcs||0,sku:a?.sku||"",designRef:a?.designRef||"",designName:a?.designName||"",itemName:a?.itemName||"",workCenterName:a?.wcName||"",workCenterId:a?.workCenterId||null,maxPcs:a?.pcs||0,damageRate:E.values.qty/a?.qty*100||0,...E.values.header.genJobFromDamage?{}:{routingName:a?.routingName||"",routingId:a?.routingId||null,routingRef:a?.routingRef||"",routingSeqNo:a?.routingSeqNo||null},metalQty:r?.metalQty||0,nonMetalQty:r?.nonMetalQty||0}})},errorCheck:"header.jobId"})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(v.U,{endpointId:R.$.Item.snapshot,name:"header.itemId",label:_.sku,valueField:"recordId",displayField:"name",valueShow:"sku",secondValueShow:"itemName",formObject:E.values.header,readOnly:!0,maxAccess:L})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(v.U,{endpointId:w.u.Design.snapshot,name:"header.designId",label:_.designRef,valueField:"recordId",displayField:"name",valueShow:"designRef",secondValueShow:"designName",formObject:E.values.header,readOnly:!0,maxAccess:L})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(y.Z,{name:"header.workCenterName",label:_.workCenter,value:E?.values?.header?.workCenterName,maxAccess:L,readOnly:!0})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(v.U,{endpointId:w.u.Routing.snapshot,valueField:"reference",displayField:"name",name:"header.routingId",label:_.routing,formObject:E.values.header,form:E,minChars:2,firstFieldWidth:5,firstValue:E.values.header.routingRef,secondValue:E.values.header.routingName,errorCheck:"header.routingId",maxAccess:L,displayFieldWidth:2,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],required:E.values.header.genJobFromDamage,readOnly:!E.values.header.genJobFromDamage||H,onChange:async(e,a)=>{let r=await es(a?.recordId);E.setFieldValue("header.routingSeqNo",r||null),E.setFieldValue("header.routingRef",a?.reference||null),E.setFieldValue("header.routingName",a?.name||null),E.setFieldValue("header.routingId",a?.recordId||null)}})})]})}),t.jsx(o(),{item:!0,xs:3,children:(0,t.jsxs)(o(),{container:!0,spacing:2,children:[t.jsx(o(),{item:!0,xs:12,children:t.jsx(F.Z,{name:"header.jobQty",label:_.jobQty,value:E.values?.header?.jobQty,onChange:E.handleChange,onClear:()=>E.setFieldValue("header.jobQty",0),required:!0,readOnly:!0,maxAccess:L,error:E?.touched?.header?.jobQty&&!!E?.errors?.header?.jobQty})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(F.Z,{name:"header.jobPcs",readOnly:!0,label:_.jobPcs,value:E.values?.header?.jobPcs,onChange:E.handleChange,onClear:()=>E.setFieldValue("header.jobPcs",0),required:!0,maxAccess:L,error:E?.touched?.header?.jobPcs&&!!E?.errors?.header?.jobPcs})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(F.Z,{name:"header.damagedQty",label:_.damagedQty,value:E.values?.header?.damagedQty,onChange:e=>{E.setFieldValue("header.damageRate",e.target.value/E?.values?.header?.jobQty*100||0),E.setFieldValue("header.damagedQty",e.target.value)},maxLength:11,decimalScale:2,onClear:()=>{E.setFieldValue("header.damageRate",null),E.setFieldValue("header.damagedQty",null)},maxAccess:L,readOnly:en||H,required:!0,error:E?.touched?.header?.damagedQty&&!!E?.errors?.header?.damagedQty})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(F.Z,{name:"header.damagedPcs",readOnly:en||H,label:_.damagedPcs,value:E.values?.header?.damagedPcs,decimalScale:0,onChange:E.handleChange,onClear:()=>E.setFieldValue("header.damagedPcs",0),required:!0,maxAccess:L,error:E?.touched?.header?.damagedPcs&&!!E?.errors?.header?.damagedPcs})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(b.Z,{endpointId:w.u.Labor.qry,parameters:"_startAt=0&_pageSize=200&_params=",name:"header.laborId",label:_.labor,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],displayFieldWidth:2,required:!0,readOnly:H,values:E.values.header,onChange:(e,a)=>{E.setFieldValue("header.laborId",a?.recordId||null)},error:E?.touched?.header?.laborId&&!!E?.errors?.header?.laborId})})]})}),t.jsx(o(),{item:!0,xs:3,children:(0,t.jsxs)(o(),{container:!0,spacing:2,children:[t.jsx(o(),{item:!0,xs:12,children:(0,t.jsxs)(o(),{container:!0,spacing:2,children:[t.jsx(o(),{item:!0,xs:6,children:t.jsx(F.Z,{name:"header.metalQty",label:_.metalQty,value:E.values?.header?.metalQty,onChange:E.handleChange,onClear:()=>E.setFieldValue("header.metalQty",null),maxAccess:L,required:!0,readOnly:!0,error:E?.touched?.header?.metalQty&&!!E?.errors?.header?.metalQty})}),t.jsx(o(),{item:!0,xs:6,children:t.jsx(F.Z,{name:"header.nonMetalQty",label:_.nonMetalQty,value:E.values?.header?.nonMetalQty,onChange:E.handleChange,readOnly:!0,onClear:()=>E.setFieldValue("header.nonMetalQty",null),maxAccess:L,required:!0,error:E?.touched?.header?.nonMetalQty&&!!E?.errors?.header?.nonMetalQty})})]})}),t.jsx(o(),{item:!0,xs:12,children:(0,t.jsxs)(o(),{container:!0,spacing:2,children:[t.jsx(o(),{item:!0,xs:6,children:t.jsx(F.Z,{name:"header.netJobQty",label:_.netJobQty,value:ee-ea,onChange:E.handleChange,onClear:()=>E.setFieldValue("header.netJobQty",null),maxAccess:L,readOnly:!0,required:!0,error:E?.touched?.header?.netJobQty&&!!E?.errors?.header?.netJobQty})}),t.jsx(o(),{item:!0,xs:6,children:t.jsx(F.Z,{name:"header.netJobPcs",label:_.netJobPcs,value:er-ed,onChange:E.handleChange,onClear:()=>E.setFieldValue("header.netJobPcs",null),maxAccess:L,readOnly:!0,required:!0,error:E?.touched?.header?.netJobPcs&&!!E?.errors?.header?.netJobPcs})})]})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(y.Z,{name:"header.generatedJobRef",label:_.generatedJobRef,value:E.values?.header?.generatedJobRef,maxAccess:L,onChange:E.handleChange,readOnly:!0,onClear:()=>E.setFieldValue("header.generatedJobRef",""),error:E.touched?.header?.generatedJobRef&&!!E.errors?.header?.generatedJobRef})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(b.Z,{endpointId:w.u.DamageReason.qry,name:"header.reasonId",label:_.damageReason,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:H,values:E.values.header,maxAccess:L,onChange:(e,a)=>{E.setFieldValue("header.reasonId",a?.recordId||null)},error:E?.touched?.header?.reasonId&&E?.errors?.header?.reasonId})}),t.jsx(o(),{item:!0,xs:12,children:t.jsx(b.Z,{endpointId:w.u.DamageCategory.qry,name:"header.categoryId",label:_.damageCategory,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],values:E.values.header,maxAccess:L,readOnly:H,onChange:(e,a)=>{E.setFieldValue("header.categoryId",a?.recordId||null)},error:E?.touched?.header?.categoryId&&E?.errors?.header?.categoryId})})]})})]})}),t.jsx(p.Q,{children:t.jsx(N.Z,{name:"damageTable",columns:Y,gridData:{list:E.values.items},rowId:["recordId"],pagination:!1,maxAccess:M})}),t.jsx(D.g,{children:t.jsx(o(),{container:!0,spacing:2,paddingTop:1,children:t.jsx(o(),{item:!0,xs:4,children:t.jsx(x.Z,{name:"header.notes",label:_.remarks,value:E.values.header.notes,rows:4,editMode:U,readOnly:H,maxAccess:L,onChange:e=>E.setFieldValue("header.notes",e.target.value),onClear:()=>E.setFieldValue("header.notes",""),error:E?.touched?.header?.notes&&!!E.errors?.header?.notes})})})})]})})}[u,m,h,b,v,Q,k,N,O,J,V,P]=A.then?(await A)():A,d()}catch(e){d(e)}})},70638:(e,a,r)=>{"use strict";r.a(e,async(e,d)=>{try{r.d(a,{Z:()=>x});var t=r(20997),n=r(16689),l=r(97996),s=r(29352),o=r(73846),i=r(96119),c=r(60520),u=r(20562),m=r(3),h=r.n(m),g=e([s,o,c]);[s,o,c]=g.then?(await g)():g;let y=({functionId:e,recordId:a,window:r})=>{let{getRequest:d}=(0,n.useContext)(s.$),{languageId:m}=(0,n.useContext)(o.V),{platformLabels:g}=(0,n.useContext)(c.l),y=a+"-"+e;(0,i.Z)({title:g.WorkFlow,window:r});let{width:x}=(0,u.d)(),b=x<=1024,I=x>1024&&x<=1280,f=b?10:I?12:14,v=b?75:I?85:95,p=b?15:I?20:25,j=async()=>{var r=`_functionId=${e}&_recordId=${a}`;let t=await d({extension:l.P.WorkFlow.graph,parameters:r});return t?.record},F=e=>{let a=[],r=[],d="",t="";return e.objects.forEach(e=>{a.push({functionName:e.functionName,reference:e.reference,date:e.date})}),e.workflow.forEach(a=>{e.objects.forEach(e=>{let r=e.functionName.split(" ").join("\r\n");a.parentId===e.recordId&&a.parentFunctionId===e.functionId&&(d=e.reference+"\r\n"+e.date+"\r\n"+r,a.parentId),a.childId===e.recordId&&a.childFunctionId===e.functionId&&(t=e.reference+"\r\n"+e.date+"\r\n"+r,a.childId)}),""===d||""===t||r.push({from:d,to:t,value:1,labelText:""}),d="",t=""}),r};return(0,n.useEffect)(()=>{!async function(){var e=await j();if(e){let a=(e,a)=>{let r=document.createElement("script");r.type="text/javascript",r.src=e,r.async=!0,r.onload=a,document.head.appendChild(r)};a("https://cdn.amcharts.com/lib/4/core.js",()=>{a("https://cdn.amcharts.com/lib/4/charts.js",()=>{a("https://cdn.amcharts.com/lib/4/themes/animated.js",()=>{am4core.ready(()=>{let a=am4core.create(y,am4charts.SankeyDiagram),r=F(e);a.data=r,a.dataFields.fromName="from",a.dataFields.toName="to",a.dataFields.value="value",a.paddingRight=2===m?0:40,a.paddingLeft=2===m?40:0,a.tooltip.label.fontSize=f;let d=a.nodes.template;d.draggable=!1,d.inert=!0,d.clickable=!1,d.width=v,d.height=p,d.nameLabel.label.fontSize=f,d.nameLabel.locationX=2===m?.85:0,d.nameLabel.height=void 0,d.nameLabel.label.fontWeight="bold";let t=a.links.template;t.middleLine.strokeOpacity=.3,t.middleLine.stroke=am4core.color("#555"),t.middleLine.strokeWidth=5,t.middleLine.hoverable=!1,t.fillOpacity=0,t.hoverable=!0,t.hoverOnFocus=!0,t.fill=am4core.color("#A8C686"),t.isHover=!0,a.appear(1e3,100)})})})})}}()},[]),t.jsx("div",{id:y,className:h().root})};y.width=950;let x=y;d()}catch(e){d(e)}})}};