"use strict";exports.id=85960,exports.ids=[85960],exports.modules={85960:(e,a,d)=>{d.a(e,async(e,r)=>{try{d.d(a,{Z:()=>_});var n=d(20997),l=d(99155),s=d.n(l),t=d(16689),i=d(75609),o=d(80582),u=d(86201),c=d(29352),m=d(38509),I=d(6416),p=d(95965),h=d(44619),y=d(71278),x=d(18611),v=d(23385),g=d(60520),D=d(96995),f=d(65980),C=d(79390),k=d(79660),F=d(91184),j=d(27736),b=d(68728),R=d(86794),w=d(61274),S=d(97969),A=d(528),G=d(65977),N=d(677),V=d(54242),O=d(59636),Z=d(76788),T=d(38782),q=d(96119),P=e([o,u,c,m,y,g,R,w,A,G,N,T]);[o,u,c,m,y,g,R,w,A,G,N,T]=P.then?(await P)():P;let L=({recordId:e,window:a})=>{let{platformLabels:d}=(0,t.useContext)(g.l),{getRequest:r,postRequest:l}=(0,t.useContext)(c.$),{stack:P}=(0,N.zY)(),L=b.J.ThreeDDesign,_=(0,t.useRef)(null),z=(0,m.E)({endpointId:D.z.ThreeDDesign.page}),{labels:E,access:$}=(0,T.Z)({datasetId:I.i.ThreeDDesign,editMode:!!e});(0,q.Z)({title:E.ThreeDDesign,window:a});let{documentType:M,maxAccess:J,changeDT:U}=(0,R.H)({functionId:L,access:$,enabled:!e}),{formik:W}=(0,p.c)({documentType:{key:"dtId",value:M?.dtId},initialValues:{recordId:null,wip:1,status:1,dtId:null,reference:"",source:null,sketchId:null,designerId:null,setPcs:0,weight:0,castingType:null,notes:"",date:new Date,startDate:null,designGroupId:null,designFamilyId:null,endDate:null,fileReference:"",itemGroupId:null,productionClassId:null,productionStandardId:null,metalId:null,collectionId:null},maxAccess:J,validateOnChange:!0,validationSchema:i.object({source:i.number().required(),sketchId:i.number().required(),castingType:i.number().required(),fileReference:i.string().required()}),onSubmit:async a=>{let r={...a,date:(0,C.ku)(a.date),startDate:a.startDate?(0,C.ku)(a.startDate):null,endDate:a.endDate?(0,C.ku)(a.endDate):null},n=await l({extension:D.z.ThreeDDesign.set,record:JSON.stringify(r)});_.current&&(_.current.value=n.recordId,await _.current.submit()),await B(n.recordId),z(),u.default.success(e?d.Edited:d.Added)}}),H=!!W.values.recordId,Y=2===W.values.wip,Q=3===W.values.status;async function B(e){await r({extension:D.z.ThreeDDesign.get,parameters:`_recordId=${e}`}).then(e=>{W.setValues({...e.record,date:(0,C.a1)(e?.record?.date),startDate:(0,C.a1)(e?.record?.startDate),endDate:(0,C.a1)(e?.record?.endDate)})})}(0,t.useEffect)(()=>{!async function(){e&&await B(e)}()},[]);let K=async()=>{let e={...W.values,date:(0,C.ku)(W.values.date),startDate:W.values.startDate?(0,C.ku)(W.values.startDate):null,endDate:W.values.endDate?(0,C.ku)(W.values.endDate):null};await l({extension:D.z.ThreeDDesign.post,record:JSON.stringify(e)}).then(async()=>{await B(e.recordId),u.default.success(d.Posted),z()})};async function X(){let e={...W.values,date:(0,C.ku)(W.values.date),startDate:W.values.startDate?(0,C.ku)(W.values.startDate):null,endDate:W.values.endDate?(0,C.ku)(W.values.endDate):null};await l({extension:D.z.ThreeDDesign.close,record:JSON.stringify(e)}).then(async e=>{await B(e.recordId),u.default.success(d.Closed),z()})}async function ee(){let e={...W.values,date:(0,C.ku)(W.values.date),startDate:W.values.startDate?(0,C.ku)(W.values.startDate):null,endDate:W.values.endDate?(0,C.ku)(W.values.endDate):null};await l({extension:D.z.ThreeDDesign.reopen,record:JSON.stringify(e)}).then(async e=>{await B(e.recordId),u.default.success(d.Reopened),z()})}async function ea(){P({Component:G.Z,props:{labels:E,recordId:W?.values?.sketchId,maxAccess:$}})}let ed=[{key:"Close",condition:!Y,onClick:X,disabled:!H||Q},{key:"Reopen",condition:Y,onClick:ee,disabled:!H||Q},{key:"Unlocked",condition:!Q,onClick:K,disabled:!H||!Y},{key:"Locked",condition:Q,onClick:"onUnpostConfirmation",disabled:!0},{key:"Approval",condition:!0,onClick:"onApproval",disabled:!Y},{key:"Sketch",condition:!0,onClick:ea,disabled:!W?.values?.sketchId}];return n.jsx(o.Z,{resourceId:I.i.ThreeDDesign,functionId:L,form:W,maxAccess:J,editMode:H,actions:ed,disabledSubmit:Y,children:n.jsx(x.R,{children:n.jsx(v.Q,{children:(0,n.jsxs)(s(),{container:!0,spacing:2,children:[n.jsx(s(),{item:!0,xs:4,children:(0,n.jsxs)(s(),{container:!0,spacing:2,children:[n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:k.r.DocumentType.qry,parameters:`_startAt=0&_pageSize=1000&_dgId=${L}`,name:"dtId",label:E.doctype,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],valueField:"recordId",displayField:["reference","name"],values:W.values,maxAccess:J,onChange:async(e,a)=>{if(W.setFieldValue("dtId",a?.recordId||""),U(a),W.setFieldValue("productionLineId",null),a?.recordId){let{record:e}=await r({extension:D.z.DocumentTypeDefault.get,parameters:`_dtId=${a?.recordId}`});e?.productionLineId&&W.setValues({...W.values,dtId:a?.recordId,productionLineId:e?.productionLineId,sketchId:null,sketchRef:"",sketchName:"",itemGroupId:null,itemGroupRef:"",itemGroupName:"",productionClassId:null,productionClassRef:"",productionClassName:"",productionStandardId:null,productionStandardRef:"",productionStandardName:"",collectionId:null,metalPurity:null,metalId:null,designGroupId:null,designFamilyId:null})}},readOnly:H,error:W.touched.dtId&&!!W.errors.dtId})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(h.Z,{name:"reference",label:E.reference,value:W.values.reference,rows:2,maxAccess:!H&&J,onChange:W.handleChange,readOnly:H,onClear:()=>W.setFieldValue("reference",""),error:W.touched.reference&&!!W.errors.reference})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:O.u.ProductionLine.qry,parameters:`_startAt=0&_pageSize=1000&_dtId=${W.values.dtId}`,values:W.values,name:"productionLineId",label:E.productionLine,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:!0,maxAccess:J,onChange:(e,a)=>{W.setFieldValue("productionLineId",a?.recordId||null)},error:W.touched.productionLineId&&W.errors.productionLineId})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{datasetId:S.v.THREED_DESIGN_SOURCE,name:"source",label:E.source,valueField:"key",displayField:"value",values:W.values,required:!0,maxAccess:J,onChange:(e,a)=>{W.setFieldValue("source",a?.key||null)},error:W.touched.source&&!!W.errors.source})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(w.U,{endpointId:D.z.Sketch.snapshot3,parameters:{_productionLineId:W.values.productionLineId||0},name:"sketchId",required:!0,label:E.sketchRef,secondDisplayField:!1,valueField:"reference",valueShow:"sketchRef",columnsInDropDown:[{key:"reference",value:"Reference"},{key:"date",value:"date",type:"date"},{key:"designerRef",value:"designer Ref"},{key:"designerName",value:"designer Name",grid:4}],form:W,displayFieldWidth:2,readOnly:Y,onChange:(e,a)=>{W.setValues({...W.values,sketchId:a?.recordId||null,sketchRef:a?.reference||"",sketchName:a?.name||"",itemGroupId:a?.itemGroupId||null,itemGroupRef:a?.itemGroupRef||"",itemGroupName:a?.itemGroupName||"",productionClassId:a?.productionClassId||null,productionClassRef:a?.productionClassRef||"",productionClassName:a?.productionClassName||"",productionStandardId:a?.productionStandardId||null,productionStandardRef:a?.productionStandardRef||"",productionStandardName:a?.productionStandardName||"",collectionId:a?.collectionId||null,metalPurity:a?.metalPurity||null,designFamilyId:a?.designFamilyId||null,designGroupId:a?.designGroupId||null,metalId:a?.metalId||null})},errorCheck:"sketchId",maxAccess:J})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:O.u.DesignFamily.qry,name:"designFamilyId",label:E.familyGroup,valueField:"recordId",displayField:"name",values:W.values,readOnly:!0,onChange:(e,a)=>W.setFieldValue("designFamilyId",a?.recordId||null),error:W?.touched?.designFamilyId&&!!W?.errors?.designFamilyId,maxAccess:J})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:O.u.DesignGroup.qry,name:"designGroupId",label:E.designGroup,valueField:"recordId",displayField:"name",values:W.values,readOnly:!0,onChange:(e,a)=>W.setFieldValue("designGroupId",a?.recordId||null),error:W?.touched?.designGroupId&&!!W?.errors?.designGroupId,maxAccess:J})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:D.z.Designer.qry,name:"designerId",label:E.designer,valueField:"recordId",displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"},{key:"typeName",value:"Type"}],readOnly:Y,maxAccess:J,values:W.values,onChange:(e,a)=>{W.setFieldValue("designerId",a?.recordId||null)},error:W.touched.designerId&&!!W.errors.designerId})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:V.$.Metals.qry,name:"metalId",label:E.purity,valueField:"recordId",displayField:["reference"],values:W.values,onChange:(e,a)=>{W.setFieldValue("metalId",a?.recordId||null),W.setFieldValue("metalPurity",a?.purity||null)},readOnly:Y,error:W.touched.metalId&&!!W.errors.metalId,maxAccess:J})})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:V.$.Group.qry,parameters:"_startAt=0&_pageSize=1000",values:W.values,name:"itemGroupId",label:E.itemGroup,valueField:"recordId",displayField:["reference","name"],displayFieldWidth:1,columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],readOnly:Y,maxAccess:J,onChange:(e,a)=>{W.setFieldValue("itemGroupId",a?.recordId||null)},error:W.touched.itemGroupId&&W.errors.itemGroupId})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:O.u.ProductionClass.qry,values:W.values,name:"productionClassId",label:E.productionClass,valueField:"recordId",readOnly:Y,displayField:"name",maxAccess:J,onChange:(e,a)=>{W.setFieldValue("productionClassId",a?.recordId||"")},error:W.touched.productionClassId&&!!W.errors.productionClassId})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:O.u.ProductionStandard.qry,values:W.values,name:"productionStandardId",label:E.productionStandard,valueField:"recordId",displayField:"reference",readOnly:Y,maxAccess:J,onChange:(e,a)=>{W.setFieldValue("productionStandardId",a?.recordId||"")},error:W.touched.productionStandardId&&!!W.errors.productionStandardId})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{endpointId:V.$.Collections.qry,name:"collectionId",label:E.collection,valueField:"recordId",readOnly:Y,displayField:["reference","name"],columnsInDropDown:[{key:"reference",value:"Reference"},{key:"name",value:"Name"}],maxAccess:J,values:W.values,onChange:(e,a)=>{W.setFieldValue("collectionId",a?.recordId)},error:W.touched.collectionId&&!!W.errors.collectionId})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(y.Z,{datasetId:S.v.CASTING_TYPE,name:"castingType",required:!0,label:E.castingType,valueField:"key",readOnly:Y,displayField:"value",values:W.values,maxAccess:J,onChange:(e,a)=>{W.setFieldValue("castingType",a?.key)},error:W.touched.castingType&&!!W.errors.castingType})})]})}),n.jsx(s(),{item:!0,xs:4,children:(0,n.jsxs)(s(),{container:!0,spacing:2,children:[n.jsx(s(),{item:!0,xs:12,sx:{marginTop:20.5},children:n.jsx(j.Z,{name:"date",label:E.date,value:W?.values?.date,onChange:W.setFieldValue,editMode:H,maxAccess:J,onClear:()=>W.setFieldValue("date",null),readOnly:Y,error:W.touched.date&&!!W.errors.date})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(Z.Z,{name:"startDate",readOnly:Y,label:E.startDate,onChange:W.setFieldValue,editMode:H,maxAccess:J,onClear:()=>W.setFieldValue("startDate",null),value:W.values?.startDate,error:W.errors?.startDate&&!!W.errors?.startDate})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(Z.Z,{name:"endDate",readOnly:Y,label:E.endDate,onChange:W.setFieldValue,editMode:H,maxAccess:J,onClear:()=>W.setFieldValue("endDate",null),value:W.values?.endDate,error:W.errors?.endDate&&!!W.errors?.endDate})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(F.Z,{name:"setPcs",label:E.setPcs,value:W.values.setPcs,maxAccess:J,readOnly:Y,onChange:W.handleChange,onClear:()=>W.setFieldValue("setPcs",0),error:W.touched.setPcs&&!!W.errors.setPcs})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(F.Z,{name:"weight",label:E.weight,value:W.values.weight,maxAccess:J,readOnly:Y,onChange:W.handleChange,onClear:()=>W.setFieldValue("weight",0),error:W.touched.weight&&!!W.errors.weight})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(h.Z,{name:"fileReference",required:!0,label:E.fileReference,value:W.values.fileReference,rows:2,maxAccess:J,onChange:W.handleChange,readOnly:Y,onClear:()=>W.setFieldValue("fileReference ",""),error:W.touched.fileReference&&!!W.errors.fileReference})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(h.Z,{name:"statusName",label:E.statusName,value:W.values.statusName,maxAccess:J,readOnly:!0})}),n.jsx(s(),{item:!0,xs:12,children:n.jsx(f.Z,{name:"notes",label:E.notes,value:W.values.notes,maxLength:"100",rows:2,maxAccess:J,onChange:W.handleChange,readOnly:Y,onClear:()=>W.setFieldValue("notes",""),error:W.touched.notes&&!!W.errors.notes})})]})}),n.jsx(s(),{item:!0,xs:4,children:n.jsx(A.Z,{ref:_,resourceId:I.i.ThreeDDesign,seqNo:0,recordId:e,height:250})})]})})})})};L.width=1200,L.height=700;let _=L;r()}catch(e){r(e)}})}};